(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["wizard-quick_start-QuickStartWizardController"],{5344:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"QuickStartWizardController":()=>i});class i extends BaseWizardController{constructor(e={}){_.defaults(e,{el:".wizard-bg",selected_province_index:-1,selected_country_index:-1}),super(e)}init(e){this.title=$.i18n._("Quick Start Wizard"),this.steps=5,this.current_step=1,this.render()}render(){super.render(),this.initCurrentStep()}buildCurrentStepUI(){var e=this;switch(this.content_div.empty(),this.stepsWidgetDic[this.current_step]={},this.current_step){case 1:(g=this.getLabel()).text($.i18n._("Welcome to")+" "+LocalCacheData.getApplicationName()+", "+$.i18n._("this Quick Start Wizard will walk you through the initial setup by asking you a few basic questions about your company."));var t=$('<div><span class="clear-both-div">'+$.i18n._("Press")+'<button style="display: inline" class="forward-btn"></button> '+$.i18n._("below to continue")+"</span></div>");this.content_div.append(g),this.content_div.append(t);break;case 2:Global.setWidgetEnabled(this.next_btn,!1),(g=this.getLabel()).text($.i18n._("Please choose the preferred settings that you would like to use to display information throughout")+" "+LocalCacheData.getApplicationName()+"."),this.content_div.append(g);var a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),i=a.find(".form-item-label"),r=a.find(".form-item-input-div"),n=this.getComboBox("time_zone",!0);i.text($.i18n._("Timezone")+": "),r.append(n),this.content_div.append(a),i=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),r=a.find(".form-item-input-div");var o=this.getComboBox("date_format",!0);i.text($.i18n._("Date Format")+": "),r.append(o),this.content_div.append(a),i=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),r=a.find(".form-item-input-div");var s=this.getComboBox("time_format",!0);i.text($.i18n._("Time Format")+": "),r.append(s),this.content_div.append(a),i=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),r=a.find(".form-item-input-div");var l=this.getComboBox("start_week_day",!0);i.text($.i18n._("Calendar Starts On")+": "),r.append(l),this.content_div.append(a),this.stepsWidgetDic[this.current_step][n.getField()]=n,this.stepsWidgetDic[this.current_step][o.getField()]=o,this.stepsWidgetDic[this.current_step][s.getField()]=s,this.stepsWidgetDic[this.current_step][l.getField()]=l;break;case 3:(g=this.getLabel()).text($.i18n._("Pay period schedules are critical to the operation of")+" "+LocalCacheData.getApplicationName()+" "+$.i18n._("regardless if you use it for processing payroll or not. Please select the pay period frequency and enter the start date, end date and transaction date (date the employees are paid) for your next four pay periods. Based on this information")+" "+LocalCacheData.getApplicationName()+" "+$.i18n._("will automatically create subsequent pay periods for you.")),this.content_div.append(g),i=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),r=a.find(".form-item-input-div");var d=this.getComboBox("type_id",!1);i.text($.i18n._("Pay Period Frequency")+": "),r.append(d),d.bind("formItemChange",(function(t,a){e.onFrequencyChange(a)})),this.content_div.append(a),this.stepsWidgetDic[this.current_step][d.getField()]=d;var c="example_dates",u=$("<div style='float: left; width: 100%'  class='grid-div wizard-grid-div'> <table id='"+c+"'></table></div>");this.setDateGrid(c,u,300);break;case 4:(g=this.getLabel()).text($.i18n._("To help determine how")+" "+LocalCacheData.getApplicationName()+" "+$.i18n._("should be initially setup, please select one or more locations that your employees reside within.")),this.content_div.append(g);t=$('<div><span class="clear-both-div">'+$.i18n._("Click")+' <button style="display: inline" class="plus-icon"></button> '+$.i18n._("icon to add additional locations")+"</span></div>");this.content_div.append(t);var _=$('<br><div><span class="clear-both-div">'+$.i18n._("Legal Entity")+"</span></div>");this.content_div.append(_);var p=Global.loadWidgetByName(FormItemType.AWESOME_BOX);p.TText({field:"legal_entity_id"}),p.AComboBox({api_class:TTAPI.APILegalEntity,allow_multiple_selection:!0,layout_name:"global_legal_entity",show_search_inputs:!1,set_empty:!0,custom_first_label:Global.all_item}),this.content_div.append(p),this.stepsWidgetDic[this.current_step].legal_entity_id=p;var h={country:$.i18n._("Country"),province:$.i18n._("Province/State")},m=Global.loadWidgetByName(FormItemType.INSIDE_EDITOR);m.InsideEditor({title:"",addRow:this.insideEditorAddRow,removeRow:this.insideEditorRemoveRow,getValue:this.insideEditorGetValue,setValue:this.insideEditorSetValue,parent_controller:this,render:"views/wizard/quick_start/QuickStartInsideEditorRender.html",render_args:h,row_render:"views/wizard/quick_start/QuickStartInsideEditorRow.html"}),m.addClass("wizard-inside-editor"),this.content_div.append(m),this.stepsWidgetDic[this.current_step].country=m;break;case 5:var g;(g=this.getLabel()).text(LocalCacheData.getApplicationName()+" "+$.i18n._("is now setup and ready for you to start adding employees and tracking their attendance.")),this.content_div.append(g);t=$('<div><span class="clear-both-div">'+$.i18n._("Click the")+' <button style="display: inline" class="done-btn"></button> '+$.i18n._("icon below to begin doing that now")+"</span></div>");this.content_div.append(t)}}initInsideEditorData(){var e=this.stepsDataDic[this.current_step],t=this.stepsWidgetDic[this.current_step].country;e?t.setValue(e.country):(t.removeAllRows(),t.addRow())}insideEditorSetValue(e){var t=e.length;if(this.removeAllRows(),t>0){for(var a=0;a<e.length;a++)if(Global.isSet(e[a])){var i=e[a];this.addRow(i)}}else this.addRow()}insideEditorRemoveRow(e){var t=e[0].rowIndex-1;e.remove(),this.rows_widgets_array.splice(t,1),this.removeLastRowLine()}insideEditorAddRow(e,t){var a=this;e||(e={country:LocalCacheData.getCurrentCompany().country,province:LocalCacheData.getCurrentCompany().province});var i=this.getRowRender(),r=this.getRender(),n={},o=$("<ul style='list-style: none; padding: 0; margin: 0;'></ul>"),s=$("<li class='widget-h-box' style='float: left; margin-right: 10px'></li>"),l=Global.loadWidgetByName(FormItemType.COMBO_BOX);l.TComboBox({field:"country",set_empty:!0,set_select_item_when_set_source_data:!0}),TTAPI.APICompany.getOptions("country",{onResult:function(d){var c=d.getResult();l.setSourceData(Global.buildRecordArray(c)),-1!=a.parent_controller.selected_country_index?l.setSelectedIndex(a.parent_controller.selected_country_index):(l.setValue(e.country),a.parent_controller.selected_country_index=l.getSelectedIndex()),e.country!=l.getValue()&&(e.country=l.getValue()),n[l.getField()]=l,l.bind("formItemChange",(function(e,t){a.parent_controller.selected_country_index=l.getSelectedIndex(),TTPromise.add("QuickStartWizard","setProvince"),a.parent_controller.setProvince({country:t.getValue(),province:""},u),TTPromise.wait("QuickStartWizard","setProvince",(function(){a.parent_controller.selected_province_index=u.getSelectedIndex()}))})),s.append(l),o.append(s),i.children().eq(0).append(o),o=$("<ul style='list-style: none; padding: 0; margin: 0;'></ul>"),s=$("<li class='widget-h-box' style='float: left; margin-right: 10px'></li>");var u=Global.loadWidgetByName(FormItemType.COMBO_BOX);u.TComboBox({field:"province",set_empty:!1}),TTPromise.add("QuickStartWizard","setProvince"),a.parent_controller.setProvince(e,u),TTPromise.wait("QuickStartWizard","setProvince",(function(){!function(e){void 0===t?a.parent_controller.selected_province_index=e.getSelectedIndex():(a.parent_controller.selected_province_index++,e.setSelectedIndex(a.parent_controller.selected_province_index))}(u)})),u.bind("formItemChange",(function(){a.parent_controller.selected_province_index=u.getSelectedIndex()})),n[u.getField()]=u,s.append(u),o.append(s),i.children().eq(1).append(o),void 0!==t?(i.insertAfter($(r).find("tr").eq(t)),a.rows_widgets_array.splice(t,0,n)):($(r).append(i),a.rows_widgets_array.push(n)),n.current_edit_item=e,a.addIconsEvent(i),a.removeLastRowLine(),a.removeLastRowLine()}})}setProvince(e,t){if(!e.country)return t.setSourceData([]),t.setValue(0),void TTPromise.reject("QuickStart","setProvince");TTAPI.APICompany.getOptions("province",e.country,{onResult:function(a){a=a.getResult(),t.setSourceData(Global.buildRecordArray(a)),t.setValue(e.province),TTPromise.resolve("QuickStartWizard","setProvince")}})}onFrequencyChange(e){var t,a=this.stepsWidgetDic[this.current_step].example_dates.getData();a&&a[0]&&(t=a[0].start_date),t&&this.setDefaultDates(!0)}setDateGrid(e,t,a){var i=this;this.content_div.append(t),a||(a=370),this.getGridColumns(e,(function(t){i.stepsWidgetDic[i.current_step][e]=new TTGrid(e,{sortable:!1,height:a,editurl:"QuickStart",multiselect:!1,onSelectRow:function(e){}},t),i.setGridSize(i.stepsWidgetDic[i.current_step][e]),i.setGridGroupColumns(e)}))}onTextInputRender(e,t,a){var i=t.colModel,r=t.rowId;return $('<div custom_cell="true" render_type="date_picker" id="'+r+"_"+i.name+'" class="t-date-picker-div"><input class="t-date-picker" type="text" value="'+e+'"></input><img id="tDatePickerIcon" class="t-date-picker-icon"></img>').get(0).outerHTML}onCloseClick(){var e=this;LocalCacheData.getCurrentCompany().is_setup_complete?($(e.el).remove(),LocalCacheData.current_open_wizard_controller=null):TAlertManager.showConfirmAlert($.i18n._("Would you like to be reminded to complete the Quick Start Wizard next time you login?"),"",(function(t){if(!t){var a={};a.id=LocalCacheData.getCurrentCompany().id,a.is_setup_complete=!0;var i=TTAPI.APICompany;LocalCacheData.getCurrentCompany().is_setup_complete=!0,i.setCompany(a,{onResult:function(){}})}$(e.el).remove(),LocalCacheData.current_open_wizard_controller=null}))}onStep3DatePickerChange(e){for(var t=this.stepsWidgetDic[this.current_step].example_dates,a=e.attr("id"),i=a.split("_")[0],r=a.substring(a.indexOf("_")+1,a.length),n=t.getData(),o=e.getValue(),s=n[0].start_date,l=n.length,d=0;d<l;d++){var c=n[d];if(c.id==i){c[r]=o,0===d&&"start_date"===r&&(s&&s!==o?this.setDefaultDates(!0):s||this.setDefaultDates());break}}}setDefaultDates(e){var t=this;function a(){var e=t.stepsWidgetDic[3].type_id.getValue(),a=t.stepsWidgetDic[3].example_dates,i=a.getData()[0].start_date;TTAPI.APIPayPeriodSchedule.detectPayPeriodScheduleDates(e,i,{onResult:function(e){var i=e.getResult();a.setData(i),t.setStep3CellDatePickers(a)}})}e?TAlertManager.showConfirmAlert($.i18n._("Would you like to pre-populate all date fields based on the first start date"),"",(function(e){e&&a()})):a()}getGridColumns(e,t){var a=[],i=this;switch(e){case"example_dates":var r={name:"start_date",index:"start_date",label:$.i18n._("Start Date"),width:100,sortable:!1,title:!1,formatter:function(e,t,a){return i.onTextInputRender(e,t,a)}};a.push(r),r={name:"end_date",index:"end_date",label:$.i18n._("End Date"),width:100,sortable:!1,title:!1,formatter:function(e,t,a){return i.onTextInputRender(e,t,a)}},a.push(r),r={name:"transaction_date",index:"transaction_date",label:$.i18n._("Transaction Date"),width:100,sortable:!1,title:!1,formatter:function(e,t,a){return i.onTextInputRender(e,t,a)}},a.push(r)}t(a)}buildCurrentStepData(){var e=this,t=this.stepsDataDic[this.current_step],a=this.stepsWidgetDic[this.current_step],i=0;switch(this.current_step){case 2:Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1);var r=TTAPI.APIUserPreference,n=TTAPI.APIAuthentication;r.getOptions("time_zone",{onResult:function(e){if(a.time_zone.setSourceData(Global.buildRecordArray(e.getResult())),t)for(var i in t)t.hasOwnProperty(i)&&a[i].setValue(t[i]);o()}}),r.getOptions("time_format",{onResult:function(e){if(a.time_format.setSourceData(Global.buildRecordArray(e.getResult())),t)for(var i in t)t.hasOwnProperty(i)&&a[i].setValue(t[i]);o()}}),r.getOptions("start_week_day",{onResult:function(e){if(a.start_week_day.setSourceData(Global.buildRecordArray(e.getResult())),t)for(var i in t)t.hasOwnProperty(i)&&a[i].setValue(t[i]);o()}}),n.getCurrentUserPreference({onResult:function(e){!function(e){var i=a.time_zone,n=a.date_format,s=a.time_format,l=a.start_week_day;"en"===e.language?r.getOptions("date_format",{onResult:function(r){if(a.date_format.setSourceData(Global.buildRecordArray(r.getResult())),t)for(var o in t)t.hasOwnProperty(o)&&a[o].setValue(t[o]);else i.setValue(e.time_zone),n.setValue(e.date_format),s.setValue(e.time_format),l.setValue(e.start_week_day)}}):r.getOptions("other_date_format",{onResult:function(r){if(a.date_format.setSourceData(Global.buildRecordArray(r.getResult())),t)for(var o in t)t.hasOwnProperty(o)&&a[o].setValue(t[o]);else i.setValue(e.time_zone),n.setValue(e.date_format),s.setValue(e.time_format),l.setValue(e.start_week_day)}});o()}(e.getResult())}});break;case 3:TTAPI.APIPayPeriodSchedule.getOptions("type",{onResult:function(i){var r=Global.buildRecordArray(i.getResult());if(r.splice(0,1),a.type_id.setSourceData(r),t){var n=t.example_dates,o=a.example_dates;o.setData(n),e.setStep3CellDatePickers(o),a.type_id.setValue(t.type_id)}else!function(){var t=[{start_date:"",end_date:"",transaction_date:""},{start_date:"",end_date:"",transaction_date:""},{start_date:"",end_date:"",transaction_date:""},{start_date:"",end_date:"",transaction_date:""}],i=a.example_dates;i.setData(t),e.setStep3CellDatePickers(i)}()}});break;case 4:e.initInsideEditorData()}function o(){4===(i+=1)&&(Global.setWidgetEnabled(e.next_btn,!0),Global.setWidgetEnabled(e.back_btn,!0))}}setStep3CellDatePickers(e){for(var t=e.grid.find('div[custom_cell="true"]'),a=this,i=0;i<t.length;i++){$(t[i]).TDatePicker({width:290}).bind("formItemChange",(function(e,t){a.onStep3DatePickerChange(t)}))}}onDoneClick(){super.onDoneClick(),$(this.el).remove(),LocalCacheData.current_open_wizard_controller=null,IndexViewController.goToView("Employee")}insideEditorGetValue(){for(var e=this.rows_widgets_array.length,t=[],a=0;a<e;a++){var i=this.rows_widgets_array[a],r={country:i.country.getValue(),province:i.province.getValue()};t.push(r)}return t}onNextClick(){var e=this;this.saveCurrentStep("forward",(function(t){Global.setWidgetEnabled(e.next_btn,!0),Global.setWidgetEnabled(e.back_btn,!0),t&&(e.current_step=e.current_step+1,e.initCurrentStep())}))}onBackClick(){var e=this;this.saveCurrentStep("back",(function(t){Global.setWidgetEnabled(e.next_btn,!0),Global.setWidgetEnabled(e.back_btn,!0),t&&(e.current_step=e.current_step-1,e.initCurrentStep())}))}saveCurrentStep(e,t){this.stepsDataDic[this.current_step]={};var a=this.stepsDataDic[this.current_step],i=this.stepsWidgetDic[this.current_step];switch(this.current_step){case 1:t(!0);break;case 2:if(Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1),a.time_zone=i.time_zone.getValue(),a.time_format=i.time_format.getValue(),a.date_format=i.date_format.getValue(),a.start_week_day=i.start_week_day.getValue(),"forward"===e){var r=TTAPI.APIAuthentication,n=TTAPI.APIUserPreference;r.getCurrentUserPreference({onResult:function(e){var i=e.getResult();i.date_format=a.date_format,i.time_format=a.time_format,i.time_zone=a.time_zone,i.start_week_day=a.start_week_day,n.setUserPreference(i,{onResult:function(){Global.updateUserPreference((function(){t(!0)}))}})}})}else t(!0);break;case 3:if(Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1),a.type_id=i.type_id.getValue(),a.example_dates=i.example_dates.getGridParam("data"),"forward"===e){var o=TTAPI.APIPayPeriodSchedule;o.detectPayPeriodScheduleSettings(a.type_id,a.example_dates,{onResult:function(e){(e=e.getResult()).hasOwnProperty("company_id")?o.setPayPeriodSchedule(e,{onResult:function(e){e.isValid()?t(!0):(TAlertManager.showErrorAlert(e),t(!1))}}):t(!0)}})}else t(!0);break;case 4:Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.back_btn,!1),a.country=i.country.getValue(),a.legal_entity_id=null;var s=i.legal_entity_id.getValue(!0);if(s&&s.length>0)for(var l in a.legal_entity_id=[],s)a.legal_entity_id.push(s[l].id);if("forward"===e)TTAPI.APISetupPresets.createPresets(a.country,a.legal_entity_id,{onResult:function(e){e.isValid?t(!0):(TAlertManager.showErrorAlert(e),t(!1))}});else t(!0);break;case 5:t(!0)}}}}}]);
//# sourceMappingURL=wizard-quick_start-QuickStartWizardController.bundle.js.map?v=5e2000ea17d3e0e35d23