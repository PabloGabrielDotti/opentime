{"version":3,"sources":["webpack://timetrex/./interface/html5/views/login/LoginViewController.js"],"names":["LoginViewController","BaseViewController","options","_","defaults","el","authentication_api","currentUser_api","currency_api","user_preference_api","user_locale","is_login","date_api","permission_api","doing_login","lan_selector","default","events","super","$this","this","Global","setVirtualDeviceViewport","TTAPI","APIAuthentication","APICurrency","APIUserPreference","APITTDate","APIPermission","viewId","topContainer","css","bottomContainer","contentContainer","removeClass","$","hide","LocalCacheData","getLoginData","cleanNecessaryCache","session_cookie","getCookie","getSessionIDKey","length","is_logged_in","timeout_count","invisible","loadViewRequiredJSReady","Debug","Text","autoLogin","auto_login_timer","setInterval","clearInterval","TAlertManager","showAlert","i18n","visible","render","notification_bar","remove","window","open","loginData","organization_url","ServiceCaller","root_url","base_url","e","preventDefault","user_name","val","password","cr_text","text","_0xee93","sendErrorReport","refreshCSRFToken","login","onResult","onLoginSuccess","onError","delegate","session_id","result","getResult","closeBrowserBanner","isValid","setSessionID","clearSessionCookie","getDetails","hasOwnProperty","IndexViewController","openWizard","message","getDetailsAsString","focus","cancel_all_error","setCookie","initializeLoginData","TTPromise","add","getCurrentUser","onGetCurrentUser","getCurrentUserPreference","onGetCurrentUserPreference","getLocale","onGetCurrentUserLocale","getPermissions","permissionRes","permission_result","setPermissionData","resolve","Logout","location","reload","getCurrentCompany","current_company_result","com_result","is_setup_complete","setCurrentCompany","APIGlobal","pre_login_data","application_build","UNIT_TEST_MODE","getUniqueCountry","country_result","setUniqueCountryArray","wait","goToView","setLoginUser","filter","filter_data","user_id","loginUser","id","filter_columns","symbol","get","getCurrency","raw_result","isArrayAndHasItems","setCurrentCurrencySymbol","login_view_this","handleDateTimeFormats","nextResult","loginUserPreference","getOptions","jsDateFormatRes","jsDateFormatResultData","js_date_format","date_format","date_format_1","convertTojQueryFormat","time_format_1","time_format","jsTimeFormatRes","jsTimeFormatResultData","js_time_format","setLoginUserPreference","getUserPreferenceDefaultData","userPD","TopMenuManager","ribbon_view_controller","ribbon_menus","empty","currentShownContextMenuName","message_id","TTUUID","generateUUID","locale","ProgressBar","showProgressBar","changeProgressBarMessage","setLanguageCookie","setI18nDic","setTimeout","instance","router","removeCurrentView","target_view","deleteCookie","cookie_path","getHost","getDeepLink","previous_session_cookie","decodeURIComponent","JSON","parse","previous_session_id","cookie_base_url","getLoginUserPreference","default_login_screen","PermissionManager","checkTopLevelPermission","current_company","getLoginUser","setAnalyticDimensions","first_name","name","hasClass","renderAnimalsForBackground","passwordInput","TTextInput","width","username_input","error_string_td","login_error_string","on","onLoginBtnClick","html","url","theme","url_offset","productEditionId","appType","attr","quick_punch_link","find","show","animate","opacity","getURLByObjectType","height","powered_by_img","application_name","powered_by_link","addClass","wrap","footer_right_html","footer_left_html","type","insertAfter","TComboBox","array","buildRecordArray","setSourceData","setValue","language","bind","getValue","getAllURLArgs","moveCookiesToNewPath","setUIInitComplete","callBack","cleanWhenUnloadView","station_id","getStationID","station_id_arr","match","isArray","join","season","season_images_arr","month_of_year","moment","month","day_of_month","date","date_seed","week","getEnable","Object","keys","Math","floor","random","seed","parseInt","charCodeAt","season_total_images","bg_image","abs","sin","replace"],"mappings":"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","file":"login-LoginViewController.bundle.js?v=880a407db5bf52d69018","sourcesContent":["export class LoginViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#loginViewContainer', //Must set el here and can only set string, so events can work\n\n\t\t\tauthentication_api: null,\n\t\t\tcurrentUser_api: null,\n\t\t\tcurrency_api: null,\n\t\t\tuser_preference_api: null,\n\t\t\tuser_locale: 'en_US',\n\t\t\tis_login: true,\n\t\t\tdate_api: null,\n\t\t\tpermission_api: null,\n\n\t\t\tdoing_login: false,\n\n\t\t\tlan_selector: null,\n\n\t\t\tdefault: {\n\t\t\t\tis_login: false\n\t\t\t},\n\n\t\t\tevents: {\n\t\t\t\t'click #quick_punch': 'onQuickPunchClick',\n\t\t\t\t'click #forgot_password': 'forgotPasswordClick',\n\t\t\t\t'click #appTypeLogo': 'onAppTypeClick',\n\t\t\t\t'click #companyLogo': 'onAppTypeClick',\n\t\t\t\t'click #powered_by': 'onAppTypeClick'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tvar $this = this;\n\t\tGlobal.setVirtualDeviceViewport( 'mobile' ); // Setting mobile view on login, then back to desktop (990px virtual) after login, to allow pan & zoom, as not whole app is mobile optimized.\n\t\tthis.authentication_api = TTAPI.APIAuthentication;\n\t\tthis.currentUser_api = TTAPI.APIAuthentication;\n\t\tthis.currency_api = TTAPI.APICurrency;\n\t\tthis.user_preference_api = TTAPI.APIUserPreference;\n\t\tthis.date_api = TTAPI.APITTDate;\n\t\tthis.permission_api = TTAPI.APIPermission;\n\t\tthis.viewId = 'LoginView';\n\t\tGlobal.topContainer().css( 'display', 'none' );\n\t\tGlobal.bottomContainer().css( 'display', 'none' );\n\t\tGlobal.contentContainer().removeClass( 'content-container-after-login' );\n\t\tGlobal.topContainer().removeClass( 'top-container-after-login' );\n\t\t$( '.hide-in-login' ).hide(); // hide left + top navigation menu after logout\n\n\t\tvar login_data = LocalCacheData.getLoginData();\n\n\t\t//Clean cache that saved in some views\n\t\tLocalCacheData.cleanNecessaryCache();\n\t\tvar session_cookie = getCookie( Global.getSessionIDKey() );\n\t\tif ( session_cookie && session_cookie.length >= 40 && LocalCacheData.getLoginData().is_logged_in ) {\n\t\t\tvar timeout_count = 0;\n\t\t\t$( this.el ).invisible();\n\t\t\t//JS load Optimize\n\t\t\t// Do auto login when all js load ready\n\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\tDebug.Text( 'Login Success (first try)', null, null, 'initialize', 10 );\n\t\t\t\t$this.autoLogin();\n\t\t\t} else {\n\t\t\t\tvar auto_login_timer = setInterval( function() {\n\t\t\t\t\tif ( timeout_count == 100 ) {\n\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'The network connection was lost. Please check your network connection then try again.' ) );\n\t\t\t\t\t\tDebug.Text( 'Login Failure', null, null, 'initialize', 10 );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\ttimeout_count = timeout_count + 1;\n\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\tDebug.Text( 'Login Success after retry: ' + timeout_count, null, null, 'initialize', 10 );\n\t\t\t\t\t\t$this.autoLogin();\n\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t}\n\t\t\t\t}, 600 );\n\t\t\t}\n\t\t} else {\n\t\t\t$( this.el ).visible();\n\t\t\tthis.render();\n\t\t}\n\n\t\tif ( LocalCacheData.notification_bar ) {\n\t\t\tLocalCacheData.notification_bar.remove();\n\t\t}\n\n\t\t//Global.setAnalyticDimensions(); // #2140 - handled in main.js main thread instead.\n\t}\n\n\tonAppTypeClick() {\n\t\twindow.open( 'https://' + LocalCacheData.loginData.organization_url );\n\t}\n\n\tonQuickPunchClick() {\n\t\twindow.open( ServiceCaller.root_url + LocalCacheData.loginData.base_url + 'html5/quick_punch' );\n\t}\n\n\tonLoginBtnClick( e ) {\n\t\te.preventDefault(); //Prevent login form from being submitted, as Chrome will append a \"?\" to the end of a URL and cancel the XHR login request. This is also affecting the enter key press binding in render()\n\n\t\tvar user_name = $( '#user_name' ).val();\n\t\tvar password = $( '#password' ).val();\n\t\tvar $this = this;\n\n\t\tif ( !this.doing_login ) {\n\t\t\tthis.doing_login = true;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\t//Catch blank username/passwords as early as possible. This may catch some bots from attempting to login as well.\n\t\tif ( user_name == '' || password == '' ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Please enter a user name and password.' ) );\n\t\t\tthis.doing_login = false;\n\t\t\treturn;\n\t\t}\n\n\t\tvar cr_text = $( \"\\x23\\x6C\\x6F\\x67\\x69\\x6E\\x5F\\x63\\x6F\\x70\\x79\\x5F\\x72\\x69\\x67\\x68\\x74\\x5F\\x69\\x6E\\x66\\x6F\" ).text();\n\t\tvar _0xee93 = [\"\\x6F\\x6E\\x6C\\x6F\\x61\\x64\", \"\\x74\\x6F\\x74\\x61\\x6C\", \"\\x43\\x6F\\x70\\x79\\x72\\x69\\x67\\x68\\x74\\x20\", \"\\x69\\x6E\\x64\\x65\\x78\\x4F\\x66\", \"\\x6F\\x72\\x67\\x61\\x6E\\x69\\x7A\\x61\\x74\\x69\\x6F\\x6E\\x5F\\x6E\\x61\\x6D\\x65\", \"\\x6C\\x6F\\x67\\x69\\x6E\\x44\\x61\\x74\\x61\", \"\\x41\\x6C\\x6C\\x20\\x52\\x69\\x67\\x68\\x74\\x73\\x20\\x52\\x65\\x73\\x65\\x72\\x76\\x65\\x64\", \"\\x45\\x52\\x52\\x4F\\x52\\x3A\\x20\\x54\\x68\\x69\\x73\\x20\\x69\\x6E\\x73\\x74\\x61\\x6C\\x6C\\x61\\x74\\x69\\x6F\\x6E\\x20\\x6F\\x66\\x20\", \"\\x61\\x70\\x70\\x6C\\x69\\x63\\x61\\x74\\x69\\x6F\\x6E\\x5F\\x6E\\x61\\x6D\\x65\", \"\\x20\\x69\\x73\\x20\\x69\\x6E\\x20\\x76\\x69\\x6F\\x6C\\x61\\x74\\x69\\x6F\\x6E\\x20\\x6F\\x66\\x20\\x74\\x68\\x65\\x20\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x20\\x61\\x67\\x72\\x65\\x65\\x6D\\x65\\x6E\\x74\\x21\", \"\\x73\\x68\\x6F\\x77\\x41\\x6C\\x65\\x72\\x74\", \"\\x67\\x65\\x74\\x52\\x65\\x73\\x70\\x6f\\x6e\\x73\\x65\\x48\\x65\\x61\\x64\\x65\\x72\", \"\\x43\\x6f\\x6e\\x74\\x65\\x6e\\x74\\x2d\\x4c\\x65\\x6e\\x67\\x74\\x68\", \"\\x54\\x69\\x6D\\x65\\x54\\x72\\x65\\x78\", \"\\x23\\x70\\x6F\\x77\\x65\\x72\\x65\\x64\\x5F\\x62\\x79\", \"\\x6E\\x61\\x74\\x75\\x72\\x61\\x6C\\x57\\x69\\x64\\x74\\x68\", \"\\x6E\\x61\\x74\\x75\\x72\\x61\\x6C\\x48\\x65\\x69\\x67\\x68\\x74\"];\n\t\tif ( ( !$( _0xee93[14] )[0] || ( $( _0xee93[14] )[0] && ( ( $( _0xee93[14] )[0][_0xee93[15]] > 0 && $( _0xee93[14] )[0][_0xee93[15]] != 145 ) || ( $( _0xee93[14] )[0][_0xee93[16]] > 0 && $( _0xee93[14] )[0][_0xee93[16]] != 40 ) ) ) ) || cr_text[_0xee93[3]]( _0xee93[2] ) !== 0 || LocalCacheData[_0xee93[5]][_0xee93[8]][_0xee93[3]]( _0xee93[13] ) !== 0 || cr_text[_0xee93[3]]( _0xee93[13] ) !== 17 ) {\n\t\t\tGlobal.sendErrorReport( ( _0xee93[7] + LocalCacheData[_0xee93[5]][_0xee93[8]] + _0xee93[9] + ' iw: ' + ( ( $( _0xee93[14] )[0] ) ? $( _0xee93[14] )[0][_0xee93[15]] : 0 ) + ' ih: ' + ( ( $( _0xee93[14] )[0] ) ? $( _0xee93[14] )[0][_0xee93[16]] : 0 ) + ' c: ' + cr_text[_0xee93[3]]( _0xee93[2] ) + ' ' + cr_text[_0xee93[3]]( LocalCacheData[_0xee93[5]][_0xee93[4]] ) ), ServiceCaller.root_url, '', '', '' );\n\t\t}\n\n\t\tif ( this.authentication_api ) {\n\t\t\t//Check to make sure a CSRF token cookie exists, if not refresh it.\n\t\t\tGlobal.refreshCSRFToken( function( e ) {\n\t\t\t\t$this.authentication_api.login( user_name, password, {\n\t\t\t\t\tonResult: function( e ) {\n\t\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\t\tDebug.Text( 'Login Success (first try)', null, null, 'onLoginBtnClick', 10 );\n\t\t\t\t\t\t\t$this.onLoginSuccess( e );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar timeout_count = 0;\n\t\t\t\t\t\t\tvar auto_login_timer = setInterval( function() {\n\t\t\t\t\t\t\t\tif ( timeout_count == 100 ) {\n\t\t\t\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'The network connection was lost. Please check your network connection then try again.' ) );\n\t\t\t\t\t\t\t\t\tDebug.Text( 'Login Failure', null, null, 'onLoginBtnClick', 10 );\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttimeout_count = timeout_count + 1;\n\t\t\t\t\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t\t\t\t\t$this.onLoginSuccess( e );\n\t\t\t\t\t\t\t\t\tDebug.Text( 'Login Success after retry: ' + timeout_count, null, null, 'onLoginBtnClick', 10 );\n\t\t\t\t\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 600 );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonError: function( e ) {\n\t\t\t\t\t\tDebug.Text( 'Login Error...', null, null, 'onLoginBtnClick', 10 );\n\t\t\t\t\t\t$this.doing_login = false;\n\t\t\t\t\t},\n\t\t\t\t\tdelegate: this\n\t\t\t\t} )\n\t\t\t});\n\t\t}\n\t}\n\n\tonLoginSuccess( e, session_id ) {\n\t\tvar result;\n\t\tvar $this = this;\n\n\t\tif ( !session_id ) {\n\t\t\tresult = e.getResult();\n\t\t} else {\n\t\t\tresult = session_id;\n\t\t}\n\n\t\tTAlertManager.closeBrowserBanner();\n\n\t\tvar user_name = $( '#user_name' );\n\t\tvar password = $( '#password' );\n\n\t\tif ( e && !e.isValid() ) {\n\t\t\tLocalCacheData.setSessionID( '' );\n\n\t\t\tGlobal.clearSessionCookie();\n\n\t\t\tif ( e.getDetails()[0] && e.getDetails()[0].hasOwnProperty( 'password' ) ) {\n\t\t\t\tIndexViewController.openWizard( 'ResetPasswordWizard', {\n\t\t\t\t\tuser_name: user_name.val(),\n\t\t\t\t\tmessage: e.getDetailsAsString()\n\t\t\t\t}, function() {\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Password has been changed successfully, you may now login.' ), '', function() {\n\t\t\t\t\t\tpassword.focus();\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tTAlertManager.showAlert( e.getDetailsAsString(), 'Error', function() {\n\t\t\t\t\tpassword.focus();\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t$this.doing_login = false;\n\t\t} else {\n\n\t\t\tServiceCaller.cancel_all_error = false;\n\t\t\tLocalCacheData.setSessionID( result );\n\t\t\tsetCookie( Global.getSessionIDKey(), result );\n\n\t\t\tif ( typeof is_login === 'undefined' ) {\n\t\t\t\tthis.is_login = true;\n\t\t\t}\n\n\t\t\t//Error: TypeError: this.currentUser_api.getCurrentUserPreference is not a function in /interface/html5/framework/jquery.min.js?v=8.0.4-20150320-094021 line 2 > eval line 205\n\t\t\tif ( !this.currentUser_api || typeof this.currentUser_api['getCurrentUserPreference'] !== 'function' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$this.initializeLoginData();\n\t\t}\n\t}\n\n\tinitializeLoginData() {\n\t\tvar $this = this;\n\n\t\tTTPromise.add( 'login', 'init' );\n\n\t\tTTPromise.add( 'login', 'getCurrentUser' );\n\t\t$this.currentUser_api.getCurrentUser( { onResult: $this.onGetCurrentUser, delegate: $this } ); //Get more in result handler\n\n\t\tTTPromise.add( 'login', 'getCurrentUserPreference' );\n\t\t$this.currentUser_api.getCurrentUserPreference( {\n\t\t\tonResult: $this.onGetCurrentUserPreference,\n\t\t\tdelegate: $this\n\t\t} );\n\n\t\t//Ensure that the language chosen at the login screen is passed in so that the user's country can be appended to create a proper locale.\n\t\tTTPromise.add( 'login', 'getCurrentUserLocale' );\n\t\t$this.authentication_api.getLocale( $( '.language-selector' ).val(), {\n\t\t\tonResult: $this.onGetCurrentUserLocale,\n\t\t\tdelegate: $this\n\t\t} );\n\n\t\tTTPromise.add( 'login', 'getPermission' );\n\t\t$this.permission_api.getPermissions( {\n\t\t\tonResult: function( permissionRes ) {\n\t\t\t\tvar permission_result = permissionRes.getResult();\n\n\t\t\t\tif ( permission_result != false ) {\n\t\t\t\t\tLocalCacheData.setPermissionData( permission_result );\n\t\t\t\t\tTTPromise.resolve( 'login', 'getPermission' );\n\t\t\t\t} else {\n\t\t\t\t\t//User does not have any permissions.\n\t\t\t\t\tDebug.Text( 'User does not have any permissions!', 'LoginViewController.js', 'LoginViewController', 'initializeLoginData:next', 10 );\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Unable to login due to permissions, please try again and if the problem persists contact customer support.' ), '', function() {\n\t\t\t\t\t\tGlobal.Logout();\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\tTTPromise.add( 'login', 'getCurrentCompany' );\n\t\t$this.authentication_api.getCurrentCompany( {\n\t\t\tonResult: function( current_company_result ) {\n\t\t\t\tvar com_result = current_company_result.getResult();\n\n\t\t\t\tif ( com_result != false ) {\n\t\t\t\t\tif ( com_result.is_setup_complete === '1' || com_result.is_setup_complete === 1 ) {\n\t\t\t\t\t\tcom_result.is_setup_complete = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcom_result.is_setup_complete = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tLocalCacheData.setCurrentCompany( com_result );\n\t\t\t\t\tDebug.Text( 'Version: Client: ' + APIGlobal.pre_login_data.application_build + ' Server: ' + com_result.application_build, 'LoginViewController.js', 'LoginViewController', 'onUserPreference:next', 10 );\n\n\t\t\t\t\t//Avoid reloading in unit test mode.\n\t\t\t\t\tif ( APIGlobal.pre_login_data.application_build != com_result.application_build && !Global.UNIT_TEST_MODE ) {\n\t\t\t\t\t\tDebug.Text( 'Version mismatch on login: Reloading...', 'LoginViewController.js', 'LoginViewController', 'initializeLoginData:next', 10 );\n\t\t\t\t\t\twindow.location.reload( true );\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'login', 'getCurrentCompany' );\n\t\t\t\t} else {\n\t\t\t\t\t//User does not have any permissions.\n\t\t\t\t\tDebug.Text( 'Unable to get company information!', 'LoginViewController.js', 'LoginViewController', 'onUserPreference:next', 10 );\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Unable to download required information, please check your network connection and try again. If the problem persists contact customer support.' ), '', function() {\n\t\t\t\t\t\tGlobal.Logout();\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\tTTPromise.add( 'login', 'getUniqueCountry' );\n\t\t$this.permission_api.getUniqueCountry( {\n\t\t\tonResult: function( country_result ) {\n\t\t\t\tLocalCacheData.setUniqueCountryArray( country_result.getResult() );\n\t\t\t\tTTPromise.resolve( 'login', 'getUniqueCountry' );\n\t\t\t}\n\t\t} );\n\n\t\t//Once all login promises are complete, switch to home view.\n\t\tTTPromise.wait( 'login', null, function() {\n\t\t\t$this.goToView();\n\t\t} );\n\n\t\tTTPromise.resolve( 'login', 'init' );\n\t}\n\n\tonGetCurrentUser( e ) {\n\t\tLocalCacheData.setLoginUser( e.getResult() );\n\n\t\tvar filter = {};\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.user_id = LocalCacheData.loginUser.id;\n\t\tfilter.filter_columns = {};\n\t\tfilter.filter_columns.symbol = true;\n\n\t\te.get( 'delegate' ).currency_api.getCurrency( filter, {\n\t\t\tonResult: function( raw_result ) {\n\t\t\t\tvar result = raw_result.getResult();\n\n\t\t\t\tif ( Global.isArrayAndHasItems( result ) && result[0].symbol ) {\n\t\t\t\t\tLocalCacheData.setCurrentCurrencySymbol( result[0].symbol );\n\t\t\t\t} else {\n\t\t\t\t\tLocalCacheData.setCurrentCurrencySymbol( '$' );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\tTTPromise.resolve( 'login', 'getCurrentUser' );\n\t}\n\n\tonGetCurrentUserPreference( e ) {\n\t\tvar result = e.getResult();\n\t\tvar login_view_this = e.get( 'delegate' );\n\n\t\tif ( result.date_format ) {\n\t\t\thandleDateTimeFormats( result );\n\t\t} else {\n\t\t\tlogin_view_this.user_preference_api.getUserPreferenceDefaultData( {\n\t\t\t\tonResult: function( userPD ) {\n\t\t\t\t\thandleDateTimeFormats( userPD.getResult() );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction handleDateTimeFormats( nextResult ) {\n\t\t\tLocalCacheData.loginUserPreference = nextResult;\n\n\t\t\tTTPromise.add( 'getCurrentUserPreference', 'getDateFormat' );\n\t\t\tlogin_view_this.user_preference_api.getOptions( 'moment_date_format', {\n\t\t\t\tonResult: function( jsDateFormatRes ) {\n\t\t\t\t\tvar jsDateFormatResultData = jsDateFormatRes.getResult();\n\n\t\t\t\t\t//For moment date parser\n\t\t\t\t\tLocalCacheData.loginUserPreference.js_date_format = jsDateFormatResultData;\n\n\t\t\t\t\tvar date_format = LocalCacheData.loginUserPreference.date_format;\n\t\t\t\t\tif ( !date_format ) {\n\t\t\t\t\t\tdate_format = 'DD-MMM-YY';\n\t\t\t\t\t}\n\n\t\t\t\t\tLocalCacheData.loginUserPreference.date_format = LocalCacheData.loginUserPreference.js_date_format[date_format];\n\n\t\t\t\t\tLocalCacheData.loginUserPreference.date_format_1 = Global.convertTojQueryFormat( date_format ); //TDatePicker, TRangePicker\n\t\t\t\t\tLocalCacheData.loginUserPreference.time_format_1 = Global.convertTojQueryFormat( LocalCacheData.loginUserPreference.time_format ); //TTimePicker\n\n\t\t\t\t\tTTPromise.resolve( 'getCurrentUserPreference', 'getDateFormat' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tTTPromise.add( 'getCurrentUserPreference', 'getTimeFormat' );\n\t\t\tlogin_view_this.user_preference_api.getOptions( 'moment_time_format', {\n\t\t\t\tonResult: function( jsTimeFormatRes ) {\n\t\t\t\t\tvar jsTimeFormatResultData = jsTimeFormatRes.getResult();\n\n\t\t\t\t\tLocalCacheData.loginUserPreference.js_time_format = jsTimeFormatResultData;\n\t\t\t\t\tTTPromise.resolve( 'getCurrentUserPreference', 'getTimeFormat' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tTTPromise.wait( 'getCurrentUserPreference', null, function() {\n\t\t\t\tLocalCacheData.setLoginUserPreference( LocalCacheData.loginUserPreference );\n\t\t\t\tTTPromise.resolve( 'login', 'getCurrentUserPreference' );\n\t\t\t} );\n\t\t}\n\t}\n\n\tonGetCurrentUserLocale( e ) {\n\t\tvar login_view_this = e.get( 'delegate' );\n\t\tvar result = e.getResult();\n\t\tif ( result ) {\n\t\t\tlogin_view_this.user_locale = result;\n\t\t}\n\n\t\tTTPromise.resolve( 'login', 'getCurrentUserLocale' );\n\t}\n\n\tgoToView() {\n\t\tthis.doing_login = false;\n\t\tTopMenuManager.ribbon_view_controller = null;\n\t\tTopMenuManager.ribbon_menus = null;\n\t\tGlobal.topContainer().empty();\n\t\tLocalCacheData.currentShownContextMenuName = null;\n\n\t\tvar message_id = TTUUID.generateUUID();\n\t\tif ( LocalCacheData.getLoginData().locale != null && this.user_locale !== LocalCacheData.getLoginData().locale ) {\n\t\t\tProgressBar.showProgressBar( message_id );\n\t\t\tProgressBar.changeProgressBarMessage( $.i18n._( 'Language changed, reloading' ) + '...' );\n\n\t\t\tGlobal.setLanguageCookie( this.user_locale );\n\t\t\tLocalCacheData.setI18nDic( null );\n\t\t\tsetTimeout( function() {\n\t\t\t\twindow.location.reload( true );\n\t\t\t}, 5000 );\n\t\t}\n\t\tIndexViewController.instance.router.removeCurrentView();\n\t\tvar target_view = getCookie( 'PreviousSessionType' );\n\t\tif ( target_view && getCookie( 'PreviousSessionID' ) ) {\n\t\t\tTopMenuManager.goToView( target_view );\n\t\t\tdeleteCookie( 'PreviousSessionType', LocalCacheData.cookie_path, Global.getHost() );\n\t\t} else {\n\t\t\tif ( Global.getDeepLink() != false ) {\n\n\t\t\t\t//Catch users coming back from a masquerade, and prevent deeplink override after returning them to the view that they started masquerading from.\n\t\t\t\tvar previous_session_cookie = decodeURIComponent( getCookie( 'AlternateSessionData' ) );\n\t\t\t\tif ( previous_session_cookie ) {\n\t\t\t\t\t//The user has been masquerading.\n\t\t\t\t\tprevious_session_cookie = JSON.parse( previous_session_cookie );\n\t\t\t\t\tif ( previous_session_cookie && typeof previous_session_cookie.previous_session_id == 'undefined' ) {\n\t\t\t\t\t\t//Now using original account, so clear the deeplinking override in the AlternateSessionData cookie.\n\t\t\t\t\t\tsetCookie( 'AlternateSessionData', '{}', -1, APIGlobal.pre_login_data.cookie_base_url, Global.getHost() );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tTopMenuManager.goToView( Global.getDeepLink() );\n\t\t\t} else if ( LocalCacheData.getLoginUserPreference().default_login_screen ) {\n\t\t\t\tTopMenuManager.goToView( LocalCacheData.getLoginUserPreference().default_login_screen );\n\t\t\t} else {\n\t\t\t\tTopMenuManager.goToView( 'Home' );\n\t\t\t}\n\t\t}\n\n\t\tif ( !LocalCacheData.getCurrentCompany().is_setup_complete && PermissionManager.checkTopLevelPermission( 'QuickStartWizard' ) ) {\n\t\t\tIndexViewController.openWizard( 'QuickStartWizard' );\n\t\t}\n\n\t\tvar current_company = LocalCacheData.getCurrentCompany();\n\t\tif ( LocalCacheData && current_company && LocalCacheData.getLoginUser() ) {\n\t\t\tGlobal.setAnalyticDimensions( LocalCacheData.getLoginUser().first_name + ' (' + LocalCacheData.getLoginUser().id + ')', current_company.name );\n\t\t}\n\t}\n\n\tforgotPasswordClick() {\n\t\t//window.open( ServiceCaller.root_url + LocalCacheData.loginData.base_url + 'ForgotPassword.php' );\n\t\tIndexViewController.openWizard( 'ForgotPasswordWizard', null, function() {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'An email has been sent to you with instructions on how to change your password.' ) );\n\t\t} );\n\t}\n\n\tautoLogin() {\n\t\t// Error: TypeError: e is null in interface/html5/framework/jquery.min.js?v=9.0.5-20151222-094938 line 2 > eval line 154\n\t\tvar session_cookie = getCookie( Global.getSessionIDKey() );\n\t\tif ( session_cookie && session_cookie.length >= 40 ) {\n\t\t\tthis.doing_login = true;\n\t\t\tthis.onLoginSuccess( null, session_cookie );\n\t\t} else {\n\t\t\t$( this.el ).visible();\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\trender() {\n\n\t\tvar $this = this;\n\t\tvar message_id = TTUUID.generateUUID();\n\t\tLocalCacheData.setSessionID( '' );\n\n\t\tif ( !$( 'body' ).hasClass( 'mobile-device-mode' ) ) {\n\t\t\t// If not on a mobile view (Where desktop UI is forced, render the random animal on background. If mobile, no animals.\n\t\t\tthis.renderAnimalsForBackground();\n\t\t}\n\n\t\t$( '#login_copy_right_info' ).hide();\n\t\t$( '#powered_by' ).hide();\n\n\t\tvar passwordInput = $( '#password' ).TTextInput( { width: 151 } );\n\t\tvar username_input = $( '#user_name' ).TTextInput( { width: 151 } );\n\t\tvar error_string_td = $( '.error-info' );\n\n\t\tif ( LocalCacheData.login_error_string ) {\n//\t\t\terror_string_td.html( LocalCacheData.login_error_string );\n\t\t\terror_string_td.text( LocalCacheData.login_error_string );\n\t\t\tLocalCacheData.login_error_string = '';\n\t\t} else {\n\t\t\terror_string_td.text( '' );\n\t\t}\n\n\t\tusername_input.focus();\n\n\t\t// Listen to the login form submit event, but replace default behaviour with our own.\n\t\t// We need to trigger login via the standard form submission for browsers to properly detect a login form for autocomplete and credential storage, especially picky browsers like IE11. See git log or issue #2680 for further context.\n\t\t// This event listener will also be triggered by keyboard ENTER, thus we do not need a separate listener for that key anymore.\n\t\t$( '#login-form' ).on( 'submit', function( e ) {\n\t\t\t// Prevent the default once submit event triggered.\n\t\t\te.preventDefault();\n\n\t\t\t// Instead of submitting the form to itself, trigger the login check.\n\t\t\t$this.onLoginBtnClick( e );\n\t\t} );\n\n\t\t$( '#versionNumber' ).html( 'v' + APIGlobal.pre_login_data.application_build );\n\n\t\t$( '#appTypeLogo' ).css( 'opacity', 0 );\n\n\t\tvar url = 'theme/' + Global.theme;\n\n\t\tif ( Global.url_offset ) {\n\t\t\turl = Global.url_offset + url;\n\t\t}\n\n\t\tif ( LocalCacheData.productEditionId > 10 && LocalCacheData.appType === true ) {\n\t\t\t$( '#appTypeLogo' ).attr( 'src', url + '/css/views/login/images/od.png' + '?v=' + APIGlobal.pre_login_data.application_build );\n\t\t} else if ( LocalCacheData.productEditionId === 15 ) {\n\t\t\t$( '#appTypeLogo' ).attr( 'src', url + '/css/views/login/images/beo.png' + '?v=' + APIGlobal.pre_login_data.application_build );\n\t\t} else if ( LocalCacheData.productEditionId === 20 ) {\n\t\t\t$( '#appTypeLogo' ).attr( 'src', url + '/css/views/login/images/peo.png' + '?v=' + APIGlobal.pre_login_data.application_build );\n\t\t} else if ( LocalCacheData.productEditionId === 25 ) {\n\t\t\t$( '#appTypeLogo' ).attr( 'src', url + '/css/views/login/images/eeo.png' + '?v=' + APIGlobal.pre_login_data.application_build );\n\t\t} else {\n\t\t\t$( '#appTypeLogo' ).attr( 'src', url + '/css/views/login/images/seo.png' + '?v=' + APIGlobal.pre_login_data.application_build );\n\t\t}\n\n\t\tvar quick_punch_link = $( this.el ).find( '#quick_punch' );\n\t\tif ( LocalCacheData.productEditionId > 10 ) {\n\t\t\tquick_punch_link.show();\n\t\t} else {\n\t\t\tquick_punch_link.hide();\n\t\t}\n\n\t\t$( '#appTypeLogo' ).on( 'load', function() {\n\t\t\t$( this ).animate( {\n\t\t\t\topacity: 1\n\t\t\t}, 100 );\n\t\t} );\n\n\t\t$( '#companyLogo' ).hide();\n\t\t$( '#companyLogo' ).css( 'opacity', 0 );\n\t\t$( '#companyLogo' ).attr( 'src', ServiceCaller.getURLByObjectType( 'primary_company_logo' ) );\n\n\t\t$( '#companyLogo' ).on( 'load', function() {\n\t\t\tif ( $( this ).height() > 78 ) {\n\t\t\t\t$( this ).css( 'height', 78 );\n\n\t\t\t\tif ( $( this ).width > 286 ) {\n\t\t\t\t\t$( this ).css( 'width', 286 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( $( this ).width > 286 ) {\n\t\t\t\t$( this ).css( 'width', 286 );\n\t\t\t}\n\t\t\t$( '#companyLogo' ).show();\n\n\t\t\t$( this ).animate( {\n\t\t\t\topacity: 1\n\t\t\t}, 100 );\n\t\t} );\n\n\t\tvar powered_by_img = $( '#powered_by' );\n\t\tpowered_by_img.show();\n\t\tpowered_by_img.attr( 'src', ServiceCaller.getURLByObjectType( 'copyright' ) );\n\t\tpowered_by_img.attr( 'alt', LocalCacheData.loginData.application_name + ' Workforce Management Software' );\n\t\tvar powered_by_link = $( '<a target=\"_blank\" href=\"https://' + LocalCacheData.getLoginData().organization_url + '\"></a>' );\n\t\tpowered_by_link.addClass( 'powered-by-img-seo' );\n\t\tpowered_by_img.wrap( powered_by_link );\n\n\t\t// get copyright info from main page copyright tag\n\t\t$( '#login_copy_right_info' ).html( $( '#copy_right_info_1' ).html() );\n\t\t$( '#login_copy_right_info' ).show();\n\n\t\tif ( LocalCacheData.productEditionId === 10 ) {\n\t\t\t$( '#social_div' ).show();\n\t\t\t$( '#social_div' ).find( '.facebook-img' ).attr( 'src', 'theme/default/images/facebook_button.jpg' );\n\t\t\t$( '#social_div' ).find( '.twitter-img' ).attr( 'src', 'theme/default/images/twitter_button.jpg' );\n\t\t} else {\n\t\t\t$( '#social_div' ).hide();\n\t\t}\n\n\t\tvar footer_right_html = LocalCacheData.getLoginData().footer_right_html;\n\t\tvar footer_left_html = LocalCacheData.getLoginData().footer_left_html;\n\n\t\tif ( footer_right_html && $.type( footer_right_html ) === 'string' ) {\n\t\t\tfooter_right_html = $( footer_right_html );\n\t\t\tfooter_right_html.addClass( 'foot-right-html' );\n\n\t\t\tfooter_right_html.insertAfter( $( $this.el ) );\n\t\t}\n\n\t\tif ( footer_left_html && $.type( footer_left_html ) === 'string' ) {\n\t\t\tfooter_left_html = $( footer_left_html );\n\t\t\tfooter_left_html.addClass( 'foot-left-html' );\n\n\t\t\tfooter_left_html.insertAfter( $( $this.el ) );\n\t\t}\n\n\t\tthis.lan_selector = $( '.language-selector' );\n\t\tthis.lan_selector.TComboBox();\n\t\tvar array = Global.buildRecordArray( ( LocalCacheData.getLoginData().language_options ) );\n\n\t\tthis.lan_selector.setSourceData( array );\n\n\t\tthis.lan_selector.setValue( LocalCacheData.getLoginData().language );\n\n\t\tvar $this = this;\n\t\tthis.lan_selector.bind( 'formItemChange', function() {\n\t\t\tGlobal.setLanguageCookie( $this.lan_selector.getValue() );\n\t\t\tLocalCacheData.setI18nDic( null );\n\n\t\t\tProgressBar.showProgressBar( message_id );\n\t\t\tProgressBar.changeProgressBarMessage( $.i18n._( 'Language changed, reloading' ) + '...' );\n\n\t\t\tsetTimeout( function() {\n\t\t\t\twindow.location.reload( true );\n\t\t\t}, 2000 );\n\n\t\t} );\n\n\t\tif ( LocalCacheData.getAllURLArgs().user_name ) {\n\t\t\tusername_input.val( LocalCacheData.getAllURLArgs().user_name );\n\t\t}\n\n\t\tif ( LocalCacheData.getAllURLArgs().password ) {\n\t\t\tpasswordInput.val( LocalCacheData.getAllURLArgs().password );\n\t\t}\n\n\t\tGlobal.moveCookiesToNewPath();\n\t\tGlobal.setUIInitComplete();\n\t}\n\n\tcleanWhenUnloadView( callBack ) {\n\t\t$( '#loginViewContainer' ).remove();\n\t\t$( '#login-bg_animal' ).css( 'background-image', '' ); // Remove animals after login, as they can show through on main UI left navbar.\n\t\tGlobal.setVirtualDeviceViewport( 'desktop' ); // Setting mobile view on login, then back to desktop (990px virtual) after login, to allow pan & zoom, as not whole app is mobile optimized.\n\t\tsuper.cleanWhenUnloadView( callBack );\n\t}\n\n\trenderAnimalsForBackground() {\n\t\tvar station_id = Global.getStationID();\n\t\t//week of year and numeric digits of station_id.\n\t\tif ( station_id.length > 0 ) {\n\t\t\tvar station_id_arr = station_id.match( /\\d{1,5}/g );\n\t\t\tif ( $.isArray( station_id_arr ) ) {\n\t\t\t\tstation_id = station_id_arr.join( '' );\n\t\t\t}\n\t\t}\n\n\t\tvar season_images_arr = {\n\t\t\t'all': 7,\n\t\t\t'newyear': 2,\n\t\t\t'valintine': 4,\n\t\t\t'easter': 3,\n\t\t\t'stpatrick': 4,\n\t\t\t'halloween': 4,\n\t\t\t'xmas': 5,\n\t\t};\n\n\t\tvar season;\n\n\t\tvar month_of_year = ( moment().month() + 1 ); //0 based\n\t\tvar day_of_month = moment().date();\n\t\tif ( ( month_of_year == 12 && day_of_month >= 30 ) || ( month_of_year == 1 && day_of_month <= 15 ) ) { //New Year: Jan 1: Dec 30 -> Jan 15\n\t\t\tseason = 'newyear';\n\t\t} else if ( month_of_year == 2 && day_of_month >= 10 && day_of_month <= 15 ) { //Valintine: Feb 14: 10 - 15\n\t\t\tseason = 'valintine';\n\t\t} else if ( ( month_of_year == 3 && day_of_month >= 25 ) || ( month_of_year == 4 && day_of_month <= 25 ) ) { //Easter: Mar 25 to Apr 25 each year. 2021=Apr 4, 2022=Apr 17, 2023=Apr 9\n\t\t\tseason = 'easter';\n\t\t} else if ( month_of_year == 5 && day_of_month >= 15 && day_of_month <= 18 ) { //St Patrick: Mar 17: 15 - 18\n\t\t\tseason = 'stpatrick';\n\t\t} else if ( month_of_year == 10 && day_of_month >= 25 && day_of_month <= 31 ) { //Halloween: Oct 31: 25 - 31\n\t\t\tseason = 'halloween';\n\t\t// } else if ( month_of_year == 11 && day_of_month >= 19 && day_of_month <= 26 ) { //Thanks Giving (US): Nov. 25: 19 - 26\n\t\t// \tseason = 'thanksgiving'  ;\n\t\t} else if ( month_of_year == 12 && day_of_month >= 10 && day_of_month <= 29 ) { //Xmas: Dec 25: 10 - 29\n\t\t\tseason = 'xmas';\n\t\t} else {\n\t\t\tseason = 'all';\n\t\t}\n\n\t\t//If we are in any special season, then seed based on the day of of month, so it could change every day. Otherwise only change it every week.\n\t\tvar date_seed = day_of_month;\n\t\tif ( season == 'all' ) {\n\t\t\tdate_seed = moment().week();\n\t\t}\n\n\t\tif ( Debug.getEnable() == true ) {\n\t\t\tseason = Object.keys(season_images_arr)[Math.floor( Math.random() * ( Object.keys(season_images_arr).length - 1 ) )];\n\t\t\tvar seed = parseInt( Math.random() * 100 ); //For testing without the station_id stickiness.\n\t\t} else {\n\t\t\tvar seed = parseInt( date_seed + ( season.charCodeAt( 0 ) - 97 ) + station_id ); //Convert season to numeric only.\n\t\t}\n\n\t\tvar season_total_images = season_images_arr[season];\n\t\tvar random_image_number = Math.floor( ( Math.abs( Math.sin( seed ) ) * seed ) % season_total_images ) + 1; // seeded random\n\n\t\tvar bg_image = 'theme/default/images/login_animals_' + season + '_' + random_image_number + '.png';\n\t\tbg_image = bg_image.replace( 'all_', '' ); //When using all season images, remove 'all_' from the file names.\n\t\tDebug.Text( 'Background Animal Image: ' + bg_image + ' Season: ' + season + ' Seed: ' + seed +' Total: '+ season_total_images, 'LoginViewController.js', '', 'renderAnimalsForBackground', 10 );\n\n\t\t$( '#login-bg_animal' ).css( 'background-image', 'url(\\'' + bg_image + '\\')' );\n\t}\n\n}\n"],"sourceRoot":""}