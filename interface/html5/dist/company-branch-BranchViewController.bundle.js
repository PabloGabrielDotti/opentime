(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["company-branch-BranchViewController"],{2424:(e,i,t)=>{"use strict";t.r(i),t.d(i,{"BranchViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#branch_view_container",status_array:null,country_array:null,province_array:null,e_province_array:null,company_api:null}),super(e)}init(e){this.edit_view_tpl="BranchEditView.html",this.permission_id="branch",this.viewId="Branch",this.script_name="BranchView",this.table_name_key="branch",this.context_menu_name=$.i18n._("Branch"),this.navigation_label=$.i18n._("Branch")+":",this.api=TTAPI.APIBranch,this.company_api=TTAPI.APICompany,this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary()}initOptions(){this.initDropDownOption("status"),this.initDropDownOption("country","country",this.company_api)}getCustomContextMenuModel(){return{exclude:[],include:[{label:$.i18n._("Import"),id:ContextMenuIconName.import_icon,group:"other",icon:Icons.import_icon,permission_result:PermissionManager.checkTopLevelPermission("ImportCSVBranch"),permission:null,sort_order:8e3}]}}onSetSearchFilterFinished(){var e;0===this.search_panel.getSelectTabIndex()?(e=this.basic_search_field_ui_dic.country.getValue(),this.setProvince(e)):1===this.search_panel.getSelectTabIndex()&&(e=this.adv_search_field_ui_dic.country.getValue(),this.setProvince(e))}onCustomContextClick(e){switch(e){case ContextMenuIconName.import_icon:this.onImportClick()}}onImportClick(){var e=this;IndexViewController.openWizard("ImportCSVWizard","Branch",(function(){e.search()}))}onBuildAdvUIFinished(){this.adv_search_field_ui_dic.country.change($.proxy((function(){var e=this.adv_search_field_ui_dic.country.getValue();this.setProvince(e),this.adv_search_field_ui_dic.province.setValue(null)}),this))}onBuildBasicUIFinished(){this.basic_search_field_ui_dic.country.change($.proxy((function(){var e=this.basic_search_field_ui_dic.country.getValue();this.setProvince(e),this.basic_search_field_ui_dic.province.setValue(null)}),this))}onFormItemChange(e,i){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var t=e.getField();switch(t){case"country":this.edit_view_ui_dic.province.setValue(null)}this.current_edit_record[t]=e.getValue(),"country"!==t?i||this.validate():this.onCountryChange()}buildEditViewUI(){super.buildEditViewUI();var e,i={"tab_branch":{"label":$.i18n._("Branch")},"tab_audit":!0};this.setTabModel(i),this.navigation.AComboBox({api_class:TTAPI.APIBranch,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_branch",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var t=this.edit_view_tab.find("#tab_branch").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(t),(e=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"status_id"}),e.setSourceData(this.status_array),this.addEditFieldToColumn($.i18n._("Status"),e,t,""),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),e,t),e.parent().width("45%"),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"manual_id",width:65}),this.addEditFieldToColumn($.i18n._("Code"),e,t),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"address1",width:"100%"}),this.addEditFieldToColumn($.i18n._("Address (Line 1)"),e,t),e.parent().width("45%"),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"address2",width:"100%"}),this.addEditFieldToColumn($.i18n._("Address (Line 2)"),e,t),e.parent().width("45%"),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"city",width:149}),this.addEditFieldToColumn($.i18n._("City"),e,t),(e=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"country",set_empty:!0}),e.setSourceData(this.country_array),this.addEditFieldToColumn($.i18n._("Country"),e,t),(e=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"province"}),e.setSourceData([]),this.addEditFieldToColumn($.i18n._("Province/State"),e,t),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"postal_code",width:149}),this.addEditFieldToColumn($.i18n._("Postal/ZIP Code"),e,t),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"work_phone",width:149}),this.addEditFieldToColumn($.i18n._("Phone"),e,t),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"fax_phone",width:149}),this.addEditFieldToColumn($.i18n._("Fax"),e,t),Global.getProductEdition()>=20&&((e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIGEOFence,allow_multiple_selection:!0,layout_name:"global_geo_fence",show_search_inputs:!0,set_empty:!0,field:"geo_fence_ids"}),this.addEditFieldToColumn($.i18n._("Allowed GEO Fences"),e,t)),(e=Global.loadWidgetByName(FormItemType.TAG_INPUT)).TTagInput({field:"tag",object_type_id:110}),this.addEditFieldToColumn($.i18n._("Tags"),e,t,"",null,null,!0)}setProvince(e,i){var t=this;e&&"-1"!==e&&"0"!==e?this.company_api.getOptions("province",e,{onResult:function(e){(e=e.getResult())||(e=[]),t.province_array=Global.buildRecordArray(e),t.adv_search_field_ui_dic.province.setSourceData(t.province_array),t.basic_search_field_ui_dic.province.setSourceData(t.province_array)}}):(t.province_array=[],this.adv_search_field_ui_dic.province.setSourceData([]),this.basic_search_field_ui_dic.province.setSourceData([]))}eSetProvince(e,i){var t=this,a=t.edit_view_ui_dic.province;e&&"-1"!==e&&"0"!==e?this.company_api.getOptions("province",e,{onResult:function(e){(e=e.getResult())||(e=[]),t.e_province_array=Global.buildRecordArray(e),i&&t.e_province_array.length>0&&(t.current_edit_record.province=t.e_province_array[0].value,a.setValue(t.current_edit_record.province)),a.setSourceData(t.e_province_array)}}):(t.e_province_array=[],a.setSourceData([]))}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:1,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:$.i18n._("Phone"),field:"work_phone",basic_search:!1,adv_search:!0,in_column:1,object_type_id:110,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Fax"),field:"fax_phone",basic_search:!1,adv_search:!0,in_column:1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Address (Line1)"),field:"address1",basic_search:!1,adv_search:!0,in_column:2,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Address (Line2)"),field:"address2",basic_search:!1,adv_search:!0,in_column:2,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Postal/ZIP Code"),field:"postal_code",basic_search:!1,adv_search:!0,in_column:2,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Country"),in_column:2,field:"country",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.COMBO_BOX}),new SearchField({label:$.i18n._("Province/State"),in_column:2,field:"province",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("City"),field:"city",basic_search:!0,adv_search:!0,in_column:3,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Code"),field:"manual_id",basic_search:!0,adv_search:!0,in_column:3,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Created By"),in_column:3,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:3,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}}}}]);
//# sourceMappingURL=company-branch-BranchViewController.bundle.js.map?v=e2b52bef897498b3ddb4