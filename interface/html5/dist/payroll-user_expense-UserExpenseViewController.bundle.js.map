{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageBrowser.js","webpack://timetrex/./interface/html5/views/payroll/user_expense/UserExpenseViewController.js"],"names":["$","fn","TImageBrowser","options","Global","addCss","field","browser","opts","extend","defaults","$this","this","name","accept_filter","default_width","default_height","setEnabled","val","btn","find","removeAttr","removeClass","attr","addClass","clearErrorStyle","getFileName","getField","setEnableDelete","image","getValue","FormData","getImageSrc","setImage","hide","d","Date","getTime","css","setValue","each","o","meta","data","isSet","on","image_height","height","naturalHeight","image_width","width","naturalWidth","trigger","show","onImageLoad","changeHandler","bind","deleteImageHandler","FileReader","files","length","window","reader","readAsDataURL","onloadend","url","result","jQuery","UserExpenseViewController","BaseViewController","_","el","status_array","hierarchy_level_array","sub_document_view_controller","document_object_type_id","relatedExpenseArray","document_api","payment_method_array","super","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","i18n","navigation_label","hierarchy_type_id","api","TTAPI","APIUserExpense","getProductEdition","job_api","APIJob","job_item_api","APIJobItem","APIDocument","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","exclude","ContextMenuIconName","copy","mass_edit","include","initDropDownOption","filter","filter_data","type_id","user_id","LocalCacheData","loginUser","id","basic_search_field_ui_dic","setDefaultArgs","column_filter","_getFilterColumnsFromDisplayColumns","key","isFalseOrNull","current_edit_record","getLoginUser","widget","edit_view_ui_dic","args","job_id","collectUIDataToCurrentEditRecord","setEditViewDataDone","setRelatedExpense","initInsideEditorData","AuthorizationHistory","init","onExpensePolicyChange","object_type_id","object_id","onResult","res","edit_view","getResult","editor","removeAllRows","getDefaultData","len","i","row","addRow","rows_widgets_array","file","push","index","getRowRender","getRender","widgets","form_item_file_name","loadWidgetByName","FormItemType","TEXT","TText","setClassStyle","children","eq","append","parent_controller","document_revision_id","widgetContainer","download","view","document_id","downloadFile","form_item_file","IMAGE_BROWSER","file_browser","a","file_name","insertAfter","splice","is_viewing","addIconsEvent","removeLastRowLine","document_attachment_id","ServiceCaller","getURLByObjectType","APIFileDownload","rowIndex","remove_id","TTUUID","isUUID","zero_id","not_exist_id","TAlertManager","showConfirmAlert","delete_confirm_message","ProgressBar","showOverlay","key_name","closeOverlay","isValid","remove","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","c_value","amount_arr","setSourceData","related_expense_policy_id","manual_id","setJobItemValueWhenJobChanged","setCheckBox","onJobQuickSearch","validate","expense_policies","getSourceData","isArray","unit_name","n","parents","html","expenses","tab_expense_column3","edit_view_tab","empty","edit_view_tabs","Object","keys","form_item_input","TEXT_INPUT","TTextInput","addEditFieldToColumn","item","reimburse_amount","editFieldResize","records","related_expenses","gross_amount","net_amount","parent_id","result_data","refresh_id","saveInsideEditorData","search","onSaveDone","removeEditView","TFeedback","source","setErrorMenu","setErrorTips","setCurrentEditViewState","current_doing_context_action","_continueDoCopyAsNew","onCopyAsNewClick","callBack","success","fileItem","addAttachment","async","uploadFile","document_result","file_data","upload_file_result","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","label","tab_expense","tab_expense_column1","tab_expense_column2","AWESOME_BOX","APIUser","set_empty","default_args","DATE_PICKER","TDatePicker","TEXT_AREA","TTextArea","parent","COMBO_BOX","TComboBox","APIExpensePolicy","always_include_columns","init_data_immediately","setRealValueCallBack","widget_checkbox","CHECKBOX","TCheckbox","APICurrency","APIBranch","APIDepartment","job_coder","disable_keyup_event","job_item_coder","TAG_INPUT","TTagInput","inside_editor_div","inside_editor_args","action","INSIDE_EDITOR","InsideEditor","insideEditorAddRow","removeRow","insideEditorRemoveRow","insideEditorGetValue","insideEditorSetValue","render_args","row_render","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type"],"mappings":"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","file":"payroll-user_expense-UserExpenseViewController.bundle.js?v=a4ea6aeeee5707526c70","sourcesContent":["( function( $ ) {\n\n\t$.fn.TImageBrowser = function( options ) {\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar id = 'file_browser';\n\t\tvar name = 'filedata';\n\t\tvar browser;\n\n\t\tvar accept_filter = '';\n\n\t\tvar default_width = 177;\n\t\tvar default_height = 42;\n\t\tvar enabled = true;\n\n\t\tthis.setEnabled = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.find( '.browser-form input' );\n\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.attr( 'disabled', true );\n\t\t\t\tbtn.removeClass( 'disable-element' ).addClass( 'disable-element' );\n\t\t\t} else {\n\t\t\t\tbtn.removeAttr( 'disabled' );\n\t\t\t\tbtn.removeClass( 'disable-element' );\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getFileName = function() {\n\n\t\t\treturn browser.val();\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.setEnableDelete = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\tif ( !val ) {\n\t\t\t\timage.removeAttr( 'enable-delete' );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\timage.attr( 'enable-delete', 1 );\n\t\t\t}\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\tvar form_data;\n\t\t\tif ( browser && browser.val() ) {\n\n\t\t\t\tif ( typeof FormData == 'undefined' ) {\n\t\t\t\t\tform_data = $this.find( '.browser-form' );\n\t\t\t\t} else {\n\t\t\t\t\tform_data = new FormData( $( $this.find( '.browser-form' ) )[0] );\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tform_data = null;\n\t\t\t}\n\n\t\t\treturn form_data;\n\t\t};\n\n\t\tthis.getImageSrc = function() {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\treturn image.attr( 'src' );\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tvar onImageLoad = function( image ) {\n\n\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n\n\t\t\tif ( image_height > default_height ) {\n\t\t\t\t$( image ).css( 'height', default_height );\n\n\t\t\t}\n\n\t\t\tif ( image_width > default_width ) {\n\t\t\t\t$( image ).css( 'width', default_width );\n\t\t\t\t$( image ).css( 'height', 'auto' );\n\t\t\t}\n\n\t\t\t$this.trigger( 'setSize' );\n\n\t\t\tif ( image_height < 5 ) {\n\t\t\t\t$( image ).hide();\n\t\t\t} else {\n\t\t\t\t$( image ).show();\n\t\t\t}\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.each( function() {\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\t// var $this = this;\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( accept_filter ) ) {\n\t\t\t\taccept_filter = o.accept_filter;\n\t\t\t}\n\n\t\t\tbrowser = $( this ).find( '.browser' );\n\t\t\tvar image = $( this ).find( '.image' );\n\t\t\timage.hide();\n\t\t\timage.on( 'load', function() {\n\t\t\t\tonImageLoad( this );\n\n\t\t\t} );\n\n\t\t\tif ( accept_filter ) {\n\t\t\t\tbrowser.attr( 'accept', accept_filter );\n\t\t\t} else {\n\t\t\t\taccept_filter = 'image/*';\n\t\t\t\tbrowser.attr( 'accept', 'image/*' );\n\t\t\t}\n\n\t\t\tbrowser.attr( 'id', id );\n\t\t\tbrowser.attr( 'name', name );\n\n\t\t\tif ( Global.isSet( o.changeHandler ) ) {\n\n\t\t\t\t$this.bind( 'imageChange', o.changeHandler );\n\t\t\t}\n\t\t\tif ( Global.isSet( o.deleteImageHandler ) ) {\n\t\t\t\tthis.find( '.file-browser' ).on( 'deleteClick', function() {\n\t\t\t\t\to.deleteImageHandler();\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tbrowser.bind( 'change', function() {\n\t\t\t\timage.hide();\n\n\t\t\t\tif ( typeof FileReader != 'undefined' ) {\n\n\t\t\t\t\tvar files = !!this.files ? this.files : [];\n\n\t\t\t\t\t// If no files were selected, or no FileReader support, return\n\t\t\t\t\tif ( !files.length || !window.FileReader ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( accept_filter === 'image/*' ) {\n\t\t\t\t\t\t// Create a new instance of the FileReader\n\t\t\t\t\t\tvar reader = new FileReader();\n\n\t\t\t\t\t\t// Read the local file as a DataURL\n\t\t\t\t\t\treader.readAsDataURL( files[0] );\n\n\t\t\t\t\t\t// When loaded, set image data as background of div\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar url = this.result;\n\t\t\t\t\t\t\timage.attr( 'src', url );\n\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t$this.trigger( 'imageChange', [$this] );\n\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageBrowser.defaults = {};\n\n} )( jQuery );","import '@/global/widgets/filebrowser/TImageBrowser';\n\nexport class UserExpenseViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#user_expense_view_container',\n\n\t\t\t// _required_files: ['TImageBrowser'],\n\n\t\t\tstatus_array: null,\n\n\t\t\thierarchy_level_array: null,\n\n\t\t\tsub_document_view_controller: null,\n\n\t\t\tdocument_object_type_id: null,\n\n\t\t\trelatedExpenseArray: null,\n\n\t\t\tdocument_api: null,\n\t\t\tpayment_method_array: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'UserExpenseEditView.html';\n\t\tthis.permission_id = 'user_expense';\n\t\tthis.viewId = 'UserExpense';\n\t\tthis.script_name = 'UserExpenseView';\n\t\tthis.table_name_key = 'user_expense';\n\t\tthis.context_menu_name = $.i18n._( 'Expenses' );\n\t\tthis.navigation_label = $.i18n._( 'Expense' ) + ':';\n\t\tthis.document_object_type_id = 400;\n\t\tthis.hierarchy_type_id = 200;\n\n\t\tthis.api = TTAPI.APIUserExpense;\n\n\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\tthis.job_api = TTAPI.APIJob;\n\t\t\tthis.job_item_api = TTAPI.APIJobItem;\n\t\t\tthis.document_api = TTAPI.APIDocument;\n\t\t}\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [ContextMenuIconName.copy, ContextMenuIconName.mass_edit],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'payment_method' );\n\n\t\tvar filter = {};\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.type_id = [10, 20, 30];\n\t\tfilter.filter_data.user_id = [LocalCacheData.loginUser.id];\n\n\t\t$this.basic_search_field_ui_dic['expense_policy_id'].setDefaultArgs( filter );\n\t}\n\n\tgetFilterColumnsFromDisplayColumns() {\n\t\tvar column_filter = {};\n\t\tcolumn_filter.user = true;\n\t\tthis._getFilterColumnsFromDisplayColumns( column_filter, true );\n\t}\n\n\tgetSubViewFilter( filter ) {\n\n\t\tif ( filter.length === 0 ) {\n\t\t\tfilter = {};\n\t\t}\n\n\t\tfilter['parent_id'] = 0;\n\n\t\treturn filter;\n\t}\n\n\t/* jshint ignore:start */\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\n\t\tif ( Global.isFalseOrNull( this.current_edit_record['user_id'] ) ) {\n\t\t\tthis.current_edit_record['user_id'] = LocalCacheData.getLoginUser().id;\n\t\t}\n\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'user_id':\n\t\t\t\t\t\tvar args = {};\n\t\t\t\t\t\tvar filter_data = {};\n\t\t\t\t\t\tfilter_data.type_id = [10, 20, 30];\n\t\t\t\t\t\tfilter_data.user_id = this.current_edit_record[key];\n\t\t\t\t\t\targs.filter_data = filter_data;\n\t\t\t\t\t\tthis.edit_view_ui_dic['expense_policy_id'].setDefaultArgs( args );\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'expense_policy_id':\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'gross_amount1':\n\t\t\t\t\t\twidget.setValue( this.current_edit_record['gross_amount'] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'gross_amount':\n\t\t\t\t\tcase 'reimburse_amount':\n\t\t\t\t\tcase 'net_amount':\n\t\t\t\t\t\t// Don't do anything.\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_id':\n\t\t\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_item_id':\n\t\t\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\t\t\tvar args = {};\n\t\t\t\t\t\t\targs.filter_data = { job_id: this.current_edit_record.job_id };\n\t\t\t\t\t\t\twidget.setDefaultArgs( args );\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_quick_search':\n//\t\t\t\t\t\twidget.setValue( this.current_edit_record['job_id'] ? this.current_edit_record['job_id'] : 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_item_quick_search':\n//\t\t\t\t\t\twidget.setValue( this.current_edit_record['job_item_id'] ? this.current_edit_record['job_item_id'] : 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\t/* jshint ignore:end */\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\n\t\tif ( Global.isSet( this.current_edit_record['related_expenses'] ) ) {\n\t\t\tthis.relatedExpenseArray = this.current_edit_record['related_expenses'];\n\t\t} else {\n\t\t\tthis.relatedExpenseArray = {};\n\t\t}\n\n\t\tthis.setRelatedExpense( this.relatedExpenseArray );\n\n\t\tthis.initInsideEditorData();\n\t\tAuthorizationHistory.init( this );\n\n\t\tthis.onExpensePolicyChange();\n\t}\n\n\tinitInsideEditorData() {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\t$this.editor.removeAllRows();\n\t\t\t$this.editor.getDefaultData();\n\n\t\t} else {\n\n\t\t\targs.filter_data.object_type_id = this.document_object_type_id;\n\t\t\targs.filter_data.object_id = this.current_edit_record['id'];\n\n\t\t\t$this.api['getAttachment']( args, {\n\t\t\t\tonResult: function( res ) {\n\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar data = res.getResult();\n\t\t\t\t\t$this.editor.setValue( data );\n\n\t\t\t\t}\n\t\t\t} );\n\n\t\t}\n\t}\n\n\tinsideEditorSetValue( val ) {\n\t\tvar len = val.length;\n\t\tthis.removeAllRows();\n\n\t\tif ( len > 0 ) {\n\t\t\tfor ( var i = 0; i < val.length; i++ ) {\n\t\t\t\tif ( Global.isSet( val[i] ) ) {\n\t\t\t\t\tvar row = val[i];\n\t\t\t\t\tthis.addRow( row );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.getDefaultData();\n\t\t}\n\t}\n\n\tinsideEditorGetValue() {\n\n\t\tvar len = this.rows_widgets_array.length;\n\n\t\tvar result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tif ( Global.isSet( row.file ) ) {\n\t\t\t\tvar data = {\n\t\t\t\t\tname: row.name.getValue(),\n\t\t\t\t\tfile: row.file.getValue()\n\t\t\t\t};\n\n\t\t\t\tif ( data.name === 'No File Selected' ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tresult.push( data );\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tinsideEditorAddRow( data, index ) {\n\n\t\tif ( !data ) {\n\t\t\tthis.getDefaultData( index );\n\t\t} else {\n\t\t\tvar row = this.getRowRender(); //Get Row render\n\t\t\tvar render = this.getRender(); //get render, should be a table\n\t\t\tvar widgets = {}; //Save each row's widgets\n\n\t\t\t//Build row widgets\n\n\t\t\t// Attachment Name\n\t\t\tvar form_item_file_name = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_file_name.TText( { field: 'name', width: 400 } );\n\t\t\tform_item_file_name.setValue( data.name ? data.name : $.i18n._( 'No File Selected' ) );\n\t\t\tform_item_file_name.setClassStyle( data.name ? {\n\t\t\t\t'font-weight': 'bold',\n\t\t\t\t'line-height': 0\n\t\t\t} : { 'line-height': 0 } );\n\t\t\twidgets[form_item_file_name.getField()] = form_item_file_name;\n\t\t\trow.children().eq( 0 ).append( form_item_file_name );\n\t\t\tform_item_file_name.attr( 'document_id', ( data.id && this.parent_controller.current_edit_record.id ) ? data.id : '' );\n\t\t\tform_item_file_name.attr( 'document_revision_id', ( data.document_revision_id && this.parent_controller.current_edit_record.id ) ? data.document_revision_id : '' );\n\n\t\t\t// Action\n\t\t\tif ( data.name ) {\n\n\t\t\t\tvar widgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\t\tvar download = $( '<button type=\\'button\\' class=\\' download-button t-button widget-right-label\\'>' + $.i18n._( 'Download' ) + '</button>' );\n\t\t\t\tvar view = $( '<button type=\\'button\\' class=\\' view-button t-button widget-right-label\\'>' + $.i18n._( 'View' ) + '</button>' );\n\n\t\t\t\tdownload.attr( {\n\t\t\t\t\tdocument_id: data.id,\n\t\t\t\t\tdocument_revision_id: data.document_revision_id,\n\t\t\t\t\tobject_type_id: this.parent_controller.document_object_type_id\n\t\t\t\t} );\n\t\t\t\tview.attr( {\n\t\t\t\t\tdocument_id: data.id,\n\t\t\t\t\tdocument_revision_id: data.document_revision_id,\n\t\t\t\t\tobject_type_id: this.parent_controller.document_object_type_id\n\t\t\t\t} );\n\n\t\t\t\tdownload.bind( 'click', this.parent_controller.downloadFile );\n\t\t\t\tview.bind( 'click', this.parent_controller.downloadFile );\n\n\t\t\t\twidgetContainer.append( download );\n\t\t\t\twidgetContainer.append( view );\n\n\t\t\t\trow.children().eq( 1 ).append( widgetContainer );\n\t\t\t} else {\n\t\t\t\tvar form_item_file = Global.loadWidgetByName( FormItemType.IMAGE_BROWSER );\n\n\t\t\t\tvar $this = this.file_browser = form_item_file.TImageBrowser( {\n\t\t\t\t\t\tfield: 'file',\n\t\t\t\t\t\tname: 'filedata',\n\t\t\t\t\t\taccept_filter: '*',\n\t\t\t\t\t\tchangeHandler: function( a ) {\n\t\t\t\t\t\t\tvar file_name = $( this ).find( '.browser' )[0].files[0].name;\n\t\t\t\t\t\t\tform_item_file_name.setValue( file_name );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\twidgets[form_item_file.getField()] = form_item_file;\n\t\t\t\trow.children().eq( 1 ).append( form_item_file );\n\n\t\t\t}\n\n\t\t\t// end\n\n\t\t\tif ( typeof index != 'undefined' ) {\n\n\t\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\t\tthis.rows_widgets_array.splice( ( index ), 0, widgets );\n\n\t\t\t} else {\n\t\t\t\t$( render ).append( row );\n\t\t\t\tthis.rows_widgets_array.push( widgets );\n\t\t\t}\n\n\t\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\t\trow.find( '.control-icon' ).hide();\n\t\t\t}\n\n\t\t\tthis.addIconsEvent( row ); //Bind event to add and minus icon\n\t\t\tthis.removeLastRowLine();\n\t\t}\n\t}\n\n\tdownloadFile() {\n\n\t\tvar $this = $( this );\n\t\tvar document_attachment_id = $this.attr( 'document_id' );\n\t\tvar document_revision_id = $this.attr( 'document_revision_id' );\n\t\tvar object_type_id = $this.attr( 'object_type_id' );\n\n\t\tvar url = ServiceCaller.getURLByObjectType( 'file_download' ) + '&object_type=document&parent_id=' + document_attachment_id + '&parent_object_type_id=' + object_type_id + '&object_id=' + document_revision_id;\n\n\t\tGlobal.APIFileDownload( null, null, null, url );\n\t}\n\n\tinsideEditorRemoveRow( row ) {\n\n\t\tvar $this = this;\n\t\tvar index = row[0].rowIndex - 1;\n\t\tvar remove_id = this.rows_widgets_array[index].name.attr( 'document_id' );\n\t\tif ( TTUUID.isUUID( remove_id ) && remove_id != TTUUID.zero_id && remove_id != TTUUID.not_exist_id ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.delete_confirm_message, null, function( result ) {\n\t\t\t\tif ( result ) {\n\t\t\t\t\tProgressBar.showOverlay();\n\t\t\t\t\t$this.api['delete' + $this.api.key_name]( remove_id, {\n\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\t\t\t\trow.remove();\n\t\t\t\t\t\t\t\t$this.rows_widgets_array.splice( index, 1 );\n\t\t\t\t\t\t\t\tif ( $this.rows_widgets_array.length === 0 ) {\n\t\t\t\t\t\t\t\t\t$this.getDefaultData();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\trow.remove();\n\t\t\t$this.rows_widgets_array.splice( index, 1 );\n\t\t}\n\n\t\tthis.removeLastRowLine();\n\t}\n\n\t/* jshint ignore:start */\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tvar amount_arr = false;\n\t\tswitch ( key ) {\n\t\t\tcase 'user_id':\n\t\t\t\tvar args = {};\n\t\t\t\tvar filter_data = {};\n\t\t\t\tfilter_data.type_id = [10, 20, 30];\n\t\t\t\tfilter_data.user_id = this.current_edit_record[key];\n\t\t\t\targs.filter_data = filter_data;\n\t\t\t\tthis.edit_view_ui_dic['expense_policy_id'].setSourceData( null );\n\t\t\t\tthis.edit_view_ui_dic['expense_policy_id'].setDefaultArgs( args );\n\t\t\t\tbreak;\n\t\t\tcase 'expense_policy_id':\n\t\t\t\tthis.onExpensePolicyChange();\n\t\t\t\tbreak;\n\t\t\tcase 'gross_amount1':\n\t\t\t\tthis.current_edit_record['gross_amount1'] = this.current_edit_record['gross_amount1'] ? this.current_edit_record['gross_amount1'] : this.current_edit_record['gross_amount'];\n\t\t\t\tif ( this.current_edit_record['expense_policy_id'] && this.current_edit_record['gross_amount1'] ) {\n\t\t\t\t\tthis.api['calcRelatedExpenses'](\n\t\t\t\t\t\tthis.current_edit_record['expense_policy_id'], this.current_edit_record['gross_amount1'], amount_arr, this.current_edit_record['is_reimbursable'],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t\t\t\t$this.relatedExpenseArray = res.getResult();\n\t\t\t\t\t\t\t\t$this.setRelatedExpense( $this.relatedExpenseArray );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'is_reimbursable':\n\t\t\t\tthis.current_edit_record['gross_amount1'] = this.current_edit_record['gross_amount1'] ? this.current_edit_record['gross_amount1'] : this.current_edit_record['gross_amount'];\n\t\t\t\tamount_arr = this.relatedExpenseArray ? this.relatedExpenseArray : false;\n\t\t\t\tif ( this.current_edit_record['expense_policy_id'] && this.current_edit_record['gross_amount1'] ) {\n\t\t\t\t\tthis.api['calcRelatedExpenses'](\n\t\t\t\t\t\tthis.current_edit_record['expense_policy_id'], this.current_edit_record['gross_amount1'], amount_arr, this.current_edit_record['is_reimbursable'],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t\t\t\t$this.relatedExpenseArray = res.getResult();\n\t\t\t\t\t\t\t\t$this.setRelatedExpense( $this.relatedExpenseArray );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'amount':\n\t\t\t\tvar related_expense_policy_id = target.attr( 'id' );\n\t\t\t\tthis.current_edit_record['gross_amount1'] = this.current_edit_record['gross_amount1'] ? this.current_edit_record['gross_amount1'] : this.current_edit_record['gross_amount'];\n\t\t\t\tthis.relatedExpenseArray['taxes'][related_expense_policy_id]['amount'] = c_value;\n\t\t\t\tamount_arr = this.relatedExpenseArray;\n\t\t\t\tif ( this.current_edit_record['expense_policy_id'] && this.current_edit_record['gross_amount1'] ) {\n\t\t\t\t\tthis.api['calcRelatedExpenses'](\n\t\t\t\t\t\tthis.current_edit_record['expense_policy_id'], this.current_edit_record['gross_amount1'], amount_arr, this.current_edit_record['is_reimbursable'],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t\t\t\t$this.relatedExpenseArray = res.getResult();\n\t\t\t\t\t\t\t\t$this.setRelatedExpense( $this.relatedExpenseArray );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\t\tthis.setJobItemValueWhenJobChanged( target.getValue( true ) );\n\t\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_item_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_quick_search':\n\t\t\tcase 'job_item_quick_search':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.onJobQuickSearch( key, c_value );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tonExpensePolicyChange() {\n\t\tvar expense_policies = this.edit_view_ui_dic['expense_policy_id'].getSourceData();\n\t\tif ( expense_policies && Global.isArray( expense_policies ) && expense_policies.length > 0 ) {\n\t\t\tvar unit_name = $.i18n._( 'Amount' );\n\n\t\t\tfor ( var n in expense_policies ) {\n\t\t\t\tif ( expense_policies[n].id == this.edit_view_ui_dic['expense_policy_id'].getValue() && expense_policies[n].unit_name && expense_policies[n].unit_name.length > 0 && expense_policies[n].type_id == 30 ) {\n\t\t\t\t\tunit_name = expense_policies[n].unit_name;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.edit_view_ui_dic['gross_amount1'].parents( '.edit-view-form-item-div' ).find( '.edit-view-form-item-label' ).html( unit_name + ':' );\n\t\t}\n\t}\n\n\t/* jshint ignore:end */\n\tsetRelatedExpense( expenses ) {\n\t\t// Third column start\n\t\tvar tab_expense = this.edit_view_tab.find( '#tab_expense' );\n\t\tvar tab_expense_column3 = tab_expense.find( '.third-column' ).empty();\n\n\t\tif ( this.edit_view_tabs[0].length < 3 ) {\n\t\t\tthis.edit_view_tabs[0].push( tab_expense_column3 );\n\t\t}\n\n\t\tif ( expenses && expenses['taxes'] && Object.keys( expenses['taxes'] ).length > 0 ) {\n\t\t\t// Net Amount\n\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tform_item_input.TTextInput( { field: 'net_amount' } );\n\t\t\tform_item_input.setValue( expenses['net_amount'] );\n\t\t\tform_item_input.setEnabled( ( this.is_viewing == false ) );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Net Amount' ), form_item_input, tab_expense_column3, '', null, true );\n\t\t\tthis.edit_view_ui_dic['net_amount'].css( 'opacity', 1 );\n\n\t\t\tfor ( var key in expenses['taxes'] ) {\n\t\t\t\t// taxes\n\t\t\t\tvar item = expenses['taxes'][key];\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_input.TTextInput( { field: 'amount' } );\n\t\t\t\tform_item_input.setValue( item['amount'] );\n\t\t\t\tform_item_input.attr( 'id', item['expense_policy_id'] );\n\t\t\t\tform_item_input.setEnabled( ( this.is_viewing == false ) );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( item['expense_policy_name'] ), form_item_input, tab_expense_column3, '', null, true );\n\t\t\t\tthis.edit_view_ui_dic['amount'].css( 'opacity', 1 );\n\t\t\t}\n\n\t\t\t// Amount\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'gross_amount' } );\n\t\t\tform_item_input.setValue( expenses['gross_amount'] );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Amount' ), form_item_input, tab_expense_column3, '', null, true );\n\t\t\tthis.edit_view_ui_dic['gross_amount'].css( 'opacity', 1 );\n\t\t}\n\n\t\t// Reimburse Amount\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'reimburse_amount' } );\n\t\tif ( expenses ) {\n\t\t\tif ( expenses['reimburse_amount'] && expenses['unit_amount'] && expenses['unit_name'] ) {\n\t\t\t\tform_item_input.setValue( expenses['reimburse_amount'] + ' (' + expenses['unit_amount'] + '/' + expenses['unit_name'] + ')' );\n\t\t\t} else {\n\t\t\t\tform_item_input.setValue( expenses['reimburse_amount'] );\n\t\t\t}\n\t\t} else {\n\t\t\tform_item_input.setValue( this.current_edit_record.reimburse_amount );\n\t\t}\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Reimburse Amount' ), form_item_input, tab_expense_column3, '', null, true );\n\n\t\tthis.edit_view_ui_dic['reimburse_amount'].css( 'opacity', 1 );\n\n\t\tthis.editFieldResize( 0 );\n\t}\n\n\tuniformVariable( records ) {\n\n\t\trecords.related_expenses = this.relatedExpenseArray;\n\t\trecords.gross_amount = this.relatedExpenseArray.gross_amount;\n\t\trecords.net_amount = this.relatedExpenseArray.net_amount;\n\t\trecords.reimburse_amount = this.relatedExpenseArray.reimburse_amount;\n\n\t\tif ( !Global.isSet( records.parent_id ) ) {\n\t\t\trecords.parent_id = false;\n\t\t}\n\n\t\treturn records;\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onSaveDone( result );\n\n\t\t\t\t$this.removeEditView();\n\n\t\t\t\t$().TFeedback( {\n\t\t\t\t\tsource: 'Save'\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\t// onSaveAndContinueResult( result ) {\n\t//\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onEditClick( $this.refresh_id, true );\n\t//\n\t// \t\t\t$this.onSaveAndContinueDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t// onSaveAndNewResult: function( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onAddClick( true );\n\t//\n\t// \t\t} );\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t_continueDoCopyAsNew() {\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\t\t\tthis.editor.removeAllRows();\n\t\t\tthis.editor.getDefaultData();\n\t\t}\n\t\tsuper._continueDoCopyAsNew();\n\t}\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\n\t\t\t\t$this.onCopyAsNewClick();\n\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndNextResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.onRightArrowClick();\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onSaveAndNextDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tsaveInsideEditorData( callBack ) {\n\t\tvar $this = this;\n\t\tvar data = this.editor.getValue();\n\t\tvar files = data.length;\n\t\tif ( files > 0 ) {\n\t\t\tvar success = 0;\n\t\t\tfor ( var key in data ) {\n\t\t\t\tvar fileItem = data[key];\n\t\t\t\tif ( Global.isSet( fileItem.file ) ) {\n\n\t\t\t\t\tvar document_revision_id = this.api.addAttachment( fileItem.name, this.document_object_type_id, this.refresh_id, { async: false } ).getResult();\n\t\t\t\t\t$this.api.uploadFile( fileItem.file, 'object_type=document_revision&object_id=' + document_revision_id + '&parent_object_type_id=' + $this.document_object_type_id, {} );\n\n\t\t\t\t\tsuccess++;\n\n\t\t\t\t} else {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( success === files ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\n\t\t} else {\n\t\t\tcallBack();\n\t\t}\n\t}\n\n\tuploadFile( document_result, file_data ) {\n\t\tvar document_revision_id = document_result.getResult();\n\t\tvar $this = this;\n\n\t\t$this.api.uploadFile( file_data, 'object_type=document_revision&object_id=' + document_revision_id, {\n\t\t\tonResult: function( upload_file_result ) {\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_expense': { 'label': $.i18n._( 'Expense' ) },\n\t\t\t'tab_attachment': true,\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUserExpense,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_expense',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_expense = this.edit_view_tab.find( '#tab_expense' );\n\n\t\tvar tab_expense_column1 = tab_expense.find( '.first-column' );\n\t\tvar tab_expense_column2 = tab_expense.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_expense_column1 );\n\t\tthis.edit_view_tabs[0].push( tab_expense_column2 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user',\n\t\t\tfield: 'user_id',\n\t\t\tset_empty: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'user_expense';\n\t\tform_item_input.setDefaultArgs( default_args );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_expense_column1, '' );\n\n\t\t// Effective Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'effective_date' } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Effective Date' ), form_item_input, tab_expense_column1, '', null );\n\n\t\t// Date Incurred\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'incurred_date' } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date Incurred' ), form_item_input, tab_expense_column1, '', null );\n\n\t\t// Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_expense_column1, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Payment Method\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'payment_method_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.payment_method_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Payment Method' ), form_item_input, tab_expense_column1 );\n\n\t\t// Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIExpensePolicy,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_expense_policy',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'expense_policy_id',\n\t\t\talways_include_columns: ['type_id', 'unit_name'],\n\t\t\tinit_data_immediately: true,\n\t\t\tsetRealValueCallBack: ( function( val ) {\n\t\t\t\tif ( val ) {\n\t\t\t\t\t$this.onExpensePolicyChange();\n\t\t\t\t}\n\t\t\t} ),\n\t\t} );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_expense_column1 );\n\n\t\t//Amount\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'gross_amount1' } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box \\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'> ' + $.i18n._( 'Reimburse' ) + ': </span>' );\n\n\t\tvar widget_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\twidget_checkbox.TCheckbox( { field: 'is_reimbursable' } );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\t\twidgetContainer.append( widget_checkbox );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Amount' ), [form_item_input, widget_checkbox], tab_expense_column1, 'last', widgetContainer );\n\n\t\t// Currency\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'currency_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Currency' ), form_item_input, tab_expense_column2, '' );\n\n\t\t// Branch\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_branch',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'branch_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Branch' ), form_item_input, tab_expense_column2 );\n\n\t\t//Department\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_department',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'department_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Department' ), form_item_input, tab_expense_column2 );\n\n\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t//Job\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIJob,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_job',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t\t}\n\t\t\t\t} ),\n\t\t\t\tfield: 'job_id'\n\t\t\t} );\n\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\t\tjob_coder.addClass( 'job-coder' );\n\n\t\t\twidgetContainer.append( job_coder );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_expense_column2, '', widgetContainer, true );\n\n\t\t\t//Job Item\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_job_item',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t\t}\n\t\t\t\t} ),\n\t\t\t\tfield: 'job_item_id'\n\t\t\t} );\n\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\t\twidgetContainer.append( job_item_coder );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_expense_column2, '', widgetContainer, true );\n\t\t}\n\t\t//Tags\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\n\t\tform_item_input.TTagInput( { field: 'tag', object_type_id: 930 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), form_item_input, tab_expense_column2, '', null, null, true );\n\n\t\t//Inside editor\n\n\t\tvar inside_editor_div = tab_expense.find( '.inside-editor-div' );\n\n\t\tvar inside_editor_args = {\n\t\t\tname: $.i18n._( 'Attachment  Name' ),\n\t\t\taction: $.i18n._( 'Action' )\n\t\t};\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\t\tthis.editor.InsideEditor( {\n\t\t\taddRow: this.insideEditorAddRow,\n\t\t\tremoveRow: this.insideEditorRemoveRow,\n\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\tparent_controller: this,\n\t\t\tapi: this.document_api,\n\t\t\trender: 'views/my_account/expense/DocumentViewInsideEditorRender.html',\n\t\t\trender_args: inside_editor_args,\n\t\t\trow_render: 'views/my_account/expense/DocumentViewInsideEditorRow.html'\n\n\t\t} );\n\n\t\tinside_editor_div.append( this.editor );\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'user_expense';\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tdefault_args: default_args,\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Tags' ),\n\t\t\t\tfield: 'tag',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tin_column: 1,\n\t\t\t\tobject_type_id: 930,\n\t\t\t\tform_item_type: FormItemType.TAG_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'expense_policy_id',\n\t\t\t\tlayout_name: 'global_expense_policy',\n\t\t\t\tapi_class: TTAPI.APIExpensePolicy,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\n\t}\n\n}\n"],"sourceRoot":""}