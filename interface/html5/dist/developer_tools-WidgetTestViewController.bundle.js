(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["developer_tools-WidgetTestViewController","filebrowser-TImage","filebrowser-TImageAdvBrowser","switch_button-SwitchButton"],{1469:()=>{!function(e){e.fn.TImage=function(t){Global.addCss("global/widgets/filebrowser/TImageBrowser.css");var i,a=e.extend({},e.fn.TImage.defaults,t);return this.clearErrorStyle=function(){},this.getField=function(){return i},this.getValue=function(){return null},this.setValue=function(e){if(e){var t=new Date;this.attr("src",e+"&t="+t.getTime())}else this.attr("src","")},this.each((function(){var t=e.meta?e.extend({},a,e(this).data()):a;i=t.field})),this},e.fn.TImage.defaults={},e(document).on("mouseover",".file-browser img",(function(t){var i=e(t.target).parents(".file-browser");if(!e(".file_browser_overlay")[0]&&1==e(t.target).attr("enable-delete")){var a=e(t.target).height(),s=(a-32)/2,l=e('<div class="file_browser_overlay"><img src="theme/default/images/delete-512.png" style="position:absolute;width:32px;height:32px;top:'+s+"px;left:"+s+'px;"></div>');l.css("position","absolute"),l.css("top","0px"),l.css("left","0"),l.css("cursor","pointer"),l.css("height",a+"px"),l.css("width","100%"),l.css("background","rgba(255,255,255,0.85)"),e(t.target).parents(".file-browser").append(l),e(document).on("click",".file_browser_overlay",(function(t){e(t.target).parent().find("img").attr("src");TAlertManager.showConfirmAlert(e.i18n._("This will permanently delete the image. Are you sure?"),"",(function(e){if(e){var t={type:"deleteClick",message:"Delete image clicked.",time:new Date};i.trigger(t)}}))})),e(document).on("mouseleave",".file-browser",(function(){(e(document).off("click",".file_browser_overlay"),e(".file_browser_overlay")[0])&&e(this).find(".file_browser_overlay").off().remove()}))}}))}(jQuery)},8243:()=>{!function(e){e.fn.TImageAdvBrowser=function(t){Global.addCss("global/widgets/filebrowser/TImageBrowser.css");var i,a,s,l=e.extend({},e.fn.TImageAdvBrowser.defaults,t),o=this,n="",r=177,c=42,d=null;return this.setEnable=function(e){e;var t=this.children().eq(1);e?t.show():t.hide()},this.clearErrorStyle=function(){},this.getField=function(){return i},this.getValue=function(){return s},this.setImage=function(e){if(!e)return a.attr("src",""),void a.hide();var t=new Date;a.hide(),a.attr("src",e+"&t="+t.getTime()+"&X-CSRF-Token="+getCookie("CSRF-Token")),a.css("height","auto"),a.css("width","auto")},this.onImageLoad=function(t){var i=e(t).height()>0?e(t).height():t.naturalHeight,a=e(t).width()>0?e(t).width():t.naturalWidth;i>c&&e(t).css("height",c),a>r&&(e(t).css("width",r),e(t).css("height","auto")),o.trigger("setSize"),i<5?e(t).hide():e(t).show()},this.setValue=function(e){e||(e="")},this.setEnableDelete=function(e){var t=o.find(".image");e?t.attr("enable-delete",1):t.removeAttr("enable-delete")},this.each((function(){var t=e.meta?e.extend({},l,e(this).data()):l;i=t.field;e(this).find("#upload_image").text(e.i18n._("Upload Image")),t.callBack&&(d=t.callBack),!1===t.show_browser&&e(this).children().eq(1).hide(),t.default_width>0&&(r=t.default_width),t.default_height>0&&(c=t.default_height),Global.isSet(t.name)&&t.name,Global.isSet(n)&&(n=t.accept_filter),Global.isSet(t.deleteImageHandler)&&o.find(".file-browser").on("deleteClick",(function(){t.deleteImageHandler()})),e(this).children().eq(1).bind("click",(function(){IndexViewController.openWizard("UserPhotoWizard",null,(function(e){d&&d(e),s=e}))})),(a=e(this).children().eq(0)).on("load",(function(){o.onImageLoad(this)})),a.hide()})),this},e.fn.TImageAdvBrowser.defaults={}}(jQuery)},6618:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"SwitchButtonIcon":()=>a}),function(e){e.fn.SwitchButton=function(t){Global.addCss("global/widgets/switch_button/SwitchButton.css");var i=e.extend({},e.fn.SwitchButton.defaults,t),a=this,s=null,l=!0;return this.getEnabled=function(){return l},this.setEnable=function(e){l=e,e?this.removeClass("disable-element"):this.removeClass("disable-element").addClass("disable-element")},this.getValue=function(e){return e?s&&s.hasClass("selected")?1:0:!(!s||!s.hasClass("selected"))},this.setValue=function(e){s&&(s.removeClass("selected"),e&&s.addClass("selected"))},this.setIcon=function(e){s.addClass(e)},this.each((function(){var t=e.meta?e.extend({},i,e(this).data()):i;s=e("<div></div>"),a.append(s),t.tooltip&&s.attr("title",t.tooltip),a.setIcon(t.icon),s.click((function(e){if(!l)return e.stopImmediatePropagation(),void e.stopPropagation();a.setValue(!a.getValue())}))})),this},e.fn.SwitchButton.defaults={}}(jQuery);var a=function(){};a.daily_total="daily",a.weekly_total="weekly",a.all_employee="all-employee",a.strict_range="strict-range",a.wages="strict-range"},2911:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"WidgetTestViewController":()=>s});i(1469),i(8243),i(3161);var a=i(6618);class s extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#awesomebox_test_view_container",user_api:null,user_group_api:null,company_api:null,user_id_array:null}),super(e)}init(e){this.edit_view_tpl="WidgetTestEditView.html",this.permission_id="user",this.viewId="WidgetTest",this.script_name="WidgetTest",this.table_name_key="awesomebox_test",this.context_menu_name=$.i18n._("Widget Test"),this.navigation_label=$.i18n._("Widget Test")+":",this.api=TTAPI.APIUser,this.select_company_id=LocalCacheData.getCurrentCompany().id,this.user_group_api=TTAPI.APIUserGroup,this.company_api=TTAPI.APICompany,this.user_id_array=[],this.render(),this.buildContextMenu(),this.initData()}setCurrentEditRecordData(){this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}clearEditViewData(){return!1}buildEditViewUI(){var e=this,t={"tab_employee":{"label":$.i18n._("Employee")}};this.setTabModel(t);var i=this.edit_view_tab.find("#tab_employee"),s=i.find(".first-column"),l=i.find(".second-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(s);var o=Global.loadWidgetByName(FormItemType.SEPARATED_BOX);o.SeparatedBox({label:$.i18n._("Separated_box: if you see this, the test is passing.")}),this.addEditFieldToColumn(null,o,s),(o=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"checkbox"}),this.addEditFieldToColumn($.i18n._("TCheckbox"),o,s,""),(o=Global.loadWidgetByName(FormItemType.COLOR_PICKER)).TColorPicker({field:"color_picker"}),this.addEditFieldToColumn($.i18n._("TColorPicker"),o,s),(o=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"datepicker"}),this.addEditFieldToColumn($.i18n._("TDatePicker"),o,s,"",null),(o=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TRangePicker({field:"daterange",validation_field:"date_stamp"}),this.addEditFieldToColumn($.i18n._("TDateRange"),o,s,"",null,!0),(o=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"timepicker"}),this.addEditFieldToColumn($.i18n._("TTimePicker"),o,s),o=Global.loadWidgetByName(FormItemType.IMAGE_AVD_BROWSER),this.file_browser=o.TImageAdvBrowser({field:"imagebrowser",default_width:128,default_height:128,enable_delete:!0,callBack:function(t){(new ServiceCaller).uploadFile(t,"object_type=user_photo&object_id="+e.current_edit_record.id,{onResult:function(t){"true"===t.toLowerCase()?e.file_browser.setImage(ServiceCaller.getURLByObjectType("user_photo")+"&object_id="+e.current_edit_record.id):TAlertManager.showAlert(t,"Error")}})},deleteImageHandler:function(t){e.onDeleteImage()}}),this.addEditFieldToColumn($.i18n._("TImageAdvBrowser"),this.file_browser,s,"",null,!1,!0),Global.loadScript("global/widgets/formula_builder/FormulaBuilder.js",(function(){(o=Global.loadWidgetByName(FormItemType.FORMULA_BUILDER)).FormulaBuilder({field:"formula",width:"100%",onFormulaBtnClick:function(){TTAPI.APIReportCustomColumn.getOptions("formula_functions",{onResult:function(t){var i=t.getResult();e.api.getOptions("formula_variables",{onResult:function(t){var a=t.getResult(),s={};s.functions=Global.buildRecordArray(i),s.variables=Global.buildRecordArray(a),s.formula=e.current_edit_record.company_value1,s.current_edit_record=Global.clone(e.current_edit_record),s.api=e.api,IndexViewController.openWizard("FormulaBuilderWizard",s,(function(t){e.current_edit_record.company_value1=t,e.edit_view_ui_dic.df_11.setValue(t)}))}})}})}}),e.detachElement("df_11"),e.addEditFieldToColumn("FormulaBuilder",o,s,"",null,!0),o.parent().width("45%")}));var n=$(".control-bar .action-chooser-div");this.all_employee_btn=n.find("#all_employee"),this.daily_totals_btn=n.find("#daily_totals"),this.weekly_totals_btn=n.find("#weekly_totals"),this.strict_range_btn=n.find("#strict_range"),this.all_employee_btn=this.all_employee_btn.SwitchButton({icon:a.SwitchButtonIcon.all_employee,tooltip:$.i18n._("Show Unscheduled Employees")}),this.daily_totals_btn=this.daily_totals_btn.SwitchButton({icon:a.SwitchButtonIcon.daily_total,tooltip:$.i18n._("Daily Totals")}),this.weekly_totals_btn=this.weekly_totals_btn.SwitchButton({icon:a.SwitchButtonIcon.weekly_total,tooltip:$.i18n._("Weekly Totals")}),this.strict_range_btn=this.strict_range_btn.SwitchButton({icon:a.SwitchButtonIcon.strict_range,tooltip:$.i18n._("Strict Range")}),this.all_employee_btn.click((function(){})),this.daily_totals_btn.click((function(){})),this.weekly_totals_btn.click((function(){})),this.strict_range_btn.setValue(!0),this.strict_range_btn.click((function(){})),this.toggle_button=$(this.el).find(".toggle-button-div");var r=[{label:$.i18n._("Day"),value:"day"},{label:$.i18n._("Week"),value:"week"},{label:$.i18n._("Month"),value:"month"},{label:$.i18n._("Year"),value:"year"}];this.toggle_button=this.toggle_button.TToggleButton({data_provider:r}),this.toggle_button.bind("change",(function(t,i){e.scroll_position=0,e.select_all_shifts_array=[],e.select_shifts_array=[],e.select_recurring_shifts_array=[]})),(o=Global.loadWidgetByName(FormItemType.TAG_INPUT)).TTagInput({field:"tags",object_type_id:930}),this.addEditFieldToColumn($.i18n._("TTagInput"),o,l,"",null,null,!0),(o=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"text",width:"100%"}),this.addEditFieldToColumn($.i18n._("TText"),o,l),o.parent().width("45%"),(o=Global.loadWidgetByName(FormItemType.PASSWORD_INPUT)).TPasswordInput({field:"password",width:200}),this.addEditFieldToColumn($.i18n._("TPasswordInput"),o,l),(o=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"textarea"}),this.addEditFieldToColumn($.i18n._("TTextArea"),o,l,"",null,null,!0)}buildSearchFields(){super.buildSearchFields();this.search_fields=[]}getCustomContextMenuModel(){return{exclude:["default"],include:[ContextMenuIconName.edit,ContextMenuIconName.cancel]}}search(){var e=this;this.api.getUser({},!0,{onResult:function(t){var i=t.getResult();e.user_id_array=i,i=e.processResultData(i),e.grid.setData(i),e.grid.setGridColumnsWidth(),e.onEditClick(i[0].id)}})}setEditViewDataDone(){var e=this;setTimeout((function(){TAlertManager.showConfirmAlert($.i18n._("Run tests?"),null,(function(t){1==t&&e.runTests()})),e.setTabOVisibility(!0),$(".edit-view-tab-bar").css("opacity",1),TTPromise.resolve("init","init")}),2500),super.setEditViewDataDone()}runTests(){var e=this;0==$("#qunit_script").length&&($("<script id='qunit_script' src='framework/qunit/qunit.js'><\/script>").appendTo("head"),$("<link rel='stylesheet' type='text/css' href='framework/qunit/qunit.css'>").appendTo("head")),QUnit.config.autostart=!1,$("#qunit_container").css("width","100%"),$("#qunit_container").css("height","auto"),$("#qunit_container").css("overflow-y","scroll"),$("#qunit_container").css("top","0px"),$("#qunit_container").css("left","0px"),$("#qunit_container").css("z-index","100"),$("#qunit_container").css("background","#fff"),$("#qunit_container").show(),$("#tt_debug_console").remove(),window.qunit_initiated||(window.qunit_initiated=!0,QUnit.start()),QUnit.module("Widgets"),this.testCheckbox(),this.testColorPicker(),TTPromise.add("datetests","picker"),TTPromise.add("datetests","range"),this.testDatePicker(),this.testDateRange(),TTPromise.wait("datetests",null,(function(){e.testTimePicker()})),TTPromise.add("wizardtests","imagebrowser"),this.testImageBrowser(),TTPromise.wait("wizardtests","imagebrowser",(function(){e.testFormulaBuilder()})),TTPromise.wait("null","null",(function(){e.testTags()})),this.testButtons(),this.testText(),this.testPassword(),this.testTextarea()}testCheckbox(){var e=this;QUnit.test("Checkbox tests",(function(t){var i=e.edit_view_ui_dic.checkbox;t.ok(0==i.getValue(),"checkbox not checked"),i.setValue(!0),t.ok(i.getValue(),"checkbox checked via code"),i.setValue(!1),t.ok(0==i.getValue(),"checkbox unchecked via code"),$(i).click(),t.ok(i.getValue(),"checkbox checked via click"),$(i).click(),t.ok(0==i.getValue(),"checkbox unchecked via click")}))}testColorPicker(){var e=this;QUnit.test("ColorPicker tests",(function(t){var i=t.async(),a=e.edit_view_ui_dic.color_picker;t.ok(""==a.getValue(),"widget empty"),$(a).click(),setTimeout((function(){$(".cp-color-picker").hide(),t.ok("FFFFFF"==a.getValue(),"widget white after no select: "+a.getValue()),a.setValue("FF0000"),t.ok("FF0000"==a.getValue(),"widget red after set value programatically"+a.getValue()),$(a).click(),$(".cp-color-picker").hide(),i()}),1e3)}))}testDatePicker(){var e=this;QUnit.test("DatePicker tests",(function(t){var i=t.async(),a=e.edit_view_ui_dic.datepicker;t.ok(""==a.getValue(),"widget empty"),setTimeout((function(){a.find("#tDatePickerIcon").trigger("mouseup"),t.ok($("#ui-datepicker-div:visible").length>0,"calendar visible after click"),$($("#ui-datepicker-div .ui-datepicker-calendar td")[15]).click(),setTimeout((function(){t.ok(0==$("#ui-datepicker-div:visible").length,"calendar invisible after date selection"),t.ok(""!=a.getValue(),"value is not blank"),TTPromise.resolve("datetests","picker"),i()}),1e3)}),1e3)}))}testDateRange(){var e=this;QUnit.test("DateRange tests",(function(t){var i=t.async(),a=e.edit_view_ui_dic.daterange;t.ok(void 0===a.getValue(),"widget empty "+a.getValue()),a.find("#tDatePickerIcon").trigger("mouseup"),setTimeout((function(){t.ok($(".t-range-picker-div:visible").length>0,"calendar visible after click"),$($(".t-range-picker-div .end-picker td")[15]).click(),$(".t-range-picker-div .close-icon").click(),setTimeout((function(){t.ok(0==$(".t-range-picker-div:visible").length,"calendar invisible after closing"),t.ok(""!=a.getValue(),"value is not blank"),i(),TTPromise.resolve("datetests","range")}),1e3)}),1e3)}))}testTimePicker(){var e=this;QUnit.test("TimePicker tests",(function(t){var i=e.edit_view_ui_dic.timepicker;t.ok(""==i.getValue(),"widget empty: "+i.getValue()),i.find("#tTimePickerIcon").trigger("mouseup"),t.ok($("#ui-datepicker-div:visible").length>0,"timepicker widget visible after click"),$('#ui-datepicker-div:visible button[data-handler="today"]').click(),t.ok($("#ui-datepicker-div:visible").length>0,"timepicker widget visible after now click"),$('#ui-datepicker-div:visible button[data-handler="hide"]').click(),t.ok(0==$("#ui-datepicker-div:visible").length,"timepicker widget gone clicking close button"),t.ok(""!=i.getValue(),"value is not blank")}))}testImageBrowser(){var e=this;TTPromise.add(""),QUnit.test("ImageBrowser tests",(function(t){var i=t.async(),a=e.edit_view_ui_dic.imagebrowser;t.ok(void 0===a.getValue(),"widget empty: "+a.getValue()),a.find("#upload_image").click(),setTimeout((function(){t.ok($(".wizard:visible").length>0,"wizard visible"),$(".wizard:visible .close-btn").click(),t.ok(0==$(".wizard:visible").length,"wizard invisible"),i(),TTPromise.resolve("wizardtests","imagebrowser")}),1e3)}))}testFormulaBuilder(){var e=this;QUnit.test("FormulaBuilder tests",(function(t){var i=t.async(),a=e.edit_view_ui_dic.formula;t.ok(""==a.getValue(),"widget empty: "+a.getValue()),a.find(".t-button.formula-btn").click(),setTimeout((function(){t.ok($(".wizard:visible").length>0,"wizard visible"),$(".wizard:visible .close-btn").click(),t.ok(0==$(".wizard:visible").length,"wizard invisible"),i()}),1e3)}))}testButtons(){QUnit.test("TotalButtons tests",(function(e){var t=e.async(),i=$(".control-bar .action-chooser-div #all_employee .all-employee"),a=$(".control-bar .action-chooser-div #daily_totals .daily"),s=$(".control-bar .action-chooser-div #weekly_totals .weekly"),l=$(".control-bar .action-chooser-div #strict_range .strict-range");e.ok(l.hasClass("selected"),"strict range starts selected"),e.ok(0==a.hasClass("selected"),"daily totals starts unselected"),e.ok(0==s.hasClass("selected"),"week total starts unselected"),e.ok(0==i.hasClass("selected"),"all employees starts unselected"),l.click(),setTimeout((function(){e.ok(0==l.hasClass("selected"),"strict range unselects on click"),a.click(),setTimeout((function(){e.ok(a.hasClass("selected"),"daily_totals_btn selects on click"),s.click(),setTimeout((function(){e.ok(s.hasClass("selected"),"weekly_totals_btn selects on click"),i.click(),setTimeout((function(){e.ok(i.hasClass("selected"),"all_employee_btn selects on click"),l.click(),a.click(),s.click(),i.click(),setTimeout((function(){e.ok(l.hasClass("selected"),"strict range starts selected"),e.ok(0==a.hasClass("selected"),"daily totals starts unselected"),e.ok(0==s.hasClass("selected"),"week total starts unselected"),e.ok(0==i.hasClass("selected"),"all employees starts unselected"),t()}),1500)}),1500)}),1500)}),1500)}),1500)}))}testTags(){var e=this;QUnit.test("Tags tests",(function(t){var i=t.async(),a=e.edit_view_ui_dic.tags.find("input.add-tag-input"),s=e.edit_view_ui_dic.tags.getValue();t.ok(""==s,"starts empty "+s),a.focus(),$(a).val("test1"),$(a).trigger({type:"keydown",which:32,keyCode:32}),$(a).val("test2"),$(a).trigger({type:"keydown",which:32,keyCode:32}),setTimeout((function(){var a=e.edit_view_ui_dic.tags.getValue();t.ok("test1,test2"==a,"2 tags entered and return in value: "+a),setTimeout((function(){$(".tag-span-div .close-btn").click(),setTimeout((function(){var a=e.edit_view_ui_dic.tags.getValue();t.ok("-test1,-test2"==a,"2 tags entered and return (subtracted) in value: "+a),i()}),1e3)}),1e3)}),1e3)}))}testText(){var e=this;QUnit.test("Text test",(function(t){var i=e.edit_view_ui_dic.text;i.setValue("testing textbox"),t.ok("testing textbox"==i.getValue(),"accepts text and returns value"),i.setValue(""),t.ok(""==i.getValue(),"returned value updates when text is updated")}))}testPassword(){var e=this;QUnit.test("Password box test",(function(t){var i=e.edit_view_ui_dic.password;i.setValue("testing textbox"),t.ok("testing textbox"==i.getValue(),"accepts text and returns value"),i.setValue(""),t.ok(""==i.getValue(),"returned value updates when text is updated")}))}testTextarea(){var e=this;QUnit.test("Password box test",(function(t){var i=e.edit_view_ui_dic.textarea;i.setValue("testing textbox"),t.ok("testing textbox"==i.getValue(),"accepts text and returns value"),i.setValue(""),t.ok(""==i.getValue(),"returned value updates when text is updated")}))}}}}]);
//# sourceMappingURL=developer_tools-WidgetTestViewController.bundle.js.map?v=cfd686d34fc17ed3fd55