(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["attendance-schedule-ScheduleShiftViewController"],{2509:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"ScheduleShiftViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#schedule_shift_view_container",schedule_status_array:null,user_status_array:null,user_group_array:null,user_api:null,user_group_api:null,date_api:null,absence_policy_api:null,total_time:null,pre_total_time:0,is_mass_adding:!1}),super(e)}init(e){this.edit_view_tpl="ScheduleShiftEditView.html",this.permission_id="schedule",this.viewId="ScheduleShift",this.script_name="ScheduleShiftView",this.table_name_key="schedule",this.context_menu_name=$.i18n._("Schedule Shift"),this.navigation_label=$.i18n._("Schedule")+":",this.api=TTAPI.APISchedule,this.absence_policy_api=TTAPI.APIAbsencePolicy,this.user_api=TTAPI.APIUser,this.user_group_api=TTAPI.APIUserGroup,Global.getProductEdition()>=20&&(this.job_api=TTAPI.APIJob,this.job_item_api=TTAPI.APIJobItem),this.date_api=TTAPI.APITTDate,this.initPermission(),this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary()}getCustomContextMenuModel(){return{exclude:[ContextMenuIconName.copy],include:[]}}onSaveClick(e){var t,i=this;if(this.is_mass_editing){t=[];var a={};for(var s in this.edit_view_ui_dic)if(this.edit_view_ui_dic.hasOwnProperty(s)){var _=this.edit_view_ui_dic[s];Global.isSet(_.isChecked)&&_.isChecked()&&_.getEnabled()&&(a[s]=_.getValue())}for(var r=0;r<this.mass_edit_record_ids.length;r++){var l=Global.clone(a);l.id=i.mass_edit_record_ids[r],t.push(l)}}else this.collectUIDataToCurrentEditRecord(),t=this.uniformVariable(this.current_edit_record);this.api["set"+this.api.key_name](t,!1,e,{onResult:function(e){i.onSaveResult(e)}})}validate(){var e=this,t={};if(this.is_mass_editing){t=[];for(var i=0;i<this.mass_edit_record_ids.length;i++){var a={};for(var s in a.id=e.mass_edit_record_ids[i],this.edit_view_ui_dic)if(this.edit_view_ui_dic.hasOwnProperty(s)){var _=this.edit_view_ui_dic[s];Global.isSet(_.isChecked)&&_.isChecked()&&_.getEnabled()&&(a[s]=_.getValue())}t.push(a)}}else this.collectUIDataToCurrentEditRecord(),t=this.uniformVariable(this.current_edit_record);this.api["validate"+this.api.key_name](t,{onResult:function(t){e.validateResult(t)}})}jobUIValidate(e){return e||(e=this.permission_id),!!(PermissionManager.validate("job","enabled")&&PermissionManager.validate(e,"edit_job")&&Global.getProductEdition()>=20)}jobItemUIValidate(e){return e||(e="schedule"),!(!PermissionManager.validate("job_item","enabled")||!PermissionManager.validate(e,"edit_job_item"))}branchUIValidate(e){return e||(e="schedule"),!!PermissionManager.validate(e,"edit_branch")}departmentUIValidate(e){return e||(e="schedule"),!!PermissionManager.validate(e,"edit_department")}initPermission(){super.initPermission(),PermissionManager.validate(this.permission_id,"view")||PermissionManager.validate(this.permission_id,"view_child")?this.show_search_tab=!0:this.show_search_tab=!1,this.jobUIValidate()?this.show_job_ui=!0:this.show_job_ui=!1,this.jobItemUIValidate()?this.show_job_item_ui=!0:this.show_job_item_ui=!1,this.branchUIValidate()?this.show_branch_ui=!0:this.show_branch_ui=!1,this.departmentUIValidate()?this.show_department_ui=!0:this.show_department_ui=!1}initOptions(){var e=this;this.initDropDownOption("status","status_id",this.api,(function(t){t=t.getResult(),e.schedule_status_array=Global.buildRecordArray(t)})),this.initDropDownOption("status","user_status_id",this.user_api,(function(t){t=t.getResult(),e.user_status_array=Global.buildRecordArray(t)})),this.user_group_api.getUserGroup("",!1,!1,{onResult:function(t){t=t.getResult(),t=Global.buildTreeRecord(t),e.user_group_array=t,e.adv_search_field_ui_dic.group_ids.setSourceData(t)}})}checkOpenPermission(){return!!(Global.getProductEdition()>=15&&PermissionManager.validate("schedule","view_open"))}getOtherFieldReferenceField(){return"note"}buildEditViewUI(){super.buildEditViewUI();var e,t,i=this,a={"tab_schedule":{"label":$.i18n._("Schedule")},"tab_audit":!0};this.setTabModel(a),this.navigation.AComboBox({api_class:TTAPI.APISchedule,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_schedule_schedule",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var s=this.edit_view_tab.find("#tab_schedule").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(s),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!this.checkOpenPermission(),set_special_empty:!0,field:"user_id",addition_source_function:function(e,t){return i.onEmployeeSourceCreate(e,t)}});var _={permission_section:"schedule"};e.setDefaultArgs(_),this.addEditFieldToColumn($.i18n._("Employee"),e,s,""),(e=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"status_id"}),e.setSourceData(i.schedule_status_array),this.addEditFieldToColumn($.i18n._("Status"),e,s),(e=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"start_date_stamp",validation_field:"date_stamp"}),this.addEditFieldToColumn($.i18n._("Date"),e,s,"",null),(e=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TRangePicker({field:"start_date_stamps",validation_field:"date_stamp"}),this.addEditFieldToColumn($.i18n._("Date"),e,s,"",null,!0),(e=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"start_time"}),this.addEditFieldToColumn($.i18n._("In"),e,s,"",null),(e=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"end_time"}),this.addEditFieldToColumn($.i18n._("Out"),e,s,"",null),(e=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"total_time"}),this.addEditFieldToColumn($.i18n._("Total"),e,s),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APISchedulePolicy,allow_multiple_selection:!1,layout_name:"global_schedule",show_search_inputs:!0,set_empty:!0,field:"schedule_policy_id"}),this.addEditFieldToColumn($.i18n._("Schedule Policy"),e,s),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIAbsencePolicy,allow_multiple_selection:!1,layout_name:"global_absences",show_search_inputs:!0,set_empty:!0,field:"absence_policy_id"}),e.customSearchFilter=function(e){return i.setAbsencePolicyFilter(e)},this.addEditFieldToColumn($.i18n._("Absence Policy"),e,s,"",null,!0),(e=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"available_balance"}),e.setClassStyle({float:"left","margin-right":"5px"}),t=$("<div style='position: relative' class='widget-h-box'></div>");var r=$("<img class='balance_icon' src='theme/default/images/infox16x16.png'></img>");r.bind("click",this.exchangeBalance);var l=$("<div  class='schedule-view-balance-info'></div>");if(t.append(e),t.append(r),t.append(l),this.addEditFieldToColumn($.i18n._("Available Balance"),e,s,"",t,!0),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIBranch,allow_multiple_selection:!1,layout_name:"global_branch",show_search_inputs:!0,set_empty:!0,field:"branch_id",addition_source_function:function(e,t){return i.onSourceDataCreate(e,t)},added_items:[{value:TTUUID.not_exist_id,label:Global.default_item}]}),this.addEditFieldToColumn($.i18n._("Branch"),e,s,"",null,!0),this.show_branch_ui||this.detachElement("branch_id"),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIDepartment,allow_multiple_selection:!1,layout_name:"global_department",show_search_inputs:!0,set_empty:!0,field:"department_id",addition_source_function:function(e,t){return i.onSourceDataCreate(e,t)},added_items:[{value:TTUUID.not_exist_id,label:Global.default_item}]}),this.addEditFieldToColumn($.i18n._("Department"),e,s,"",null,!0),this.show_department_ui||this.detachElement("department_id"),Global.getProductEdition()>=20){(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIJob,allow_multiple_selection:!1,layout_name:"global_job",show_search_inputs:!0,set_empty:!0,setRealValueCallBack:function(e){e&&d.setValue(e.manual_id)},field:"job_id",addition_source_function:function(e,t){return i.onSourceDataCreate(e,t)},added_items:[{value:TTUUID.not_exist_id,label:Global.default_item}]}),t=$("<div class='widget-h-box'></div>");var d=Global.loadWidgetByName(FormItemType.TEXT_INPUT);d.TTextInput({field:"job_quick_search",disable_keyup_event:!0}),d.addClass("job-coder"),t.append(d),t.append(e),this.addEditFieldToColumn($.i18n._("Job"),[e,d],s,"",t,!0),this.show_job_ui||this.detachElement("job_id"),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIJobItem,allow_multiple_selection:!1,layout_name:"global_job_item",show_search_inputs:!0,set_empty:!0,setRealValueCallBack:function(e){e&&o.setValue(e.manual_id)},field:"job_item_id",addition_source_function:function(e,t){return i.onSourceDataCreate(e,t)},added_items:[{value:TTUUID.not_exist_id,label:Global.default_item}]}),t=$("<div class='widget-h-box'></div>");var o=Global.loadWidgetByName(FormItemType.TEXT_INPUT);o.TTextInput({field:"job_item_quick_search",disable_keyup_event:!0}),o.addClass("job-coder"),t.append(o),t.append(e),this.addEditFieldToColumn($.i18n._("Task"),[e,o],s,"",t,!0),this.show_job_item_ui||this.detachElement("job_item_id")}(e=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"note",width:"100%"}),this.addEditFieldToColumn($.i18n._("Note"),e,s,"",null,null,!0),e.parent().width("45%"),this.is_mass_editing?this.detachElement("total_time"):this.attachElement("total_time")}onSourceDataCreate(e,t){var i=e.getDisplayColumns(),a={};return $.each(i,(function(e,t){return a.id=TTUUID.not_exist_id,a[t.name]=Global.default_item,!1})),t&&"array"===$.type(t)||(t=[]),t.unshift(a),t}setEditViewWidgetsMode(){var e={};for(var t in this.edit_view_ui_dic)if(this.edit_view_ui_dic.hasOwnProperty(t)){var i=this.edit_view_ui_dic[t],a=(this.edit_view_form_item_dic[t],i.parent().parent().parent()),s=a.parent().attr("id");switch(a.hasClass("v-box")||e[s]||(e[s]=!0),t){case"start_date_stamps":this.current_edit_record.id&&this.current_edit_record.id!=TTUUID.zero_id||this.is_mass_editing||this.is_edit?(this.detachElement(t),i.parents(".edit-view-form-item-div").hide()):(this.attachElement(t),i.parents(".edit-view-form-item-div").show());break;case"start_date_stamp":this.current_edit_record.id&&this.current_edit_record.id!=TTUUID.zero_id||this.is_mass_editing||this.is_edit?(this.attachElement(t),i.parents(".edit-view-form-item-div").show()):(this.detachElement(t),i.parents(".edit-view-form-item-div").hide());break;default:i.css("opacity",1)}this.is_viewing?Global.isSet(i.setEnabled)&&i.setEnabled(!1):Global.isSet(i.setEnabled)&&i.setEnabled(!0)}}exchangeBalance(){var e=$($(this).next());"block"===e.css("display")?e.css("display","none"):"none"===e.css("display")&&e.css("display","block")}onAddResult(e){var t=this,i=e.getResult();i||(i=[]),i.company=LocalCacheData.current_company.name,t.sub_view_mode&&t.parent_key&&(i[t.parent_key]=t.parent_value),!0===i&&(i={user_id:TTUUID.zero_id}),!i.user_id&&(i.user_id=TTUUID.zero_id),t.current_edit_record=i,t.initEditView()}setAbsencePolicyFilter(e){return e.filter_data||(e.filter_data={}),e.filter_data.user_id=this.current_edit_record.user_id,e.filter_columns&&(e.filter_columns.absence_policy=!0),e}onEmployeeSourceCreate(e,t){if(!this.checkOpenPermission())return t;var i=e.getDisplayColumns(),a={};return $.each(i,(function(e,t){return a.id=TTUUID.zero_id,a[t.name]=Global.open_item,!1})),t&&"array"===$.type(t)||(t=[]),t.unshift(a),t}buildSearchFields(){super.buildSearchFields();var e=this;this.search_fields=[new SearchField({label:$.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Employee"),in_column:1,field:"user_id",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,addition_source_function:function(t,i){return e.onEmployeeSourceCreate(t,i)},adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Pay Period"),in_column:1,field:"pay_period_id",layout_name:"global_Pay_period",api_class:TTAPI.APIPayPeriod,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Start Date"),in_column:1,field:"start_date",basic_search:!1,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:$.i18n._("End Date"),in_column:1,field:"end_date",basic_search:!1,adv_search:!0,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:$.i18n._("Employee Status"),in_column:1,field:"user_status_id",multiple:!0,basic_search:!1,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Default Branch"),in_column:1,field:"default_branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!1,adv_search:!0,script_name:"BranchView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Default Department"),in_column:1,field:"default_department_id",layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!1,adv_search:!0,script_name:"DepartmentView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Group"),in_column:2,multiple:!0,field:"group_ids",layout_name:"global_tree_column",tree_mode:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Title"),field:"title_id",in_column:2,layout_name:"global_job_title",api_class:TTAPI.APIUserTitle,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Job"),in_column:2,field:"job_id",layout_name:"global_job",api_class:Global.getProductEdition()>=20?TTAPI.APIJob:null,multiple:!0,basic_search:!1,adv_search:this.show_job_ui&&Global.getProductEdition()>=20,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Task"),in_column:2,field:"job_item_id",layout_name:"global_job_item",api_class:Global.getProductEdition()>=20?TTAPI.APIJobItem:null,multiple:!0,basic_search:!1,adv_search:this.show_job_item_ui&&Global.getProductEdition()>=20,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Schedule Branch"),in_column:2,field:"branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!0,adv_search:!0,script_name:"BranchView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Schedule Department"),in_column:2,field:"department_id",layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!0,adv_search:!0,script_name:"DepartmentView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Schedule Policy"),in_column:2,field:"schedule_policy_id",layout_name:"global_schedule",api_class:TTAPI.APISchedulePolicy,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX})]}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),a=e.getValue();switch(this.current_edit_record[i]=a,i){case"job_id":Global.getProductEdition()>=20&&(this.edit_view_ui_dic.job_quick_search.setValue(e.getValue(!0)&&e.getValue(!0).manual_id?e.getValue(!0).manual_id:""),this.setJobItemValueWhenJobChanged(e.getValue(!0),"job_item_id",{status_id:10,job_id:this.current_edit_record.job_id}),this.edit_view_ui_dic.job_quick_search.setCheckBox(!0));break;case"job_item_id":Global.getProductEdition()>=20&&(this.edit_view_ui_dic.job_item_quick_search.setValue(e.getValue(!0)&&e.getValue(!0).manual_id?e.getValue(!0).manual_id:""),this.edit_view_ui_dic.job_item_quick_search.setCheckBox(!0));break;case"job_quick_search":case"job_item_quick_search":Global.getProductEdition()>=20&&(this.onJobQuickSearch(i,a),t=!0);break;case"absence_policy_id":case"status_id":this.onStatusChange();break;case"user_id":this.edit_view_ui_dic.absence_policy_id.setSourceData(null),this.edit_view_ui_dic.absence_policy_id.setValue(!1),this.current_edit_record.absence_policy_id=!1,this.getAbsencePolicy(this.current_edit_record[i]),$.isArray(this.current_edit_record[i])&&this.current_edit_record[i].length>1?this.is_mass_adding=!0:this.is_mass_adding=!1,this.setEditMenu()}this.getScheduleTotalTime(),this.getProjectedAbsencePolicyBalance(),t||this.validate()}getProjectedAbsencePolicyBalance(){if($(this.edit_view_form_item_dic.available_balance.find(".schedule-view-balance-info")).css("display","none"),this.current_edit_record.absence_policy_id&&"block"===this.edit_view_form_item_dic.absence_policy_id.css("display")&&!this.is_mass_editing){var e;if(Global.isArray(this.current_edit_record.user_id)&&1===this.current_edit_record.user_id.length)e=this.current_edit_record.user_id[0];else{if(!this.current_edit_record.user_id)return;e=this.current_edit_record.user_id}var t=this.current_edit_record.date_stamp,i=this.absence_policy_api.getProjectedAbsencePolicyBalance(this.current_edit_record.absence_policy_id,e,t,this.total_time,this.pre_total_time,{async:!1}).getResult();i=i||{available_balance:0,current_time:0,remaining_balance:0,projected_balance:0,projected_remaining_balance:0},this.edit_view_ui_dic.available_balance.setValue(Global.getTimeUnit(i.remaining_balance));var a=$(this.edit_view_form_item_dic.available_balance.find(".schedule-view-balance-info")),s="<table>";for(var _ in i)switch(_){case"available_balance":s+="<tr>",s+="<td>"+$.i18n._("Available Balance")+":</td>",s+="<td>"+Global.getTimeUnit(i[_])+"</td>",s+="</tr>";break;case"current_time":s+="<tr>",s+="<td>"+$.i18n._("Current Time")+":</td>",s+="<td>"+Global.getTimeUnit(i[_])+"</td>",s+="</tr>";break;case"remaining_balance":s+="<tr>",s+="<td>"+$.i18n._("Remaining Balance")+":</td>",s+="<td>"+Global.getTimeUnit(i[_])+"</td>",s+="</tr>",s+="<tr><td colspan='2'>&nbsp;</td></tr>";break;case"projected_balance":s+="<tr>",s+="<td>"+$.i18n._("Projected Balance by false")+":</td>",s+="<td>"+Global.getTimeUnit(i[_])+"</td>",s+="</tr>";break;case"projected_remaining_balance":s+="<tr>",s+="<td>"+$.i18n._("Projected Remaining Balance")+":</td>",s+="<td>"+Global.getTimeUnit(i[_])+"</td>",s+="</tr>"}s+="</table>",a.html(s)}this.onStatusChange()}getAbsencePolicy(e){var t={filter_data:{}};t.filter_data.user_id=e,this.edit_view_ui_dic.absence_policy_id.setDefaultArgs(t)}uniformVariable(e){var t=[];if(Global.isArray(e.user_id)&&e.user_id.length>0){var i=e.user_id;for(var a in i){var s=Global.clone(e);s.user_id=i[a],t.push(s)}}else t.push(this.current_edit_record);if(this.current_edit_record.start_date_stamps&&t.length>0){var _=[];for(var r in t){var l=this.uniformDates(t[r].start_date_stamps,t[r]);for(var d in l=Array.isArray(t[r].start_date_stamps)?t[r].start_date_stamps:this.parserDatesRange(t[r].start_date_stamps)){var o={};for(var n in t[r])"start_date_stamps"!=n&&(o[n]=t[r][n]);o.start_date_stamp=l[d],o.date_stamp=l[d],_.push(o)}}}else _=this.current_edit_record,$.isArray(_.start_date_stamp)&&1==_.start_date_stamp.length&&(_.start_date_stamp=_.start_date_stamp[0]);return _}parserDatesRange(e){for(var t=e.split(" - "),i=[],a=Global.strToDate(t[0]),s=Global.strToDate(t[1]),_=a;_.getTime()<s.getTime();)i.push(_.format()),_=new Date(new Date(_.getTime()).setDate(_.getDate()+1));return t}uniformDates(e,t){return Array.isArray(e)||-1!=e.indexOf(" - ")?Array.isArray(e)?e:this.parserDatesRange(e):[e]}setCurrentEditRecordData(){for(var e in this.setDefaultData({"status_id":10}),this.current_edit_record.id||this.is_mass_editing?this.edit_view_ui_dic.user_id.setAllowMultipleSelection(!1):this.edit_view_ui_dic.user_id.setAllowMultipleSelection(!0),this.current_edit_record){var t=this.edit_view_ui_dic[e];if(Global.isSet(t)||"date_stamp"===e)switch(e){case"start_date_stamp":case"start_date_stamps":if(!this.current_edit_record[e])continue;var i;this.current_edit_record.id?0==Array.isArray(this.current_edit_record.start_date_stamp)&&(i=[this.current_edit_record.start_date_stamp]):i=this.current_edit_record.start_date_stamps,this.current_edit_record.start_date_stamp=i,t.setValue(i);break;case"total_time":this.pre_total_time=this.is_add?0:this.current_edit_record[e];break;case"job_id":if(Global.getProductEdition()>=20)(a={}).filter_data={status_id:10,user_id:this.current_edit_record.user_id},t.setDefaultArgs(a),t.setValue(this.current_edit_record[e]);break;case"job_item_id":var a;if(Global.getProductEdition()>=20)(a={}).filter_data={status_id:10,job_id:this.current_edit_record.job_id},t.setDefaultArgs(a),t.setValue(this.current_edit_record[e]);break;case"user_id":t.setValue(this.current_edit_record[e]),this.getAbsencePolicy(this.current_edit_record[e]);break;case"date_stamp":this.current_edit_record.start_date_stamp=this.current_edit_record[e],this.current_edit_record.start_date_stamps=this.current_edit_record[e];break;default:t.setValue(this.current_edit_record[e])}}this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}getScheduleTotalTime(){if(!this.is_mass_editing){var e,t=(e=this.current_edit_record.start_date_stamps?this.uniformDates(this.current_edit_record.start_date_stamps,this.current_edit_record)[0]:this.current_edit_record.date_stamp)+" "+this.current_edit_record.start_time,i=e+" "+this.current_edit_record.end_time,a=this.current_edit_record.schedule_policy_id?this.current_edit_record.schedule_policy_id:"";if(a){var s=this.current_edit_record.user_id,_=this.api.getScheduleTotalTime(t,i,a,s,{async:!1});if(_){this.total_time=_.getResult();var r=Global.getTimeUnit(this.total_time);this.edit_view_ui_dic.total_time.setValue(r),this.current_edit_record.total_time=r}}}}setEditViewDataDone(){super.setEditViewDataDone(),this.onStatusChange(),this.getScheduleTotalTime(),this.setEditViewWidgetsMode(),this.getProjectedAbsencePolicyBalance()}onStatusChange(){20==this.current_edit_record.status_id?(this.attachElement("absence_policy_id"),this.current_edit_record.absence_policy_id&&this.current_edit_record.absence_policy_id!=TTUUID.zero_id?this.attachElement("available_balance"):this.detachElement("available_balance")):(this.detachElement("absence_policy_id"),this.detachElement("available_balance")),this.editFieldResize()}}}}]);
//# sourceMappingURL=attendance-schedule-ScheduleShiftViewController.bundle.js.map?v=e787ff5846cc0b9cf3aa