(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["wizard-user_generic_data_status-UserGenericStatusWindowController"],{1706:(t,e,i)=>{"use strict";i.r(e),i.d(e,{"UserGenericStatusWindowController":()=>a});class a extends BaseViewController{constructor(t={}){_.defaults(t,{el:"",batch_id:"",user_id:"",callback:null,events:{"click .done-btn":"onCloseClick"}}),super(t)}init(t){this.options=t,this.content_div=$(this.el).find(".content"),this.batch_id=this.options.batch_id,this.user_id=this.options.user_id,this.options.callback&&(this.callback=this.options.callback),this.api=TTAPI.APIUserGenericStatus,this.render(),this.initData()}initData(){var t=this;ProgressBar.showOverlay(),this.getAllColumns((function(){t.initLayout()}))}initLayout(){var t=this;t.getDefaultDisplayColumns((function(){t.setSelectLayout(),t.search()}))}onCloseClick(){$(this.el).remove(),this.callback&&this.callback()}render(){$(this.el).find(".title").text($.i18n._("Status Report"))}getAllColumns(t){var e=this;this.api.getOptions("columns",{onResult(i){var a=i.getResult();e.all_columns=Global.buildColumnArray(a),t&&t()}})}search(t){Global.isSet(t)||(t=!0);var e=this,i={filter_data:{}};i.filter_data.batch_id=this.batch_id,i.filter_items_per_page=0,this.api.getUserGenericStatus(i,!0,{onResult:function(i){var a=i.getResult();a=Global.formatGridData(a,e.api.key_name),e.grid.setData(a),e.setGridSize(),ProgressBar.closeOverlay(),t&&e.setDefaultMenu(!0)}}),this.api.getUserGenericStatusCountArray(this.user_id,this.batch_id,{onResult:function(t){var i=t.getResult(),a=$(e.el).find(".failed"),s=$(e.el).find(".warning"),l=$(e.el).find(".success");1!=i&&i.status&&(a.text(i.status[10].total+"/"+i.total+"( "+i.status[10].percent+"% )"),s.text(i.status[20].total+"/"+i.total+"( "+i.status[20].percent+"% )"),l.text(i.status[30].total+"/"+i.total+"( "+i.status[30].percent+"% )"))}})}setGridSize(){}setSelectLayout(t){var e=this,i=[];this.select_layout={id:""},this.select_layout.data={filter_data:{},filter_sort:{}},this.select_layout.data.display_columns=this.default_display_columns;var a=this.select_layout.data,s=this.buildDisplayColumns(a.display_columns),l=s.length;a.display_columns.length<1&&(a.display_columns=this.default_display_columns);var r=0;Global.isSet(t)&&t>0&&(r=t);for(var n=r;n<l;n++){var o=s[n];if("description"===o.value)var d={name:o.value,index:o.value,label:o.label,width:400,sortable:!1,title:!1};else d="status"===o.value?{name:o.value,index:o.value,label:o.label,width:100,sortable:!1,title:!1,formatter:function(t,e,i){var a=$("<span></span>");return"Failed"===t?a.addClass("failed-label"):"Warning"===t?a.addClass("warning-label"):"Success"===t&&a.addClass("success-label"),a.text(t),a.get(0).outerHTML}}:{name:o.value,index:o.value,label:o.label,width:100,sortable:!1,title:!1};i.push(d)}this.grid&&(this.grid.grid.jqGrid("GridUnload"),this.grid=null),this.grid=new TTGrid("user_generic_data_status_grid-"+this.batch_id,{altRows:!0,onSelectRow:$.proxy(this.onGridSelectRow,this),data:[],rowNum:1e4,sortable:!1,datatype:"local",width:600,colNames:[],viewrecords:!0},i);var c=$(this.el).find(".content");this.grid.grid.setGridWidth(c.width()-2),this.grid.grid.setGridHeight(c.height()-25),$(window).resize((function(){e.grid.grid.setGridWidth(c.width()-2),e.grid.grid.setGridHeight(c.height()-25)})),this.filter_data=this.select_layout.data.filter_data}}a.open=function(t,e,i){Global.loadViewSource("UserGenericStatus","UserGenericStatusWindow.css"),Global.loadViewSource("UserGenericStatus","UserGenericStatusWindow.html",(function(s){if(1==TTUUID.isUUID(t)){var l={batch_id:t,failed:$.i18n._("Failed"),warning:$.i18n._("Warning"),success:$.i18n._("Success")},r=_.template(s);$("body").append(r(l)),new a({el:"#"+t,batch_id:t,user_id:e,can_cache_controller:!1,callback:i})}else TAlertManager.showAlert($.i18n._("Status report is empty. Please try again.",LocalCacheData.getApplicationName()),$.i18n._("NOTICE"))}))}}}]);
//# sourceMappingURL=wizard-user_generic_data_status-UserGenericStatusWindowController.bundle.js.map?v=c75f686e413081e4e043