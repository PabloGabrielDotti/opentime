(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["wizard-re_calculate_accrual-ReCalculateAccrualWizardController"],{1490:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"ReCalculateAccrualWizardController":()=>s});class s extends BaseWizardController{constructor(e={}){_.defaults(e,{el:".wizard-bg"}),super(e)}init(e){this.title=$.i18n._("Accrual ReCalculation Wizard"),this.steps=3,this.current_step=1,this.render()}render(){super.render(),this.initCurrentStep()}buildCurrentStepUI(){this.content_div.empty();var e=this;switch(this.stepsWidgetDic[this.current_step]={},this.current_step){case 1:var t=this.getLabel();t.text($.i18n._("Select one or more accrual policies")+":");var i=this.getAComboBox(TTAPI.APIAccrualPolicy,!0,"global_accrual","accrual_policy_id"),s=$("<div class='wizard-acombobox-div'></div>");s.append(i),this.stepsWidgetDic[this.current_step][i.getField()]=i,this.content_div.append(t),this.content_div.append(s);break;case 2:(t=this.getLabel()).text($.i18n._("Select the date range")+":"),this.content_div.append(t);var a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html")),r=a.find(".form-item-label"),d=a.find(".form-item-input-div"),n=this.getComboBox("time_period",!0);r.text($.i18n._("Time Period")+": "),d.append(n),this.content_div.append(a),r=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),d=a.find(".form-item-input-div");var o=this.getDatePicker("start_date");r.text($.i18n._("Start Date")+": "),d.append(o),this.content_div.append(a),r=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),d=a.find(".form-item-input-div");var l=this.getDatePicker("end_date");r.text($.i18n._("End Date")+": "),d.append(l),this.content_div.append(a),r=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),d=a.find(".form-item-input-div");var c=this.getAComboBox(TTAPI.APIPayPeriod,!0,"global_Pay_period","pay_period_id");r.text($.i18n._("Pay Period")+": "),d.append(c),this.content_div.append(a),r=(a=$(Global.loadWidget("global/widgets/wizard_form_item/WizardFormItem.html"))).find(".form-item-label"),d=a.find(".form-item-input-div");var p=this.getAComboBox(TTAPI.APIPayPeriodSchedule,!0,"global_pay_period_schedule","pay_period_schedule_id");r.text($.i18n._("Pay Period Schedule")+": "),d.append(p),this.content_div.append(a),n.bind("formItemChange",(function(t,i){e.onTimePeriodChange(i)})),this.stepsWidgetDic[this.current_step][n.getField()]=n,this.stepsWidgetDic[this.current_step][o.getField()]=o,this.stepsWidgetDic[this.current_step][l.getField()]=l,this.stepsWidgetDic[this.current_step][c.getField()]=c,this.stepsWidgetDic[this.current_step][p.getField()]=p,e.onTimePeriodChange(n);break;case 3:(t=this.getLabel()).text($.i18n._("Select one or more employees")+":"),i=this.getAComboBox(TTAPI.APIUser,!0,"global_user","user_id",!0),(s=$("<div class='wizard-acombobox-div'></div>")).append(i),this.stepsWidgetDic[this.current_step]={},this.stepsWidgetDic[this.current_step][i.getField()]=i,this.content_div.append(t),this.content_div.append(s)}}onTimePeriodChange(e){var t=e.getValue(),i=this.stepsWidgetDic[this.current_step].start_date.parent().parent(),s=this.stepsWidgetDic[this.current_step].end_date.parent().parent(),a=this.stepsWidgetDic[this.current_step].pay_period_id.parent().parent(),r=this.stepsWidgetDic[this.current_step].pay_period_schedule_id.parent().parent();"custom_date"===t?(i.css("display","block"),s.css("display","block"),a.css("display","none"),r.css("display","none")):"custom_pay_period"===t?(i.css("display","none"),s.css("display","none"),a.css("display","block"),r.css("display","none")):"this_pay_period"===t||"last_pay_period"===t||"to_last_pay_period"===t||"to_this_pay_period"===t?(i.css("display","none"),s.css("display","none"),a.css("display","none"),r.css("display","block")):(i.css("display","none"),s.css("display","none"),a.css("display","none"),r.css("display","none"))}onDoneClick(){var e=this;super.onDoneClick(),this.saveCurrentStep();var t=this.stepsDataDic[1].accrual_policy_id,i=this.stepsDataDic[3].user_id,s={};for(var a in s.time_period=this.stepsDataDic[2].time_period,this.stepsDataDic[2])this.stepsDataDic[2].hasOwnProperty([a])&&"time_period"!==a&&"effective_date"!==a&&(s[a]=this.stepsDataDic[2][a]);TTAPI.APIAccrualPolicy.recalculateAccrual(t,s,i,{onResult:function(t){e.onCloseClick(),e.call_back&&e.call_back()}})}buildCurrentStepData(){var e=this,t=this.stepsDataDic[this.current_step],i=this.stepsWidgetDic[this.current_step];switch(this.current_step){case 1:if(t)for(var s in t)t.hasOwnProperty(s)&&i[s].setValue(t[s]);break;case 2:TTAPI.APITimesheetSummaryReport.getOptions("time_period",{onResult:function(s){if(i.time_period.setSourceData(Global.buildRecordArray(s.getResult())),t)for(var a in t)t.hasOwnProperty(a)&&i[a].setValue(t[a]);else{new Date;i.time_period.setValue("last_month")}e.onTimePeriodChange(i.time_period)}});break;case 3:if(t)for(var s in t)t.hasOwnProperty(s)&&i[s].setValue(t[s]);else i.user_id.setValue(TTUUID.not_exist_id);break;default:for(var s in t)t.hasOwnProperty(s)&&i[s].setValue(t[s])}}saveCurrentStep(){this.stepsDataDic[this.current_step]={};var e=this.stepsDataDic[this.current_step],t=this.stepsWidgetDic[this.current_step];switch(this.current_step){case 1:e.accrual_policy_id=t.accrual_policy_id.getValue();break;case 2:for(var i in t)t.hasOwnProperty(i)&&t[i].is(":visible")&&(e[i]=t[i].getValue());break;case 3:e.user_id=t.user_id.getValue()}}setDefaultDataToSteps(){if(!this.default_data)return null;this.stepsDataDic[1]={},this.getDefaultData("accrual_policy_id")&&(this.stepsDataDic[1].accrual_policy_id=this.getDefaultData("accrual_policy_id"))}}}}]);
//# sourceMappingURL=wizard-re_calculate_accrual-ReCalculateAccrualWizardController.bundle.js.map?v=3eecb0954897e1996ecf