{"version":3,"sources":["webpack://timetrex/./interface/html5/views/invoice/district/InvoiceDistrictViewController.js"],"names":["InvoiceDistrictViewController","BaseViewController","options","_","defaults","el","status_array","country_array","province_array","e_province_array","company_api","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIInvoiceDistrict","APICompany","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","initDropDownOption","select_value","search_panel","getSelectTabIndex","basic_search_field_ui_dic","getValue","setProvince","change","proxy","selectVal","setValue","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","key","getField","edit_view_ui_dic","current_edit_record","validate","onCountryChange","buildEditViewUI","form_item_input","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_district_column1","edit_view_tab","find","edit_view_tabs","push","Global","loadWidgetByName","FormItemType","TEXT_INPUT","TTextInput","field","width","addEditFieldToColumn","parent","COMBO_BOX","TComboBox","set_empty","setSourceData","val","m","$this","getOptions","onResult","res","getResult","buildRecordArray","refresh","province_widget","length","province","value","buildSearchFields","search_fields","SearchField","label","in_column","multiple","basic_search","adv_search","form_item_type","AWESOME_BOX","APIUser"],"mappings":"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","file":"invoice-district-InvoiceDistrictViewController.bundle.js?v=b5388f54687af530b380","sourcesContent":["export class InvoiceDistrictViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#invoice_district_view_container',\n\n\t\t\tstatus_array: null,\n\t\t\tcountry_array: null,\n\t\t\tprovince_array: null,\n\n\t\t\te_province_array: null,\n\n\t\t\tcompany_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'InvoiceDistrictEditView.html';\n\t\tthis.permission_id = 'client';\n\t\tthis.viewId = 'InvoiceDistrict';\n\t\tthis.script_name = 'InvoiceDistrictView';\n\t\tthis.table_name_key = 'invoice_district';\n\t\tthis.context_menu_name = $.i18n._( 'District' );\n\t\tthis.navigation_label = $.i18n._( 'District' ) + ':';\n\t\tthis.api = TTAPI.APIInvoiceDistrict;\n\t\tthis.company_api = TTAPI.APICompany;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'country', 'country', this.company_api );\n\t}\n\n\tonSetSearchFilterFinished() {\n\t\tvar combo;\n\t\tvar select_value;\n\t\tif ( this.search_panel.getSelectTabIndex() === 0 ) {\n\t\t\tcombo = this.basic_search_field_ui_dic['country'];\n\t\t\tselect_value = combo.getValue();\n\t\t\tthis.setProvince( select_value );\n\t\t}\n\t}\n\n\tonBuildBasicUIFinished() {\n\t\tthis.basic_search_field_ui_dic['country'].change( $.proxy( function() {\n\t\t\tvar combo = this.basic_search_field_ui_dic['country'];\n\t\t\tvar selectVal = combo.getValue();\n\n\t\t\tthis.setProvince( selectVal );\n\n\t\t\tthis.basic_search_field_ui_dic['province'].setValue( null );\n\n\t\t}, this ) );\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\n\t\tswitch ( key ) {\n\t\t\tcase 'country':\n\t\t\t\tvar widget = this.edit_view_ui_dic['province'];\n\t\t\t\twidget.setValue( null );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.current_edit_record[key] = target.getValue();\n\n\t\tif ( key === 'country' ) {\n\t\t\tthis.onCountryChange();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_district': { 'label': $.i18n._( 'District' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tvar form_item_input;\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIInvoiceDistrict,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_invoice_district',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_district = this.edit_view_tab.find( '#tab_district' );\n\n\t\tvar tab_district_column1 = tab_district.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_district_column1 );\n\n\t\t// Name\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_district_column1, '' );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Country\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'country', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Country' ), form_item_input, tab_district_column1 );\n\n\t\t//Province / State\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'province' } );\n\t\tform_item_input.setSourceData( [] );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Province / State' ), form_item_input, tab_district_column1, '' );\n\t}\n\n\tsetProvince( val, m ) {\n\t\tvar $this = this;\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.province_array = [];\n\t\t\tthis.basic_search_field_ui_dic['province'].setSourceData( [] );\n\n\t\t} else {\n\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.province_array = Global.buildRecordArray( res );\n\t\t\t\t\t$this.basic_search_field_ui_dic['province'].setSourceData( $this.province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.e_province_array = Global.buildRecordArray( res );\n\t\t\t\t\tif ( refresh && $this.e_province_array.length > 0 ) {\n\t\t\t\t\t\t$this.current_edit_record.province = $this.e_province_array[0].value;\n\t\t\t\t\t\tprovince_widget.setValue( $this.current_edit_record.province );\n\t\t\t\t\t}\n\t\t\t\t\tprovince_widget.setSourceData( $this.e_province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Country' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'country',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.COMBO_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Province/State' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'province',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tscript_name: 'EmployeeView',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tscript_name: 'EmployeeView',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\n\t\t];\n\t}\n\n}"],"sourceRoot":""}