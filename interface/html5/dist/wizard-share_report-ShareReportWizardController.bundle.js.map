{"version":3,"sources":["webpack://timetrex/./interface/html5/views/wizard/share_report/ShareReportWizardController.js"],"names":["ShareReportWizardController","BaseWizardController","options","_","defaults","el","super","this","title","$","i18n","steps","current_step","render","initCurrentStep","content_div","empty","stepsWidgetDic","label","getLabel","text","a_combobox","getAComboBox","TTAPI","APIUserReportData","div","append","getField","APIUser","current_step_data","stepsDataDic","current_step_ui","key","hasOwnProperty","setValue","default_data","$this","onDoneClick","saveCurrentStep","report_ids","user_report_data_ids","user_ids","destination_user_ids","shareUserReportData","onResult","result","isValid","TAlertManager","showAlert","remove","showErrorAlert","getValue"],"mappings":"qMAAO,MAAMA,UAAoCC,qBAChD,YAAaC,EAAU,IACtBC,EAAEC,SAAUF,EAAS,CACpBG,GAAI,eAGLC,MAAOJ,GAGR,KAAMA,GAGLK,KAAKC,MAAQC,EAAEC,KAAKP,EAAG,uBACvBI,KAAKI,MAAQ,EACbJ,KAAKK,aAAe,EAEpBL,KAAKM,SAGN,SACCP,MAAMO,SAENN,KAAKO,kBAIN,qBAKC,OAHAP,KAAKQ,YAAYC,QAEjBT,KAAKU,eAAeV,KAAKK,cAAgB,GAChCL,KAAKK,cACb,KAAK,EACJ,IAAIM,EAAQX,KAAKY,WACjBD,EAAME,KAAMX,EAAEC,KAAKP,EAAG,qDAAwD,KAE9E,IAAIkB,EAAad,KAAKe,aAAcC,MAAMC,mBAAmB,EAAM,aAAc,wBAAwB,GACrGC,EAAMhB,EAAG,4CACbgB,EAAIC,OAAQL,GAEZd,KAAKQ,YAAYW,OAAQR,GACzBX,KAAKQ,YAAYW,OAAQD,GAEzBlB,KAAKU,eAAeV,KAAKK,cAAcS,EAAWM,YAAcN,EAEhE,MACD,KAAK,GACJH,EAAQX,KAAKY,YACPC,KAAMX,EAAEC,KAAKP,EAAG,qDAAwD,KAE9EkB,EAAad,KAAKe,aAAcC,MAAMK,SAAS,EAAM,cAAe,wBAAwB,IAC5FH,EAAMhB,EAAG,6CACLiB,OAAQL,GAEZd,KAAKU,eAAeV,KAAKK,cAAgB,GACzCL,KAAKU,eAAeV,KAAKK,cAAcS,EAAWM,YAAcN,EAEhEd,KAAKQ,YAAYW,OAAQR,GACzBX,KAAKQ,YAAYW,OAAQD,IAM5B,uBACC,IACII,EAAoBtB,KAAKuB,aAAavB,KAAKK,cAC3CmB,EAAkBxB,KAAKU,eAAeV,KAAKK,cAE/C,OAASL,KAAKK,cACb,KAAK,EACJ,GAAMiB,EAaL,IAAM,IAAIG,KAAOH,EACVA,EAAkBI,eAAgBD,IAIxCD,EAAgBC,GAAKE,SAAUL,EAAkBG,SAjBlD,IAAM,IAAIA,KAAOD,EAEVA,EAAgBE,eAAgBD,IAIjCzB,KAAK4B,cACTJ,EAAgBC,GAAKE,SAAU3B,KAAK4B,cAcvC,MACD,QACC,IAAM,IAAIH,KAAOH,EACVA,EAAkBI,eAAgBD,IAIxCD,EAAgBC,GAAKE,SAAUL,EAAkBG,KAMrD,cACC,IAAII,EAAQ7B,KACZD,MAAM+B,cACN9B,KAAK+B,kBAEL,IAAIC,EAAahC,KAAKuB,aAAa,GAAGU,qBAClCC,EAAWlC,KAAKuB,aAAa,GAAGY,qBAE1BnB,MAAMC,kBAEZmB,oBAAqBJ,EAAYE,EAAU,CAC9CG,SAAU,SAAUC,GAEdA,EAAOC,WACXC,cAAcC,UAAWvC,EAAEC,KAAKP,EAAG,+BACnCM,EAAG2B,EAAM/B,IAAK4C,UAEdF,cAAcG,eAAgBL,MAOlC,kBACCtC,KAAKuB,aAAavB,KAAKK,cAAgB,GACvC,IAAIiB,EAAoBtB,KAAKuB,aAAavB,KAAKK,cAC3CmB,EAAkBxB,KAAKU,eAAeV,KAAKK,cAI7C,IAAM,IAAIoB,KAHHzB,KAAKK,aAGKmB,EACVA,EAAgBE,eAAgBD,KAItCH,EAAkBG,GAAOD,EAAgBC,GAAKmB,YAMlD,wBAEC,IAAM5C,KAAK4B,aACV,OAAO","file":"wizard-share_report-ShareReportWizardController.bundle.js?v=1552a6026bb054cd0d43","sourcesContent":["export class ShareReportWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\n\t\tthis.title = $.i18n._( 'Share Report Wizard' );\n\t\tthis.steps = 2;\n\t\tthis.current_step = 1;\n\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\t//Create each page UI\n\tbuildCurrentStepUI() {\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more saved report you wish to share' ) + ':' );\n\n\t\t\t\tvar a_combobox = this.getAComboBox( TTAPI.APIUserReportData, true, 'global_job', 'user_report_data_ids', false );\n\t\t\t\tvar div = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more employees to share report with' ) + ':' );\n\n\t\t\t\ta_combobox = this.getAComboBox( TTAPI.APIUser, true, 'global_user', 'destination_user_ids', false );\n\t\t\t\tdiv = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\t\t\t\tbreak;\n\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t\tvar $this = this;\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tif ( !current_step_data ) {\n\t\t\t\t\tfor ( var key in current_step_ui ) {\n\n\t\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( this.default_data ) {\n\t\t\t\t\t\t\tcurrent_step_ui[key].setValue( this.default_data );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar report_ids = this.stepsDataDic[1].user_report_data_ids;\n\t\tvar user_ids = this.stepsDataDic[2].destination_user_ids;\n\n\t\tvar api = TTAPI.APIUserReportData;\n\n\t\tapi.shareUserReportData( report_ids, user_ids, {\n\t\t\tonResult: function( result ) {\n\n\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Report shared successfully' ) );\n\t\t\t\t\t$( $this.el ).remove();\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tdefault:\n\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n}"],"sourceRoot":""}