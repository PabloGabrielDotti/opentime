(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["payperiod-PayPeriodScheduleViewController"],{6415:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"PayPeriodScheduleViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#pay_period_schedule_view_container",user_preference_api:null,type_array:null,pay_period_starts_on_array:null,start_week_day_array:null,transaction_date_array:null,transaction_date_business_day_array:null,time_zone_array:null,shift_assigned_day_array:null,timesheet_verify_type_array:null,sub_pay_periods_view_controller:null}),super(e)}init(e){this.edit_view_tpl="PayPeriodScheduleEditView.html",this.permission_id="pay_period_schedule",this.viewId="PayPeriodSchedule",this.script_name="PayPeriodScheduleView",this.table_name_key="pay_period_schedule",this.context_menu_name=$.i18n._("Pay Period Schedule"),this.navigation_label=$.i18n._("Pay Period Schedule")+":",this.api=TTAPI.APIPayPeriodSchedule,this.user_preference_api=TTAPI.APIUserPreference,this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary("PayPeriodSchedule")}getCustomContextMenuModel(){return{exclude:[ContextMenuIconName.copy,ContextMenuIconName.mass_edit],include:[]}}openEditView(e){Global.setUINotready(),TTPromise.add("init","init"),TTPromise.wait();var t=this;t.edit_only_mode?t.initOptions((function(i){t.edit_view||t.initEditViewUI(t.viewId,t.edit_view_tpl),t.getPayPeriodScheduleData(e,(function(e){t.current_edit_record=e,t.initEditView()}))})):this.edit_view||this.initEditViewUI(t.viewId,t.edit_view_tpl)}getPayPeriodScheduleData(e,t){var i={filter_data:{}};i.filter_data.id=[e],this.api["get"+this.api.key_name](i,{onResult:function(e){var i=e.getResult();i||(i=[]),i=i[0],t(i)}})}initOptions(e){var t=this,i=[{option_name:"type"},{option_name:"transaction_date"},{option_name:"transaction_date_business_day"},{option_name:"shift_assigned_day"},{option_name:"time_zone",field_name:"",api:this.user_preference_api},{option_name:"timesheet_verify_type"},{option_name:"start_week_day"}];this.initDropDownOptions(i,(function(i){t.transaction_date_array=Global.addLastItemToArray(t.transaction_date_array,-1,$.i18n._("- Last Day Of Month -")),t.user_preference_api.getOptions("start_week_day",{onResult:function(i){var a=i.getResult();t.pay_period_starts_on_array=Global.buildRecordArray(a),e&&e(a)}})}))}initSubPayPeriodsView(){var e=this;if(this.current_edit_record.id){if(this.sub_pay_periods_view_controller)return this.sub_pay_periods_view_controller.buildContextMenu(!0),this.sub_pay_periods_view_controller.setDefaultMenu(),e.sub_pay_periods_view_controller.parent_value=e.current_edit_record.id,e.sub_pay_periods_view_controller.parent_edit_record=e.current_edit_record,void e.sub_pay_periods_view_controller.initData();Global.loadScript("views/payroll/pay_periods/PayPeriodsViewController.js",(function(){var a=e.edit_view_tab.find("#tab_pay_period").find(".first-column-sub-view");Global.trackView("SubPayPeriodsView"),PayPeriodsViewController.loadSubView(a,t,i)}))}else TTPromise.resolve("BaseViewController","onTabShow");function t(){}function i(t){e.sub_pay_periods_view_controller=t,e.sub_pay_periods_view_controller.parent_key="pay_period_schedule_id",e.sub_pay_periods_view_controller.parent_value=e.current_edit_record.id,e.sub_pay_periods_view_controller.parent_edit_record=e.current_edit_record,e.sub_pay_periods_view_controller.parent_view_controller=e,e.sub_pay_periods_view_controller.initData()}}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),a=e.getValue();this.current_edit_record[i]=a,"type_id"==i?this.onTypeChange():"start_day_of_week"!=i||this.current_edit_record&&this.current_edit_record.id?"timesheet_verify_type_id"==i&&this.onVerifyTypeChange():(this.edit_view_ui_dic.start_week_day_id.setValue(this.edit_view_ui_dic.start_day_of_week.getValue()),this.current_edit_record.start_week_day_id=this.edit_view_ui_dic.start_day_of_week.getValue()),t||this.validate()}removeEditView(){super.removeEditView(),this.sub_pay_periods_view_controller=null}onVerifyTypeChange(){10==this.current_edit_record.timesheet_verify_type_id?(this.detachElement("timesheet_verify_before_end_date"),this.detachElement("timesheet_verify_before_transaction_date")):(this.attachElement("timesheet_verify_before_end_date"),this.attachElement("timesheet_verify_before_transaction_date")),this.editFieldResize()}onTypeChange(){5==this.current_edit_record.type_id||this.current_edit_record.id?this.detachElement("anchor_date"):this.attachElement("anchor_date"),5==this.current_edit_record.type_id?(this.detachElement("primary"),this.detachElement("primary_day_of_month"),this.detachElement("primary_transaction_day_of_month"),this.detachElement("secondary"),this.detachElement("secondary_day_of_month"),this.detachElement("secondary_transaction_day_of_month"),this.attachElement("annual_pay_periods"),this.detachElement("start_day_of_week"),this.detachElement("transaction_date"),this.detachElement("transaction_date_bd")):10==this.current_edit_record.type_id||20==this.current_edit_record.type_id||100==this.current_edit_record.type_id?(this.detachElement("primary"),this.detachElement("primary_day_of_month"),this.detachElement("primary_transaction_day_of_month"),this.detachElement("secondary"),this.detachElement("secondary_day_of_month"),this.detachElement("secondary_transaction_day_of_month"),this.detachElement("annual_pay_periods"),this.attachElement("start_day_of_week"),this.attachElement("transaction_date"),this.attachElement("transaction_date_bd")):30==this.current_edit_record.type_id?(this.attachElement("primary"),this.attachElement("primary_day_of_month"),this.attachElement("primary_transaction_day_of_month"),this.attachElement("secondary"),this.attachElement("secondary_day_of_month"),this.attachElement("secondary_transaction_day_of_month"),this.detachElement("annual_pay_periods"),this.detachElement("start_day_of_week"),this.detachElement("transaction_date"),this.attachElement("transaction_date_bd")):50==this.current_edit_record.type_id&&(this.attachElement("primary"),this.attachElement("primary_day_of_month"),this.attachElement("primary_transaction_day_of_month"),this.detachElement("secondary"),this.detachElement("secondary_day_of_month"),this.detachElement("secondary_transaction_day_of_month"),this.detachElement("annual_pay_periods"),this.detachElement("start_day_of_week"),this.detachElement("transaction_date"),this.attachElement("transaction_date_bd")),this.editFieldResize()}setCurrentEditRecordData(){for(var e in this.current_edit_record){var t=this.edit_view_ui_dic[e];Global.isSet(t)&&t.setValue(this.current_edit_record[e])}this.onTypeChange(),this.onVerifyTypeChange(),this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}buildEditViewUI(){super.buildEditViewUI();var e=this,t={"tab_pay_period_schedule":{"label":$.i18n._("Pay Period Schedule")},"tab_advanced":{"label":$.i18n._("Advanced")},"tab_pay_period":{"label":$.i18n._("Pay Periods"),"init_callback":"initSubPayPeriodsView","display_on_mass_edit":!1},"tab_audit":!0};this.setTabModel(t),this.edit_only_mode||(this.navigation.AComboBox({id:this.script_name+"_navigation",api_class:TTAPI.APIPayPeriodSchedule,allow_multiple_selection:!1,layout_name:"global_pay_period_schedule",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation());var i,a,d,o=this.edit_view_tab.find("#tab_pay_period_schedule").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(o),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),i,o,""),i.parent().width("45%"),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn($.i18n._("Description"),i,o),i.parent().width("45%"),(i=Global.loadWidgetByName(FormItemType.SEPARATED_BOX)).SeparatedBox({label:$.i18n._("Pay Period Dates")}),this.addEditFieldToColumn(null,i,o),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type_id"}),i.setSourceData(e.type_array),this.addEditFieldToColumn($.i18n._("Type"),i,o),(i=Global.loadWidgetByName(FormItemType.SEPARATED_BOX)).SeparatedBox({label:$.i18n._("Primary")}),this.addEditFieldToColumn(null,i,o,"",null,!0,!1,"primary"),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"primary_day_of_month"}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'> "+$.i18n._("at 00:00")+"</span>"),a.append(i),a.append(d),i.setSourceData(e.transaction_date_array),this.addEditFieldToColumn($.i18n._("Pay Period Start Day of Month"),i,o,"",a,!0),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"primary_transaction_day_of_month"}),i.setSourceData(e.transaction_date_array),this.addEditFieldToColumn($.i18n._("Transaction Day Of Month"),i,o,"",null,!0),(i=Global.loadWidgetByName(FormItemType.SEPARATED_BOX)).SeparatedBox({label:$.i18n._("Secondary")}),this.addEditFieldToColumn(null,i,o,"",null,!0,!1,"secondary"),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"secondary_day_of_month"}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'> "+$.i18n._("at 00:00")+"</span>"),a.append(i),a.append(d),i.setSourceData(e.transaction_date_array),this.addEditFieldToColumn($.i18n._("Pay Period Start Day of Month"),i,o,"",a,!0),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"secondary_transaction_day_of_month"}),i.setSourceData(e.transaction_date_array),this.addEditFieldToColumn($.i18n._("Transaction Day Of Month"),i,o,"",null,!0),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"annual_pay_periods"}),this.addEditFieldToColumn($.i18n._("Annual Pay Periods"),i,o,"",null,!0),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"start_day_of_week"}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'> "+$.i18n._("at 00:00")+"</span>"),a.append(i),a.append(d),i.setSourceData(e.pay_period_starts_on_array),this.addEditFieldToColumn($.i18n._("Pay Period Starts On"),i,o,"",a,!0),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"transaction_date"}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'> ("+$.i18n._("days after end of pay period")+")</span>"),a.append(i),a.append(d),i.setSourceData(e.transaction_date_array),this.addEditFieldToColumn($.i18n._("Transaction Date"),i,o,"",a,!0),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"transaction_date_bd"}),i.setSourceData(e.transaction_date_business_day_array),this.addEditFieldToColumn($.i18n._("Transaction Always on Business Day"),i,o,"",null,!0),(i=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"anchor_date"}),this.addEditFieldToColumn($.i18n._("Create Initial Pay Periods From"),i,o,"",null,!0),(i=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!0,layout_name:"global_user",show_search_inputs:!0,set_empty:!0,field:"user"}),this.addEditFieldToColumn($.i18n._("Employees"),i,o);var _=this.edit_view_tab.find("#tab_advanced").find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(_),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"start_week_day_id"}),i.setSourceData(e.start_week_day_array),this.addEditFieldToColumn($.i18n._("Overtime Week"),i,_,""),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"time_zone",set_empty:!0}),i.setSourceData(e.time_zone_array),this.addEditFieldToColumn($.i18n._("Time Zone"),i,_),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"new_day_trigger_time",mode:"time_unit",need_parser_sec:!0}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'>("+$.i18n._("Only for shifts that span midnight")+")</span>"),a.append(i),a.append(d),this.addEditFieldToColumn($.i18n._("Minimum Time-Off Between Shifts"),i,_,"",a),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"maximum_shift_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn($.i18n._("Maximum Shift Time"),i,_,"",null),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"shift_assigned_day_id"}),i.setSourceData(e.shift_assigned_day_array),this.addEditFieldToColumn($.i18n._("Assign Shifts To"),i,_),(i=Global.loadWidgetByName(FormItemType.SEPARATED_BOX)).SeparatedBox({label:$.i18n._("TimeSheet Verification")}),this.addEditFieldToColumn(null,i,_),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"timesheet_verify_type_id"}),i.setSourceData(e.timesheet_verify_type_array),this.addEditFieldToColumn($.i18n._("TimeSheet Verification"),i,_),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"timesheet_verify_before_end_date",width:30}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'>"+$.i18n._("Day(s)")+" ("+$.i18n._("Before Pay Period End Date")+" )</span>"),a.append(i),a.append(d),this.addEditFieldToColumn($.i18n._("Verification Window Starts"),i,_,"",a,!0),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"timesheet_verify_before_transaction_date",width:30}),a=$("<div class='widget-h-box'></div>"),d=$("<span class='widget-right-label'>"+$.i18n._("Day(s)")+" ("+$.i18n._("Before Pay Period Transaction Date")+" )</span>"),a.append(i),a.append(d),this.addEditFieldToColumn($.i18n._("Verification Window Ends"),i,_,"",a,!0)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Name"),in_column:1,field:"name",basic_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Description"),in_column:1,field:"description",basic_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}}}}]);
//# sourceMappingURL=payperiod-PayPeriodScheduleViewController.bundle.js.map?v=a809bb295b0329b73909