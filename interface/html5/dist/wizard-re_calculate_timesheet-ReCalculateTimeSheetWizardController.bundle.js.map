{"version":3,"sources":["webpack://timetrex/./interface/html5/views/wizard/re_calculate_timesheet/ReCalculateTimeSheetWizardController.js"],"names":["ReCalculateTimeSheetWizardController","BaseWizardController","options","_","defaults","el","super","this","title","$","i18n","steps","current_step","render","initCurrentStep","content_div","empty","label","getLabel","text","append","a_combobox","getAComboBox","TTAPI","APIPayPeriod","div","stepsWidgetDic","getField","APIUser","$this","onDoneClick","saveCurrentStep","stepsDataDic","pay_period_ids","pay_period_id","user_ids","user_id","timesheet_api","APITimeSheet","onCloseClick","reCalculateTimeSheet","onResult","result","call_back","current_step_data","current_step_ui","setValue","getValue","default_data","getDefaultData"],"mappings":"iOAAO,MAAMA,UAA6CC,qBACzD,YAAaC,EAAU,IACtBC,EAAEC,SAAUF,EAAS,CACpBG,GAAI,eAGLC,MAAOJ,GAGR,KAAMA,GAGLK,KAAKC,MAAQC,EAAEC,KAAKP,EAAG,kCACvBI,KAAKI,MAAQ,EACbJ,KAAKK,aAAe,EAEpBL,KAAKM,SAGN,SACCP,MAAMO,SAENN,KAAKO,kBAIN,qBAGC,OADAP,KAAKQ,YAAYC,QACRT,KAAKK,cACb,KAAK,EACJ,IAAIK,EAAQV,KAAKW,WACjBD,EAAME,KAAMV,EAAEC,KAAKP,EAAG,qHAEtBI,KAAKQ,YAAYK,OAAQH,GACzB,MACD,KAAK,GACJA,EAAQV,KAAKW,YACPC,KAAMV,EAAEC,KAAKP,EAAG,mCAEtB,IAAIkB,EAAad,KAAKe,aAAcC,MAAMC,cAAc,EAAM,oBAAqB,iBAC/EC,EAAMhB,EAAG,4CACbgB,EAAIL,OAAQC,GAEZd,KAAKmB,eAAenB,KAAKK,cAAgB,GACzCL,KAAKmB,eAAenB,KAAKK,cAAcS,EAAWM,YAAcN,EAEhEd,KAAKQ,YAAYK,OAAQH,GACzBV,KAAKQ,YAAYK,OAAQK,GAEzB,MACD,KAAK,GACJR,EAAQV,KAAKW,YACPC,KAAMV,EAAEC,KAAKP,EAAG,gCAAmC,KAEzDkB,EAAad,KAAKe,aAAcC,MAAMK,SAAS,EAAM,cAAe,WAAW,IAC/EH,EAAMhB,EAAG,6CACLW,OAAQC,GAEZd,KAAKmB,eAAenB,KAAKK,cAAgB,GACzCL,KAAKmB,eAAenB,KAAKK,cAAcS,EAAWM,YAAcN,EAEhEd,KAAKQ,YAAYK,OAAQH,GACzBV,KAAKQ,YAAYK,OAAQK,IAK5B,wBAGA,cACC,IAAII,EAAQtB,KAGZ,GAFAD,MAAMwB,cACNvB,KAAKwB,kBACAxB,KAAKyB,cAAgBzB,KAAKyB,aAAa,IAAMzB,KAAKyB,aAAa,GAAK,CACxE,IAAIC,EAAiB1B,KAAKyB,aAAa,GAAGE,cACtCC,EAAW5B,KAAKyB,aAAa,GAAGI,QAEhCC,EAAgBd,MAAMe,aAG1B/B,KAAKgC,eACLF,EAAcG,qBAAsBP,EAAgBE,EAAU,CAC7DM,SAAU,SAAUC,GAEdb,EAAMc,WACVd,EAAMc,gBAQX,uBAEC,GAAMpC,KAAKyB,aAAazB,KAAKK,cAA7B,CAGC,IAAIgC,EAAoBrC,KAAKyB,aAAazB,KAAKK,cAC3CiC,EAAkBtC,KAAKmB,eAAenB,KAAKK,cAGhD,OAASL,KAAKK,cACb,KAAK,EACJ,MACD,KAAK,EACCgC,EAAkBV,eACtBW,EAAgBX,cAAcY,SAAUF,EAAkBV,eAE3D,MACD,KAAK,EAECU,EAAkBR,SACtBS,EAAgBT,QAAQU,SAAUF,EAAkBR,WAOxD,kBACC7B,KAAKyB,aAAazB,KAAKK,cAAgB,GACvC,IAAIgC,EAAoBrC,KAAKyB,aAAazB,KAAKK,cAC3CiC,EAAkBtC,KAAKmB,eAAenB,KAAKK,cAC/C,OAASL,KAAKK,cACb,KAAK,EACJ,MACD,KAAK,EACJgC,EAAkBV,cAAgBW,EAAgBX,cAAca,WAChE,MACD,KAAK,EACJH,EAAkBR,QAAUS,EAAgBT,QAAQW,YAKvD,wBAEC,IAAMxC,KAAKyC,aACV,OAAO,KAGRzC,KAAKyB,aAAa,GAAK,GACvBzB,KAAKyB,aAAa,GAAK,GAElBzB,KAAK0C,eAAgB,aACzB1C,KAAKyB,aAAa,GAAGI,QAAU7B,KAAK0C,eAAgB,YAGhD1C,KAAK0C,eAAgB,mBACzB1C,KAAKyB,aAAa,GAAGE,cAAgB3B,KAAK0C,eAAgB","file":"wizard-re_calculate_timesheet-ReCalculateTimeSheetWizardController.bundle.js?v=e42e57e9b09f7611065b","sourcesContent":["export class ReCalculateTimeSheetWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\n\t\tthis.title = $.i18n._( 'TimeSheet ReCalculation Wizard' );\n\t\tthis.steps = 3;\n\t\tthis.current_step = 1;\n\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\t//Create each page UI\n\tbuildCurrentStepUI() {\n\n\t\tthis.content_div.empty();\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Recalculating timesheets is only required when policies have been modified and need to be applied retroactively.' ) );\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more pay periods' ) );\n\n\t\t\t\tvar a_combobox = this.getAComboBox( TTAPI.APIPayPeriod, true, 'global_Pay_period', 'pay_period_id' );\n\t\t\t\tvar div = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more employees' ) + ':' );\n\n\t\t\t\ta_combobox = this.getAComboBox( TTAPI.APIUser, true, 'global_user', 'user_id', true );\n\t\t\t\tdiv = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\t\tif ( this.stepsDataDic && this.stepsDataDic[2] && this.stepsDataDic[3] ) {\n\t\t\tvar pay_period_ids = this.stepsDataDic[2].pay_period_id;\n\t\t\tvar user_ids = this.stepsDataDic[3].user_id;\n\n\t\t\tvar timesheet_api = TTAPI.APITimeSheet;\n\n\t\t\t//this is outside the callback to prevent hammer-clicking which was causing problems.\n\t\t\tthis.onCloseClick();\n\t\t\ttimesheet_api.reCalculateTimeSheet( pay_period_ids, user_ids, {\n\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t\t$this.call_back();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetCurrentStepValues() {\n\n\t\tif ( !this.stepsDataDic[this.current_step] ) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\t}\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif ( current_step_data.pay_period_id ) {\n\t\t\t\t\tcurrent_step_ui.pay_period_id.setValue( current_step_data.pay_period_id );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\n\t\t\t\tif ( current_step_data.user_id ) {\n\t\t\t\t\tcurrent_step_ui.user_id.setValue( current_step_data.user_id );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcurrent_step_data.pay_period_id = current_step_ui.pay_period_id.getValue();\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcurrent_step_data.user_id = current_step_ui.user_id.getValue();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.stepsDataDic[2] = {};\n\t\tthis.stepsDataDic[3] = {};\n\n\t\tif ( this.getDefaultData( 'user_id' ) ) {\n\t\t\tthis.stepsDataDic[3].user_id = this.getDefaultData( 'user_id' );\n\t\t}\n\n\t\tif ( this.getDefaultData( 'pay_period_id' ) ) {\n\t\t\tthis.stepsDataDic[2].pay_period_id = this.getDefaultData( 'pay_period_id' );\n\t\t}\n\t}\n\n}"],"sourceRoot":""}