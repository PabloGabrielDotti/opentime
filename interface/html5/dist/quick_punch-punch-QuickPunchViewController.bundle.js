(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["quick_punch-punch-QuickPunchViewController","quick_punch-QuickPunchBaseViewController","quick_punch-header-HeaderViewController"],{7194:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{"g":()=>IndexViewController});var _views_quick_punch_header_HeaderViewController__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5196);class ApplicationRouter extends Backbone.Router{constructor(e={}){_.defaults(e,{controller:null,headerView:null,routes:{"":"onViewChange","!:viewName":"onViewChange","*notFound":"notFound"}}),super(e)}loadView(e){Global.loadViewSource(e,e+"View.html",(function(t){var i=_.template(t);Global.contentContainer().html(i),LocalCacheData.current_open_view_id=e,Global.trackView(e)}))}reloadView(view_id){"function"===eval("typeof "+view_id+"ViewController")&&this.loadView(view_id)}notFound(e){var t=Global.getBaseURL().split("#")[0];Global.setURLToBrowser(t+"#!m=QuickPunchLogin")}onViewChange(viewName){var $this=this,args={},view_id;if(Global.needReloadBrowser)return Global.needReloadBrowser=!1,void window.location.reload();viewName&&(args=Global.buildArgDic(viewName.split("&"))),viewName&&viewName.indexOf("m=")>=0&&viewName.indexOf("QuickPunch")>=0?view_id=Global.sanitizeViewId(args.m):(view_id="QuickPunchLogin",Global.setURLToBrowser(Global.getBaseURL().split("#")[0]+"#!m=QuickPunchLogin")),LocalCacheData.fullUrlParameterStr=viewName,LocalCacheData.setAllURLArgs(args);var reg=new RegExp("^[0-9]*$"),timeout_count;if(timeout_count=0,LocalCacheData.loadViewRequiredJSReady)showRibbonMenuAndLoadView();else var auto_login_timer=setInterval((function(){100==timeout_count&&clearInterval(auto_login_timer),timeout_count+=1,LocalCacheData.loadViewRequiredJSReady&&(showRibbonMenuAndLoadView(),clearInterval(auto_login_timer))}),600);function showRibbonMenuAndLoadView(){$("body").removeClass("login-bg"),$this.headerView||($this.headerView=new _views_quick_punch_header_HeaderViewController__WEBPACK_IMPORTED_MODULE_0__.HeaderViewController,$("#topContainer").html($this.headerView.el)),loadViewController()}function loadViewController(){Global.loadViewSource(view_id,view_id+"ViewController.js",(function(){var view_controller=eval("new "+view_id+"ViewController(); ");Global.trackView(view_id),Global.topContainer().css("display","block"),Global.bottomContainer().css("display","block")}))}}cleanAnySubViewUI(){var e=Global.contentContainer().children();if(e.length>1)for(var t=1;t<e.length;t++)try{if($(e[t]).attr("id")===LocalCacheData.current_open_primary_controller.ui_id)continue;e[t].remove()}catch(i){}}setContentDivHeight(){Global.contentContainer().removeClass("content-container"),Global.contentContainer().addClass("content-container-after-login"),Global.topContainer().addClass("top-container-after-login")}addTopMenu(){Global.loadScript("global/widgets/top_menu/TopMenuController.js"),TopMenuController&&TopMenuController.loadView()}removeCurrentView(e){function t(e){e.clearErrorTips(),e.edit_view&&e.edit_view.remove(),e.sub_log_view_controller=null,e.edit_view_ui_dic={},e.edit_view_ui_validation_field_dic={},e.edit_view_form_item_dic={},e.edit_view_error_ui_dic={},LocalCacheData.current_doing_context_action=""}LocalCacheData.current_open_edit_only_controller&&(t(LocalCacheData.current_open_edit_only_controller),LocalCacheData.current_open_edit_only_controller=null),LocalCacheData.current_open_primary_controller?(LocalCacheData.current_open_primary_controller.edit_view&&t(LocalCacheData.current_open_primary_controller),Global.contentContainer().empty(),LocalCacheData.current_open_primary_controller.cleanWhenUnloadView(e)):Global.isSet(e)&&e()}}class IndexViewController extends Backbone.View{constructor(e={}){_.defaults(e,{el:"body",router:null}),super(e)}initialize(e){IndexViewController.instance=this,this.router=new ApplicationRouter,this.router.controller=this,Backbone.History.started||Backbone.history.start()}}IndexViewController.instance=null},9942:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"QuickPunchBaseViewController":()=>r});var a=i(6739);class r extends a.TTBackboneView{constructor(e={}){_.defaults(e,{}),super(e)}}},5196:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"HeaderViewController":()=>o});var a=i(6739),r=i(12);class o extends a.TTBackboneView{constructor(e={}){_.defaults(e,{}),super(e)}initialize(e){super.initialize(e);var t=Global.loadWidget("views/quick_punch/header/HeaderView.html");t&&(this.tpl=_.template(t)),this.render()}render(){var e=r.n.getURLByObjectType("primary_company_logo");this.tpl&&this.setElement(this.tpl({company_logo:e}))}}},3e3:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"QuickPunchViewController":()=>d,"QuickPunchModalController":()=>l});var a=i(9942),r=i(7194),o=i(7526),n=i(9239),s=i(4936);class d extends a.QuickPunchBaseViewController{constructor(e={}){_.defaults(e,{type_array:null,status_array:null,branch_array:null,department_array:null,job_array:null,job_item_array:null,job_api:null,job_item_api:null,old_type_status:{},show_job_ui:!1,show_job_item_ui:!1,show_branch_ui:!1,show_department_ui:!1,show_good_quantity_ui:!1,show_bad_quantity_ui:!1,show_transfer_ui:!1,show_node_ui:!1,el:"#quick_punch_container",events:{'change input[type="text"]':"onFormItemChange",'change input[type="checkbox"]':"onFormItemChange","change select.form-control":"onFormItemChange","change textarea.form-control":"onFormItemChange"}}),super(e)}initialize(e){if(super.initialize(e),!LocalCacheData.getPunchLoginUser())return r.g.instance.router.navigate("QuickPunchLogin",!0),!1;this.current_edit_record=null,this.edit_view_error_ui_dic={},this.permission_id="punch",this.other_fields=[],this.api=o.y.APIPunch,this.branch_api=o.y.APIBranch,this.department_api=o.y.APIDepartment,this.other_field_api=o.y.APIOtherField,Global.getProductEdition()>=20&&(this.job_api=o.y.APIJob,this.job_item_api=o.y.APIJobItem),this.company_api=o.y.APICompany,this.api_station=o.y.APIStation,this.current_user_api=o.y.APIAuthentication,this.initPermission(),ProgressBar.showOverlay(),TTPromise.add("QuickPunch","CurrentEditRecordComplete"),this.initOptions(),this.getUserPunch();var t=this;this.getOtherFields((function(){TTPromise.wait("QuickPunch","CurrentEditRecordComplete",(function(){t.render()}))}))}initPermission(){if(this.jobUIValidate()?this.show_job_ui=!0:this.show_job_ui=!1,this.jobItemUIValidate()?this.show_job_item_ui=!0:this.show_job_item_ui=!1,this.branchUIValidate()?this.show_branch_ui=!0:this.show_branch_ui=!1,this.departmentUIValidate()?this.show_department_ui=!0:this.show_department_ui=!1,this.goodQuantityUIValidate()?this.show_good_quantity_ui=!0:this.show_good_quantity_ui=!1,this.badQuantityUIValidate()?this.show_bad_quantity_ui=!0:this.show_bad_quantity_ui=!1,this.transferUIValidate()?this.show_transfer_ui=!0:this.show_transfer_ui=!1,this.noteUIValidate()?this.show_node_ui=!0:this.show_node_ui=!1,this.company_api&&_.isFunction(this.company_api.isBranchAndDepartmentAndJobAndJobItemEnabled)){var e=this;this.company_api.isBranchAndDepartmentAndJobAndJobItemEnabled({onResult:function(t){t?((t=t.getResult()).branch||(e.show_branch_ui=!1),t.department||(e.show_department_ui=!1),t.job||(e.show_job_ui=!1),t.job_item||(e.show_job_item_ui=!1)):(e.show_branch_ui=!1,e.show_department_ui=!1,e.show_job_ui=!1,e.show_job_item_ui=!1)}})}}jobUIValidate(){return!(!PermissionManager.validate("job","enabled")||!PermissionManager.validate("punch","edit_job"))}jobItemUIValidate(){return!(!PermissionManager.validate("job","enabled")||!PermissionManager.validate("punch","edit_job_item"))}branchUIValidate(){return!!PermissionManager.validate("punch","edit_branch")}departmentUIValidate(){return!!PermissionManager.validate("punch","edit_department")}goodQuantityUIValidate(){return!(!PermissionManager.validate("job","enabled")||!PermissionManager.validate("punch","edit_quantity"))}badQuantityUIValidate(){return!(!PermissionManager.validate("job","enabled")||!PermissionManager.validate("punch","edit_bad_quantity"))}transferUIValidate(){return!(!PermissionManager.validate("punch","edit_transfer")&&!PermissionManager.validate("punch","default_transfer"))}noteUIValidate(){return!!PermissionManager.validate("punch","edit_note")}preRender(e){var t=this;TTPromise.wait("QuickPunch_options",null,(function(){t.setSourceData("status_id",t.status_array,!0),t.setSourceData("type_id",t.type_array,!0),t.setSourceData("branch_id",t.branch_array,!0),t.setSourceData("department_id",t.department_array,!0),t.setSourceData("job_id",t.job_array,!0),t.setSourceData("job_item_id",t.job_item_array,!0),Global.contentContainer().html(t.$el),TTPromise.wait(null,null,(function(){var e=t.getFirstAvailableField();e.setAttribute("tab-start",""),e.focus();new l({el:t.el,_timedRedirect:10,is_modal:!1,_delegateCallback:function(){t.onSaveClick()}})}))}))}initOptions(){var e=this,t={filter_columns:{id:!0,name:!0}};if(TTPromise.add("QuickPunch_options","Status"),TTPromise.add("QuickPunch_options","Type"),TTPromise.add("QuickPunch_options","Branch"),TTPromise.add("QuickPunch_options","Department"),this.api.getOptions("status",{onResult:function(t){e.status_array=t.getResult(),TTPromise.resolve("QuickPunch_options","Status")}}),this.api.getOptions("type",{onResult:function(t){e.type_array=t.getResult(),TTPromise.resolve("QuickPunch_options","Type")}}),this.branch_api.getBranch(t,!0,{onResult:function(t){e.branch_array=t.getResult(),TTPromise.resolve("QuickPunch_options","Branch")}}),this.department_api.getDepartment(t,!0,{onResult:function(t){e.department_array=t.getResult(),TTPromise.resolve("QuickPunch_options","Department")}}),Global.getProductEdition()>=20){TTPromise.add("QuickPunch_options","Job"),TTPromise.add("QuickPunch_options","JobItem");var i=LocalCacheData.getPunchLoginUser();t.filter_data={status_id:10,user_id:i.id},t.filter_columns.manual_id=t.filter_columns.default_item_id=!0,this.job_api.getJob(t,!0,{onResult:function(t){e.job_array=t.getResult(),TTPromise.resolve("QuickPunch_options","Job")}});e=this;TTPromise.wait("QuickPunch","CurrentEditRecordComplete",(function(){t.filter_data={status_id:10,job_id:e.current_edit_record.job_id},t.filter_columns.default_item_id=!1,e.job_item_api.getJobItem(t,!0,{onResult:function(t){e.job_item_array=t.getResult(),TTPromise.resolve("QuickPunch_options","JobItem")}})}))}}getFirstAvailableField(){return _.min(this.$("input[tabindex], select[tabindex], textarea[tabindex]"),(function(e){if($(e).attr("tabindex"))return parseInt($(e).attr("tabindex"))}))}getOtherFields(e){var t=this;this.other_field_api.getOtherField({filter_data:{type_id:15}},!0,{onResult:function(i){var a=i.getResult();if("array"===$.type(a)&&a.length>0){var r=a[0];TTPromise.wait("QuickPunch","CurrentEditRecordComplete",(function(){for(var e=1;e<10;e++)if(r["other_id"+e]){var i=PermissionManager.getPermissionData();if(Global.isSet(i[t.permission_id]["edit_other_id"+e])&&0==PermissionManager.validate(t.permission_id,"edit_other_id"+e))continue;t.other_fields.push({field:"other_id"+e,label:r["other_id"+e],value:t.current_edit_record["other_id"+e]})}}))}e()}})}render(){var e=this,t=Global.loadWidget("views/quick_punch/punch/QuickPunchView.html");return this.current_edit_record||this.onCancelClick(),this.setElement(_.template(t)({show_job_ui:this.show_job_ui,show_job_item_ui:this.show_job_item_ui,show_branch_ui:this.show_branch_ui,show_department_ui:this.show_department_ui,show_good_quantity_ui:this.show_good_quantity_ui,show_bad_quantity_ui:this.show_bad_quantity_ui,show_transfer_ui:this.show_transfer_ui,show_node_ui:this.show_node_ui,first_name:this.current_edit_record.first_name,last_name:this.current_edit_record.last_name,punch_time:this.current_edit_record.punch_time,punch_date:this.current_edit_record.punch_date,transfer:this.current_edit_record.transfer,quantity:this.current_edit_record.quantity,bad_quantity:this.current_edit_record.bad_quantity,note:this.current_edit_record.note,other_fields:this.other_fields})),this.save_btn=this.$("#save_btn"),this.save_btn.on("click",(function(){e.onSaveClick()})),this.cancel_btn=this.$("#cancel_btn"),this.cancel_btn.on("click",(function(){e.onCancelClick()})),this.preRender(),$(document).off("keydown").on("keydown",(function(t){var i=t.target.attributes;if(13===t.keyCode&&"cancel_btn"!=$(t.target).attr("id")){if("disabled"==e.save_btn.attr("disabled"))return;if("note"==t.target.name)return;return e.onSaveClick(),void t.preventDefault()}if((13===t.keyCode||32===t.keyCode)&&"cancel_btn"==$(t.target).attr("id"))return e.onCancelClick(),void t.preventDefault();if(9===t.keyCode&&t.shiftKey&&$(t.target).parents(".form-group").index()==$($(".quick-punch-form-container select,input,textarea")[0]).parents(".form-group").index()&&($("#cancel_btn").focus(),t.preventDefault()),i["tab-end"]&&!1===t.shiftKey){var a=e.$("input[tab-start]",e.$el);a.length>0&&a[0].focus(),t.preventDefault()}})),this}getUserPunch(){var e=this,t=Global.getStationID();function i(t){if(e.api&&"function"==typeof e.api.getUserPunch){var i=t.getResult();Global.setStationID(i)}}t?this.api_station.getCurrentStation(t,"10",{onResult:function(e){i(e)}}):this.api_station.getCurrentStation("","10",{onResult:function(e){i(e)}}),e.api.getUserPunch({onResult:function(t){var i=t.getResult();t.isValid()?Global.isSet(i)&&(e.current_edit_record=i,e.old_type_status.status_id=i.status_id,e.old_type_status.type_id=i.type_id,TTPromise.resolve("QuickPunch","CurrentEditRecordComplete")):e.showErrorAlert(t,(function(){setTimeout((function(){e.doLogout()}),5e3)}))}})}showErrorAlert(e,t){var i=e.getDetails()?e.getDetails()[0]:{};i&&i.hasOwnProperty("error")&&(i=i.error);var a=$("<div>").addClass("alert").addClass("alert-danger").attr("role","alert");for(var r in i)if(i.hasOwnProperty(r)){var o,n=$("<p>").addClass("text-center");o=_.isArray(i[r])?i[r][0]:i[r],n.text($.i18n._(o)),a.append(n)}_.size(i)>0&&Global.contentContainer().html(a),t()}onFormItemChange(e,t){var i=e.currentTarget.name,a=$(e.currentTarget).val();switch(this.current_edit_record[i]=a,i){case"job_id":if(Global.getProductEdition()>=20){var r=$($(e.currentTarget).find("option[value='"+a+"']")).attr("manual_id");this.$('input[name="job_quick_search"]').val(r||""),this.setJobItemValueWhenJobChanged(a)}break;case"job_item_id":if(Global.getProductEdition()>=20){r=$($(e.currentTarget).find("option[value='"+a+"']")).attr("manual_id");this.$('input[name="job_item_quick_search"]').val(r||"")}break;case"transfer":a=!!$(e.currentTarget).is(":checked"),this.current_edit_record[i]=a,this.onTransferChanged(a);break;case"job_quick_search":case"job_item_quick_search":Global.getProductEdition()>=20&&this.onJobQuickSearch(i,a)}t||this.validate()}validate(){var e=this;this.api.setUserPunch(this.current_edit_record,!0,{onResult:function(t){e.validateResult(t)}})}validateResult(e){e.isValid()||this.setErrorTips(e)}setErrorTips(e){this.clearErrorTips(!0);var t={},i="";if(!e.getDetails()){var a=e.getDescription();return n.K.showAlert(a,"Error"),void this.save_btn.removeAttr("disabled")}for(var r in(t=e.getDetails()[0])&&t.hasOwnProperty("error")&&(t=t.error),t){var o,s;if(t.hasOwnProperty(r))this.$('input[name="'+r+'"]')[0]?o=this.$('input[name="'+r+'"]'):this.$('select[name="'+r+'"]')[0]?o=this.$('select[name="'+r+'"]'):this.$('textarea[name="'+r+'"]')[0]&&(o=this.$('textarea[name="'+r+'"]')),s=_.isArray(t[r])?t[r][0]:t[r],o?(this.showErrorTips(o,s),this.edit_view_error_ui_dic[r]=o):i+=s+"</br>"}if(_.size(this.edit_view_error_ui_dic)>0){this.save_btn.removeAttr("disabled");var d=_.min(this.edit_view_error_ui_dic,(function(e){if(e.attr("tabindex"))return parseInt(e.attr("tabindex"))}));if(void 0!==d.focus)d.focus();else this.getFirstAvailableField().focus()}""!=i&&(this.save_btn.removeAttr("disabled"),n.K.showAlert(i,"Error"))}showErrorTips(e,t){e.addClass("error-tip"),e.attr("data-original-title",t),e.tooltip({container:"body",trigger:"hover focus"}),e.tooltip("show")}clearErrorTips(e,t){for(var i in this.edit_view_error_ui_dic)(""!==this.edit_view_error_ui_dic[i].val()||e)&&(this.edit_view_error_ui_dic[i].removeClass("error-tip"),this.edit_view_error_ui_dic[i].attr("data-original-title","")),t&&this.edit_view_error_ui_dic[i].tooltip("dipose");this.edit_view_error_ui_dic={}}onJobQuickSearch(e,t){var i={},a=this;i.filter_columns={id:!0,name:!0,manual_id:!0},"job_quick_search"===e?(i.filter_data={manual_id:t,user_id:this.current_edit_record.user_id,status_id:"10"},i.filter_columns.default_item_id=!0,this.job_api.getJob(i,{onResult:function(e){var t=e.getResult();t.length>0?(a.$('select[name="job_id"]').val(t[0].id),a.current_edit_record.job_id=t[0].id,a.setJobItemValueWhenJobChanged(t[0].id)):(a.$('select[name="job_id"]').val(""),a.current_edit_record.job_id=!1,a.setJobItemValueWhenJobChanged(null))}})):"job_item_quick_search"===e&&(i.filter_data={manual_id:t,job_id:this.current_edit_record.job_id,status_id:"10"},this.job_item_api.getJobItem(i,{onResult:function(e){var t=e.getResult();t.length>0?(a.$('select[name="job_item_id"]').val(t[0].id),a.current_edit_record.job_item_id=t[0].id):(a.$('select[name="job_item_id"]').val(""),a.current_edit_record.job_item_id=!1)}}))}onTransferChanged(e){e?(this.$('select[name="type_id"]').attr("disabled",!0),this.$('select[name="status_id"]').attr("disabled",!0),this.old_type_status.type_id=this.$('select[name="type_id"]').val(),this.old_type_status.status_id=this.$('select[name="status_id"]').val(),this.$('select[name="type_id"]').val(10),this.$('select[name="status_id"]').val(10),this.current_edit_record.type_id=10,this.current_edit_record.status_id=10):(this.$('select[name="type_id"]').removeAttr("disabled"),this.$('select[name="status_id"]').removeAttr("disabled"),this.old_type_status.hasOwnProperty("type_id")&&(this.$('select[name="type_id"]').val(this.old_type_status.type_id),this.$('select[name="status_id"]').val(this.old_type_status.status_id),this.current_edit_record.type_id=this.old_type_status.type_id,this.current_edit_record.status_id=this.old_type_status.status_id))}setJobItemValueWhenJobChanged(e,t,i){var a=this;null==t&&(t="job_item_id"),null==i&&(i={status_id:10,job_id:e});var r={};r.filter_data=i,r.filter_columns={id:!0,name:!0,manual_id:!0};var o=a.$('select[name="'+t+'"]'),n=o.val();if(s.d.isUUID(n)&&n!=s.d.zero_id&&n!=s.d.not_exist_id){var _=Global.clone(r);_.filter_data.job_id=e,a.job_item_api.getJobItem(_,{onResult:function(e){var i=e.getResult();i.length>0?a.current_edit_record[t]=n:d(t),a.setSourceData(t,i,!0)}})}else d(t),a.job_item_api.getJobItem(r,!0,{onResult:function(e){a.setSourceData(t,e.getResult(),!0)}});function d(t){if(null==t&&(t="job_item_id"),a.current_edit_record.job_id){var i=a.$('select[name="job_id"] option[value="'+e+'"]').attr("default_item_id");a.current_edit_record[t]=i,!1!==i&&0!==i||a.$('input[name="job_item_quick_search"]').val("")}else o.val(""),a.current_edit_record[t]=!1,a.$('input[name="job_item_quick_search"]').val("")}}setSourceData(e,t,i){var a=this,r='select[name="'+e+'"]';if($(this.$el).find(r)&&$(this.$el).find(r)[0]){if($(this.$el).find(r).empty(),0==_.size(t)&&(i=!0),!0===i){var o=$(a.$el).find(r);switch(e){case"status_id":case"type_id":break;default:o.append($("<option></option>").prop("value","0").text("-- "+$.i18n._("None")+" --")).attr("selected","selected")}}if(_.size(t)>0)_.isArray(t)?_.each(t,(function(t){var i=$("<option></option>").prop("value",t.id).text(t.name);"job_id"!=e&&"job_item_id"!=e||i.attr("manual_id",t.manual_id),"job_id"==e&&i.attr("default_item_id",t.default_item_id),$(a.$el).find(r).append(i),a.current_edit_record[e]==t.id&&($(a.$el).find(r).val(t.id),"job_id"==e&&a.$('input[name="job_quick_search"]').val(t.manual_id),"job_item_id"==e&&a.$('input[name="job_item_quick_search"]').val(t.manual_id))})):$.each(t,(function(t,i){$(a.$el).find(r).append($("<option></option>").prop("value",t).text(i)),"status_id"!=e&&"type_id"!=e||1==a.current_edit_record.transfer&&(a.current_edit_record[e]=10),a.current_edit_record[e]==t&&$(a.$el).find(r).val(t)}));else switch(e){case"branch_id":case"department_id":$(a.$el).find("div."+e).hide();break;case"job_id":$(a.$el).find("div."+e).hide(),$(a.$el).find("div.job_item_id").hide()}}}onCancelClick(){window.history.back()}onSaveClick(){var e=this,t=this.current_edit_record;this.save_btn.attr("disabled","disabled"),this.clearErrorTips(!0,!0),this.api.setIsIdempotent(!0),this.api.setUserPunch(t,!1,!1,{onResult:function(t){if(t.isValid())t.getResult(),new l({el:_.template(Global.loadWidget("views/quick_punch/punch/QuickPunchSuccessView.html"))({user_full_name:e.current_edit_record.first_name+" "+e.current_edit_record.last_name,label:10==e.current_edit_record.status_id?$.i18n._("In"):$.i18n._("Out"),return_date:e.current_edit_record.time_stamp,is_mobile:0==_.isUndefined(window.is_mobile)}),_timedRedirect:5,is_modal:!0,_delegateCallback:function(){e.doLogout()}});else e.setErrorTips(t)}})}doLogout(){if(this.current_user_api.Logout({onResult:function(){}}),Global.setAnalyticDimensions(),"undefined"!=typeof ga&&!0===APIGlobal.pre_login_data.analytics_enabled)try{ga("send","pageview",{"sessionControl":"end"})}catch(e){throw e}"undefined"!=typeof lh_inst&&clearTimeout(lh_inst.timeoutStatuscheck),deleteCookie("SessionID-QP"),LocalCacheData.setPunchLoginUser(null),LocalCacheData.setCurrentCompany(null),sessionStorage.clear(),window.location.href===Global.getBaseURL()+"#!m=QuickPunchLogin"?r.g.instance.router.reloadView("QuickPunchLogin"):Global.setURLToBrowser(Global.getBaseURL()+"#!m=QuickPunchLogin")}}class l extends Backbone.View{constructor(e={}){_.defaults(e,{timed_redirect_time:0}),super(e)}initialize(e){var t=this;this._delegateCallback=e._delegateCallback||null,this._timedRedirect=e._timedRedirect,this.is_modal=e.is_modal,this.render(),window.onpopstate=function(){clearTimeout(t.timer)}}render(){var e=this;return $(document).off("keyup").on("keyup",(function(){e.stopTimedRedirect()})),$(document).off("mousedown").on("mousedown",(function(){e.stopTimedRedirect()})),this.is_modal?($(this.el).on("hidden.bs.modal",(function(){e.remove(),e.delegateCallback()})),$(this.el).on("shown.bs.modal",(function(){e.timedRedirect(e._timedRedirect)})),$("body").append($(this.el).modal({backdrop:"static",show:!0}))):e.timedRedirect(e._timedRedirect),this}delegateCallback(){this._delegateCallback&&this._delegateCallback()}stopTimedRedirect(){!1===this.is_modal&&(this._delegateCallback=null),this.removeTimedRedirect()}updateTimedRedirect(e){"undefined"!=e&&e>0&&(this.timed_redirect_time=e)}removeTimedRedirect(){clearTimeout(this.timer),this.is_modal?this.$el.modal("hide"):(this.$("#timedRedirect").remove(),this.delegateCallback())}timedRedirect(e){var t=this;this.updateTimedRedirect(e),this.timed_redirect_time>0?(this.$("#timedRedirect").html("( "+this.timed_redirect_time+" )"),this.timed_redirect_time--,this.timer=setTimeout((function(){t.timedRedirect(null)}),1e3)):0==this.timed_redirect_time&&this.removeTimedRedirect()}}}}]);
//# sourceMappingURL=quick_punch-punch-QuickPunchViewController.bundle.js.map?v=e62a113d9363ec36ea1c