{"version":3,"sources":["webpack://timetrex/./interface/html5/views/attendance/accrual/AccrualViewController.js"],"names":["AccrualViewController","BaseViewController","options","_","defaults","el","type_array","user_group_api","user_group_array","user_type_array","system_type_array","delete_type_array","date_api","edit_enabled","delete_enabled","is_trigger_add","sub_view_grid_data","hide_search_field","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIAccrual","initPermission","render","sub_view_mode","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","TTPromise","resolve","PermissionManager","validate","$this","initDropDownOption","res","result","getResult","basic_search_field_ui_dic","setSourceData","Global","buildRecordArray","APIUserGroup","getUserGroup","onResult","buildTreeRecord","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","form_item_input","tab_accrual_column1","edit_view_tab","find","edit_view_tabs","push","loadWidgetByName","FormItemType","TEXT","TText","field","addEditFieldToColumn","AWESOME_BOX","APIUser","set_empty","default_args","setDefaultArgs","APIAccrualPolicyAccount","COMBO_BOX","TComboBox","TEXT_INPUT","TTextInput","need_parser_sec","mode","DATE_PICKER","TDatePicker","TEXT_AREA","TTextArea","buildSearchFields","search_fields","SearchField","label","in_column","multiple","basic_search","adv_search","form_item_type","tree_mode","APIBranch","APIDepartment","is_viewing","edit_view_ui_dic","type_id","setEditViewData","widget","current_edit_record","is_mass_editing","setAllowMultipleSelection","records","record_array","type","user_id","length","key","new_record","clone","isSet","setValue","collectUIDataToCurrentEditRecord","setEditViewDataDone","column_filter","accrual_policy_account","accrual_policy_account_id","_getFilterColumnsFromDisplayColumns","editEnabled","deleteEnabled","setDefaultMenu","grid_selected_id_array","getGridSelectIdArray","i","selected_item","getRecordFromGridById","context_btn","grid_selected_length","pId","editPermissionValidate","edit_only_mode","addClass","editOwnerOrChildPermissionValidate","removeClass","deletePermissionValidate","deleteOwnerOrChildPermissionValidate","exclude","ContextMenuIconName","save_and_continue","include","timesheet","group","icon","Icons","import_icon","sort_order","container_selector","sub_grid_mode","onSelectRow","onGridSelectRow","onCellSelect","onSelectAll","onGridSelectAll","ondblClickRow","e","onGridDblClickRow","onRightClickRow","rowId","indexOf","grid","resetSelection","setSelection","onNavigationClick","onImportClick","IndexViewController","openWizard","search","doNotSetFocus","context_menu_array","selectContextMenu","setTotalDisplaySpan","len","attr","add","setDefaultMenuAddIcon","edit","setDefaultMenuEditIcon","view","setDefaultMenuViewIcon","mass_edit","setDefaultMenuMassEditIcon","copy","setDefaultMenuCopyIcon","delete_icon","setDefaultMenuDeleteIcon","delete_and_next","setDefaultMenuDeleteAndNextIcon","save","setDefaultMenuSaveIcon","save_and_next","setDefaultMenuSaveAndNextIcon","save_and_new","setDefaultMenuSaveAndAddIcon","save_and_copy","setDefaultMenuSaveAndCopyIcon","copy_as_new","setDefaultMenuCopyAsNewIcon","cancel","setDefaultMenuCancelIcon","setDefaultMenuImportIcon","export_excel","setDefaultMenuExportIcon","setContextMenuGroupVisibility","setEditMenuSaveIcon","setEditMenuAddIcon","setEditMenuEditIcon","setEditMenuViewIcon","setEditMenuMassEditIcon","setEditMenuCopyIcon","setEditMenuDeleteIcon","setEditMenuDeleteAndNextIcon","setEditMenuSaveAndAddIcon","setEditMenuSaveAndNextIcon","setEditMenuSaveAndCopyIcon","setEditMenuCopyAndAddIcon","filter","filter_data","base_date","time_stamp","addViewTab","window","location","href","goToView","accrual_filter","selectedId","getAccrual","result_data","parent_edit_record","company","LocalCacheData","current_company","name","initEditView","onAddClick","getGridParam","isArray","onCancelClick","parent_view_controller","searchDone","loadView","loadViewSource","wait","template","contentContainer","html","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","sub_accrual_view_controller"],"mappings":"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","file":"attendance-accrual-AccrualViewController.bundle.js?v=617a9db4addb17e3b6fd","sourcesContent":["export class AccrualViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#accrual_view_container',\n\t\t\ttype_array: null,\n\n\t\t\tuser_group_api: null,\n\t\t\tuser_group_array: null,\n\t\t\tuser_type_array: null,\n\t\t\tsystem_type_array: null,\n\t\t\tdelete_type_array: null,\n\t\t\tdate_api: null,\n\n\t\t\tedit_enabled: false,\n\t\t\tdelete_enabled: false,\n\n\t\t\tis_trigger_add: false,\n\n\t\t\tsub_view_grid_data: null,\n\n\t\t\thide_search_field: false,\n\n//\t  parent_filter: null,\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'AccrualEditView.html';\n\t\tthis.permission_id = 'accrual';\n\t\tthis.viewId = 'Accrual';\n\t\tthis.script_name = 'AccrualView';\n\t\tthis.table_name_key = 'accrual';\n\t\tthis.context_menu_name = $.i18n._( 'Accruals' );\n\t\tthis.navigation_label = $.i18n._( 'Accrual' ) + ':';\n\n\t\tthis.api = TTAPI.APIAccrual;\n\n\t\tthis.initPermission();\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\t\tthis.setSelectRibbonMenuIfNecessary( 'Accrual' );\n\t\tTTPromise.resolve( 'AccrualViewController', 'init' );\n\t}\n\n\tinitPermission() {\n\n\t\tsuper.initPermission();\n\n\t\tif ( PermissionManager.validate( this.permission_id, 'view' ) || PermissionManager.validate( this.permission_id, 'view_child' ) ) {\n\t\t\tthis.hide_search_field = false;\n\t\t} else {\n\t\t\tthis.hide_search_field = true;\n\t\t}\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'user_type', null, null, function( res ) {\n\t\t\tvar result = res.getResult();\n\t\t\t$this.user_type_array = result;\n\n\t\t} );\n\t\tthis.initDropDownOption( 'delete_type', null, null, function( res ) {\n\t\t\tvar result = res.getResult();\n\t\t\t$this.delete_type_array = result;\n\n\t\t} );\n\n\t\tthis.initDropDownOption( 'type', null, null, function( res ) {\n\t\t\tvar result = res.getResult();\n\t\t\t$this.system_type_array = result;\n\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['type_id'] ) {\n\t\t\t\t$this.basic_search_field_ui_dic['type_id'].setSourceData( Global.buildRecordArray( result ) );\n\t\t\t}\n\t\t} );\n\n\t\tTTAPI.APIUserGroup.getUserGroup( '', false, false, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildTreeRecord( res );\n\n\t\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['group_id'] ) {\n\t\t\t\t\t$this.basic_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t}\n\n\t\t\t\t$this.user_group_array = res;\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_accrual': { 'label': $.i18n._( 'Accrual' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIAccrual,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_accrual_accrual',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_accrual = this.edit_view_tab.find( '#tab_accrual' );\n\n\t\tvar tab_accrual_column1 = tab_accrual.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_accrual_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t// Employee\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'full_name' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_accrual_column1, '' );\n\t\t} else {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tallow_multiple_selection: true,\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'user_id'\n\t\t\t} );\n\n\t\t\tvar default_args = {};\n\t\t\tdefault_args.permission_section = 'accrual';\n\t\t\tform_item_input.setDefaultArgs( default_args );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_accrual_column1, '' );\n\t\t}\n\n\t\t// Accrual Policy Account\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'accrual_policy_account' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Accrual Account' ), form_item_input, tab_accrual_column1 );\n\t\t} else {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIAccrualPolicyAccount,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_accrual_policy_account',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'accrual_policy_account_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Accrual Account' ), form_item_input, tab_accrual_column1 );\n\n\t\t}\n\n\t\t//Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'type_id' } );\n\t\tform_item_input.setSourceData( $this.user_type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_accrual_column1 );\n\n\t\t// Amount\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'amount', need_parser_sec: true, mode: 'time_unit' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Amount' ), form_item_input, tab_accrual_column1, '', null );\n\n\t\t// Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'time_stamp' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_accrual_column1, '', null );\n\n\t\t//Note\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( {\n\t\t\tfield: 'note'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Note' ), form_item_input, tab_accrual_column1, '', null, null, true );\n\t}\n\n\tbuildSearchFields() {\n\t\tsuper.buildSearchFields();\n\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'accrual';\n\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tfield: 'user_id',\n\t\t\t\tin_column: 1,\n\t\t\t\tdefault_args: default_args,\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: !this.hide_search_field,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Accrual Account' ),\n\t\t\t\tfield: 'accrual_policy_account_id',\n\t\t\t\tin_column: 1,\n\t\t\t\tlayout_name: 'global_accrual_policy_account',\n\t\t\t\tapi_class: TTAPI.APIAccrualPolicyAccount,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Group' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tmultiple: true,\n\t\t\t\tfield: 'group_id',\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\ttree_mode: true,\n\t\t\t\tbasic_search: !this.hide_search_field,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Default Branch' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'default_branch_id',\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: !this.hide_search_field,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Default Department' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'default_department_id',\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: !this.hide_search_field,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: !this.hide_search_field,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: !this.hide_search_field,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tsetEditViewData() {\n\t\t//use the user_type_array in edit mode and new mode, use the system_type_array in view mode\n\t\t//this prevents users from choosing type_ids that are for system use only but can see the system type_ids when viewing\n\t\tif ( this.is_viewing ) {\n\t\t\tthis.edit_view_ui_dic.type_id.setSourceData( this.system_type_array );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic.type_id.setSourceData( this.user_type_array );\n\t\t}\n\n\t\tsuper.setEditViewData(); //Set Navigation\n\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tvar widget = this.edit_view_ui_dic['user_id'];\n\t\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\t\twidget.setAllowMultipleSelection( true );\n\t\t\t} else {\n\t\t\t\twidget.setAllowMultipleSelection( false );\n\t\t\t}\n\t\t}\n\t}\n\n\tuniformVariable( records ) {\n\n\t\tvar record_array = [];\n\t\tif ( $.type( records.user_id ) === 'array' ) {\n\n\t\t\tif ( records.user_id.length === 0 ) {\n\t\t\t\trecords.user_id = false;\n\t\t\t\treturn records;\n\t\t\t}\n\n\t\t\tfor ( var key in records.user_id ) {\n\t\t\t\tvar new_record = Global.clone( records );\n\t\t\t\tnew_record.user_id = records.user_id[key];\n\t\t\t\trecord_array.push( new_record );\n\t\t\t}\n\t\t}\n\n\t\tif ( record_array.length > 0 ) {\n\t\t\trecords = record_array;\n\t\t}\n\n\t\treturn records;\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'full_name':\n\t\t\t\t\t\tif ( this.current_edit_record['first_name'] ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record['first_name'] + ' ' + this.current_edit_record['last_name'] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tgetFilterColumnsFromDisplayColumns() {\n\t\tvar column_filter = {};\n\t\tcolumn_filter.type_id = true;\n\t\tif ( this.sub_view_mode ) {\n\t\t\tcolumn_filter.accrual_policy_account = true;\n\t\t\tcolumn_filter.accrual_policy_account_id = true;\n\t\t\tcolumn_filter.user_id = true;\n\t\t}\n\t\treturn this._getFilterColumnsFromDisplayColumns( column_filter, true );\n\t}\n\n\tonGridSelectAll() {\n\t\tthis.edit_enabled = this.editEnabled();\n\t\tthis.delete_enabled = this.deleteEnabled();\n\t\tthis.setDefaultMenu();\n\t}\n\n\tdeleteEnabled() {\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tif ( grid_selected_id_array.length > 0 ) {\n\t\t\tfor ( var i = grid_selected_id_array.length - 1; i >= 0; i-- ) {\n\t\t\t\tvar selected_item = this.getRecordFromGridById( grid_selected_id_array[i] );\n\t\t\t\tif ( Global.isSet( this.delete_type_array[selected_item.type_id] ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\teditEnabled() {\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tif ( grid_selected_id_array.length > 0 ) {\n\t\t\tfor ( var i = grid_selected_id_array.length - 1; i >= 0; i-- ) {\n\t\t\t\tvar selected_item = this.getRecordFromGridById( grid_selected_id_array[i] );\n\t\t\t\tif ( Global.isSet( this.user_type_array[selected_item.type_id] ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonGridSelectRow() {\n\n\t\tvar selected_item = null;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tif ( grid_selected_length > 0 ) {\n\t\t\tselected_item = this.getRecordFromGridById( grid_selected_id_array[0] );\n\n\t\t\tthis.edit_enabled = this.editEnabled();\n\t\t\tthis.delete_enabled = this.deleteEnabled();\n\t\t}\n\n\t\tthis.setDefaultMenu();\n\t}\n\n\tsetDefaultMenuEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 && this.editOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tif ( this.edit_enabled ) {\n\t\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t} else {\n\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t}\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuMassEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length > 1 ) {\n\t\t\tif ( this.edit_enabled ) {\n\t\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t} else {\n\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t}\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuDeleteIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length >= 1 && this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tif ( this.delete_enabled ) {\n\t\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t} else {\n\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t}\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( this.edit_enabled && this.editOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\tif ( !this.is_viewing ) {\n\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t}\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteIcon( context_btn, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( this.delete_enabled && this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteAndNextIcon( context_btn, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( this.delete_enabled && this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [ContextMenuIconName.save_and_continue],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'TimeSheet' ),\n\t\t\t\t\tid: ContextMenuIconName.timesheet,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.timesheet\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Import' ),\n\t\t\t\t\tid: ContextMenuIconName.import_icon,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.import_icon,\n\t\t\t\t\tsort_order: 8000\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tgetGridSetup() {\n\t\tvar $this = this;\n\n\t\tvar grid_setup = {\n\t\t\tcontainer_selector: this.sub_view_mode ? '.edit-view-tab' : '.view',\n\t\t\tsub_grid_mode: this.sub_view_mode,\n\t\t\tonSelectRow: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonCellSelect: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonSelectAll: function() {\n\t\t\t\t$this.onGridSelectAll();\n\t\t\t},\n\t\t\tondblClickRow: function( e ) {\n\t\t\t\t$this.onGridDblClickRow( e );\n\t\t\t},\n\t\t\tonRightClickRow: function( rowId ) {\n\t\t\t\tvar id_array = $this.getGridSelectIdArray();\n\t\t\t\tif ( id_array.indexOf( rowId ) < 0 ) {\n\t\t\t\t\t$this.grid.grid.resetSelection();\n\t\t\t\t\t$this.grid.grid.setSelection( rowId );\n\t\t\t\t\t$this.onGridSelectRow();\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\n\t\treturn grid_setup;\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\tthis.onNavigationClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.import_icon:\n\t\t\t\tthis.onImportClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonImportClick() {\n\t\tvar $this = this;\n\t\tIndexViewController.openWizard( 'ImportCSVWizard', 'Accrual', function() {\n\t\t\t$this.search();\n\t\t} );\n\t}\n\n\tsetDefaultMenu( doNotSetFocus ) {\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Employee&a=edit&id=42411&tab=Wage line 282\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !Global.isSet( doNotSetFocus ) || !doNotSetFocus ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setDefaultMenuAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setDefaultMenuMassEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setDefaultMenuCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setDefaultMenuDeleteIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setDefaultMenuSaveIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setDefaultMenuSaveAndAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setDefaultMenuSaveAndCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.import_icon:\n\t\t\t\t\tthis.setDefaultMenuImportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetEditMenu() {\n\t\tthis.selectContextMenu();\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tswitch ( id ) {\n\t\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setEditMenuAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setEditMenuMassEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setEditMenuCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setEditMenuDeleteIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setEditMenuDeleteAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setEditMenuSaveAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setEditMenuSaveAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setEditMenuSaveAndCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setEditMenuCopyAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\t// Prevent user clicking timesheet from new accrual page by disabling the icon\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tonNavigationClick() {\n\t\tvar $this = this;\n\t\tvar filter = { filter_data: {} };\n\t\tvar label = this.sub_view_mode ? $.i18n._( 'Accrual Balances' ) : $.i18n._( 'Accruals' );\n\n\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\n\t\t\tfilter.user_id = this.current_edit_record.user_id;\n\t\t\tfilter.base_date = this.current_edit_record.time_stamp;\n\n\t\t\tGlobal.addViewTab( this.viewId, label, window.location.href );\n\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\n\t\t} else {\n\t\t\tvar accrual_filter = {};\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tvar selectedId = grid_selected_id_array[0];\n\n\t\t\t\taccrual_filter.filter_data = {};\n\t\t\t\taccrual_filter.filter_data.id = [selectedId];\n\n\t\t\t\tTTAPI.APIAccrual.getAccrual( accrual_filter, {\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\tfilter.user_id = result_data.user_id;\n\t\t\t\t\t\tfilter.base_date = result_data.time_stamp;\n\n\t\t\t\t\t\tGlobal.addViewTab( $this.viewId, label, window.location.href );\n\t\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetSubViewFilter( filter ) {\n\t\tif ( this.parent_edit_record && this.parent_edit_record.user_id && this.parent_edit_record.accrual_policy_account_id ) {\n\t\t\tfilter.user_id = this.parent_edit_record.user_id;\n\t\t\tfilter.accrual_policy_account_id = this.parent_edit_record.accrual_policy_account_id;\n\t\t}\n\t\treturn filter;\n\t}\n\n\tonAddResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tresult_data = [];\n\t\t}\n\n\t\tresult_data.company = LocalCacheData.current_company.name;\n\n\t\tif ( $this.sub_view_mode ) {\n\t\t\tresult_data['user_id'] = $this.parent_edit_record['user_id'];\n\t\t\tresult_data['first_name'] = $this.parent_edit_record['first_name'];\n\t\t\tresult_data['last_name'] = $this.parent_edit_record['last_name'];\n\t\t\tresult_data['accrual_policy_account_id'] = $this.parent_edit_record['accrual_policy_account_id'];\n\t\t\tresult_data['accrual_policy_account'] = $this.parent_edit_record['accrual_policy_account'];\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\n\t\t$this.initEditView();\n\t}\n\n\tsearchDone() {\n\t\tvar $this = this;\n\n\t\t//When Attendance -> Accrual Balance, New icon is clicked, open the Balance view first, then trigger the New icon to create a new accrual entry from there.\n\t\tif ( Global.isSet( $this.is_trigger_add ) && $this.is_trigger_add ) {\n\t\t\t$this.onAddClick();\n\t\t\t$this.is_trigger_add = false;\n\t\t}\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tTTPromise.resolve( 'initSubAccrualView', 'init' );\n\n\t\t\tvar result_data = this.grid.getGridParam( 'data' );\n\t\t\tif ( !Global.isArray( result_data ) || result_data.length < 1 ) {\n\t\t\t\tthis.onCancelClick();\n\t\t\t\tif ( this.parent_view_controller ) {\n\t\t\t\t\tthis.parent_view_controller.search();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.searchDone();\n\t}\n}\n\nAccrualViewController.loadView = function() {\n\n\tGlobal.loadViewSource( 'Accrual', 'AccrualView.html', function( result ) {\n\n\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\n\t\t\tvar args = {};\n\t\t\tvar template = _.template( result );\n\n\t\t\tGlobal.contentContainer().html( template( args ) );\n\t\t} );\n\t} );\n\n};\n\nAccrualViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\tGlobal.loadViewSource( 'Accrual', 'SubAccrualView.html', function( result ) {\n\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.add( 'AccrualViewController', 'init' );\n\t\t\t\tTTPromise.wait( 'AccrualViewController', 'init', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_accrual_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n};"],"sourceRoot":""}