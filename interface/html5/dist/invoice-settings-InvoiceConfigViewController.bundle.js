(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["invoice-settings-InvoiceConfigViewController","filebrowser-TImage","filebrowser-TImageAdvBrowser"],{1469:()=>{!function(e){e.fn.TImage=function(t){Global.addCss("global/widgets/filebrowser/TImageBrowser.css");var i,o=e.extend({},e.fn.TImage.defaults,t);return this.clearErrorStyle=function(){},this.getField=function(){return i},this.getValue=function(){return null},this.setValue=function(e){if(e){var t=new Date;this.attr("src",e+"&t="+t.getTime())}else this.attr("src","")},this.each((function(){var t=e.meta?e.extend({},o,e(this).data()):o;i=t.field})),this},e.fn.TImage.defaults={},e(document).on("mouseover",".file-browser img",(function(t){var i=e(t.target).parents(".file-browser");if(!e(".file_browser_overlay")[0]&&1==e(t.target).attr("enable-delete")){var o=e(t.target).height(),n=(o-32)/2,a=e('<div class="file_browser_overlay"><img src="theme/default/images/delete-512.png" style="position:absolute;width:32px;height:32px;top:'+n+"px;left:"+n+'px;"></div>');a.css("position","absolute"),a.css("top","0px"),a.css("left","0"),a.css("cursor","pointer"),a.css("height",o+"px"),a.css("width","100%"),a.css("background","rgba(255,255,255,0.85)"),e(t.target).parents(".file-browser").append(a),e(document).on("click",".file_browser_overlay",(function(t){e(t.target).parent().find("img").attr("src");TAlertManager.showConfirmAlert(e.i18n._("This will permanently delete the image. Are you sure?"),"",(function(e){if(e){var t={type:"deleteClick",message:"Delete image clicked.",time:new Date};i.trigger(t)}}))})),e(document).on("mouseleave",".file-browser",(function(){(e(document).off("click",".file_browser_overlay"),e(".file_browser_overlay")[0])&&e(this).find(".file_browser_overlay").off().remove()}))}}))}(jQuery)},8243:()=>{!function(e){e.fn.TImageAdvBrowser=function(t){Global.addCss("global/widgets/filebrowser/TImageBrowser.css");var i,o,n,a=e.extend({},e.fn.TImageAdvBrowser.defaults,t),l=this,r="",d=177,s=42,c=null;return this.setEnable=function(e){e;var t=this.children().eq(1);e?t.show():t.hide()},this.clearErrorStyle=function(){},this.getField=function(){return i},this.getValue=function(){return n},this.setImage=function(e){if(!e)return o.attr("src",""),void o.hide();var t=new Date;o.hide(),o.attr("src",e+"&t="+t.getTime()+"&X-CSRF-Token="+getCookie("CSRF-Token")),o.css("height","auto"),o.css("width","auto")},this.onImageLoad=function(t){var i=e(t).height()>0?e(t).height():t.naturalHeight,o=e(t).width()>0?e(t).width():t.naturalWidth;i>s&&e(t).css("height",s),o>d&&(e(t).css("width",d),e(t).css("height","auto")),l.trigger("setSize"),i<5?e(t).hide():e(t).show()},this.setValue=function(e){e||(e="")},this.setEnableDelete=function(e){var t=l.find(".image");e?t.attr("enable-delete",1):t.removeAttr("enable-delete")},this.each((function(){var t=e.meta?e.extend({},a,e(this).data()):a;i=t.field;e(this).find("#upload_image").text(e.i18n._("Upload Image")),t.callBack&&(c=t.callBack),!1===t.show_browser&&e(this).children().eq(1).hide(),t.default_width>0&&(d=t.default_width),t.default_height>0&&(s=t.default_height),Global.isSet(t.name)&&t.name,Global.isSet(r)&&(r=t.accept_filter),Global.isSet(t.deleteImageHandler)&&l.find(".file-browser").on("deleteClick",(function(){t.deleteImageHandler()})),e(this).children().eq(1).bind("click",(function(){IndexViewController.openWizard("UserPhotoWizard",null,(function(e){c&&c(e),n=e}))})),(o=e(this).children().eq(0)).on("load",(function(){l.onImageLoad(this)})),o.hide()})),this},e.fn.TImageAdvBrowser.defaults={}}(jQuery)},2196:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"InvoiceConfigViewController":()=>o});i(1469),i(8243);class o extends BaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}init(e){this.edit_view_tpl="InvoiceConfigEditView.html",this.permission_id="invoice_config",this.viewId="InvoiceConfig",this.script_name="InvoiceConfigView",this.context_menu_name=$.i18n._("Preferences"),this.api=TTAPI.APIInvoiceConfig,this.render(),this.initData()}render(){super.render()}initOptions(e){e()}getCustomContextMenuModel(){return{exclude:["default"],include:[ContextMenuIconName.save,ContextMenuIconName.cancel,ContextMenuIconName.export_excel]}}getInvoiceConfigData(e){var t=this;t.api["get"+t.api.key_name]({onResult:function(i){var o=i.getResult();Global.isArray(o)&&Global.isSet(o[0])?e(o[0]):t.api.getInvoiceConfigDefaultData({onResult:function(t){o=t.getResult(),e(o)}})}})}setCurrentEditRecordData(){for(var e in this.current_edit_record){var t=this.edit_view_ui_dic[e];Global.isSet(t)&&t.setValue(this.current_edit_record[e])}this.file_browser.setImage(ServiceCaller.getURLByObjectType("invoice_config")),this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}openEditView(){var e=this;e.edit_only_mode&&e.initOptions((function(){e.getInvoiceConfigData((function(t){e.buildContextMenu(),TTPromise.add("InvoiceConfig","openEditView"),e.edit_view||e.initEditViewUI(e.viewId,e.edit_view_tpl),e.current_edit_record=t,TTPromise.wait("InvoiceConfig","openEditView",(function(){e.initEditView()}))}))}))}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),o=e.getValue();this.current_edit_record[i]=o,t||this.validate()}setErrorMenu(){for(var e=this.context_menu_array.length,t=0;t<e;t++){var i=$(this.context_menu_array[t]),o=$(i.find(".ribbon-sub-menu-icon")).attr("id");switch(i.removeClass("disable-image"),o){case ContextMenuIconName.cancel:break;default:i.addClass("disable-image")}}}buildEditViewUI(){var e=this;super.buildEditViewUI();var t={"tab_invoice_settings":{"label":$.i18n._("Invoice Settings")}};this.setTabModel(t);var i,o=this.edit_view_tab.find("#tab_invoice_settings").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(o),"undefined"==typeof FormData?(i=Global.loadWidgetByName(FormItemType.IMAGE_BROWSER),this.file_browser=i.TImageBrowser({field:"",default_width:128,default_height:128}),this.file_browser.bind("imageChange",(function(t,i){(new ServiceCaller).uploadFile(i.getValue(),"object_type=invoice_config",{onResult:function(t){"true"===t.toLowerCase()?e.file_browser.setImage(ServiceCaller.getURLByObjectType("invoice_config")):TAlertManager.showAlert(t,"Error")}})}))):(i=Global.loadWidgetByName(FormItemType.IMAGE_AVD_BROWSER),this.file_browser=i.TImageAdvBrowser({field:"",default_width:128,default_height:128,callBack:function(t){(new ServiceCaller).uploadFile(t,"object_type=invoice_config",{onResult:function(t){"true"===t.toLowerCase()?e.file_browser.setImage(ServiceCaller.getURLByObjectType("invoice_config")):TAlertManager.showAlert(t,"Error")}})}})),this.addEditFieldToColumn($.i18n._("Logo"),i,o,"",null,!1,!0),(i=Global.loadWidgetByName(FormItemType.SEPARATED_BOX)).SeparatedBox({label:$.i18n._("Display on Invoice")}),this.addEditFieldToColumn(null,i,o),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"display_company_address"}),this.addEditFieldToColumn($.i18n._("Company Address"),i,o),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"display_company_work_phone"}),this.addEditFieldToColumn($.i18n._("Phone"),i,o),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"display_company_fax_phone"}),this.addEditFieldToColumn($.i18n._("Fax"),i,o),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"display_part_number"}),this.addEditFieldToColumn($.i18n._("Part Numbers"),i,o),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"display_payment"}),this.addEditFieldToColumn($.i18n._("Payment Information"),i,o),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"display_payment_signature"}),this.addEditFieldToColumn($.i18n._("Payment Signature"),i,o),(i=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"note",width:"100%"}),this.addEditFieldToColumn($.i18n._("Note"),i,o,"",null,null,!0),i.parent().width("45%"),(i=Global.loadWidgetByName(FormItemType.SEPARATED_BOX)).SeparatedBox({label:$.i18n._("Invoice Email")}),this.addEditFieldToColumn(null,i,o),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"email_from"}),this.addEditFieldToColumn($.i18n._("From Address"),i,o),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"email_bcc"}),this.addEditFieldToColumn($.i18n._("Bcc Address"),i,o),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"email_subject"}),this.addEditFieldToColumn($.i18n._("Subject"),i,o),(i=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"email_body",width:400,height:300}),this.addEditFieldToColumn($.i18n._("Body"),i,o,"",null,null,!0),TTPromise.resolve("InvoiceConfig","openEditView")}}}}]);
//# sourceMappingURL=invoice-settings-InvoiceConfigViewController.bundle.js.map?v=272425b18237c5db630a