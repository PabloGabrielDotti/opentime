(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["attendance-exceptions-ExceptionViewController"],{961:(e,i,t)=>{"use strict";t.r(i),t.d(i,{"ExceptionViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#exception_view_container",status_array:null}),super(e)}init(e){this.edit_view_tpl="ExceptionEditView.html",this.permission_id="punch",this.viewId="Exception",this.script_name="ExceptionView",this.context_menu_name=$.i18n._("Exceptions"),this.navigation_label=$.i18n._("Exception")+":",this.api=TTAPI.APIException,this.initPermission(),this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary()}onCustomContextClick(e){switch(e){case ContextMenuIconName.edit_employee:case ContextMenuIconName.edit_pay_period:case ContextMenuIconName.edit_pay_period_schedule:case ContextMenuIconName.schedule:case ContextMenuIconName.timesheet:this.onNavigationClick(e)}}setDefaultMenu(e){if(this.context_menu_array){Global.isSet(e)&&e||this.selectContextMenu(),this.setTotalDisplaySpan();for(var i=this.context_menu_array.length,t=this.getGridSelectIdArray().length,a=0;a<i;a++){var n=$(this.context_menu_array[a]),o=$(n.find(".ribbon-sub-menu-icon")).attr("id");switch(n.removeClass("invisible-image"),n.removeClass("disable-image"),o){case ContextMenuIconName.timesheet:this.setDefaultMenuViewIcon(n,t,"punch");break;case ContextMenuIconName.schedule:this.setDefaultMenuViewIcon(n,t,"schedule");break;case ContextMenuIconName.edit_employee:this.setDefaultMenuEditEmployeeIcon(n,t,"user");break;case ContextMenuIconName.edit_pay_period_schedule:case ContextMenuIconName.edit_pay_period:this.setDefaultMenuEditIcon(n,t,"pay_period_schedule");break;case ContextMenuIconName.export_excel:this.setDefaultMenuExportIcon(n,t)}}this.setContextMenuGroupVisibility()}}initPermission(){super.initPermission(),PermissionManager.validate(this.permission_id,"view")||PermissionManager.validate(this.permission_id,"view_child")?this.show_search_tab=!0:this.show_search_tab=!1}autoOpenEditViewIfNecessary(){this.autoOpenEditOnlyViewIfNecessary()}setDefaultMenuEditEmployeeIcon(e,i){this.editChildPermissionValidate("user")||e.addClass("invisible-image"),1===i?e.removeClass("disable-image"):e.addClass("disable-image")}onNavigationClick(e){var i=this.getSelectedItem();if(null!=i)var t=i.user_id;switch(e){case ContextMenuIconName.edit_employee:IndexViewController.openEditView(this,"Employee",t);break;case ContextMenuIconName.edit_pay_period:var a=i.pay_period_id;a&&IndexViewController.openEditView(this,"PayPeriods",a);break;case ContextMenuIconName.edit_pay_period_schedule:i.pay_period_schedule_id&&IndexViewController.openEditView(this,"PayPeriodSchedule",a);break;case ContextMenuIconName.schedule:var n={filter_data:{}},o={value:[t]};n.filter_data.include_user_ids=o,n.select_date=i.date_stamp,Global.addViewTab(this.viewId,$.i18n._("Exception"),window.location.href),IndexViewController.goToView("Schedule",n);break;case ContextMenuIconName.timesheet:(n={filter_data:{}}).user_id=t,n.base_date=i.date_stamp,Global.addViewTab(this.viewId,$.i18n._("Exception"),window.location.href),IndexViewController.goToView("TimeSheet",n)}}initOptions(){var e=this;this.initDropDownOption("status","user_status_id",TTAPI.APIUser),this.initDropDownOption("severity",null,TTAPI.APIExceptionPolicy),this.initDropDownOption("type","exception_policy_type_id",TTAPI.APIExceptionPolicy),TTAPI.APIUserGroup.getUserGroup("",!1,!1,{onResult:function(i){i=i.getResult(),i=Global.buildTreeRecord(i),!e.sub_view_mode&&e.basic_search_field_ui_dic.group_id&&(e.basic_search_field_ui_dic.group_id.setSourceData(i),e.adv_search_field_ui_dic.group_id.setSourceData(i))}})}getCustomContextMenuModel(){return{exclude:["default"],include:[{label:$.i18n._("TimeSheet"),id:ContextMenuIconName.timesheet,group:"navigation",icon:Icons.timesheet},{label:$.i18n._("Schedules"),id:ContextMenuIconName.schedule,group:"navigation",icon:Icons.schedule},{label:$.i18n._("Edit<br>Employee"),id:ContextMenuIconName.edit_employee,group:"navigation",icon:Icons.employee},{label:$.i18n._("Edit Pay<br>Period"),id:ContextMenuIconName.edit_pay_period,group:"navigation",icon:Icons.pay_period},{label:$.i18n._("Edit PP<br>Schedule"),id:ContextMenuIconName.edit_pay_period_schedule,group:"navigation",icon:Icons.pay_period_schedule},{label:$.i18n._("Export"),id:ContextMenuIconName.export_excel,group:"other",icon:Icons.export_excel,sort_order:9e3}]}}getSearchPanelFilter(e,i){if(Global.isSet(e))var t=e;else t=this.search_panel.getSelectTabIndex();var a=null;if(0===t)this.filter_data=[],a=this.basic_search_field_ui_dic;else{if(1!==t)return;this.filter_data=[],a=this.adv_search_field_ui_dic}var n=this;$.each(a,(function(e,i){if(n.filter_data[e]={field:e,id:"",value:a[e].getValue(!0)},"show_pre_mature"===e&&!0!==n.filter_data[e].value)return delete n.filter_data[e],!1;n.temp_basic_filter_data&&(n.temp_basic_filter_data[e]=n.filter_data[e]),n.temp_adv_filter_data&&(n.temp_adv_filter_data[e]=n.filter_data[e])})),i&&(0===t?n.temp_basic_filter_data=Global.clone(n.filter_data):1===t&&(n.temp_adv_filter_data=Global.clone(n.filter_data)))}onGridDblClickRow(){for(var e=this.context_menu_array.length,i=!1,t=0;t<e&&!i;t++){var a=$(this.context_menu_array[t]),n=$(a.find(".ribbon-sub-menu-icon")).attr("id");switch(n){case ContextMenuIconName.timesheet:if(a.is(":visible")&&!a.hasClass("disable-image"))return void this.onNavigationClick(ContextMenuIconName.timesheet)}}for(t=0;t<e&&!i;t++)switch(a=$(this.context_menu_array[t]),n=$(a.find(".ribbon-sub-menu-icon")).attr("id")){case ContextMenuIconName.schedule:if(i=!0,a.is(":visible")&&!a.hasClass("disable-image"))return void this.onNavigationClick(ContextMenuIconName.schedule)}}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Employee Status"),in_column:1,field:"user_status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Pay Period"),in_column:1,field:"pay_period_id",layout_name:"global_Pay_period",api_class:TTAPI.APIPayPeriod,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Employee"),in_column:1,field:"user_id",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Severity"),in_column:1,field:"severity_id",multiple:!0,adv_search:!0,basic_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Exception"),in_column:1,field:"exception_policy_type_id",multiple:!0,adv_search:!0,basic_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Default Branch"),in_column:2,field:"default_branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Default Department"),field:"default_department_id",in_column:2,layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Branch"),in_column:2,field:"branch_id",layout_name:"global_branch",api_class:TTAPI.APIBranch,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Department"),field:"department_id",in_column:2,layout_name:"global_department",api_class:TTAPI.APIDepartment,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Title"),in_column:3,field:"title_id",layout_name:"global_job_title",api_class:TTAPI.APIUserTitle,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Show Pre-Mature"),in_column:3,field:"show_pre_mature",basic_search:!1,adv_search:!0,form_item_type:FormItemType.CHECKBOX})]}getFilterColumnsFromDisplayColumns(){var e={exception_color:!0,exception_background_color:!0,user_id:!0,pay_period_id:!0,pay_period_schedule_id:!0};return this._getFilterColumnsFromDisplayColumns(e,!0)}setGridCellBackGround(){var e=this.grid.getGridParam("data");if(e)for(var i=e.length,t=0;t<i;t++){var a=e[t];if(a.exception_background_color){var n=$("tr[id='"+a.id+"']").find('td[aria-describedby="'+this.ui_id+'_grid_severity"]');n.css("background-color",a.exception_background_color),n.css("font-weight","bold")}if(a.exception_color){var o=$("tr[id='"+a.id+"']").find('td[aria-describedby="'+this.ui_id+'_grid_exception_policy_type_id"]');o.css("color",a.exception_color),o.css("font-weight","bold")}}}}a.loadView=function(){Global.loadViewSource("Exception","ExceptionView.html",(function(e){var i=_.template(e);Global.contentContainer().html(i({}))}))}}}]);
//# sourceMappingURL=attendance-exceptions-ExceptionViewController.bundle.js.map?v=1edc7f7f4abfbe0c3520