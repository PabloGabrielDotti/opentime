{"version":3,"sources":["webpack://timetrex/./interface/html5/views/reports/saved_report/SavedReportViewController.js"],"names":["SavedReportViewController","BaseViewController","options","_","defaults","el","sub_report_schedule_view_controller","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIUserReportData","super","this","render","sub_view_mode","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","result","remove_ids","$this","ProgressBar","closeOverlay","isValid","search","onDeleteDone","edit_view","removeEditView","parent_view_controller","onSavedReportDelete","TAlertManager","showErrorAlert","id","ContextMenuIconName","share_report","Global","getProductEdition","default_data","current_edit_record","push","getGridSelectIdArray","IndexViewController","openWizard","showAlert","getUpgradeMessage","showOverlay","onEditClick","onViewClick","context_menu_model","groups","share","label","exclude","include","edit","delete_icon","delete_and_next","save","save_and_continue","save_and_next","cancel","group","icon","Icons","copy_as_new","unshift","view","hr_reports","grid_setup","container_selector","sub_grid_mode","onSelectRow","onGridSelectRow","onCellSelect","onSelectAll","onGridSelectAll","ondblClickRow","e","onGridDblClickRow","onRightClickRow","rowId","indexOf","grid","resetSelection","setSelection","setGridSize","baseViewSubTabGridResize","onResizeGrid","edit_record","noRefreshUI","record","getRecordFromGridById","script","report_name","LocalCacheData","current_doing_context_action","default_edit_id_for_next_open_edit_view","Debug","Text","isSet","openReport","buildEditViewUI","tab_model","setTabModel","edit_only_mode","navigation","AComboBox","api_class","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_report_column1","edit_view_tab","find","edit_view_tabs","form_item_input","loadWidgetByName","FormItemType","TEXT_INPUT","TTextInput","field","width","addEditFieldToColumn","parent","CHECKBOX","TCheckbox","TEXT_AREA","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type","APIUser","AWESOME_BOX","setDefaultMenu","parent_value","parent_edit_record","loadViewSource","firstColumn","TTPromise","add","wait","css","trackView","ReportScheduleViewController","loadSubView","beforeLoadView","afterLoadView","html","resolve","subViewController","parent_key","records","onSaveDoneCallback","onSaveDone","column_filter","display_columns","getGridParam","len","length","i","name","reportData","setCurrentEditViewState","openEditView","initEditView","trigger","searchDone","container","beforeViewLoadedFun","afterViewLoadedFun","template","sub_saved_report_controller"],"mappings":"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","file":"reports-saved_report-SavedReportViewController.bundle.js?v=8af6c8fc54556a32e8e4","sourcesContent":["export class SavedReportViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#saved_report_view_container',\n\n\t\t\t//Issue #1187 - Many of these variables are needed when this view is rendered as a sub view\n\t\t\t//in that case, init() will not be run so those variables need to be defined at load time instead.\n\n\t\t\tsub_report_schedule_view_controller: null,\n\t\t\tedit_view_tpl: 'SavedReportEditView.html',\n\t\t\tpermission_id: 'report',\n\t\t\tviewId: 'SavedReport',\n\t\t\tscript_name: 'UserReportDataView',\n\t\t\ttable_name_key: 'user_report_data',\n\t\t\tcontext_menu_name: $.i18n._( 'Reports' ),\n\t\t\tnavigation_label: $.i18n._( 'Saved Report' ) + ':',\n\n\t\t\tapi: TTAPI.APIUserReportData\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\tthis.render();\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\n\t\t\t//call init data in parent view, don't call initData\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t\tif ( !this.sub_view_mode ) {\n\t\t\t\tthis.initData();\n\t\t\t}\n\t\t\tthis.setSelectRibbonMenuIfNecessary();\n\t\t}\n\t}\n\n\tonDeleteResult( result, remove_ids ) {\n\t\tvar $this = this;\n\t\tProgressBar.closeOverlay();\n\n\t\tif ( result.isValid() ) {\n\t\t\t$this.search();\n\t\t\t$this.onDeleteDone( result );\n\n\t\t\tif ( $this.edit_view ) {\n\t\t\t\t$this.removeEditView();\n\t\t\t}\n\n\t\t\tif ( this.sub_view_mode && this.parent_view_controller ) {\n\t\t\t\tthis.parent_view_controller.onSavedReportDelete();\n\t\t\t}\n\n\t\t} else {\n\t\t\tTAlertManager.showErrorAlert( result );\n\t\t}\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.share_report:\n\n\t\t\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\t\t\tvar default_data = [];\n\t\t\t\t\tif ( this.edit_view && this.current_edit_record.id ) {\n\t\t\t\t\t\tdefault_data.push( this.current_edit_record.id );\n\t\t\t\t\t} else if ( !this.edit_view ) {\n\t\t\t\t\t\tdefault_data = this.getGridSelectIdArray();\n\t\t\t\t\t}\n\t\t\t\t\tIndexViewController.openWizard( 'ShareReportWizard', default_data );\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showAlert( Global.getUpgradeMessage() );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonGridDblClickRow() {\n\t\tProgressBar.showOverlay();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.onEditClick();\n\t\t} else {\n\t\t\tthis.onViewClick();\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {\n\t\t\t\tshare: {\n\t\t\t\t\tlabel: $.i18n._( 'Share' ),\n\t\t\t\t\tid: this.viewId + 'Share'\n\t\t\t\t}\n\t\t\t},\n\t\t\texclude: ['default'],\n\t\t\tinclude: [\n\t\t\t\tContextMenuIconName.edit,\n\t\t\t\tContextMenuIconName.delete_icon,\n\t\t\t\tContextMenuIconName.delete_and_next,\n\t\t\t\tContextMenuIconName.save,\n\t\t\t\tContextMenuIconName.save_and_continue,\n\t\t\t\tContextMenuIconName.save_and_next,\n\t\t\t\tContextMenuIconName.cancel,\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Share<br>Report' ),\n\t\t\t\t\tid: ContextMenuIconName.share_report,\n\t\t\t\t\tgroup: 'share',\n\t\t\t\t\ticon: Icons.copy_as_new\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tcontext_menu_model.include.unshift( {\n\t\t\t\tlabel: $.i18n._( 'Report' ),\n\t\t\t\tid: ContextMenuIconName.view,\n\t\t\t\tgroup: 'editor',\n\t\t\t\ticon: Icons.hr_reports\n\t\t\t} );\n\t\t}\n\n\t\treturn context_menu_model;\n\t}\n\n\tremoveEditView() {\n\n\t\tsuper.removeEditView();\n\t\tthis.sub_report_schedule_view_controller = null;\n\t}\n\n\tgetGridSetup() {\n\t\tvar $this = this;\n\n\t\tvar grid_setup = {\n\t\t\tcontainer_selector: this.sub_view_mode ? '#tab_saved_reports' : '.view', //tab4 = Saved Report tab.\n\t\t\tsub_grid_mode: this.sub_view_mode,\n\t\t\tonSelectRow: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonCellSelect: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonSelectAll: function() {\n\t\t\t\t$this.onGridSelectAll();\n\t\t\t},\n\t\t\tondblClickRow: function( e ) {\n\t\t\t\t$this.onGridDblClickRow( e );\n\t\t\t},\n\t\t\tonRightClickRow: function( rowId ) {\n\t\t\t\tvar id_array = $this.getGridSelectIdArray();\n\t\t\t\tif ( id_array.indexOf( rowId ) < 0 ) {\n\t\t\t\t\t$this.grid.grid.resetSelection();\n\t\t\t\t\t$this.grid.grid.setSelection( rowId );\n\t\t\t\t\t$this.onGridSelectRow();\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\n\t\t//Only use custom grid sizing when in sub_view_mode, since we need to use the BaseViewController grid sizing otherwise.\n\t\tif ( this.sub_view_mode ) {\n\t\t\tgrid_setup.setGridSize = function() {\n\t\t\t\tif ( $this.sub_view_mode ) {\n\t\t\t\t\t$this.baseViewSubTabGridResize( '#tab_saved_reports' );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tgrid_setup.onResizeGrid = function() {\n\t\t\t\tif ( $this.sub_view_mode ) {\n\t\t\t\t\t$this.baseViewSubTabGridResize( '#tab_saved_reports' );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn grid_setup;\n\t}\n\n\tonViewClick( edit_record, noRefreshUI ) {\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar id = grid_selected_id_array[0];\n\n\t\tvar record = this.getRecordFromGridById( id );\n\t\tif ( record && record.script ) {\n\t\t\tvar report_name = record.script; //Must use 'script' instead of 'script_name' so it doesn't change with different languages.\n\n\t\t\tLocalCacheData.current_doing_context_action = 'view';\n\t\t\tLocalCacheData.default_edit_id_for_next_open_edit_view = id;\n\n\t\t\tswitch ( report_name ) {\n\t\t\t\tcase 'AccrualBalanceSummaryReport':\n\t\t\t\tcase 'ActiveShiftReport':\n\t\t\t\tcase 'AuditTrailReport':\n\t\t\t\tcase 'Form1099NecReport':\n\t\t\t\tcase 'Form940Report':\n\t\t\t\tcase 'Form941Report':\n\t\t\t\tcase 'FormW2Report':\n\t\t\t\tcase 'GeneralLedgerSummaryReport':\n\t\t\t\tcase 'InvoiceTransactionSummaryReport':\n\t\t\t\tcase 'JobInformationReport':\n\t\t\t\tcase 'JobItemInformationReport':\n\t\t\t\tcase 'JobSummaryReport':\n\t\t\t\tcase 'KPIReport':\n\t\t\t\tcase 'PayrollExportReport':\n\t\t\t\tcase 'PayStubTransactionSummaryReport':\n\t\t\t\tcase 'PayStubSummaryReport':\n\t\t\t\tcase 'PunchSummaryReport':\n\t\t\t\tcase 'RemittanceSummaryReport':\n\t\t\t\tcase 'ScheduleSummaryReport':\n\t\t\t\tcase 'T4ASummaryReport':\n\t\t\t\tcase 'T4SummaryReport':\n\t\t\t\tcase 'TaxSummaryReport':\n\t\t\t\tcase 'TimesheetDetailReport':\n\t\t\t\tcase 'TimesheetSummaryReport':\n\t\t\t\tcase 'UserQualificationReport':\n\t\t\t\tcase 'UserRecruitmentDetailReport':\n\t\t\t\tcase 'UserRecruitmentSummaryReport':\n\t\t\t\tcase 'UserSummaryReport':\n\t\t\t\t\t//Leave report_name alone, as it should match exactly.\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'UserExpenseReport':\n\t\t\t\t\treport_name = 'ExpenseSummaryReport';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ExceptionReport':\n\t\t\t\t\treport_name = 'ExceptionSummaryReport';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'JobDetailReport':\n\t\t\t\t\treport_name = 'JobAnalysisReport';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'AffordableCareReport':\n\t\t\t\t\tif ( Global.getProductEdition() == 10 ) {\n\t\t\t\t\t\tTAlertManager.showAlert( Global.getUpgradeMessage() );\n\t\t\t\t\t\treport_name = null;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t\tDebug.Text( 'ERROR: Saved Report name not defined: ' + report_name, 'SavedReportViewController.js', '', 'onViewClick', 10 );\n\t\t\t\t\treport_name = null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( report_name ) && report_name ) {\n\t\t\t\tIndexViewController.openReport( this, report_name );\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_report': { 'label': $.i18n._( 'Report' ) },\n\t\t\t'tab_schedule': { 'label': $.i18n._( 'Schedule' ), 'init_callback': 'initSubReportScheduleView' },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tif ( !this.edit_only_mode ) {\n\t\t\tthis.navigation.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIUserReportData,\n\t\t\t\tid: this.script_name + '_navigation',\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_user_report_data',\n\t\t\t\tnavigation_mode: true,\n\t\t\t\tshow_search_inputs: true\n\t\t\t} );\n\n\t\t\tthis.setNavigation();\n\n\t\t}\n\n\t\t//Tab 0 start\n\n\t\tvar tab_report = this.edit_view_tab.find( '#tab_report' );\n\n\t\tvar tab_report_column1 = tab_report.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_report_column1 );\n\n\t\t// Name\n\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_report_column1, '' );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Default\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\n\t\tform_item_input.TCheckbox( { field: 'is_default' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default' ), form_item_input, tab_report_column1 );\n\n\t\t// Description\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_report_column1, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Description' ),\n\t\t\t\tfield: 'description',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tin_column: 1,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tscript_name: 'EmployeeView',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tscript_name: 'EmployeeView',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\n\t\t];\n\t}\n\n\tinitSubReportScheduleView() {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\tif ( this.sub_report_schedule_view_controller ) {\n\t\t\t\tthis.sub_report_schedule_view_controller.buildContextMenu( true );\n\t\t\t\tthis.sub_report_schedule_view_controller.setDefaultMenu();\n\t\t\t\t$this.sub_report_schedule_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t\t$this.sub_report_schedule_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t\t$this.sub_report_schedule_view_controller.initData(); //Init data in this parent view\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tGlobal.loadViewSource( 'ReportSchedule', 'ReportScheduleViewController.js', function() {\n\t\t\t\tvar tab = $this.edit_view_tab.find( '#tab_schedule' );\n\n\t\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\n\t\t\t\tTTPromise.add( 'initSubReportScheduleView', 'init' );\n\t\t\t\tTTPromise.wait( 'initSubReportScheduleView', 'init', function() {\n\t\t\t\t\tfirstColumn.css( 'opacity', '1' );\n\t\t\t\t} );\n\n\t\t\t\tfirstColumn.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\n\t\t\t\tGlobal.trackView( 'Sub' + 'ReportSchedule' + 'View' );\n\t\t\t\tReportScheduleViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t\t} );\n\t\t} else {\n\t\t\tthis.edit_view_tab.find( '#tab_schedule' ).find( '.first-column-sub-view' ).css( 'display', 'none' );\n\t\t\tthis.edit_view.find( '.permission-defined-div' ).css( 'display', 'block' );\n\t\t\tthis.edit_view.find( '.permission-message' ).html( Global.getUpgradeMessage() );\n\t\t\tthis.edit_view.find( '.save-and-continue-button-div' ).css( 'display', 'none' );\n\t\t}\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_report_schedule_view_controller = subViewController;\n\t\t\t$this.sub_report_schedule_view_controller.parent_key = 'user_report_data_id';\n\t\t\t$this.sub_report_schedule_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_report_schedule_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_report_schedule_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_report_schedule_view_controller.sub_view_mode = true;\n\n\t\t\t$this.sub_report_schedule_view_controller.initData(); //Init data in this parent view\n\t\t}\n\t}\n\n\tuniformVariable( records ) {\n\n\t\t// Remove in next commit, related to #2698 fix, no longer needed but semi-big refactor to remove\n\t\t// if ( records.hasOwnProperty( 'data' ) && records.data.hasOwnProperty( 'config' ) && records.data.config.hasOwnProperty( 'filter' ) ) {\n\t\t// \trecords.data.config.filter_ = records.data.config.filter;\n\t\t// }\n\n\t\treturn records;\n\t}\n\n\tonSaveDone( result ) {\n\t\t//onSaveDoneCallback is set in Report controller\n\t\tif ( this.parent_view_controller && this.parent_view_controller.onSaveDoneCallback ) {\n\t\t\tthis.parent_view_controller.onSaveDoneCallback( result, this.current_edit_record );\n\t\t}\n\t}\n\n\tonSaveAndContinueDone( result ) {\n\t\tthis.onSaveDone( result );\n\t}\n\n\tonSaveAndNextDone( result ) {\n\t\tthis.onSaveDone( result );\n\t}\n\n\tgetFilterColumnsFromDisplayColumns() {\n\t\tvar column_filter = {};\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.is_owner = true;\n\t\tcolumn_filter.is_child = true;\n\t\tcolumn_filter.script = true; //Include script column so onViewClick() knows which view to open for saved reports.\n\n\t\t// Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tvar display_columns = [];\n\t\tif ( this.grid ) {\n\t\t\tdisplay_columns = this.grid.getGridParam( 'colModel' );\n\t\t}\n\n\t\tif ( display_columns ) {\n\t\t\tvar len = display_columns.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar column_info = display_columns[i];\n\t\t\t\tcolumn_filter[column_info.name] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tonAddClick( reportData ) {\n\n\t\tProgressBar.closeOverlay();\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\t$this.openEditView();\n\t\t$this.current_edit_record = reportData;\n\t\t$this.initEditView();\n\t}\n\n\tsearchDone() {\n\t\t$( 'window' ).trigger( 'resize' );\n\t\tif ( this.sub_view_mode ) {\n\t\t\tTTPromise.resolve( 'SubSavedReportView', 'init' );\n\t\t}\n\t\tsuper.searchDone();\n\t}\n}\n\nSavedReportViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'SavedReport', 'SubSavedReportView.html', function( result ) {\n\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_saved_report_controller );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n};\n"],"sourceRoot":""}