(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["ribbon-RibbonViewController"],{9538:(e,a,n)=>{"use strict";n.r(a),n.d(a,{"RibbonViewController":()=>r});var o=n(6739),t=n(9490);class r extends o.TTBackboneView{constructor(e={}){_.defaults(e,{el:"#ribbon_view_container",user_api:null,subMenuNavMap:null}),super(e)}initialize(e){super.initialize(e),TopMenuManager.ribbon_view_controller=this;this.render()}onMenuSelect(e,a){}onSubMenuNavClick(e,a){var n=this,o=this.subMenuNavMap[a];if(LocalCacheData.openRibbonNaviMenu){if(LocalCacheData.openRibbonNaviMenu.attr("id")==="sub_nav"+a)return void LocalCacheData.openRibbonNaviMenu.close();LocalCacheData.openRibbonNaviMenu.close()}!function(){for(var t=o.get("items"),r=$("<ul id='sub_nav"+a+"' class='ribbon-sub-menu-nav'> </ul>"),i=0;i<t.length;i++){var l=t[i],c=$("<li class='ribbon-sub-menu-nav-item' id='"+l.get("id")+"'><span class='label'>"+l.get("label")+"</span></li>");r.append(c),c.unbind("click").click((function(){var e=$(this).attr("id");n.onReportMenuClick(e)}))}r=r.RibbonSubMenuNavWidget(),LocalCacheData.openRibbonNaviMenu=r,$(e).append(r)}()}onReportMenuClick(e){t.Global.closeEditViews((function(){if("AffordableCareReport"!==e||t.Global.getProductEdition()>=15){var a=LocalCacheData.current_open_edit_only_controller?LocalCacheData.current_open_edit_only_controller:LocalCacheData.current_open_primary_controller;IndexViewController.openReport(a,e)}else TAlertManager.showAlert(t.Global.getUpgradeMessage())}))}onSubMenuClick(e){var a=this;t.Global.closeEditViews((function(){a.setSelectSubMenu(e),a.openSelectView(e)}))}buildRibbonMenus(){var e=this;this.subMenuNavMap={};for(var a=TopMenuManager.ribbon_menus,n=$(".ribbonTabLabel"),o=$(".ribbon"),r=a.length,i=0;i<r;i++){var l=a[i];if(!1!==l.get("permission_result")){for(var c=l.get("sub_menu_groups"),s=$('<div id="'+l.get("id")+'" class="ribbon-tab-out-side"><div class="ribbon-tab"><div class="ribbon-sub-menu"></div></div></div>'),u=c.length,d=0;d<u;d++){for(var b=c[d],p=b.get("sub_menus"),_=$("<ul></ul>"),g=$('<div class="menu top-ribbon-menu"></div>'),h=p.length,m=0;m<h;m++){var C=p[m],v=$('<li><div class="ribbon-sub-menu-icon" id="'+C.get("id")+'"><img src="'+C.get("icon")+'" ><span class="ribbon-label">'+C.get("label")+"</span></div></li>");C.get("type")===RibbonSubMenuType.NAVIGATION?C.get("items").length>0&&(_.append(v),v.children().eq(0).addClass("ribbon-sub-menu-nav-icon"),e.subMenuNavMap[C.get("id")]=C,v.click(t.Global.debounce((function(a){var n=$(this).find(".ribbon-sub-menu-icon").attr("id");e.onSubMenuNavClick(this,n)}),t.Global.calcDebounceWaitTimeBasedOnNetwork(),!0))):(_.append(v),v.click(t.Global.debounce((function(a){var n=$(this).find(".ribbon-sub-menu-icon").attr("id");e.onSubMenuClick(n)}),t.Global.calcDebounceWaitTimeBasedOnNetwork(),!0)))}_.children().length>0&&(g.append(_),g.append($('<div class="menu-bottom"><span class="menu-bottom-span">'+b.get("label")+"</span></div>")),s.find(".ribbon-sub-menu").append(g))}s.find(".ribbon-sub-menu").children().length>0&&(n.append($('<li><a id="menu:'+l.get("id")+'"  ref="'+l.get("id")+'" href="#'+l.get("id")+'">'+l.get("label")+"</a></li>")),o.append(s))}}this.setRibbonMenuVisibility()}setRibbonMenuVisibility(){for(var e=["companyMenu","employeeMenu","payrollMenu"],a=e.length,n=0;n<a;n++){var o=e[n];if(t.Global.topContainer().find("#"+o).find("li").length<1)t.Global.topContainer().find("a[ref='"+o+"']").parent().hide()}}render(){if(this.el){this.buildRibbonMenus();$(this.el).tabs({}),this.setSelectMenu(TopMenuManager.selected_menu_id),this.setSelectSubMenu(TopMenuManager.selected_sub_menu_id),$("#leftLogo").attr("src",t.Global.getRealImagePath("css/global/widgets/ribbon/images/logo.png")),$("#rightLogo").attr("src",ServiceCaller.getURLByObjectType("company_logo")),LocalCacheData.getLoginUserPreference()&&$("#leftLogo").unbind("click").bind("click",(function(){t.Global.closeEditViews((function(){TopMenuManager.goToView("Home")}))}))}}setSelectMenu(e){e||(e="Home");var a=$(this.el).find("#ribbon a[ref="+e+"]").parent().index();a>=0&&$(this.el).tabs("option","active",a),TopMenuManager.selected_menu_id=e}openSelectView(e){switch(t.Global.setUINotready(),e){case"ImportCSV":IndexViewController.openWizard("ImportCSVWizard",null,(function(){LocalCacheData.current_open_primary_controller&&"function"==typeof LocalCacheData.current_open_primary_controller.search&&LocalCacheData.current_open_primary_controller.search()}));break;case"QuickStartWizard":PermissionManager.checkTopLevelPermission("QuickStartWizard")&&IndexViewController.openWizard("QuickStartWizard");break;case"InOut":case"UserDefault":case"Company":case"LoginUserContact":case"LoginUserPreference":case"ChangePassword":case"InvoiceConfig":case"RecruitmentPortalConfig":case"About":LocalCacheData.current_open_edit_only_controller&&LocalCacheData.current_open_edit_only_controller.viewId==e?(LocalCacheData.current_open_edit_only_controller.setEditMenu(),$("#ribbon_view_container .context-menu:visible a").click()):LocalCacheData.current_open_edit_only_controller?IndexViewController.openEditView(LocalCacheData.current_open_edit_only_controller,e):IndexViewController.openEditView(LocalCacheData.current_open_primary_controller,e);break;case"Logout":this.doLogout();break;case"PortalLogout":this.doPortalLogout();break;case"AdminGuide":var a="https://www.timetrex.com/h?id=admin_guide&v="+LocalCacheData.getLoginData().application_version+"&e="+t.Global.getProductEdition();window.open(a,"_blank");break;case"FAQS":a="https://www.timetrex.com/h?id=faq&v="+LocalCacheData.getLoginData().application_version+"&e="+t.Global.getProductEdition(),window.open(a,"_blank");break;case"WhatsNew":a="https://www.timetrex.com/h?id=changelog&v="+LocalCacheData.getLoginData().application_version+"&e="+t.Global.getProductEdition(),window.open(a,"_blank");break;case"EmailHelp":t.Global.getProductEdition()>=15?location.href="mailto:"+APIGlobal.pre_login_data.support_email+"?subject=Company: "+LocalCacheData.getCurrentCompany().name+"&body=Company: "+LocalCacheData.getCurrentCompany().name+"  Registration Key: "+LocalCacheData.getLoginData().registration_key:(a="https://www.timetrex.com/r?id=29",window.open(a,"_blank"));break;case"Sandbox":if(APIGlobal.pre_login_data.sandbox_url&&APIGlobal.pre_login_data.sandbox_url.length>0){var n=LocalCacheData.getLoginUser();t.Global.NewSession(n.user_name,"SANDBOX",!0)}break;case"ProcessPayrollWizard":IndexViewController.openWizard("ProcessPayrollWizard",null,(function(){LocalCacheData.current_open_primary_controller&&"function"==typeof LocalCacheData.current_open_primary_controller.search&&LocalCacheData.current_open_primary_controller.search()}));break;case"PayrollRemittanceAgencyEventWizard":IndexViewController.openWizardController("PayrollRemittanceAgencyEventWizardController",null,(function(){LocalCacheData.current_open_primary_controller&&"function"==typeof LocalCacheData.current_open_primary_controller.search&&LocalCacheData.current_open_primary_controller.search()}));break;case"ProcessTransactionsWizard":IndexViewController.openWizardController("ProcessTransactionsWizard",null,(function(){LocalCacheData.current_open_primary_controller&&"function"==typeof LocalCacheData.current_open_primary_controller.search&&LocalCacheData.current_open_primary_controller.search()}));break;case"LegalEntity":t.Global.getProductEdition()>=15?TopMenuManager.goToView(TopMenuManager.selected_sub_menu_id):IndexViewController.openEditView(LocalCacheData.current_open_primary_controller,e,!1);break;default:LocalCacheData.current_open_edit_only_controller&&LocalCacheData.current_open_edit_only_controller.viewId==e?(LocalCacheData.current_open_edit_only_controller.onCancelClick(),TTPromise.wait("base","onCancelClick",(function(){TopMenuManager.goToView(TopMenuManager.selected_sub_menu_id)}))):TopMenuManager.goToView(TopMenuManager.selected_sub_menu_id)}}setSelectSubMenu(e){switch(e){case"InOut":case"UserDefault":case"Company":case"LoginUserContact":case"ImportCSV":case"QuickStartWizard":case"InvoiceConfig":case"LoginUserPreference":case"RecruitmentPortalConfig":case"Logout":case"AdminGuide":case"FAQS":case"WhatsNew":case"EmailHelp":break;case"ProcessPayrollWizard":case"PayrollRemittanceAgencyWizard":break;default:if(TopMenuManager.selected_sub_menu_id)try{$("#"+TopMenuManager.selected_sub_menu_id).removeClass("selected-menu")}catch(a){return TopMenuManager.selected_sub_menu_id="",TopMenuManager.selected_menu_id="",void TAlertManager.showAlert($.i18n._("Invalid view name"))}e||(e="Home"),$("#"+e).addClass("selected-menu"),TopMenuManager.selected_sub_menu_id=e}}doLogout(){var e=TTAPI.APIAuthentication;if(void 0!==e.Logout&&e.Logout({onResult(){}}),t.Global.setAnalyticDimensions(),"undefined"!=typeof ga&&!0===APIGlobal.pre_login_data.analytics_enabled)try{ga("send","pageview",{"sessionControl":"end"})}catch(a){throw a}"undefined"!=typeof lh_inst&&clearTimeout(lh_inst.timeoutStatuscheck),t.Global.Logout(),TopMenuManager.goToView("Login"),TAlertManager.showBrowserTopBanner()}static loadView(){t.Global.topContainer().css("display","block");var e=t.Global.loadPageSync("global/widgets/ribbon/RibbonView.html"),a=_.template(e);t.Global.topContainer().html(a)}}}}]);
//# sourceMappingURL=ribbon-RibbonViewController.bundle.js.map?v=8e39e22a9b8554f3a889