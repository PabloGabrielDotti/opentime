{"version":3,"sources":["webpack://timetrex/./interface/html5/views/attendance/timesheet/UserDateTotalParentViewController.js"],"names":["UserDateTotalParentViewController","BaseViewController","options","_","defaults","el","sub_user_date_total_view_controller","super","this","edit_view_tpl","permission_id","script_name","viewId","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIUserDateTotal","render","sub_view_mode","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","removeEditView","parent_view_controller","onSubViewRemoved","include","date_str","$this","edit_only_mode","TTPromise","add","edit_view","initEditViewUI","date_stamp","Global","strToDate","format","current_edit_record","date","user_id","LocalCacheData","getAllURLArgs","wait","initEditView","buildSearchFields","search_fields","buildEditViewUI","tab_model","setTabModel","resolve","edit_view_tab","find","css","initSubUserDateTotalView","setEditViewDataDone","tab_id","setDefaultMenu","parent_edit_record","getSubViewFilter","filter","getFilter","beforeLoadView","afterLoadView","subViewController","target","object_type_id","loadScript","firstColumn","trackView","UserDateTotalViewController","loadSubView","loadView","container","loadViewSource","result","args","template","isSet","html","contentContainer","beforeViewLoadedFun","afterViewLoadedFun","sub_user_date_total_parent_view_controller"],"mappings":"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","file":"attendance-timesheet-UserDateTotalParentViewController.bundle.js?v=e3fa3f83812cd89d37d2","sourcesContent":["export class UserDateTotalParentViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#user_date_total_parent_view_container',\n\t\t\tsub_user_date_total_view_controller: null,\n\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'UserDateTotalParentEditView.html';\n\t\tthis.permission_id = 'punch';\n\t\tthis.script_name = 'UserDateTotalParentView';\n\t\tthis.viewId = 'UserDateTotalParent';\n\t\tthis.table_name_key = 'user_date_total_parent';\n\t\tthis.context_menu_name = $.i18n._( 'Accumulated Time' );\n\t\tthis.navigation_label = $.i18n._( 'Accumulated Time' ) + ':';\n\t\tthis.api = TTAPI.APIUserDateTotal;\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\tremoveEditView() {\n\t\tsuper.removeEditView();\n\n\t\tif ( this.parent_view_controller && this.parent_view_controller.viewId === 'TimeSheet' ) {\n\t\t\tthis.parent_view_controller.onSubViewRemoved();\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\treturn { include: ['default'] };\n\t}\n\n\topenEditView( date_str ) {\n\n\t\tvar $this = this;\n\n\t\tif ( $this.edit_only_mode ) {\n\n\t\t\tTTPromise.add( 'UserDateTotalParent', 'init' );\n\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t$this.initEditViewUI( $this.viewId, $this.edit_view_tpl );\n\t\t\t}\n\n\t\t\tvar date_stamp = Global.strToDate( date_str, 'YYYY-MM-DD' ).format();\n\n\t\t\t$this.current_edit_record = {\n\t\t\t\tdate: date_str,\n\t\t\t\tuser_id: LocalCacheData.getAllURLArgs().user_id,\n\t\t\t\tdate_stamp: date_stamp\n\t\t\t};\n\t\t\tTTPromise.wait( 'UserDateTotalParent', 'init', function() {\n\t\t\t\t$this.initEditView();\n\t\t\t} );\n\n\t\t} else {\n\t\t\tif ( !this.edit_view ) {\n\t\t\t\tthis.initEditViewUI( $this.viewId, $this.edit_view_tpl );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [];\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_user_date_total_parent': { 'label': $.i18n._( 'Accumulated Time' ) },\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tTTPromise.resolve( 'UserDateTotalParent', 'init' );\n\t}\n\n\tsetCurrentEditRecordData() {\n\n\t\tthis.edit_view_tab.find( '#tab_user_date_total_parent' ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\tthis.initSubUserDateTotalView( 'tab_user_date_total_parent' );\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tinitSubUserDateTotalView( tab_id ) {\n\t\tvar $this = this;\n\n\t\tif ( this.sub_user_date_total_view_controller ) {\n\t\t\tthis.sub_user_date_total_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_user_date_total_view_controller.setDefaultMenu();\n\t\t\t$this.sub_user_date_total_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_user_date_total_view_controller.getSubViewFilter = function( filter ) {\n\n\t\t\t\treturn getFilter( filter, this );\n\t\t\t};\n\n\t\t\t$this.sub_user_date_total_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/attendance/timesheet/UserDateTotalViewController.js', function() {\n\t\t\tvar tab = $this.edit_view_tab.find( '#' + tab_id );\n\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\t\t\tGlobal.trackView( 'Sub' + 'UserDateTotal' + 'View' );\n\t\t\tUserDateTotalViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_user_date_total_view_controller = subViewController;\n\t\t\t$this.sub_user_date_total_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_user_date_total_view_controller.getSubViewFilter = function( filter ) {\n\n\t\t\t\treturn getFilter( filter, this );\n\t\t\t};\n\t\t\t$this.sub_user_date_total_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_user_date_total_view_controller.initData();\n\n\t\t}\n\n\t\tfunction getFilter( filter, target ) {\n\t\t\tvar date = Global.strToDate( target.parent_edit_record.date, 'YYYY-MM-DD' ).format();\n\n\t\t\tfilter.date_stamp = date;\n\t\t\tfilter.user_id = target.parent_edit_record.user_id; //Should be selected user_id\n\t\t\tfilter.object_type_id = [20, 25, 30, 40, 100, 110];\n\n\t\t\treturn filter;\n\t\t}\n\t}\n\n}\n\nUserDateTotalParentViewController.loadView = function( container ) {\n\tGlobal.loadViewSource( 'UserDateTotalParent', 'UserDateTotalParentView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t} else {\n\t\t\tGlobal.contentContainer().html( template( args ) );\n\t\t}\n\n\t} );\n};\n\nUserDateTotalParentViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'UserDateTotalParent', 'SubUserDateTotalParentView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_user_date_total_parent_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t} );\n\n};"],"sourceRoot":""}