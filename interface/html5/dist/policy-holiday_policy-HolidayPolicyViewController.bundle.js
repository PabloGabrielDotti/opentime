(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["policy-holiday_policy-HolidayPolicyViewController"],{935:(e,i,t)=>{"use strict";t.r(i),t.d(i,{"HolidayPolicyViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#holiday_policy_view_container",type_array:null,default_schedule_status_array:null,shift_on_holiday_type_array:null,worked_scheduled_days_array:null,date_api:null,sub_holiday_view_controller:null}),super(e)}init(e){this.edit_view_tpl="HolidayPolicyEditView.html",this.permission_id="holiday_policy",this.viewId="HolidayPolicy",this.script_name="HolidayPolicyView",this.table_name_key="holiday_policy",this.context_menu_name=$.i18n._("Holiday Policy"),this.navigation_label=$.i18n._("Holiday Policy")+":",this.api=TTAPI.APIHolidayPolicy,this.date_api=TTAPI.APITTDate,this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary("HolidayPolicy")}initOptions(){var e=this;this.initDropDownOption("type"),this.initDropDownOption("average_time_frequency_type"),this.initDropDownOption("default_schedule_status"),this.initDropDownOption("shift_on_holiday_type"),this.initDropDownOption("scheduled_day","worked_scheduled_days",null,(function(i){i=i.getResult(),e.worked_scheduled_days_array=$.extend({},i)}))}buildEditViewUI(){super.buildEditViewUI();var e=this,i={"tab_holiday_policy":{"label":$.i18n._("Holiday Policy")},"tab_eligibility":{"label":$.i18n._("Eligibility")},"tab_holiday_time":{"label":$.i18n._("Holiday Time")},"tab_holidays":{"label":$.i18n._("Holidays"),"init_callback":"initSubHolidayView","display_on_mass_edit":!1},"tab_audit":!0};this.setTabModel(i),this.navigation.AComboBox({api_class:TTAPI.APIHolidayPolicy,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_holiday",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var t,a,l,d=this.edit_view_tab.find("#tab_holiday_policy").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(d),(t=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),t,d,""),t.parent().width("45%"),(t=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"description",width:"100%"}),this.addEditFieldToColumn($.i18n._("Description"),t,d,"",null,null,!0),t.parent().width("45%"),(t=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type_id",set_empty:!1}),t.setSourceData(e.type_array),this.addEditFieldToColumn($.i18n._("Type"),t,d),(t=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"default_schedule_status_id"}),t.setSourceData(e.default_schedule_status_array),this.addEditFieldToColumn($.i18n._("Default Schedules Status"),t,d),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIRecurringHoliday,allow_multiple_selection:!0,layout_name:"global_recurring_holiday",show_search_inputs:!0,set_empty:!0,field:"recurring_holiday_id"}),this.addEditFieldToColumn($.i18n._("Recurring Holidays"),t,d,"");var o=this.edit_view_tab.find("#tab_eligibility").find(".first-column");this.edit_view_tabs[1]=[],this.edit_view_tabs[1].push(o),(t=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"minimum_employed_days",width:50}),this.addEditFieldToColumn($.i18n._("Minimum Employed Days"),t,o,"");var _=Global.loadWidgetByName(FormItemType.TEXT_INPUT);_.TTextInput({field:"minimum_worked_days",width:30});var s=Global.loadWidgetByName(FormItemType.TEXT_INPUT);s.TTextInput({field:"minimum_worked_period_days",width:30});var n=Global.loadWidgetByName(FormItemType.COMBO_BOX);n.TComboBox({field:"worked_scheduled_days"}),n.setSourceData(e.worked_scheduled_days_array),a=$("<div class='widget-h-box'></div>");var r=$("<span class='widget-right-label'> "+$.i18n._("of the")+" </span>"),m=$("<span class='widget-right-label'> "+$.i18n._("prior to the holiday")+" </span>"),h=$("<span class='widget-right-label'>   </span>");a.append(_),a.append(r),a.append(s),a.append(h),a.append(n),a.append(m),this.addEditFieldToColumn($.i18n._("Employee Must Work at Least"),[_,s,n],o,"",a,!0),(t=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"shift_on_holiday_type_id"}),t.setSourceData(e.shift_on_holiday_type_array),this.addEditFieldToColumn($.i18n._("On the Holiday, the Employee"),t,o,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"minimum_worked_after_days",width:30}),(s=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"minimum_worked_after_period_days",width:30}),(n=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"worked_after_scheduled_days"}),n.setSourceData(e.worked_scheduled_days_array),a=$("<div class='widget-h-box'></div>"),r=$("<span class='widget-right-label'> "+$.i18n._("of the")+" </span>"),m=$("<span class='widget-right-label'> "+$.i18n._("following the holiday")+" </span>"),h=$("<span class='widget-right-label'>   </span>"),a.append(_),a.append(r),a.append(s),a.append(h),a.append(n),a.append(m),this.addEditFieldToColumn($.i18n._("Employee Must Work at Least"),[_,s,n],o,"",a,!0),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIContributingShiftPolicy,allow_multiple_selection:!1,layout_name:"global_contributing_shift_policy",show_search_inputs:!0,set_empty:!0,field:"eligible_contributing_shift_policy_id"}),this.addEditFieldToColumn($.i18n._("Contributing Shift Policy"),t,o,"",null,!0);var y=this.edit_view_tab.find("#tab_holiday_time").find(".first-column");this.edit_view_tabs[2]=[],this.edit_view_tabs[2].push(y),(t=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"average_time_days",width:30});var c=Global.loadWidgetByName(FormItemType.COMBO_BOX);c.TComboBox({field:"average_time_frequency_type_id"}),c.setSourceData(e.average_time_frequency_type_array),(a=$("<div class='widget-h-box'></div>")).append(t),a.append(c),this.addEditFieldToColumn($.i18n._("Total Time Over"),[t,c],y,"",a,!0);var p=Global.loadWidgetByName(FormItemType.CHECKBOX);p.TCheckbox({field:"average_time_worked_days"});var u=Global.loadWidgetByName(FormItemType.TEXT_INPUT);u.TTextInput({field:"average_days",width:30}),a=$("<div class='widget-h-box '></div>"),r=$("<span class='widget-right-label'> "+$.i18n._("Worked Days Only")+":  </span>"),m=$("<span class='widget-right-label'> "+$.i18n._("or")+" </span>"),h=$("<span class='widget-right-label'> "+$.i18n._("days")+" </span>"),a.append(r),a.append(p),a.append(m),a.append(u),a.append(h),this.average_days_widgets=[m,u,h],this.addEditFieldToColumn($.i18n._("Average Time Over"),[p,u],y,"",a,!0),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIContributingShiftPolicy,allow_multiple_selection:!1,layout_name:"global_contributing_shift_policy",show_search_inputs:!0,set_empty:!0,field:"contributing_shift_policy_id"}),this.addEditFieldToColumn($.i18n._("Contributing Shift Policy"),t,y,"",null,!0),(t=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"minimum_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn($.i18n._("Holiday Time"),t,y,"",null,!0),(t=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"maximum_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn($.i18n._("Maximum Time"),t,y,"",null,!0),(t=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"force_over_time_policy"}),a=$("<div class='widget-h-box'></div>"),l=$("<span class='widget-right-label '> ("+$.i18n._("Even if they are not eligible for holiday pay")+")</span>"),a.append(t),a.append(l),this.addEditFieldToColumn($.i18n._("Always Apply Over Time/Premium Policies"),t,y,"",a,!0),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIRoundIntervalPolicy,allow_multiple_selection:!1,layout_name:"global_round_interval",show_search_inputs:!0,set_empty:!0,field:"round_interval_policy_id"}),this.addEditFieldToColumn($.i18n._("Rounding Policy"),t,y,"",null,!0),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIAbsencePolicy,allow_multiple_selection:!1,layout_name:"global_absences",show_search_inputs:!0,set_empty:!0,field:"absence_policy_id"}),this.addEditFieldToColumn($.i18n._("Absence Policy"),t,y,"")}onFormItemChange(e,i){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var t=e.getField(),a=e.getValue();switch(this.current_edit_record[t]=a,t){case"type_id":this.onTypeChange();break;case"average_time_worked_days":this.onWorkedDaysChange()}i||this.validate()}setEditViewDataDone(){super.setEditViewDataDone(),this.onTypeChange(),this.onWorkedDaysChange()}onWorkedDaysChange(){!0===this.current_edit_record.average_time_worked_days?(this.average_days_widgets[0].hide(),this.average_days_widgets[1].hide(),this.average_days_widgets[2].hide()):(this.average_days_widgets[0].show(),this.average_days_widgets[1].show(),this.average_days_widgets[2].show())}onTypeChange(){10==this.current_edit_record.type_id?(this.detachElement("minimum_worked_days"),this.detachElement("shift_on_holiday_type_id"),this.detachElement("minimum_worked_after_days"),this.detachElement("average_time_days"),this.detachElement("average_time_worked_days"),this.edit_view_form_item_dic.minimum_time.find(".edit-view-form-item-label").text($.i18n._("Holiday Time")+": "),this.detachElement("maximum_time"),this.detachElement("force_over_time_policy"),this.detachElement("round_interval_policy_id"),this.detachElement("eligible_contributing_shift_policy_id"),this.detachElement("contributing_shift_policy_id")):20==this.current_edit_record.type_id?(this.attachElement("minimum_worked_days"),this.attachElement("shift_on_holiday_type_id"),this.attachElement("minimum_worked_after_days"),this.detachElement("average_time_days"),this.detachElement("average_time_worked_days"),this.edit_view_form_item_dic.minimum_time.find(".edit-view-form-item-label").text($.i18n._("Holiday Time")+": "),this.detachElement("maximum_time"),this.detachElement("force_over_time_policy"),this.detachElement("round_interval_policy_id"),this.attachElement("eligible_contributing_shift_policy_id"),this.detachElement("contributing_shift_policy_id")):30==this.current_edit_record.type_id&&(this.attachElement("minimum_worked_days"),this.attachElement("shift_on_holiday_type_id"),this.attachElement("minimum_worked_after_days"),this.attachElement("average_time_days"),this.attachElement("average_time_worked_days"),this.edit_view_form_item_dic.minimum_time.find(".edit-view-form-item-label").text($.i18n._("Minimum Time")+": "),this.attachElement("maximum_time"),this.attachElement("force_over_time_policy"),this.attachElement("round_interval_policy_id"),this.attachElement("eligible_contributing_shift_policy_id"),this.attachElement("contributing_shift_policy_id")),this.editFieldResize()}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX})]}initSubHolidayView(){var e=this;if(this.current_edit_record.id){if(this.sub_holiday_view_controller)return this.sub_holiday_view_controller.buildContextMenu(!0),this.sub_holiday_view_controller.setDefaultMenu(),e.sub_holiday_view_controller.parent_value=e.current_edit_record.id,e.sub_holiday_view_controller.parent_edit_record=e.current_edit_record,void e.sub_holiday_view_controller.initData();Global.loadScript("views/policy/holiday/HolidayViewController.js",(function(){var a=e.edit_view_tab.find("#tab_holidays").find(".first-column-sub-view");Global.trackView("SubHolidayView"),HolidayViewController.loadSubView(a,i,t)}))}else TTPromise.resolve("BaseViewController","onTabShow");function i(){}function t(i){e.sub_holiday_view_controller=i,e.sub_holiday_view_controller.parent_key="holiday_policy_id",e.sub_holiday_view_controller.parent_value=e.current_edit_record.id,e.sub_holiday_view_controller.parent_edit_record=e.current_edit_record,e.sub_holiday_view_controller.parent_view_controller=e,e.sub_holiday_view_controller.initData()}}removeEditView(){super.removeEditView(),this.sub_holiday_view_controller=null}}}}]);
//# sourceMappingURL=policy-holiday_policy-HolidayPolicyViewController.bundle.js.map?v=852bbd57661b9ffe7b64