(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["my_account-request-RequestViewController"],{926:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"RequestViewController":()=>a});class a extends RequestViewCommonController{constructor(e={}){_.defaults(e,{el:"#request_view_container",type_array:null,status_array:null,api_request_schedule:null,authorization_api:null,hierarchy_type_id:!1,messages:null}),super(e)}init(e){this.edit_view_tpl="RequestEditView.html",this.permission_id="request",this.viewId="Request",this.script_name="RequestView",this.table_name_key="request",this.context_menu_name=$.i18n._("Requests"),this.navigation_label=$.i18n._("Request")+":",this.api=TTAPI.APIRequest,this.api_absence_policy=TTAPI.APIAbsencePolicy,this.api_schedule=TTAPI.APISchedule,this.message_control_api=TTAPI.APIMessageControl,Global.getProductEdition()>=15&&(this.api_request_schedule=TTAPI.APIRequestSchedule),Global.getProductEdition()>=20&&(this.job_api=TTAPI.APIJob,this.job_item_api=TTAPI.APIJobItem),this.authorization_api=TTAPI.APIAuthorization,this.initPermission(),this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary()}initOptions(e){this.initDropDownOptions([{option_name:"status"},{option_name:"type"}],(function(t){e&&e(t)}))}buildEditViewUI(){super.buildEditViewUI();var e={"tab_request":{"label":$.i18n._("Message")},"tab_audit":!0};this.setTabModel(e),this.edit_view.find("a[ref=tab_audit]").css("display","none");var t=this.edit_view_tab.find("#tab_request"),i=t.find(".first-column"),a=t.find(".second-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(i);var s=Global.loadWidgetByName(FormItemType.TEXT_INPUT);s.TTextInput({field:"subject",width:359}),this.addEditFieldToColumn($.i18n._("Subject"),s,i,""),(s=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"body",width:600,height:400}),this.addEditFieldToColumn($.i18n._("Body"),s,i,"",null,null,!0),a.css("display","none")}buildAddViewUI(){super.buildEditViewUI();var e={"tab_request":{"label":$.i18n._("Request")},"tab_audit":!0};this.setTabModel(e),this.edit_view.find("a[ref=tab_audit]").css("display","none");var t,i,a,s=this.edit_view_tab.find("#tab_request"),d=s.find(".first-column"),n=s.find(".second-column");if(this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(d),this.edit_view_tabs[0].push(n),(t=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"full_name"}),this.addEditFieldToColumn($.i18n._("Employee"),t,d,""),(t=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type_id",set_empty:!1}),t.setSourceData(this.type_array),this.addEditFieldToColumn($.i18n._("Type"),t,d),(t=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"date_stamp"}),i=$("<div class='widget-h-box'></div>"),a=$("<span class='widget-right-label'> "+$.i18n._("(Use the first or only date affected by this request)")+"</span>"),i.append(t),i.append(a),this.addEditFieldToColumn($.i18n._("Date"),t,d,"",i),Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")){(t=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"request_schedule_status_id",set_empty:!1}),t.setSourceData({10:"Working",20:"Absent"}),this.addEditFieldToColumn($.i18n._("Status"),t,d),(t=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"start_date"}),this.addEditFieldToColumn($.i18n._("Start Date"),t,d,""),(t=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"end_date"}),this.addEditFieldToColumn($.i18n._("End Date"),t,d,"");var l=Global.loadWidgetByName(FormItemType.CHECKBOX);l.TCheckbox({field:"sun"});var o=Global.loadWidgetByName(FormItemType.CHECKBOX);o.TCheckbox({field:"mon"});var _=Global.loadWidgetByName(FormItemType.CHECKBOX);_.TCheckbox({field:"tue"});var r=Global.loadWidgetByName(FormItemType.CHECKBOX);r.TCheckbox({field:"wed"});var c=Global.loadWidgetByName(FormItemType.CHECKBOX);c.TCheckbox({field:"thu"});var u=Global.loadWidgetByName(FormItemType.CHECKBOX);u.TCheckbox({field:"fri"});var h=Global.loadWidgetByName(FormItemType.CHECKBOX);h.TCheckbox({field:"sat"}),i=$("<div></div>");var m=$("<span class='widget-top-label'> "+$.i18n._("Sun")+" <br>  </span>"),b=$("<span class='widget-top-label'> "+$.i18n._("Mon")+" <br>  </span>"),p=$("<span class='widget-top-label'> "+$.i18n._("Tue")+" <br>  </span>"),g=$("<span class='widget-top-label'> "+$.i18n._("Wed")+" <br>  </span>"),v=$("<span class='widget-top-label'> "+$.i18n._("Thu")+" <br>  </span>"),C=$("<span class='widget-top-label'> "+$.i18n._("Fri")+" <br>  </span>"),I=$("<span class='widget-top-label'> "+$.i18n._("Sat")+" <br>  </span>");if(m.append(l),b.append(o),p.append(_),g.append(r),v.append(c),C.append(u),I.append(h),i.append(m),i.append(b),i.append(p),i.append(g),i.append(v),i.append(C),i.append(I),i.addClass("request_edit_view_effective_days"),this.addEditFieldToColumn($.i18n._("Effective Days"),[l,o,_,r,c,u,h],d,"",i,!1,!0),(t=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"start_time"}),this.addEditFieldToColumn($.i18n._("In"),t,d),(t=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"end_time"}),this.addEditFieldToColumn($.i18n._("Out"),t,d),(t=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"total_time"}),this.addEditFieldToColumn($.i18n._("Total"),t,d),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APISchedulePolicy,allow_multiple_selection:!1,layout_name:"global_schedule",show_search_inputs:!0,set_empty:!0,field:"schedule_policy_id"}),this.addEditFieldToColumn($.i18n._("Schedule Policy"),t,d),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIAbsencePolicy,customSearchFilter:function(){return{filter_data:{user_id:LocalCacheData.getLoginUser().id}}},allow_multiple_selection:!1,layout_name:"global_absences",set_empty:!0,field:"absence_policy_id"}),this.addEditFieldToColumn($.i18n._("Absence Policy"),t,d),(t=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"available_balance"}),i=$("<div class='widget-h-box'></div>"),this.available_balance_info=$('<img class="available-balance-info" src="'+Global.getRealImagePath("images/infox16x16.png")+'">'),i.append(t),i.append(this.available_balance_info),this.addEditFieldToColumn($.i18n._("Available Balance"),t,d,"",i,!0),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIBranch,allow_multiple_selection:!1,layout_name:"global_branch",show_search_inputs:!0,set_empty:!0,field:"branch_id"}),this.show_branch_ui&&this.addEditFieldToColumn($.i18n._("Branch"),t,d),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIDepartment,allow_multiple_selection:!1,layout_name:"global_department",show_search_inputs:!0,set_empty:!0,field:"department_id"}),this.show_department_ui&&this.addEditFieldToColumn($.i18n._("Department"),t,d),Global.getProductEdition()>=20){(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIJob,allow_multiple_selection:!1,layout_name:"global_job",show_search_inputs:!0,set_empty:!0,setRealValueCallBack:function(e){e&&T.setValue(e.manual_id)},field:"job_id",added_items:[{value:"-1",label:Global.default_item},{value:"-2",label:Global.selected_item}]}),i=$("<div class='widget-h-box'></div>");var T=Global.loadWidgetByName(FormItemType.TEXT_INPUT);T.TTextInput({field:"job_quick_search",disable_keyup_event:!0}),T.addClass("job-coder"),i.append(T),i.append(t),this.addEditFieldToColumn($.i18n._("Job"),[t,T],d,"",i,!0),this.show_job_ui||this.detachElement("job_id"),(t=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIJobItem,allow_multiple_selection:!1,layout_name:"global_job_item",show_search_inputs:!0,set_empty:!0,setRealValueCallBack:function(e){e&&y.setValue(e.manual_id)},field:"job_item_id",added_items:[{value:"-1",label:Global.default_item},{value:"-2",label:Global.selected_item}]}),i=$("<div class='widget-h-box'></div>");var y=Global.loadWidgetByName(FormItemType.TEXT_INPUT);y.TTextInput({field:"job_item_quick_search",disable_keyup_event:!0}),y.addClass("job-coder"),i.append(y),i.append(t),this.addEditFieldToColumn($.i18n._("Task"),[t,y],d,"",i,!0),this.show_job_item_ui||this.detachElement("job_item_id")}}(t=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"message",width:400,height:300}),this.addEditFieldToColumn($.i18n._("Reason / Message"),t,d,"",null,null,!0),Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")&&(this.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").hide(),this.hideAdvancedFields()),this.onTypeChanged(),this.onWorkingStatusChanged()}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Employee"),in_column:1,field:"user_id",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Start Date"),in_column:1,field:"start_date",basic_search:!0,adv_search:!1,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:$.i18n._("End Date"),in_column:1,field:"end_date",basic_search:!0,adv_search:!1,form_item_type:FormItemType.DATE_PICKER}),new SearchField({label:$.i18n._("Status"),in_column:2,field:"status_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX})]}getCustomContextMenuModel(){return{exclude:["default"],include:[{label:$.i18n._("New"),id:ContextMenuIconName.add,group:"editor",icon:Icons.new_add},{label:$.i18n._("View"),id:ContextMenuIconName.view,group:"editor",icon:Icons.view},{label:$.i18n._("Reply"),id:ContextMenuIconName.edit,group:"editor",icon:Icons.edit},{label:$.i18n._("Delete"),id:ContextMenuIconName.delete_icon,group:"editor",icon:Icons.delete_icon},{label:$.i18n._("Delete<br>& Next"),id:ContextMenuIconName.delete_and_next,group:"editor",icon:Icons.delete_and_next},{label:$.i18n._("Send"),id:ContextMenuIconName.send,group:"editor",icon:Icons.send},{label:$.i18n._("Cancel"),id:ContextMenuIconName.cancel,group:"editor",icon:Icons.cancel,sort_order:1990},{label:$.i18n._("TimeSheet"),id:ContextMenuIconName.timesheet,group:"navigation",icon:Icons.timesheet},{label:$.i18n._("Schedule"),id:ContextMenuIconName.schedule,group:"navigation",icon:Icons.schedule},{label:$.i18n._("Edit<br>Employee"),id:ContextMenuIconName.edit_employee,group:"navigation",icon:Icons.employee},{label:$.i18n._("Export"),id:ContextMenuIconName.export_excel,group:"other",icon:Icons.export_excel,sort_order:9e3}]}}setCurrentEditRecordData(e){for(var t in e&&(this.current_edit_record=e),this.current_edit_record||(this.current_edit_record={}),this.current_edit_record)if(this.current_edit_record.hasOwnProperty(t)){var i=this.edit_view_ui_dic[t];if(Global.isSet(i))switch(t){case"full_name":this.is_add?i.setValue(LocalCacheData.loginUser.first_name+" "+LocalCacheData.loginUser.last_name):this.is_viewing&&i.setValue(this.current_edit_record.first_name+" "+this.current_edit_record.last_name);break;case"subject":this.is_edit&&this.messages?i.setValue("Re: "+this.messages[0].subject):this.is_viewing&&i.setValue(this.current_edit_record[t]);break;default:i.setValue(this.current_edit_record[t])}}this.collectUIDataToCurrentEditRecord(),this.is_add&&(this.current_edit_record.user_id=LocalCacheData.loginUser.id),this.setEditViewDataDone()}setEditViewDataDone(){super.setEditViewDataDone(),this.is_viewing||Global.isSet(this.messages)&&(this.messages=null)}initViewingView(){if(super.initViewingView(),this.edit_view_ui_dic.message&&this.edit_view_ui_dic.message.parents(".edit-view-form-item-div").hide(),Global.getProductEdition()>=15&&(30==this.edit_view_ui_dic.type_id||40==this.edit_view_ui_dic.type_id)){var e=["sun","mon","tue","wed","thu","fri","sat"],t=!1;for(var i in this.current_edit_record)if(e.indexOf(i)>-1){for(var a=0;a<7;a++)if(0!==this.current_edit_record[i]&&!1!==this.current_edit_record[i]){t=!0;break}t?this.edit_view_ui_dic.sun.parents(".edit-view-form-item-div").show():this.edit_view_ui_dic.sun.parents(".edit-view-form-item-div").hide()}}}setURL(){"edit"!==LocalCacheData.current_doing_context_action?super.setURL():LocalCacheData.current_doing_context_action=""}setDefaultMenu(e){if(this.context_menu_array){Global.isSet(e)&&e||this.selectContextMenu(),this.setTotalDisplaySpan();for(var t=this.context_menu_array.length,i=this.getGridSelectIdArray().length,a=0;a<t;a++){var s=$(this.context_menu_array[a]),d=$(s.find(".ribbon-sub-menu-icon")).attr("id");switch(s.removeClass("disable-image"),s.removeClass("invisible-image"),d){case ContextMenuIconName.add:this.setDefaultMenuAddIcon(s,i);break;case ContextMenuIconName.view:this.setDefaultMenuViewIcon(s,i);break;case ContextMenuIconName.edit:this.setDefaultMenuEditIcon(s,i,"request");break;case ContextMenuIconName.delete_icon:this.setDefaultMenuDeleteIcon(s,i);break;case ContextMenuIconName.delete_and_next:this.setDefaultMenuDeleteAndNextIcon(s,i);break;case ContextMenuIconName.send:this.setDefaultMenuSendIcon(s,i);break;case ContextMenuIconName.cancel:this.setDefaultMenuCancelIcon(s,i);break;case ContextMenuIconName.timesheet:this.setDefaultMenuViewIcon(s,i,"punch");break;case ContextMenuIconName.schedule:this.setDefaultMenuViewIcon(s,i,"schedule");break;case ContextMenuIconName.edit_employee:this.setDefaultMenuEditEmployeeIcon(s,i,"user");break;case ContextMenuIconName.export_excel:this.setDefaultMenuExportIcon(s,i)}}this.setContextMenuGroupVisibility()}}setEditMenu(){this.selectContextMenu();for(var e=this.context_menu_array.length,t=0;t<e;t++){var i=$(this.context_menu_array[t]),a=$(i.find(".ribbon-sub-menu-icon")).attr("id");switch(i.removeClass("disable-image"),a){case ContextMenuIconName.add:this.setEditMenuAddIcon(i);break;case ContextMenuIconName.view:this.setEditMenuViewIcon(i);break;case ContextMenuIconName.edit:this.setEditMenuEditIcon(i,"request");break;case ContextMenuIconName.delete_icon:this.setEditMenuDeleteIcon(i);break;case ContextMenuIconName.delete_and_next:this.setEditMenuDeleteAndNextIcon(i);break;case ContextMenuIconName.send:this.setEditMenuSaveIcon(i);break;case ContextMenuIconName.cancel:break;case ContextMenuIconName.timesheet:this.setEditMenuNavViewIcon(i,"punch");break;case ContextMenuIconName.schedule:this.setEditMenuNavViewIcon(i,"schedule");break;case ContextMenuIconName.edit_employee:this.setEditMenuNavEditIcon(i,"user");break;case ContextMenuIconName.export_excel:this.setDefaultMenuExportIcon(i)}}this.setContextMenuGroupVisibility()}setDefaultMenuCancelIcon(e,t,i){this.sub_view_mode||this.is_viewing||e.addClass("disable-image")}setDefaultMenuExportIcon(e,t,i){this.edit_only_mode||null==this.grid?e.addClass("invisible-image"):(this.is_viewing||this.is_edit||this.is_add)&&e.addClass("disable-image")}setEditMenuAddIcon(e,t){super.setEditMenuAddIcon(e,t),(this.is_edit||this.is_add)&&e.addClass("disable-image")}setEditMenuDeleteAndNextIcon(e,t){(this.is_edit||this.is_add)&&e.addClass("disable-image")}setEditMenuNavViewIcon(e,t){(this.is_edit||this.is_add)&&e.addClass("disable-image")}setEditMenuViewIcon(e,t){e.addClass("disable-image")}setEditMenuDeleteIcon(e,t){(this.is_edit||this.is_add)&&e.addClass("disable-image")}onTypeChanged(e){if(this.current_edit_record&&Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")&&(30==this.current_edit_record.type_id||40==this.current_edit_record.type_id)){this.edit_view_ui_dic.date_stamp&&this.edit_view_ui_dic.date_stamp.parents(".edit-view-form-item-div").hide(),null!=this.current_edit_record.date_stamp&&""==this.current_edit_record.start_date&&(this.edit_view_ui_dic.start_date.setValue(this.current_edit_record.date_stamp),this.current_edit_record.start_date=this.current_edit_record.date_stamp),null!=this.current_edit_record.date_stamp&&""==this.current_edit_record.end_date&&(this.edit_view_ui_dic.end_date.setValue(this.current_edit_record.date_stamp),this.current_edit_record.end_date=this.current_edit_record.date_stamp),this.showAdvancedFields(!1),30==this.edit_view_ui_dic.type_id.getValue()?this.edit_view_ui_dic.request_schedule_status_id.setValue(20):40==this.edit_view_ui_dic.type_id.getValue()&&this.edit_view_ui_dic.request_schedule_status_id.setValue(10),e&&(e.request_schedule_status_id=this.edit_view_ui_dic.request_schedule_status_id.getValue()),this.onWorkingStatusChanged();var t=this;this.setRequestFormDefaultData(e,(function(){t.getAvailableBalance(),t.setCurrentEditRecordData(t.current_edit_record),t.getScheduleTotalTime()}))}else this.hideAdvancedFields(),this.edit_view_ui_dic.date_stamp&&this.edit_view_ui_dic.date_stamp.parents(".edit-view-form-item-div").show(),this.onWorkingStatusChanged()}setRequestFormDefaultData(e,t){if(Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")&&(30==this.current_edit_record.type_id||40==this.current_edit_record.type_id))if(null==e){var i=this;this.enable_validation=!1,this.setUIWidgetFieldsToCurrentEditRecord();var a=this.uniformVariable(this.buildDataForAPI(this.current_edit_record));this.api_request_schedule.getRequestScheduleDefaultData(a,{onResult:function(a){(e=a.getResult()).request_schedule_status_id=e.status_id,e.date_stamp=e.start_date,i.setDefaultData(e,!0),t&&t()}})}else e.date_stamp=e.start_date,e=this.buildDataFromAPI(e),this.setDefaultData(e,!0),t&&t()}onAvailableBalanceChange(){Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")&&(this.edit_view_ui_dic&&this.edit_view_ui_dic.absence_policy_id&&20==this.edit_view_ui_dic.request_schedule_status_id.getValue()&&this.edit_view_ui_dic.absence_policy_id.getValue()!=TTUUID.zero_id?this.getAvailableBalance():this.edit_view_ui_dic&&this.edit_view_ui_dic.available_balance&&this.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").hide())}onSaveDone(e){var t;return this.is_edit?(this.onViewClick(this.current_edit_record.id),t=!1):t=!0,$().TFeedback({source:"Send"}),t}uniformVariable(e){if("object"==typeof e&&(e.user_id=LocalCacheData.loginUser.id,e.first_name=LocalCacheData.loginUser.first_name,e.last_name=LocalCacheData.loginUser.last_name),this.is_add)e=this.buildDataForAPI(e);else if(this.is_edit){var t=this.uniformMessageVariable(e);return e&&e.request_schedule&&(t.request_schedule=e.request_schedule),t}return e}onSaveClick(e){var t=this;for(var i in LocalCacheData.current_doing_context_action="save",Global.isSet(e)||(e=!1),t.current_edit_record)null!=t.edit_view_ui_dic[i]&&(t.current_edit_record[i]=t.edit_view_ui_dic[i].getValue());if(this.is_add)a=this.uniformVariable(t.current_edit_record),this.api["set"+this.api.key_name](a,!1,e,{onResult:function(e){t.onSaveResult(e)}});else if(this.is_edit){var a={};this.is_add=!1,this.setCurrentEditRecordData(),a=this.uniformVariable(this.current_edit_record),EmbeddedMessage.reply([a],e,(function(e){if(e.isValid()){var i=t.current_edit_record.id;t.removeEditView(),t.onViewClick(i)}else t.setErrorTips(e),t.setErrorMenu()}))}}search(e,t,i,a){this.refresh_id=null,super.search(e,t,i,a)}setDefaultMenuEditIcon(e,t,i){this.editPermissionValidate(i)&&!this.edit_only_mode||e.addClass("invisible-image"),e.addClass("disable-image")}setDefaultMenuScheduleIcon(e,t,i){PermissionManager.checkTopLevelPermission("Schedule")&&!this.edit_only_mode||e.addClass("invisible-image"),1===t?e.removeClass("disable-image"):e.addClass("disable-image")}setDefaultMenuSendIcon(e,t,i){this.addPermissionValidate(i)&&!this.edit_only_mode||e.addClass("invisible-image"),e.addClass("disable-image")}setDefaultMenuEditEmployeeIcon(e,t){this.editChildPermissionValidate("user")||e.addClass("invisible-image"),1===t?e.removeClass("disable-image"):e.addClass("disable-image")}onCustomContextClick(e){switch(e){case ContextMenuIconName.timesheet:case ContextMenuIconName.schedule:case ContextMenuIconName.edit_employee:this.onNavigationClick(e);break;case ContextMenuIconName.send:this.onSaveClick()}}setEditViewWidgetsMode(){var e=!1;for(var t in this.edit_view_ui_dic){var i=this.edit_view_ui_dic[t];i.css("opacity",1),i.parent().parent().parent().hasClass("v-box")||e||(e=!0),this.is_viewing?Global.isSet(i.setEnabled)&&i.setEnabled(!1):Global.isSet(i.setEnabled)&&i.setEnabled(!0)}}onFormItemChange(e,t){var i=this;this.collectUIDataToCurrentEditRecord(),this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var a=e.getField(),s=e.getValue();this.current_edit_record[a]=s;var d=!1;switch(a){case"job_id":Global.getProductEdition()>=20&&(this.edit_view_ui_dic.job_quick_search.setValue(e.getValue(!0)&&e.getValue(!0).manual_id?e.getValue(!0).manual_id:""),this.setJobItemValueWhenJobChanged(e.getValue(!0),"job_item_id"),this.edit_view_ui_dic.job_quick_search.setCheckBox(!0));break;case"job_item_id":Global.getProductEdition()>=20&&(this.edit_view_ui_dic.job_item_quick_search.setValue(e.getValue(!0)&&e.getValue(!0).manual_id?e.getValue(!0).manual_id:""),this.edit_view_ui_dic.job_item_quick_search.setCheckBox(!0));break;case"job_quick_search":case"job_item_quick_search":Global.getProductEdition()>=20&&this.onJobQuickSearch(a,s,"job_id","job_item_id");break;case"type_id":t=!0,this.onTypeChanged();break;case"date_stamp":this.onDateStampChanged();break;case"request_schedule_status_id":this.onWorkingStatusChanged();break;case"start_date":this.current_edit_record.start_date=this.edit_view_ui_dic.start_date.getValue(),this.current_edit_record.date_stamp=this.edit_view_ui_dic.start_date.getValue(),this.onStartDateChanged(),this.onAvailableBalanceChange(),this.setRequestFormDefaultData(null,(function(){n()})),d=!0;break;case"end_date":this.current_edit_record.end_date=this.edit_view_ui_dic.end_date.getValue(),this.onAvailableBalanceChange(),this.setRequestFormDefaultData(null,(function(){n()})),d=!0;break;case"start_time":case"end_time":case"sun":case"tue":case"wed":case"thu":case"fri":case"sat":this.getScheduleTotalTime();break;case"absence_policy_id":this.selected_absence_policy_record=this.edit_view_ui_dic.absence_policy_id.getValue(),this.onAvailableBalanceChange()}function n(){"date_stamp"!==a&&"start_date_stamps"!==a&&"start_date"!==a&&"end_date"!==a&&"start_date_stamp"!==a&&"start_time"!==a&&"end_time"!==a&&"schedule_policy_id"!==a&&"absence_policy_id"!==a||(""!==i.current_edit_record.date_stamp&&""!==i.current_edit_record.start_time&&""!==i.current_edit_record.end_time?i.getScheduleTotalTime():i.onAvailableBalanceChange()),t||i.validate(),i.setEditMenu()}d||n()}validate(){var e=this,t=this.current_edit_record;t=this.uniformVariable(t);var i=this.message_control_api;this.is_add&&(t=this.buildDataForAPI(t),i=this.api),i["validate"+i.key_name](t,{onResult:function(t){e.validateResult(t)}})}onAddClick(e){TTPromise.add("Request","add"),TTPromise.wait();var t=this;this.edit_view&&this.removeEditView(),this.setCurrentEditViewState("new"),this.openEditView(),this.buildAddViewUI(),t.api&&"function"==typeof t.api["get"+t.api.key_name+"DefaultData"]&&t.api["get"+t.api.key_name+"DefaultData"]({onResult:function(i){e&&(i=$.extend({},i.getResult(),e)),t.onAddResult(i),t.onDateStampChanged(),i.type_id?t.onTypeChanged(i):t.getScheduleTotalTime(),TTPromise.resolve("Request","add")}})}openAddView(e){this.sub_view_mode=!0,this.edit_only_mode=!0;var t=this;this.initOptions((function(){t.onAddClick(e)}))}}}}]);
//# sourceMappingURL=my_account-request-RequestViewController.bundle.js.map?v=3c79973f8d63830073ed