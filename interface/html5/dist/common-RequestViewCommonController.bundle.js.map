{"version":3,"sources":["webpack://timetrex/./interface/html5/views/common/RequestViewCommonController.js"],"names":["RequestViewCommonController","BaseViewController","options","_","defaults","authorization_history","selected_absence_policy_record","enable_edit_view_ui","super","this","grid","data","getGridParam","len","length","i","item","status_id","$","id","addClass","force","cancel_all","callback","TTPromise","add","$this","current_edit_record","$record_id","doNext","edit_view","parent_view_controller","sub_view_mode","is_changed","buildContextMenu","onCancelClick","is_edit","setCurrentEditViewState","onViewClick","setEditMenu","removeEditView","search","Global","setUIInitComplete","ProgressBar","closeOverlay","resolve","LocalCacheData","current_doing_context_action","TAlertManager","showConfirmAlert","modify_alert_message","flag","viewId","request_schedule_id","user_id","loginUser","isSet","data_for_api","request_schedule","afn","getAdvancedFieldNames","key","edit_view_ui_dic","date_stamp","getValue","indexOf","request_schedule_status_id","getProductEdition","PermissionManager","validate","type_id","0","pre_request_schedule","extend","update_schedule_total_time","TTUUID","isUUID","zero_id","not_exist_id","is_add","parents","show","hideAdvancedFields","advanced_field_names","hide","show_branch_ui","show_department_ui","show_job_ui","show_job_item_ui","is_viewing","date","available_balance","total_time","getScheduleTotalTime","start_time","end_time","schedulePolicyId","getLoginUser","result","TTAPI","APISchedule","async","isValid","getResult","getTimeUnit","setValue","onAvailableBalanceChange","absence_policy_id","showAbsencePolicyField","ui_field","start_date","days","end_date","getDaysInSpan","sun","mon","tue","wed","thu","fri","sat","policy_id","api_absence_policy","getProjectedAbsencePolicyBalance","onResult","getBalanceHandler","display_columns","authorization_history_grid","AuthorizationHistory","getAuthorizationHistoryDefaultDisplayColumns","column_filter","name","result_data","buildDataFromAPI","edit_view_tab","find","initEditView","initViewingView","onWorkingStatusChanged","EmbeddedMessage","init","clearCurrentSelectedRecord","edit_record","clear_edit_view","clearEditView","sub_log_view_controller","getSubViewFilter","filter","parent_edit_record","showAdvancedFields","view_id","edit_view_file_name","setUINotready","wait","remove","loadViewSource","attr","ui_id","setTabOVisibility","tabs","activate","e","ui","onTabShow","bind","onTabIndexChange","contentContainer","append","initRightClickMenu","RightClickMenuType","EDITVIEW","buildViewUI","buildEditViewUI","setEditViewTabHeight","editId","noRefreshUI","initEditViewUI","edit_view_tpl","body","widgetContainer","tab_model","i18n","setTabModel","navigation","AComboBox","api_class","APIRequest","script_name","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_request","tab_request_column1","edit_view_tabs","push","form_item_input","loadWidgetByName","FormItemType","TEXT","TText","field","addEditFieldToColumn","set_empty","COMBO_BOX","TComboBox","setSourceData","10","20","DATE_PICKER","TDatePicker","form_item_sun_checkbox","CHECKBOX","TCheckbox","form_item_mon_checkbox","form_item_tue_checkbox","form_item_wed_checkbox","form_item_thu_checkbox","form_item_fri_checkbox","form_item_sat_checkbox","TIME_PICKER","TTimePicker","AWESOME_BOX","APISchedulePolicy","APIAbsencePolicy","customSearchFilter","setAbsencePolicyFilter","setRealValueCallBack","value","available_balance_info","getRealImagePath","APIBranch","detachElement","APIDepartment","APIJob","val","job_coder","manual_id","added_items","label","default_item","selected_item","TEXT_INPUT","TTextInput","disable_keyup_event","APIJobItem","job_item_coder","initUI","filter_data","filter_columns","absence_policy","iconName","temp_filter","grid_selected_id_array","selectedId","ContextMenuIconName","timesheet","base_date","addViewTab","window","location","href","IndexViewController","goToView","getGridSelectIdArray","api","key_name","edit_employee","openEditView","schedule","include_users","include_user_ids","select_date","permission_id","show_search_tab","jobUIValidate","jobItemUIValidate","branchUIValidate","departmentUIValidate","company_api","APICompany","isFunction","isBranchAndDepartmentAndJobAndJobItemEnabled","branch","department","job","job_item","context_btn","pId","editPermissionValidate","editOwnerOrChildPermissionValidate","records","msg","subject","object_id","object_type_id"],"mappings":"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","file":"common-RequestViewCommonController.bundle.js?v=200cb84fbb57fc86617c","sourcesContent":["export class RequestViewCommonController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tauthorization_history: null,\n\t\t\tselected_absence_policy_record: null,\n\t\t\tenable_edit_view_ui: false\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tsetGridCellBackGround() {\n\t\t//Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar data = this.grid.getGridParam( 'data' );\n\t\t//Error: TypeError: data is undefined in /interface/html5/framework/jquery.min.js?v=7.4.6-20141027-074127 line 2 > eval line 70\n\t\tif ( !data ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar len = data.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar item = data[i];\n\n\t\t\tif ( item.status_id == 30 ) {\n\t\t\t\t$( 'tr#' + item.id ).addClass( 'bolder-request' );\n\t\t\t}\n\t\t}\n\t}\n\n\tonCancelClick( force, cancel_all, callback ) {\n\t\tTTPromise.add( 'base', 'onCancelClick' );\n\t\tvar $this = this;\n\n\t\t//#2571 - Unable to get property 'id' of undefined or null reference\n\t\tif ( this.current_edit_record && this.current_edit_record.id ) {\n\t\t\tvar $record_id = this.current_edit_record.id;\n\t\t}\n\n\t\tLocalCacheData.current_doing_context_action = 'cancel';\n\t\tif ( this.is_changed && !force ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\tdoNext();\n\t\t\t\t}\n\n\t\t\t} );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\tif ( !$this.edit_view && $this.parent_view_controller && $this.sub_view_mode ) {\n\t\t\t\t$this.parent_view_controller.is_changed = false;\n\t\t\t\t$this.parent_view_controller.buildContextMenu( true );\n\t\t\t\t$this.parent_view_controller.onCancelClick();\n\n\t\t\t} else {\n\t\t\t\tif ( $this.is_edit && $record_id ) {\n\t\t\t\t\t$this.setCurrentEditViewState( 'view' );\n\t\t\t\t\t$this.onViewClick( $record_id, true );\n\t\t\t\t\t$this.setEditMenu();\n\t\t\t\t} else {\n\t\t\t\t\t$this.removeEditView();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif ( callback ) {\n\t\t\t\tcallback();\n\t\t\t}\n\n\t\t\t$this.search(); //Refresh the grid, as we don't do that during authorize/decline clicks anymore.\n\n\t\t\tGlobal.setUIInitComplete();\n\t\t\tProgressBar.closeOverlay();\n\n\t\t\tTTPromise.resolve( 'base', 'onCancelClick' );\n\n\t\t}\n\n\t}\n\n\tonCloseIconClick() {\n\t\tthis.onCancelClick();\n\t}\n\n\tbuildDataForAPI( data ) {\n\t\tif ( this.viewId == 'RequestAuthorization' && ( !data.request_schedule_id || data.request_schedule_id <= 0 ) ) {\n\t\t\treturn data;\n\t\t}\n\n\t\tvar user_id = LocalCacheData.loginUser.id;\n\t\tif ( Global.isSet( this.current_edit_record.user_id ) ) {\n\t\t\tuser_id = this.current_edit_record.user_id;\n\t\t}\n\t\tvar data_for_api = { 'user_id': user_id };\n\t\tvar request_schedule = {};\n\n\t\tvar request_schedule_keys = '';\n\n\t\tvar afn = this.getAdvancedFieldNames();\n\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tif ( key == 'start_date' && this.edit_view_ui_dic[key] ) {\n\t\t\t\tdata_for_api.date_stamp = this.edit_view_ui_dic[key].getValue();\n\t\t\t}\n\n\t\t\tif ( afn.indexOf( key ) > -1 ) {\n\t\t\t\tif ( key == 'request_schedule_id' ) {\n\t\t\t\t\trequest_schedule['id'] = this.current_edit_record.request_schedule_id;\n\t\t\t\t} else if ( key == 'request_schedule_status_id' ) {\n\t\t\t\t\t//this case is for when asking for default data\n\t\t\t\t\trequest_schedule['status_id'] = this.edit_view_ui_dic.request_schedule_status_id.getValue();\n\t\t\t\t} else if ( this.edit_view_ui_dic[key] ) {\n\t\t\t\t\trequest_schedule[key] = this.edit_view_ui_dic[key].getValue();\n\t\t\t\t}\n\t\t\t} else if ( key == 'available_balance' || key == 'job_item_quick_search' || key == 'job_quick_search' ) {\n\t\t\t\t//ignore. these fields do not need to be saved and break the insert sql.\n\t\t\t} else {\n\t\t\t\tdata_for_api[key] = this.current_edit_record[key];\n\t\t\t}\n\t\t}\n\t\t//data_for_api['status_id'] = 30; //Manually set pending status -- This is done at the API automatically now.\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) && ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) ) {\n\t\t\tdata_for_api.request_schedule = { 0: request_schedule };\n\t\t}\n\t\treturn data_for_api;\n\t}\n\n\tbuildDataFromAPI( data ) {\n\t\tif ( Global.isSet( data ) && Global.isSet( data.request_schedule ) ) {\n\t\t\tfor ( var key in data.request_schedule ) {\n\t\t\t\tif ( key == 'id' ) {\n\t\t\t\t\tdata['request_schedule_id'] = data.request_schedule.id;\n\t\t\t\t} else if ( key == 'status_id' ) {\n\t\t\t\t\tdata['request_schedule_status_id'] = data.request_schedule.status_id;\n\t\t\t\t} else if ( typeof ( data[key] ) == 'undefined' ) {\n\t\t\t\t\tdata[key] = data.request_schedule[key];\n\t\t\t\t} else {\n\t\t\t\t\t//Debug.Text('Not overwriting: '+key+' request_schedule: '+data.request_schedule[key]+' request: '+data[key], 'RequestViewCommonController.js', 'RequestViewCommonController','buildDataFromAPI' ,10)\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tdelete data.request_schedule;\n\t\t\tthis.pre_request_schedule = false; //is this a request from before request schedule was added? we need to know if this is an \"old version\" request\n\t\t} else {\n\t\t\tthis.pre_request_schedule = true;\n\t\t}\n\n\t\tvar retval = $.extend( this.current_edit_record, data );\n\t\treturn retval;\n\t}\n\n\tshowAdvancedFields( update_schedule_total_time ) {\n\t\tif (\n\t\t\tGlobal.getProductEdition() >= 15 &&\n\t\t\t( PermissionManager.validate( 'request', 'add_advanced' )\n\t\t\t\t|| ( TTUUID.isUUID( this.current_edit_record.request_schedule_id ) && this.current_edit_record.request_schedule_id != TTUUID.zero_id && this.current_edit_record.request_schedule_id != TTUUID.not_exist_id ) )\n\t\t\t&& ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) && ( !this.pre_request_schedule || this.is_add )\n\t\t) {\n\t\t\tvar advanced_field_names = this.getAdvancedFieldNames();\n\t\t\tif ( this.edit_view_ui_dic ) {\n\t\t\t\tfor ( var i = 0; i < advanced_field_names.length; i++ ) {\n\t\t\t\t\tif ( advanced_field_names[i] == 'absence_policy_id' && this.edit_view_ui_dic.request_schedule_status_id && this.edit_view_ui_dic.request_schedule_status_id.getValue() != 20 ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif ( this.edit_view_ui_dic[advanced_field_names[i]] ) {\n\t\t\t\t\t\tif ( advanced_field_names[i] == 'branch_id' && !this.show_branch_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'department_id' && !this.show_department_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'job_id' && !this.show_job_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'job_item_id' && !this.show_job_item_ui ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else if ( advanced_field_names[i] == 'available_balance' && !this.is_viewing ) {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( this.edit_view_ui_dic.date ) {\n\t\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t}\n\n\t\t\t\tif ( this.edit_view_ui_dic.available_balance ) {\n\t\t\t\t\tif ( this.is_viewing == true && this.viewId == 'Request' ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( this.current_edit_record.type_id != 30 && this.current_edit_record.type_id != 40 ) {\n\t\t\t\t\tif ( this.edit_view_ui_dic.total_time ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( update_schedule_total_time != false ) {\n\t\t\t\t\t\tthis.getScheduleTotalTime();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.edit_view_ui_dic.date_stamp ) {\n\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).show();\n\t\t\t}\n\t\t\tthis.hideAdvancedFields();\n\t\t}\n\t}\n\n\thideAdvancedFields() {\n\t\tvar advanced_field_names = this.getAdvancedFieldNames();\n\t\tif ( this.edit_view_ui_dic ) {\n\t\t\tfor ( var i = 0; i < advanced_field_names.length; i++ ) {\n\t\t\t\tif ( this.edit_view_ui_dic[advanced_field_names[i]] ) {\n\t\t\t\t\tthis.edit_view_ui_dic[advanced_field_names[i]].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.edit_view_ui_dic.date ) {\n\t\t\t\tthis.edit_view_ui_dic.date.parents( '.edit-view-form-item-div' ).show();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAdvancedFieldNames() {\n\t\treturn [\n\t\t\t'request_id',\n\t\t\t'request_schedule_status_id',\n\t\t\t'request_schedule_id',\n\t\t\t'start_date',\n\t\t\t'end_date',\n\n\t\t\t'sun',\n\t\t\t'mon',\n\t\t\t'tue',\n\t\t\t'wed',\n\t\t\t'thu',\n\t\t\t'fri',\n\t\t\t'sat',\n\n\t\t\t'start_time',\n\t\t\t'end_time',\n\t\t\t'total_time',\n\n\t\t\t'schedule_policy_id',\n\t\t\t'absence_policy_id',\n\t\t\t'branch_id',\n\t\t\t'department_id',\n\t\t\t'job_id',\n\t\t\t'job_item_id',\n\n\t\t\t'schedule_policy',\n\t\t\t'absence_policy',\n\t\t\t'branch',\n\t\t\t'department',\n\t\t\t'job',\n\t\t\t'job_item',\n\t\t\t'available_balance'\n\t\t];\n\t}\n\n\tgetScheduleTotalTime() {\n\t\tif ( Global.getProductEdition() >= 15\n\t\t\t&& ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 )\n\t\t\t&& ( this.edit_view_ui_dic && this.edit_view_ui_dic['total_time'] )\n\t\t) {\n\n\t\t\tvar start_time = false;\n\t\t\tif ( this.current_edit_record['start_date'] && this.current_edit_record['start_time'] ) {\n\t\t\t\tstart_time = this.current_edit_record['start_date'] + ' ' + this.current_edit_record['start_time'];\n\t\t\t}\n\n\t\t\tvar end_time = false;\n\t\t\tif ( this.current_edit_record['start_date'] && this.current_edit_record['end_time'] ) {\n\t\t\t\tend_time = this.current_edit_record['start_date'] + ' ' + this.current_edit_record['end_time'];\n\t\t\t}\n\n\t\t\tvar schedulePolicyId = ( this.current_edit_record['schedule_policy_id'] ) ? this.current_edit_record['schedule_policy_id'] : null;\n\t\t\tvar user_id = this.current_edit_record.user_id;\n\n\t\t\tif ( typeof user_id == 'undefined' && LocalCacheData.getLoginUser().id ) {\n\t\t\t\tuser_id = LocalCacheData.getLoginUser().id;\n\t\t\t}\n\n\t\t\tif ( start_time && end_time ) {\n\t\t\t\tvar schedule_api = TTAPI.APISchedule;\n\t\t\t\tvar result = schedule_api.getScheduleTotalTime( start_time, end_time, schedulePolicyId, user_id, { async: false } );\n\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\tthis.total_time = result.getResult();\n\t\t\t\t} else {\n\t\t\t\t\tthis.total_time = 0;\n\t\t\t\t}\n\n\t\t\t\tthis.current_edit_record['total_time'] = this.total_time;\n\t\t\t\tvar total_time = Global.getTimeUnit( this.total_time );\n\t\t\t\tthis.edit_view_ui_dic['total_time'].setValue( total_time );\n\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).show();\n\t\t\t} else {\n\t\t\t\tif ( this.edit_view_ui_dic.total_time ) {\n\t\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.edit_view_ui_dic.total_time ) {\n\t\t\t\tthis.edit_view_ui_dic.total_time.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\n\t\tthis.onAvailableBalanceChange();\n\t}\n\n\tonWorkingStatusChanged() {\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\tif ( this.edit_view_ui_dic.request_schedule_status_id && this.edit_view_ui_dic.absence_policy_id ) {\n\t\t\t\tvar type_id = this.edit_view_ui_dic.type_id ? this.edit_view_ui_dic.type_id.getValue() : this.current_edit_record.type_id;\n\t\t\t\tthis.showAbsencePolicyField( type_id, this.edit_view_ui_dic.request_schedule_status_id.getValue(), this.edit_view_ui_dic.absence_policy_id );\n\t\t\t}\n\t\t}\n\t}\n\n\tshowAbsencePolicyField( type_id, request_schedule_status_id, ui_field ) {\n\t\tif ( request_schedule_status_id == 20 && ( type_id == 30 || type_id == 40 ) ) {\n\t\t\tui_field.parents( '.edit-view-form-item-div' ).show();\n\t\t\tif ( ( this.viewId == 'Request' && this.is_viewing ) == false ) {\n\t\t\t\tthis.onAvailableBalanceChange();\n\t\t\t}\n\t\t} else {\n\t\t\tui_field.parents( '.edit-view-form-item-div' ).hide();\n\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t}\n\t}\n\n\tonDateStampChanged() {\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\tthis.edit_view_ui_dic.start_date.setValue( this.current_edit_record.date_stamp );\n\t\t\tthis.current_edit_record.start_date = this.current_edit_record.date_stamp;\n\t\t}\n\t}\n\n\tonStartDateChanged() {\n\t\tthis.edit_view_ui_dic.date_stamp.setValue( this.current_edit_record.start_date );\n\t\tthis.current_edit_record.date_stamp = this.current_edit_record.start_date;\n\t}\n\n\tgetAvailableBalance() {\n\t\tif ( ( this.is_viewing && this.viewId == 'Request' ) || Global.isSet( this.current_edit_record ) == false ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ( this.viewId != 'Request' || this.is_viewing == false ) &&\n\t\t\tthis.current_edit_record.absence_policy_id &&\n\t\t\t( PermissionManager.validate( 'request', 'add_advanced' ) || ( TTUUID.isUUID( this.current_edit_record.request_schedule_id ) && this.current_edit_record.request_schedule_id != TTUUID.zero_id && this.current_edit_record.request_schedule_id != TTUUID.not_exist_id ) ) &&\n\t\t\tLocalCacheData.loginUser.id &&\n\t\t\tthis.current_edit_record.total_time &&\n\t\t\tthis.current_edit_record.total_time != '00:00' &&\n\t\t\tthis.current_edit_record.start_date ) {\n\n\t\t\tvar days = 1;\n\t\t\tif ( this.current_edit_record.start_date != this.current_edit_record.end_date ) {\n\t\t\t\tvar days = Global.getDaysInSpan( this.current_edit_record.start_date, this.current_edit_record.end_date, this.current_edit_record.sun, this.current_edit_record.mon, this.current_edit_record.tue, this.current_edit_record.wed, this.current_edit_record.thu, this.current_edit_record.fri, this.current_edit_record.sat );\n\t\t\t}\n\n\t\t\tvar $this = this;\n\t\t\tvar user_id = this.current_edit_record.user_id;\n\t\t\tvar total_time = this.current_edit_record.total_time * days;\n\t\t\tvar date_stamp = this.current_edit_record.date_stamp;\n\t\t\tvar policy_id = this.current_edit_record.absence_policy_id ? this.current_edit_record.absence_policy_id : 0;\n\n\t\t\tif ( user_id && date_stamp && total_time ) {\n\t\t\t\tthis.api_absence_policy.getProjectedAbsencePolicyBalance(\n\t\t\t\t\tpolicy_id,\n\t\t\t\t\tuser_id,\n\t\t\t\t\tdate_stamp,\n\t\t\t\t\ttotal_time,\n\t\t\t\t\t{\n\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\tif ( $this.edit_view_ui_dic && $this.edit_view_ui_dic.available_balance ) {\n\t\t\t\t\t\t\t\t$this.getBalanceHandler( result, date_stamp );\n\t\t\t\t\t\t\t\tif ( result && $this.selected_absence_policy_record ) {\n\t\t\t\t\t\t\t\t\t$this.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).show();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$this.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\t// If unset or set to --None--...\n\t\t} else if ( this.current_edit_record.absence_policy_id == false || this.current_edit_record.absence_policy_id == TTUUID.zero_id ) {\n\t\t\tif ( this.edit_view_ui_dic.available_balance ) {\n\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFilterColumnsFromDisplayColumns( authorization_history ) {\n\t\t// Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tvar display_columns = [];\n\t\tif ( authorization_history ) {\n\t\t\tif ( this.authorization_history.authorization_history_grid ) {\n\t\t\t\tdisplay_columns = AuthorizationHistory.getAuthorizationHistoryDefaultDisplayColumns();\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.grid ) {\n\t\t\t\tdisplay_columns = this.grid.getGridParam( 'colModel' );\n\t\t\t}\n\t\t}\n\t\tvar column_filter = {};\n\t\tcolumn_filter.is_owner = true;\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.is_child = true;\n\t\tcolumn_filter.in_use = true;\n\t\tcolumn_filter.first_name = true;\n\t\tcolumn_filter.last_name = true;\n\t\tcolumn_filter.user_id = true;\n\t\tcolumn_filter.status_id = true;\n\n\t\tif ( display_columns ) {\n\t\t\tvar len = display_columns.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar column_info = display_columns[i];\n\t\t\t\tcolumn_filter[column_info.name] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tjobUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'job', 'enabled' ) &&\n\t\t\tPermissionManager.validate( 'punch', 'edit_job' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tjobItemUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_job_item' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbranchUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_branch' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdepartmentUIValidate() {\n\t\t//use punch permission section rather than schedule permission section as that's what they can see when they're creating punches\n\t\tif ( PermissionManager.validate( 'punch', 'edit_department' ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprocessAPICallbackResult( result_data ) {\n\t\tthis.current_edit_record = this.buildDataFromAPI( result_data[0] );\n\t\tthis.current_edit_record.total_time = Global.getTimeUnit( this.current_edit_record.total_time );\n\n\t\treturn result_data;\n\t}\n\n\tdoViewClickResult( result_data ) {\n\t\tif ( Global.isSet( this.current_edit_record.start_date ) && this.edit_view_tab ) {\n\t\t\tthis.edit_view_tab.find( '#tab_request' ).find( '.third-column' ).show();\n\t\t}\n\n\t\tthis.initEditView();\n\t\tthis.initViewingView();\n\n\t\t//This line is required to avoid problems with the absence policy box not showing properly on initial load.\n\t\tthis.onWorkingStatusChanged();\n\n\t\tvar $this = this;\n\t\tEmbeddedMessage.init( this.current_edit_record.id, 50, this, this.edit_view, this.edit_view_tab, this.edit_view_ui_dic, function() {\n\t\t\t$this.authorization_history = AuthorizationHistory.init( $this );\n\t\t} );\n\t\treturn this.clearCurrentSelectedRecord();\n\t}\n\n\tonViewClick( edit_record, clear_edit_view ) {\n\t\tif ( clear_edit_view ) {\n\t\t\tthis.clearEditView();\n\t\t}\n\t\tsuper.onViewClick( edit_record );\n\t}\n\n\tsetSubLogViewFilter() {\n\t\tif ( !this.sub_log_view_controller ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.sub_log_view_controller.getSubViewFilter = function( filter ) {\n\t\t\tfilter['table_name_object_id'] = {\n\t\t\t\t'request': [this.parent_edit_record.id],\n\t\t\t\t'request_schedule': [this.parent_edit_record.request_schedule_id]\n\t\t\t};\n\n\t\t\treturn filter;\n\t\t};\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * This function exists because the edit form is not actually an edit mode form, so we need to do some\n\t * stuff differently in view mode than in edit mode.\n\t */\n\tinitViewingView() {\n\t\tthis.showAdvancedFields();\n\t}\n\n\tinitEditViewUI( view_id, edit_view_file_name ) {\n\t\tGlobal.setUINotready();\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\t\tvar $this = this;\n\n\t\tif ( this.edit_view ) {\n\t\t\tthis.edit_view.remove();\n\t\t}\n\n\t\tthis.edit_view = $( Global.loadViewSource( view_id, edit_view_file_name, null, true ) );\n\t\tthis.edit_view_tab = $( this.edit_view.find( '.edit-view-tab-bar' ) );\n\n\t\t//Give edt view tab a id, so we can load it when put right click menu on it\n\t\tthis.edit_view_tab.attr( 'id', this.ui_id + '_edit_view_tab' );\n\n\t\tthis.setTabOVisibility( false );\n\n\t\tthis.edit_view_tab = this.edit_view_tab.tabs( {\n\t\t\tactivate: function( e, ui ) {\n\t\t\t\t$this.onTabShow( e, ui );\n\t\t\t}\n\t\t} );\n\n\t\tthis.edit_view_tab.bind( 'tabsselect', function( e, ui ) {\n\t\t\t$this.onTabIndexChange( e, ui );\n\t\t} );\n\n\t\tGlobal.contentContainer().append( this.edit_view );\n\t\tthis.initRightClickMenu( RightClickMenuType.EDITVIEW );\n\n\t\tif ( this.is_viewing ) {\n\t\t\tLocalCacheData.current_doing_context_action = 'view';\n\t\t\tthis.buildViewUI();\n\t\t} else if ( this.is_edit ) {\n\t\t\tLocalCacheData.current_doing_context_action = 'edit';\n\t\t\tthis.buildEditViewUI();\n\t\t}\n\n\t\t$this.setEditViewTabHeight();\n\t}\n\n\tonEditClick( editId, noRefreshUI ) {\n\t\tthis.setCurrentEditViewState( 'edit' );\n\t\tthis.initEditViewUI( this.viewId, this.edit_view_tpl );\n\t\tthis.initEditView();\n\t\t//Clear last sent message body value.\n\t\tthis.edit_view_ui_dic.body.setValue( '' );\n\t\t//ensure send button is available\n\t\tthis.setEditMenu();\n\t}\n\n\tbuildViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_request': { 'label': $.i18n._( 'Request' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIRequest,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_request',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\n\t\t//Tab 0 first column start\n\t\tvar tab_request = this.edit_view_tab.find( '#tab_request' );\n\t\tvar tab_request_column1 = tab_request.find( '.first-column' );\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_request_column1 );\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'full_name' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_request_column1 );\n\n\t\t// Type\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'type', set_empty: false } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_request_column1 );\n\n\t\t// Date\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'date_stamp' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_request_column1 );\n\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\n\t\t\t//Working Status\n\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\tform_item_input.TComboBox( { field: 'request_schedule_status_id', set_empty: false } );\n\t\t\tform_item_input.setSourceData( { 10: 'Working', 20: 'Absent' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_request_column1 );\n\t\t\tform_item_input.bind( 'change', function( e ) {\n\t\t\t\t$this.onWorkingStatusChanged();\n\t\t\t} );\n\n\t\t\t//Start Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t//End  Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t// Effective Days\n\t\t\tvar form_item_sun_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sun_checkbox.TCheckbox( { field: 'sun' } );\n\n\t\t\tvar form_item_mon_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_mon_checkbox.TCheckbox( { field: 'mon' } );\n\n\t\t\tvar form_item_tue_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_tue_checkbox.TCheckbox( { field: 'tue' } );\n\n\t\t\tvar form_item_wed_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_wed_checkbox.TCheckbox( { field: 'wed' } );\n\n\t\t\tvar form_item_thu_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_thu_checkbox.TCheckbox( { field: 'thu' } );\n\n\t\t\tvar form_item_fri_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_fri_checkbox.TCheckbox( { field: 'fri' } );\n\n\t\t\tvar form_item_sat_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sat_checkbox.TCheckbox( { field: 'sat' } );\n\n\t\t\twidgetContainer = $( '<div></div>' );\n\n\t\t\tvar sun = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sun' ) + ' <br> ' + ' </span>' );\n\t\t\tvar mon = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Mon' ) + ' <br> ' + ' </span>' );\n\t\t\tvar tue = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Tue' ) + ' <br> ' + ' </span>' );\n\t\t\tvar wed = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Wed' ) + ' <br> ' + ' </span>' );\n\t\t\tvar thu = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Thu' ) + ' <br> ' + ' </span>' );\n\t\t\tvar fri = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Fri' ) + ' <br> ' + ' </span>' );\n\t\t\tvar sat = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sat' ) + ' <br> ' + ' </span>' );\n\n\t\t\tsun.append( form_item_sun_checkbox );\n\t\t\tmon.append( form_item_mon_checkbox );\n\t\t\ttue.append( form_item_tue_checkbox );\n\t\t\twed.append( form_item_wed_checkbox );\n\t\t\tthu.append( form_item_thu_checkbox );\n\t\t\tfri.append( form_item_fri_checkbox );\n\t\t\tsat.append( form_item_sat_checkbox );\n\n\t\t\twidgetContainer.append( sun );\n\t\t\twidgetContainer.append( mon );\n\t\t\twidgetContainer.append( tue );\n\t\t\twidgetContainer.append( wed );\n\t\t\twidgetContainer.append( thu );\n\t\t\twidgetContainer.append( fri );\n\t\t\twidgetContainer.append( sat );\n\n\t\t\twidgetContainer.addClass( 'request_edit_view_effective_days' );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Effective Days' ), [form_item_sun_checkbox, form_item_mon_checkbox, form_item_tue_checkbox, form_item_wed_checkbox, form_item_thu_checkbox, form_item_fri_checkbox, form_item_sat_checkbox], tab_request_column1, '', widgetContainer, false, true );\n\n\t\t\t//Start time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'start_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'In' ), form_item_input, tab_request_column1 );\n\n\t\t\t//End  time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'end_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Out' ), form_item_input, tab_request_column1 );\n\n\t\t\t// Total\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'total_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Total' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Schedule Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APISchedulePolicy,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_schedule',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'schedule_policy_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Schedule Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Absence Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIAbsencePolicy,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_absences',\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'absence_policy_id',\n\t\t\t\tcustomSearchFilter: function( filter ) {\n\t\t\t\t\treturn $this.setAbsencePolicyFilter( filter );\n\t\t\t\t},\n\t\t\t\tsetRealValueCallBack: function( value ) {\n\t\t\t\t\t// #2135 fix for cases where user is removed from absence policies between creating request and approval\n\t\t\t\t\t$this.selected_absence_policy_record = value;\n\t\t\t\t\t$this.onAvailableBalanceChange();\n\t\t\t\t}\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Absence Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Available Balance\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'available_balance' } );\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\tthis.available_balance_info = $( '<img class=\"available-balance-info\" src=\"' + Global.getRealImagePath( 'images/infox16x16.png' ) + '\">' );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\twidgetContainer.append( this.available_balance_info );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Available Balance' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\n\t\t\t//branch\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'branch_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Branch' ), form_item_input, tab_request_column1 );\n\t\t\tif ( !this.show_branch_ui ) {\n\t\t\t\tthis.detachElement( 'branch_id' );\n\t\t\t}\n\n\t\t\t//Dept\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'department_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Department' ), form_item_input, tab_request_column1 );\n\t\t\tif ( !this.show_department_ui ) {\n\t\t\t\tthis.detachElement( 'department_id' );\n\t\t\t}\n\n\t\t\tif ( Global.getProductEdition() >= 20 ) {\n\t\t\t\t//Job\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJob,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_ui ) {\n\t\t\t\t\tthis.detachElement( 'job_id' );\n\t\t\t\t}\n\n\t\t\t\t//Job Item\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job_item',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_item_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_item_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_item_ui ) {\n\t\t\t\t\tthis.detachElement( 'job_item_id' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tEmbeddedMessage.initUI( this, tab_request );\n\t}\n\n\tsetAbsencePolicyFilter( filter ) {\n\t\tif ( !filter.filter_data ) {\n\t\t\tfilter.filter_data = {};\n\t\t}\n\t\tfilter.filter_data.user_id = this.current_edit_record.user_id;\n\n\t\tif ( filter.filter_columns ) {\n\t\t\tfilter.filter_columns.absence_policy = true;\n\t\t}\n\t\treturn filter;\n\t}\n\n\tneedShowNavigation() {\n\t\tif ( this.is_viewing && this.current_edit_record && Global.isSet( this.current_edit_record.id ) && this.current_edit_record.id ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tonNavigationClick( iconName ) {\n\n\t\tvar $this = this;\n\t\tvar filter;\n\t\tvar temp_filter;\n\t\tvar grid_selected_id_array;\n\t\tvar grid_selected_length;\n\n\t\tvar selectedId;\n\t\t/* jshint ignore:start */\n\t\tswitch ( iconName ) {\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\tfilter = { filter_data: {} };\n\t\t\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\n\t\t\t\t\tfilter.user_id = this.current_edit_record.user_id ? this.current_edit_record.user_id : LocalCacheData.loginUser.id;\n\t\t\t\t\tfilter.base_date = this.current_edit_record.date_stamp;\n\n\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\n\t\t\t\t} else {\n\t\t\t\t\ttemp_filter = {};\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\n\t\t\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\t\t\ttemp_filter.filter_data = {};\n\t\t\t\t\t\ttemp_filter.filter_columns = { user_id: true, date_stamp: true };\n\t\t\t\t\t\ttemp_filter.filter_data.id = [selectedId];\n\n\t\t\t\t\t\tthis.api['get' + this.api.key_name]( temp_filter, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\t\t\tfilter.user_id = result_data.user_id;\n\t\t\t\t\t\t\t\tfilter.base_date = result_data.date_stamp;\n\t\t\t\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\tfilter = { filter_data: {} };\n\t\t\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\t\t\t\t\tIndexViewController.openEditView( this, 'Employee', this.current_edit_record.user_id ? this.current_edit_record.user_id : LocalCacheData.loginUser.id );\n\t\t\t\t} else {\n\t\t\t\t\ttemp_filter = {};\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\n\t\t\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\t\t\ttemp_filter.filter_data = {};\n\t\t\t\t\t\ttemp_filter.filter_columns = { user_id: true };\n\t\t\t\t\t\ttemp_filter.filter_data.id = [selectedId];\n\n\t\t\t\t\t\tthis.api['get' + this.api.key_name]( temp_filter, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\t\t\tIndexViewController.openEditView( $this, 'Employee', result_data.user_id );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.schedule:\n\n\t\t\t\tfilter = { filter_data: {} };\n\n\t\t\t\tvar include_users = null;\n\n\t\t\t\tif ( Global.isSet( this.current_edit_record ) ) {\n\n\t\t\t\t\tinclude_users = [this.current_edit_record.user_id ? this.current_edit_record.user_id : LocalCacheData.loginUser.id];\n\t\t\t\t\tfilter.filter_data.include_user_ids = { value: include_users };\n\t\t\t\t\tfilter.select_date = this.current_edit_record.date_stamp;\n\n\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\tIndexViewController.goToView( 'Schedule', filter );\n\n\t\t\t\t} else {\n\t\t\t\t\ttemp_filter = {};\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\n\t\t\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\t\t\ttemp_filter.filter_data = {};\n\t\t\t\t\t\ttemp_filter.filter_columns = { user_id: true, date_stamp: true };\n\t\t\t\t\t\ttemp_filter.filter_data.id = [selectedId];\n\n\t\t\t\t\t\tthis.api['get' + this.api.key_name]( temp_filter, {\n\t\t\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\t\t\t\t\tinclude_users = [result_data.user_id];\n\n\t\t\t\t\t\t\t\tfilter.filter_data.include_user_ids = include_users;\n\t\t\t\t\t\t\t\tfilter.select_date = result_data.date_stamp;\n\n\t\t\t\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - Request' ), window.location.href );\n\t\t\t\t\t\t\t\tIndexViewController.goToView( 'Schedule', filter );\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\t/* jshint ignore:end */\n\t}\n\n\tinitPermission() {\n\t\tif ( PermissionManager.validate( this.permission_id, 'view' ) || PermissionManager.validate( this.permission_id, 'view_child' ) ) {\n\t\t\tthis.show_search_tab = true;\n\t\t} else {\n\t\t\tthis.show_search_tab = false;\n\t\t}\n\n\t\tif ( this.jobUIValidate() ) {\n\t\t\tthis.show_job_ui = true;\n\t\t} else {\n\t\t\tthis.show_job_ui = false;\n\t\t}\n\n\t\tif ( this.jobItemUIValidate() ) {\n\t\t\tthis.show_job_item_ui = true;\n\t\t} else {\n\t\t\tthis.show_job_item_ui = false;\n\t\t}\n\n\t\tif ( this.branchUIValidate() ) {\n\t\t\tthis.show_branch_ui = true;\n\t\t} else {\n\t\t\tthis.show_branch_ui = false;\n\t\t}\n\n\t\tif ( this.departmentUIValidate() ) {\n\t\t\tthis.show_department_ui = true;\n\t\t} else {\n\t\t\tthis.show_department_ui = false;\n\t\t}\n\n\t\t// Error: Uncaught TypeError: (intermediate value).isBranchAndDepartmentAndJobAndJobItemEnabled is not a function on line 207\n\t\tvar company_api = TTAPI.APICompany;\n\t\tif ( company_api && _.isFunction( company_api.isBranchAndDepartmentAndJobAndJobItemEnabled ) ) {\n\t\t\tvar result = company_api.isBranchAndDepartmentAndJobAndJobItemEnabled( { async: false } ).getResult();\n\t\t}\n\n\t\tif ( !result ) {\n\t\t\tthis.show_branch_ui = false;\n\t\t\tthis.show_department_ui = false;\n\t\t\tthis.show_job_ui = false;\n\t\t\tthis.show_job_item_ui = false;\n\t\t} else {\n\t\t\tif ( !result.branch ) {\n\t\t\t\tthis.show_branch_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.department ) {\n\t\t\t\tthis.show_department_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.job ) {\n\t\t\t\tthis.show_job_ui = false;\n\t\t\t}\n\n\t\t\tif ( !result.job_item ) {\n\t\t\t\tthis.show_job_item_ui = false;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tsetEditMenuEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\t//If edit_child is FALSE and this is a child record, inputs should be read-only.\n\t\tif ( this.editOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tthis.enable_edit_view_ui = true;\n\t\t} else {\n\t\t\tthis.enable_edit_view_ui = false;\n\t\t}\n\n\t\tif ( !this.editOwnerOrChildPermissionValidate( pId ) || this.is_add || this.is_edit ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\t// Creates the record shipped to the API at setMesssage\n\tuniformMessageVariable( records ) {\n\t\tvar msg = {};\n\n\t\tmsg.subject = this.edit_view_ui_dic['subject'].getValue();\n\t\tmsg.body = this.edit_view_ui_dic['body'].getValue();\n\t\tmsg.object_id = this.current_edit_record['id'];\n\t\tmsg.object_type_id = 50;\n\n\t\treturn msg;\n\t}\n\n}\n"],"sourceRoot":""}