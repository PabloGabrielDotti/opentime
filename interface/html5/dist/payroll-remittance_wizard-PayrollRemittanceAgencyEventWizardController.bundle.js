(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["payroll-remittance_wizard-PayrollRemittanceAgencyEventWizardController","payroll-remittance_wizard-PayrollRemittanceAgencyEventWizard","wizard-Wizard"],{3207:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{"Wizard":()=>Wizard});var _views_TTBackboneView__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6739);class Wizard extends _views_TTBackboneView__WEBPACK_IMPORTED_MODULE_0__.TTBackboneView{constructor(e={}){_.defaults(e,{current_step:!1,wizard_id:"generic_wizard",wizard_name:$.i18n._("Wizard"),step_history:{},step_objects:{},el:$(".wizard"),previous_wizard:null,_step_map:null,do_not_initialize_onload:!1,external_data:null,events:{"click .close-btn":"onCloseClick","click .close-icon":"onCloseClick","click .wizard-overlay.onclick-close":"onCloseClick","click .forward-btn":"onNextClick","click .back-btn":"onPrevClick","click .done-btn":"onDone"}}),super(e)}initialize(e){if(super.initialize(e),e&&e.external_data&&this.setExternalData(e.external_data),!this.do_not_initialize_onload){this.step_history={},this.step_objects={};var t=this;this.initStepObject(this.getCurrentStepName()?this.getCurrentStepName():"home",(function(e){t.init(),t.render(),t.enableButtons(),LocalCacheData.current_open_wizard_controller?t.previous_wizard=LocalCacheData.current_open_wizard_controller:t.previous_wizard=!1,LocalCacheData.current_open_wizard_controller=t}))}}init(){}setExternalData(e){this.external_data=e}getExternalData(){return this.external_data}onNextClick(e){if(1==this.button_click_procesing)return!1;if(0==$(e.target).hasClass("disable-image")){this.disableButtons();var t=this.getStepObject().getNextStepName(),a=this;this.initStepObject(t,(function(e){e.setPreviousStepName(a.getCurrentStepName()),a.setCurrentStepName(t)}))}}onPrevClick(e){if(1==this.button_click_procesing)return!1;if(!0===e||0==$(e.target).hasClass("disable-image")){this.disableButtons();var t=this.getStepObject().getPreviousStepName(),a=this;this.initStepObject(t,(function(e){a.setCurrentStepName(t)}))}}onCloseClick(e){if(!e||0==$(e.target).hasClass("disable-image")){var t=this;!1!==this.getStepObject().getPreviousStepName()&&!1!==this.getStepObject().getNextStepName()?TAlertManager.showConfirmAlert($.i18n._("Are you sure you wish to cancel without completing all steps for this event?"),null,(function(e){!0===e&&t.cleanUp()})):0==this.getStepObject().getNextStepName()?0==this.getStepObject().isRequiredButtonsClicked()?TAlertManager.showConfirmAlert($.i18n._("<strong>WARNING</strong>: You are about to cancel without performing all required actions on this step! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>"),null,(function(e){!0===e&&t.cleanUp()})):TAlertManager.showConfirmAlert($.i18n._("Are you sure you wish to cancel without marking this event as completed?"),null,(function(e){!0===e&&t.cleanUp()})):t.cleanUp()}}onDone(e){if(!e||0==$(e.target).hasClass("disable-image")){var t=this;0==this.getStepObject().getNextStepName()&&0==this.getStepObject().isRequiredButtonsClicked()?TAlertManager.showConfirmAlert($.i18n._("<strong>WARNING</strong>: You are about to mark this event as completed without performing all required actions on this step! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>"),null,(function(e){!0===e&&t.onDoneComplete()})):t.onDoneComplete()}}onDoneComplete(e){$this.cleanUp()}addStepObject(e,t){return this.step_objects[e]=t,this.step_objects[e]}getStepObject(e){return void 0===e&&(e=this.getCurrentStepName()),"object"==typeof this.step_objects[e]?this.step_objects[e]:this.step_objects.home}getCurrentStepName(){return this.current_step}setCurrentStepName(e){this.current_step=e}render(){}cleanUp(){for(var e in $(this.el).remove(),this.step_objects)this.step_objects[e]&&(this.step_objects[e].reload=!0);LocalCacheData.current_open_wizard_controller=null,$().TFeedback({source:this.wizard_id})}initStepObject(name,callback){if(this._step_map.hasOwnProperty(name)){if(null==this.step_objects[name]||"object"!=typeof this.step_objects[name]){var $this=this;return void Global.loadScript(this._step_map[name].script_path,(function(){$this.setCurrentStepName(name),$($this.el).find(".content").html("");var obj=eval("new "+$this._step_map[name].object_name+"( $this );");obj.reload=!1,$this.addStepObject(name,obj),"function"==typeof callback&&callback(obj)}))}if(this.setCurrentStepName(name),"function"==typeof callback){var obj=this.step_objects[name];$(this.el).find(".content").html("");var obj=eval("new "+this._step_map[name].object_name+"( this );");1==this.step_objects[name].reload&&(obj.clicked_buttons={},obj.reload=!1),this.addStepObject(name,obj),callback(obj)}}else;}disableButtons(){this.button_click_procesing=!0}enableButtons(){var e=this.getStepObject();"string"!=typeof e.getNextStepName()?($(this.el).find(".forward-btn").addClass("disable-image"),$(this.el).find(".done-btn").removeClass("disable-image")):($(this.el).find(".forward-btn").removeClass("disable-image"),$(this.el).find(".done-btn").addClass("disable-image")),"string"!=typeof e.getPreviousStepName()?$(this.el).find(".back-btn").addClass("disable-image"):$(this.el).find(".back-btn").removeClass("disable-image"),this._enableButtons(),this.button_click_procesing=!1}_enableButtons(){}minimize(){LocalCacheData.PayrollRemittanceAgencyEventWizard=this,Global.addViewTab(this.wizard_id,this.wizard_name,window.location.href),this.delegateEvents(),$(this.el).remove()}reload(){for(var e in this.step_objects)this.step_objects[e].reload=!0}disableForCommunity(e){Global.getProductEdition()<=10?TAlertManager.showAlert(Global.getUpgradeMessage(),$.i18n._("Denied")):"function"==typeof e&&e()}}},7591:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"PayrollRemittanceAgencyEventWizard":()=>n});var i=a(3207);class n extends i.Wizard{constructor(e={}){_.defaults(e,{current_step:!1,wizard_name:$.i18n._("Tax Wizard"),selected_remittance_agency_event:null,selected_remittance_agency_event_id:null,payroll_remittance_agency_event_block:null,wizard_id:"PayrollRemittanceAgencyEventWizard",_step_map:{"home":{script_path:"views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepHome.js",object_name:"PayrollRemittanceAgencyEventWizardStepHome"},"review":{script_path:"views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepReview.js",object_name:"PayrollRemittanceAgencyEventWizardStepReview"},"submit":{script_path:"views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepSubmit.js",object_name:"PayrollRemittanceAgencyEventWizardStepSubmit"},"publish":{script_path:"views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizardStepPublish.js",object_name:"PayrollRemittanceAgencyEventWizardStepPublish"}}}),super(e)}init(){}render(){}onNextClick(e){if(this.getStepObject().grid){var t=this.getStepObject().grid.getRowData(this.getStepObject().grid.getSelectedRow());t.in_time_period&&1==t.in_time_period?TAlertManager.showConfirmAlert($.i18n._("Time period for this event has not ended yet, are you sure you want to process this event early?"),null,(t=>{!0===t&&super.onNextClick(e)})):super.onNextClick(e)}else super.onNextClick(e);return null}buildEventDataBlock(e,t){$("#"+e).remove();var a=$("<div id='"+e+"' class='payroll_remittance_agency_event_wizard_event_details'><table></table></div>");this.getStepObject(this.getCurrentStepName()).append(a);if(null==this.payroll_remittance_agency_event_block){for(var i=[{key:"legal_entity_legal_name",title:$.i18n._("Legal Entity")},{key:"payroll_remittance_agency_name",title:$.i18n._("Agency")},{key:"type",title:$.i18n._("Event")}],n=[{key:"frequency",title:$.i18n._("Frequency")},{key:"time_period",title:$.i18n._("Time Period")},{key:"due_date",title:$.i18n._("Due Date")}],r=i.length>n.length?i.length:n.length,l=0;l<r;l++){var s=$("<tr></tr>");if(i.length>l)(o=$('<td class="label col1"></td>')).html(i[l].title+":"),(c=$('<td class="value"></td>')).html(t[i[l].key]),s.append(o),s.append(c);else s.append($("<td></td>")),s.append($("<td></td>"));if(n.length>l){var o;(o=$('<td class="label col2"></td>')).html(n[l].title+":");var c=$('<td class="value"></td>');"time_period"==n[l].key?c.html(t.start_date+" - "+t.end_date):c.html(t[n[l].key]),s.append(o),s.append(c)}else s.append($("<td></td>")),s.append($("<td></td>"));$("#"+e+" table").append(s)}if(t.in_time_period&&1==t.in_time_period){s=$("<tr></tr>");var _=$('<td align="center" style="font-weight: bold; color: red;" colspan="4"></td>');_.html($.i18n._("WARNING: Time period has not ended yet, you may be processing early.")),s.append(_),$("#"+e+" table").append(s)}this.payroll_remittance_agency_event_block=$("#"+e+" table").html()}else $("#"+e+" table").html(this.payroll_remittance_agency_event_block)}getPayrollRemittanceAgencyEventById(e,t,a){if("function"==typeof a&&this.selected_remittance_agency_event&&this.selected_remittance_agency_event.id==e)a(this.selected_remittance_agency_event);else{var i={filter_data:{id:this.selected_remittance_agency_event_id}};null==t||void 0===t?i.filter_columns={"payroll_remittance_agency_id":!0,"legal_entity_legal_name":!0,"payroll_remittance_agency_name":!0,"user_report_data_id":!0,"status":!0,"status_id":!0,"type":!0,"type_id":!0,"frequency":!0,"start_date":!0,"end_date":!0,"due_date":!0,"in_time_period":!0}:i.columns=t;TTAPI.APIPayrollRemittanceAgencyEvent.getPayrollRemittanceAgencyEvent(i,{onResult:function(e){e=e.getResult()[0];TTAPI.APIPayrollRemittanceAgency.getPayrollRemittanceAgency({filter_data:{id:e.payroll_remittance_agency_id}},{onResult:function(t){e.payroll_remittance_agency_obj=t.getResult()[0],"function"==typeof a&&a(e)}})}})}}getReport(e,t){t||(t={0:this.selected_remittance_agency_event_id,1:e}),Global.APIFileDownload("APIPayrollRemittanceAgencyEvent","getReportData",t)}showHTMLReport(e,t){ProgressBar.showOverlay(),TTAPI.APIPayrollRemittanceAgencyEvent.getReportData(this.selected_remittance_agency_event_id,"html",{onResult:function(e){if(ProgressBar.closeOverlay(),e.isValid()){var a=e.getResult();if(t){var i=window.open();i.document.writeln(a.api_retval),i.document.close()}else a&&IndexViewController.openWizard("ReportViewWizard",a.api_retval)}else TAlertManager.showErrorAlert(e)}})}onDoneComplete(e){var t=this;this.getPayrollRemittanceAgencyEventById(this.selected_remittance_agency_event_id,{},(function(e){e&&(e.enable_recalculate_dates=1,e.last_due_date=e.due_date,TTAPI.APIPayrollRemittanceAgencyEvent.setPayrollRemittanceAgencyEvent(e,!1,!0,{onResult:function(e){t.cleanUp()}}))}))}}},5095:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"PayrollRemittanceAgencyEventWizardController":()=>n});var i=a(7591);class n extends BaseWindowController{constructor(e={}){_.defaults(e,{el:".wizard-bg",wizard_obj:null}),super(e)}init(){var e="PayrollRemittanceAgencyEventWizard";!this.wizard_obj&&LocalCacheData[e]?(this.wizard_obj=LocalCacheData[e],this.wizard_obj.init(),this.wizard_obj.setElement($(".tax_wizard")),delete LocalCacheData[e]):this.wizard_obj=new i.PayrollRemittanceAgencyEventWizard({el:$(".tax_wizard")})}}}}]);
//# sourceMappingURL=payroll-remittance_wizard-PayrollRemittanceAgencyEventWizardController.bundle.js.map?v=776dcd84b301fb7c456a