(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["reports-ReportBaseViewController"],{7867:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"ReportBaseViewController":()=>o});var a=i(121),r=i(9490);class o extends a.BaseViewController{constructor(e={}){_.defaults(e,{view_file:"",page_orientation_array:null,font_size_array:null,auto_refresh_array:null,chart_display_mode_array:null,chart_type_array:null,templates_array:null,setup_fields_array:null,log_action_id_array:null,log_table_name_id_array:null,time_period_array:null,visible_report_widgets:null,visible_report_values:null,visible_report_widgets_order_fix:null,status_id_array:null,api_user_report:null,current_saved_report:null,saved_report_array:null,sub_saved_report_view_controller:null,sub_custom_column_view_controller:null,need_refresh_display_columns:!1,ReportMissedField:null,include_form_setup:!1,show_empty_message:!1,do_validate_after_create_ui:!1,form_setup_changed:!1}),super(e)}preInit(e){this.preInitReport()}init(e){this.real_this=this.constructor.__super__,this.permission_id="report",LocalCacheData.current_open_report_controller=this;var t=this;t.api_user_report=TTAPI.APIUserReportData,t.initReport(),t.buildContextMenu(),TTPromise.resolve("Reports","openReport"),t.postInitReport()}preInitReport(e){}initReport(e){}postInitReport(e){}render(){}processFilterField(){}getDefaultReport(e){var t=_.find(e,(function(e){return!0===e.is_default}));return e&&e.length>0&&!t&&(t=e[0]),t}getDefaultContextMenuModel(){var e={groups:{editor:{label:$.i18n._("Editor"),id:"editor"},saved_report:{label:$.i18n._("Saved Report"),id:this.viewId+"SavedReport"}},"icons":{}};return e.icons[ContextMenuIconName.view_html]={label:$.i18n._("View"),id:ContextMenuIconName.view_html,group:"editor",icon:Icons.view},e.icons[ContextMenuIconName.view]={label:$.i18n._("PDF"),id:ContextMenuIconName.view,group:"editor",icon:Icons.print},e.icons[ContextMenuIconName.export_excel]={label:$.i18n._("Excel"),id:ContextMenuIconName.export_excel,group:"editor",icon:Icons.export_excel,sort_order:1800},e.icons[ContextMenuIconName.cancel]={label:$.i18n._("Cancel"),id:ContextMenuIconName.cancel,group:"editor",icon:Icons.cancel,sort_order:1990},e.icons[ContextMenuIconName.save_existed_report]={label:$.i18n._("Save"),id:ContextMenuIconName.save_existed_report,group:"saved_report",icon:Icons.save},e.icons[ContextMenuIconName.save_new_report]={label:$.i18n._("Save as New"),id:ContextMenuIconName.save_new_report,group:"saved_report",icon:Icons.save_and_new},e}setDefaultMenuExportIcon(e,t,i){}openEditView(){var e=this,t=e.context_menu_array;this.initOptions((function(){e.processFilterField(),e.edit_view||e.initEditViewUI(e.viewId,e.view_file),e.context_menu_array=t,e.do_validate_after_create_ui=!0,TTPromise.wait("init","init",(function(){LocalCacheData.default_edit_id_for_next_open_edit_view?(e.navigation.setValue(LocalCacheData.default_edit_id_for_next_open_edit_view),e.api_user_report.getUserReportData({filter_data:{id:LocalCacheData.default_edit_id_for_next_open_edit_view}},{onResult:function(t){t=t.getResult(),e.current_saved_report=t[0],e.current_edit_record={},e.visible_report_values={},LocalCacheData.default_edit_id_for_next_open_edit_view=null,e.initEditView()}})):e.api_user_report.getUserReportData({filter_data:{script:e.script_name,is_default:!0}},{onResult:function(t){var i=t.getResult();e.current_saved_report={},i&&i.length>0&&(e.current_saved_report=i[0]),e.current_edit_record={},e.visible_report_values={},e.initEditView()}})}))}))}setDefaultConfigData(){var e=this;this.api.getOtherConfig({onResult:function(t){if(e.current_saved_report&&e.current_saved_report.data&&e.current_saved_report.data.config&&e.current_saved_report.data.config.other);else for(var i in t=t.getResult())e.edit_view_ui_dic.hasOwnProperty(i)&&(e.edit_view_ui_dic[i].setValue(t[i]),e.current_edit_record[i]=t[i])}}),this.api.getChartConfig({onResult:function(t){if(e.current_saved_report&&e.current_saved_report.data&&e.current_saved_report.data.config&&e.current_saved_report.data.config.chart);else for(var i in t=t.getResult())e.edit_view_ui_dic.hasOwnProperty(i)&&(e.edit_view_ui_dic[i].setValue(t[i]),e.current_edit_record[i]=t[i])}})}setTabStatus(){}initTabData(){}getReportData(e){var t=this,i={};i.filter_data={script:this.script_name},this.api_user_report.getUserReportData(i,{onResult:function(i){var a=i.getResult();t.pager_data=i.getPagerData(),e(a)}})}initOptions(e){this.initDropDownOptions([{option_name:"page_orientation"},{option_name:"font_size"},{option_name:"auto_refresh"},{option_name:"chart_display_mode"},{option_name:"chart_type"},{option_name:"templates"},{option_name:"setup_fields"}],(function(t){e(t)}))}initEditViewData(){if(this.edit_view.find(".navigation-div").css("display","block"),!this.navigation.getSourceData()){this.navigation.setSourceData(this.saved_report_array),LocalCacheData.getLoginUserPreference()&&this.navigation.setRowPerPage(LocalCacheData.getLoginUserPreference().items_per_page),this.navigation.setPagerData(this.pager_data);var e={};e.filter_data={script:this.script_name},this.navigation.setDefaultArgs(e)}this.navigation.setValue(this.current_saved_report),this.setUIWidgetFieldsToCurrentEditRecord(),this.setNavigationArrowsStatus(),this.setCurrentEditRecordData(),this.edit_view.find(".save-and-continue-div").SaveAndContinueBox({related_view_controller:this}),this.edit_view.find(".save-and-continue-div").css("display","none")}onRightOrLeftArrowClickCallBack(e){this.navigation.setValue(e),this.current_saved_report=e,this.current_edit_record={},this.visible_report_values={},this.initEditView()}initEditView(){var e=this,t=window.location.href;if(t.indexOf("&sm")>0&&(t=t.substring(0,t.indexOf("&sm"))),t=e.current_saved_report&&e.current_saved_report.id?t+"&sm="+e.viewId+"&sid="+e.current_saved_report.id:t+"&sm="+e.viewId,window.location.href.indexOf("&tab=")>0){var i=window.location.href;t+="&tab="+(i=(i=i.substr(window.location.href.indexOf("&tab=")+5)).substr(0,window.location.href.indexOf("&")))}r.Global.setURLToBrowser(t),super.initEditView()}setNavigation(){var e=this;this.navigation.off("formItemChange").on("formItemChange",(function(t,i){var a=i.getValue();if(e.edit_view_error_ui_dic={},!a)return e.current_saved_report=null,e.saved_report_array=[],e.current_edit_record={},e.visible_report_values={},e.do_validate_after_create_ui=!0,void e.initEditView();a!==e.current_edit_record.id&&(e.current_saved_report=i.getValue(!0),e.current_edit_record={},e.visible_report_values={},e.initEditView()),r.Global.triggerAnalyticsEditViewNavigation("navigation",e.viewId)}))}initSubCustomColumnView(e){var t=this;if(t.sub_view_mode=!0,this.sub_custom_column_view_controller)return t.sub_custom_column_view_controller.edit_only_mode=!1,t.sub_custom_column_view_controller.buildContextMenu(!0),t.sub_custom_column_view_controller.parent_value=this.script_name,void t.sub_custom_column_view_controller.initData();function i(){}function a(i){t.sub_custom_column_view_controller=i,t.sub_custom_column_view_controller.parent_key="script",t.sub_custom_column_view_controller.parent_value=t.script_name,t.sub_custom_column_view_controller.parent_view_controller=t,t.sub_custom_column_view_controller.edit_only_mode=!1,t.sub_custom_column_view_controller.sub_view_mode=!0,e&&e(),t.sub_custom_column_view_controller.initData()}r.Global.loadViewSource("CustomColumn","CustomColumnViewController.js",(function(){var e=t.edit_view_tab.find("#tab_custom_columns").find(".first-column-sub-view");TTPromise.add("SubCustomColumnView","init"),TTPromise.wait("SubCustomColumnView","init",(function(){e.css("opacity","1")})),e.css("opacity","0"),r.Global.trackView("SubReportScheduleView"),CustomColumnViewController.loadSubView(e,i,a)}))}onSavedReportDelete(){this.refreshNav()}initSubSavedReportView(e){var t=this;if(t.sub_view_mode=!0,this.sub_saved_report_view_controller)return t.sub_saved_report_view_controller.edit_only_mode=!1,t.sub_saved_report_view_controller.buildContextMenu(!0),t.sub_saved_report_view_controller.parent_value=this.script_name,void t.sub_saved_report_view_controller.initData();function i(){}function a(i){t.sub_saved_report_view_controller=i,t.sub_saved_report_view_controller.parent_key="script",t.sub_saved_report_view_controller.parent_value=t.script_name,t.sub_saved_report_view_controller.parent_view_controller=t,t.sub_saved_report_view_controller.edit_only_mode=!1,t.sub_saved_report_view_controller.sub_view_mode=!0,e?e():t.sub_saved_report_view_controller.initData()}r.Global.loadViewSource("SavedReport","SavedReportViewController.js",(function(){var e=t.edit_view_tab.find("#tab_saved_reports").find(".first-column-sub-view");TTPromise.add("SubSavedReportView","init"),TTPromise.wait("SubSavedReportView","init",(function(){e.css("opacity","1")})),e.css("opacity","0"),r.Global.trackView("SubReportScheduleView"),SavedReportViewController.loadSubView(e,i,a)}))}buildEditViewUI(){var e=this,t=this.edit_view.find(".navigation-div"),i=t.find(".navigation-label"),a=t.find(".left-click"),o=t.find(".right-click"),s=t.find(".navigation-widget-div");this.navigation=r.Global.loadWidgetByName(FormItemType.AWESOME_BOX),s.append(this.navigation),a.attr("src",r.Global.getRealImagePath("images/left_arrow.png")),o.attr("src",r.Global.getRealImagePath("images/right_arrow.png")),i.text(this.navigation_label),s.append(this.navigation),this.edit_view_close_icon=this.edit_view.find(".close-icon"),this.edit_view_close_icon.hide(),this.edit_view_close_icon.click((function(){e.onCloseIconClick()}));var _=this.edit_view.find("a[ref=tab_report]"),n=this.edit_view.find("a[ref=tab_setup]"),d=this.edit_view.find("a[ref=tab_chart]");if(this.include_form_setup){var l=this.edit_view.find("a[ref=tab_form_setup]"),c=this.edit_view.find("a[ref=tab_custom_columns]"),p=this.edit_view.find("a[ref=tab_saved_reports]");_.text($.i18n._("Report")),n.text($.i18n._("Setup")),d.text($.i18n._("Chart")),l.text($.i18n._("Form Setup")),c.text($.i18n._("Custom Columns")),p.text($.i18n._("Saved Reports")),this.buildFormSetupUI()}else{l=this.edit_view.find("a[ref=tab_custom_columns]"),c=this.edit_view.find("a[ref=tab_saved_reports]");_.text($.i18n._("Report")),n.text($.i18n._("Setup")),d.text($.i18n._("Chart")),l.text($.i18n._("Custom Columns")),c.text($.i18n._("Saved Reports"))}this.navigation.AComboBox({api_class:TTAPI.APIUserReportData,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_user_report_data",default_args:{filter_data:{script:this.script_name}},navigation_mode:!0,show_search_inputs:!0,set_empty:!0,always_search_full_columns:!0}),this.setNavigation();var u=this.edit_view_tab.find("#tab_report").find(".first-column"),m=r.Global.loadWidgetByName(FormItemType.COMBO_BOX);m.TComboBox({field:"template",set_empty:!0}),m.setSourceData(e.templates_array),this.addEditFieldToColumn($.i18n._("Template"),m,u);var v=this.edit_view_tab.find("#tab_setup").find(".first-column");(m=r.Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({allow_multiple_selection:!0,key:"value",layout_name:"global_option_column",allow_drag_to_order:!0,set_empty:!0,field:"setup_field"}),this.addEditFieldToColumn($.i18n._("Fields"),m,v,""),this.setup_fields_array.shift(),m.setSourceData(this.setup_fields_array),(m=r.Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"page_orientation",set_empty:!1}),m.setSourceData(e.page_orientation_array),this.addEditFieldToColumn($.i18n._("Page Orientation"),m,v),(m=r.Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"font_size",set_empty:!1}),m.setSourceData(e.font_size_array),this.addEditFieldToColumn($.i18n._("Font Size"),m,v),(m=r.Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"disable_grand_total"}),this.addEditFieldToColumn($.i18n._("Disable Grand Total"),m,v),(m=r.Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"show_duplicate_values"}),this.addEditFieldToColumn($.i18n._("Show Duplicate Values"),m,v),(m=r.Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"auto_refresh",set_empty:!1}),m.setSourceData(e.auto_refresh_array),this.addEditFieldToColumn($.i18n._("Auto-Refresh"),m,v),(m=r.Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"maximum_page_limit",width:50}),this.addEditFieldToColumn($.i18n._("Maximum Pages"),m,v);var h=this.edit_view_tab.find("#tab_chart").find(".first-column");(m=r.Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"enable"}),this.addEditFieldToColumn($.i18n._("Enable"),m,h,""),(m=r.Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"display_mode",set_empty:!1}),m.setSourceData(e.chart_display_mode_array),this.addEditFieldToColumn($.i18n._("Display"),m,h),(m=r.Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type",set_empty:!1}),m.setSourceData(e.chart_type_array),this.addEditFieldToColumn($.i18n._("Type"),m,h),(m=r.Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"include_sub_total"}),this.addEditFieldToColumn($.i18n._("Chart Sub-Totals"),m,h),(m=r.Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"axis_scale_static"}),this.addEditFieldToColumn($.i18n._("Consistent Axis Scales"),m,h),(m=r.Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"combine_columns"}),this.addEditFieldToColumn($.i18n._("Combine Columns"),m,h,""),TTPromise.resolve("init","init")}buildFormSetupUI(){}buildSelectTemplateData(){for(var e=this.current_saved_report.data.template,t=this.current_saved_report.data.config,i={},a=0;a<e.length;a++){var r=e[a];i[r]="sort"===r?t[r+"_"]:t[r]}return i}setCurrentEditRecordData(){var e=this;if(LocalCacheData.default_filter_for_next_open_view)this.do_validate_after_create_ui=!1,this.current_edit_record.template=LocalCacheData.default_filter_for_next_open_view.template,e.onTemplateChange(this.current_edit_record.template),LocalCacheData.default_filter_for_next_open_view=null;else if(this.current_saved_report&&this.current_saved_report.data){var t=this.buildSelectTemplateData();for(var i in this.setSelectTemplate(t),this.current_edit_record.template=this.current_saved_report.data.config.template,this.current_saved_report.data.config.other)this.current_saved_report.data.config.other.hasOwnProperty(i)&&(this.current_edit_record[i]=this.current_saved_report.data.config.other[i]);for(var a in this.current_saved_report.data.config.chart)this.current_saved_report.data.config.chart.hasOwnProperty(a)&&(this.current_edit_record[a]=this.current_saved_report.data.config.chart[a])}else this.do_validate_after_create_ui=!1,this.onTemplateChange(this.templates_array[1].id),this.current_edit_record.template=this.templates_array[1].id;for(var o in this.current_edit_record)if(this.current_edit_record.hasOwnProperty(o)){var s=this.edit_view_ui_dic[o];if(r.Global.isSet(s))switch(o){case"user_id":s.setValue(this.current_edit_record[o]);break;case"country":this.setCountryValue(s,o);break;default:s.setValue(this.current_edit_record[o])}}this.include_form_setup&&this.api.getCompanyFormConfig({onResult:function(t){var i=t.getResult();1==i.length&&i.hasOwnProperty("0")&&!1===i[0]||e.setFormSetupData(i)}}),this.collectUIDataToCurrentEditRecord(),this.setDefaultConfigData(),this.setEditViewDataDone()}setEditViewDataDone(){if(this.setTabOVisibility(!0),this.do_validate_after_create_ui&&(this.validate(),this.do_validate_after_create_ui=!1),this.initRightClickMenuForViewButton(),window.location.href.indexOf("&tab=")>0){var e=window.location.href;e=(e=e.substr(window.location.href.indexOf("&tab=")+5)).substr(0,window.location.href.indexOf("&"));for(var t=this.edit_view_tab.find(".edit-view-tab-bar-label").children(),i=0;i<t;i++)if($(t[i]).find("a").length>0&&e==$(t[i]).find("a").html().replace(/\/|\s+/g,"")){$(t[i]).find("a").click();break}}TTPromise.resolve("init","init"),$(".edit-view-tab-bar").css("opacity",1)}initRightClickMenuForViewButton(){var e=this,t="#viewHTMLIcon";if(0!=$(t).length){var i=this.getViewButtonRightClickItems();i&&!$.isEmptyObject(i)&&($.contextMenu("destroy",t),$.contextMenu({selector:t,callback:function(t,i){e.onContextMenuClick(null,t)},onContextMenu:function(){return!1},items:i,zIndex:50}))}}getViewButtonRightClickItems(){var e={};function t(){return!!$("#viewHTMLIcon").parent().hasClass("disable-image")}return e.viewHTMLIcon={name:$.i18n._("View"),icon:"viewHTMLIcon",disabled:function(){return t()}},e.viewHTMLNewWindow={name:$.i18n._("View (New Window)"),icon:"viewHTMLIcon",disabled:function(){return t()}},e}onFormItemChangeProcessFilterField(){}preFormItemChange(e,t){return!0}onFormItemChange(e,t){this.preFormItemChange(e);this.setIsChanged(e);var i,a,r,o,s,_=e.getField();if(this.visible_report_widgets&&(this.visible_report_widgets[_]||"start_date"===_||"end_date"===_||"pay_period_id"===_||"pay_period_schedule_id"===_))if("sort"===_)this.visible_report_values[_]=e.getValue(!0);else if(_.indexOf("time_period")>=0)i=e.getValue(),this.visible_report_values[_]&&this.visible_report_values[_].time_period===i||(this.visible_report_values[_]={time_period:i},this.onTimePeriodChange(e));else if("filter"===_)this.onFormItemChangeProcessFilterField(e,_);else if("start_date"===_||"end_date"===_||"pay_period_id"===_||"pay_period_schedule_id"===_)(i=this.visible_report_values[e.attr("time_period_key")?e.attr("time_period_key"):"time_period"])[_]=e.getValue();else if("membership_renewal_date"===_)r=e.getValue(),this.visible_report_values[_]={time_period:r},this.onMembershipRenewalDateChange(e);else if("start_date_1"===_||"end_date_1"===_||"pay_period_id_1"===_||"pay_period_schedule_id_1"===_)(r=this.visible_report_values.membership_renewal_date)[_.replace("_1","")]=e.getValue();else if("skill_expiry_date"===_)a=e.getValue(),this.visible_report_values[_]={time_period:a},this.onSkillExpiryDate(e);else if("start_date_2"===_||"end_date_2"===_||"pay_period_id_2"===_||"pay_period_schedule_id_2"===_)(a=this.visible_report_values.skill_expiry_date)[_.replace("_2","")]=e.getValue();else if("license_expiry_date"===_)o=e.getValue(),this.visible_report_values[_]={time_period:o},this.onLicenseExpiryDate(e);else if("start_date_3"===_||"end_date_3"===_||"pay_period_id_3"===_||"pay_period_schedule_id_3"===_)(o=this.visible_report_values.license_expiry_date)[_.replace("_3","")]=e.getValue();else if("education_graduate_date"===_)s=e.getValue(),this.visible_report_values[_]={time_period:s},this.onEducationGraduateDate(e);else if("start_date_4"===_||"end_date_4"===_||"pay_period_id_4"===_||"pay_period_schedule_id_4"===_)(s=this.visible_report_values.education_graduate_date)[_.replace("_4","")]=e.getValue();else if(e.hasClass("t-checkbox"))this.visible_report_values[_]=e.getValue();else{var n=e.getValue();n&&("array"!==$.type(n)||n.length>0)&&n!=TTUUID.zero_id?this.visible_report_values[_]=e.getValue():delete this.visible_report_values[_]}else this.current_edit_record[_]=e.getValue();"template"===_?(this.onTemplateChange(this.current_edit_record[_]),this.setEditMenu()):t||this.validate(),this.include_form_setup&&3===_&&(this.form_setup_changed=!0)}onTemplateChange(e){var t=this;this.api.getTemplate(e,{onResult:function(e){var i=e.getResult();t.setSelectTemplate(i)}})}setSelectTemplate(e){var t=this,i=r.Global.buildRecordArray(e),a=i.length;if(t.current_edit_record){t.current_edit_record.setup_field=[],t.visible_report_values={};for(var o=0;o<a;o++){var s=i[o];"template"!==s.value&&(t.visible_report_values[s.value]=s.label,t.current_edit_record.setup_field.push(s.value))}t.createUI(i)}}getFieldLabel(e){for(var t=this.setup_fields_array.length,i=0;i<t;i++){var a=this.setup_fields_array[i];if(a.value===e)return a.label}}createUI(e){this.cleanUI();var t=this,i=e.length,a=this.edit_view_tab.find("#tab_report").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(a),this.visible_report_widgets={},this.edit_view_form_item_dic={},this.visible_report_widgets_order_fix={};var r=this.visible_report_values;this.visible_report_values={};for(var o=1001,s=0;s<i;s++){var _,n=e[s],d="";_=r[d=n.value?n.value:n];var l=this.getUIWidget(d);l&&this.getFieldLabel(d)&&(d.indexOf("time_period")>=0||"membership_renewal_date"===d||"skill_expiry_date"===d||"license_expiry_date"==d||"education_graduate_date"==d?(this.addEditFieldToColumn($.i18n._(this.getFieldLabel(d)),l,a,"",null,!0,!0),t.edit_view_form_item_dic[d].attr("id","report_"+d+"_div")):this.addEditFieldToColumn($.i18n._(this.getFieldLabel(d)),l,a,"",null,!0),_&&(d.indexOf("time_period")>=0?(l.setValue(_.time_period),t.onTimePeriodChange(l,_)):"membership_renewal_date"===d?(l.setValue(_.time_period),t.onMembershipRenewalDateChange(l,_)):"skill_expiry_date"===d?(l.setValue(_.time_period),t.onSkillExpiryDate(l,_)):"license_expiry_date"===d?(l.setValue(_.time_period),t.onLicenseExpiryDate(l,_)):"education_graduate_date"===d?(l.setValue(_.time_period),t.onEducationGraduateDate(l,_)):"filter"===d?t.setFilterValue(l,_):l.setValue(_)),this.initSourceData(d,l),delete this.current_edit_record[d],(l.hasClass("t-checkbox")||_)&&(this.visible_report_values[d]=_),this.visible_report_widgets[d]=l,this.visible_report_widgets_order_fix[d]=o,o+=1)}this.setEditViewWidgetsMode(),this.need_refresh_display_columns=!1,this.editFieldResize(0)}onTabShow(e){var t=$(e.target).tabs("option","active");if(this.editFieldResize(t),this.current_edit_record){var i=this.getEditViewTabIndex();this.include_form_setup?(1!==i&&!this.need_refresh_display_columns||0!==t?1===t?(this.edit_view_ui_dic.setup_field.setValue(this.current_edit_record.setup_field),10==r.Global.getProductEdition()&&this.edit_view_ui_dic.auto_refresh.parent().parent().css("display","none"),this.buildContextMenu(!0),this.setEditMenu()):2===t?r.Global.getProductEdition()>=15?(this.edit_view_tab.find("#tab_chart").find(".first-column").css("display","block"),this.edit_view.find(".permission-defined-div").css("display","none")):(this.edit_view_tab.find("#tab_chart").find(".first-column").css("display","none"),this.edit_view.find(".permission-defined-div").css("display","block"),this.edit_view.find(".permission-message").html(r.Global.getUpgradeMessage())):4===t?r.Global.getProductEdition()>=15?(this.edit_view_tab.find("#tab_form_setup").find(".first-column-sub-view").css("display","block"),this.edit_view.find(".permission-defined-div").css("display","none"),this.initSubCustomColumnView()):(this.edit_view_tab.find("#tab_form_setup").find(".first-column-sub-view").css("display","none"),this.edit_view.find(".permission-defined-div").css("display","block"),this.edit_view.find(".permission-message").html(r.Global.getUpgradeMessage())):5===t?this.initSubSavedReportView():(this.buildContextMenu(!0),this.setEditMenu()):(this.buildReportUIBaseOnSetupFields(),this.buildContextMenu(!0),this.setEditMenu()),this.checkFormSetupSaved(i)):1!==i&&!this.need_refresh_display_columns||0!==t?1===t?(this.edit_view_ui_dic.setup_field.setValue(this.current_edit_record.setup_field),10==r.Global.getProductEdition()&&this.edit_view_ui_dic.auto_refresh.parent().parent().css("display","none"),this.buildContextMenu(!0),this.setEditMenu()):2===t?r.Global.getProductEdition()>=15?(this.edit_view_tab.find("#tab_chart").find(".first-column").css("display","block"),this.edit_view.find(".permission-defined-div").css("display","none")):(this.edit_view_tab.find("#tab_chart").find(".first-column").css("display","none"),this.edit_view.find(".permission-defined-div").css("display","block"),this.edit_view.find(".permission-message").html(r.Global.getUpgradeMessage())):3===t?r.Global.getProductEdition()>=15?(this.edit_view_tab.find("#tab_custom_columns").find(".first-column-sub-view").css("display","block"),this.edit_view.find(".permission-defined-div").css("display","none"),this.initSubCustomColumnView()):(this.edit_view_tab.find("#tab_custom_columns").find(".first-column-sub-view").css("display","none"),this.edit_view.find(".permission-defined-div").css("display","block"),this.edit_view.find(".permission-message").html(r.Global.getUpgradeMessage())):4===t?this.initSubSavedReportView():(this.buildContextMenu(!0),this.setEditMenu()):(this.buildReportUIBaseOnSetupFields(),this.buildContextMenu(!0),this.setEditMenu()),0===t&&this.validate()}}checkFormSetupSaved(e,t){var i=this;null==t&&(t=$.i18n._("Form Setup")),3===e&&this.form_setup_changed&&(i.form_setup_changed=!1,TAlertManager.showConfirmAlert($.i18n._("You have modified")+" "+t+" "+$.i18n._("data without saving, would you like to save your data now?"),"",(function(e){e&&i.onSaveSetup(t)})))}cleanUI(){for(var e in this.edit_view_form_item_dic)if(this.edit_view_form_item_dic.hasOwnProperty(e)){var t=this.edit_view_form_item_dic[e];void 0===t.getField&&-1!=e.indexOf("separated_")||t.remove()}this.edit_view_tab&&this.edit_view_tab.find("#tab_report").find(".first-column").find(".clear-both-div").remove();$(".errortip-box").remove(),$(".errortip-box").remove()}removeEditView(){super.removeEditView(),this.sub_custom_column_view_controller=null,this.sub_saved_report_view_controller=null,LocalCacheData.current_open_report_controller=null}getUIWidget(e){var t;if(e.indexOf("time_period")>=0)t=this.getSimpleTComboBox(e,!1);else switch(e){case"is_reprint":t=this.getCheckBox(e);break;case"columns":case"sub_total":case"group":case"page_break":case"user_review_control_type_id":case"user_review_control_status_id":case"severity_id":case"term_id":case"kpi_type_id":case"kpi_status_id":case"fluency_id":case"qualification_type_id":case"proficiency_id":case"competency_id":case"ownership_id":case"invoice_status_id":case"user_status_id":case"pay_stub_status_id":case"filter":case"pay_period_time_sheet_verify_status_id":case"job_status_id":case"job_item_status_id":case"client_status_id":case"product_type_id":case"custom_filter":case"log_action_id":case"log_table_name_id":case"accrual_type_id":case"accrual_policy_type_id":case"exception_policy_severity_id":case"exception_policy_type_id":case"expense_policy_require_receipt_id":case"expense_policy_type_id":case"user_expense_payment_method_id":case"user_expense_status_id":case"job_applicant_sex_id":case"job_applicant_status_id":case"job_application_status_id":case"job_application_type_id":case"job_vacancy_employment_status_id":case"job_vacancy_level_id":case"job_vacancy_status_id":case"job_vacancy_type_id":case"job_vacancy_wage_type_id":case"pay_stub_run_id":case"pay_stub_type_id":case"remittance_source_account_type_id":case"transaction_type_id":case"transaction_status_id":t=this.getSimpleTComboBox(e);break;case"sort":t=this.getSortComboBox(e);break;case"license_expiry_date":case"membership_renewal_date":case"skill_expiry_date":case"education_graduate_date":t=this.getComboBox(e);break;case"user_group_id":case"qualification_group_id":case"kpi_group_id":case"job_group_id":case"job_item_group_id":case"client_group_id":case"product_group_id":t=this.getTreeModeAComboBox(e);break;case"user_tag":case"review_tag":case"job_tag":case"job_item_tag":t=this.getTag(e);break;case"include_user_id":case"exclude_user_id":case"client_sales_contact_id":case"created_by_id":case"updated_by_id":case"include_reviewer_user_id":case"exclude_reviewer_user_id":case"job_applicant_interviewer_user_id":case"job_application_interviewer_user_id":t=this.getTComboBox(e,"global_user",TTAPI.APIUser);break;case"user_title_id":t=this.getTComboBox(e,"global_user_title",TTAPI.APIUserTitle);break;case"payroll_remittance_agency_id":t=this.getTComboBox(e,"global_payroll_remittance_agency",TTAPI.APIPayrollRemittanceAgency);break;case"legal_entity_id":t=this.getTComboBox(e,"global_legal_entity",TTAPI.APILegalEntity);break;case"default_branch_id":case"schedule_branch_id":case"punch_branch_id":t=this.getTComboBox(e,"global_branch",TTAPI.APIBranch);break;case"default_department_id":case"schedule_department_id":case"punch_department_id":t=this.getTComboBox(e,"global_department",TTAPI.APIDepartment);break;case"default_job_id":case"punch_job_id":case"include_job_id":case"exclude_job_id":t=this.getTComboBox(e,"global_job",TTAPI.APIJob);break;case"default_job_item_id":case"punch_job_item_id":case"include_job_item_id":case"exclude_job_item_id":t=this.getTComboBox(e,"global_job_item",TTAPI.APIJobItem);break;case"absence_policy_id":t=this.getTComboBox(e,"global_absences",TTAPI.APIAbsencePolicy);break;case"currency_id":t=this.getTComboBox(e,"global_currency",TTAPI.APICurrency);break;case"include_no_data_rows":case"exclude_ytd_adjustment":case"show_child_expenses":t=this.getCheckBox(e);break;case"accrual_policy_id":t=this.getTComboBox(e,"global_accrual",TTAPI.APIAccrualPolicy);break;case"pay_period_id":t=this.getTComboBox(e,"global_Pay_period",TTAPI.APIPayPeriod);break;case"job_id":r.Global.getProductEdition()>=20&&(t=this.getTComboBox(e,"global_job",TTAPI.APIJob));break;case"job_item_id":r.Global.getProductEdition()>=20&&(t=this.getTComboBox(e,"global_job_item",TTAPI.APIJobItem));break;case"expense_policy_id":t=this.getTComboBox(e,"global_expense_policy",TTAPI.APIExpensePolicy);break;case"pay_stub_entry_account_id":t=this.getTComboBox(e,"global_PayStubAccount",TTAPI.APIPayStubEntryAccount);break;case"product_id":case"exclude_product_id":case"include_product_id":t=this.getTComboBox(e,"global_product",TTAPI.APIProduct);break;case"job_client_id":case"exclude_client_id":case"include_client_id":t=this.getTComboBox(e,"global_client",TTAPI.APIClient);break;case"company_deduction_id":t=this.getTComboBox(e,"global_deduction",TTAPI.APICompanyDeduction);break;case"qualification_id":t=this.getTComboBox(e,"global_qualification",TTAPI.APIQualification);break;case"kpi_id":t=this.getTComboBox(e,"global_kpi",TTAPI.APIKPI);break;case"job_applicant_id":t=this.getTComboBox(e,"global_job_applicant",TTAPI.APIJobApplicant);break;case"job_vacancy_id":t=this.getTComboBox(e,"global_job_vacancy",TTAPI.APIJobVacancy);break;case"accrual_policy_account_id":t=this.getTComboBox(e,"global_accrual_policy_account",TTAPI.APIAccrualPolicyAccount);break;default:r.Global.isSet(o.ReportMissedField)||(o.ReportMissedField={}),o.ReportMissedField[e]=!0}return t}getTag(e){var t=r.Global.loadWidgetByName(FormItemType.TAG_INPUT);return t.TTagInput({field:e}),t}getTreeModeAComboBox(e){var t=r.Global.loadWidgetByName(FormItemType.AWESOME_BOX);return t=t.AComboBox({tree_mode:!0,allow_multiple_selection:!0,layout_name:"global_tree_column",set_empty:!0,field:e})}getCheckBox(e){var t=r.Global.loadWidgetByName(FormItemType.CHECKBOX);return t=t.TCheckbox({field:e})}getTComboBox(e,t,i){var a=r.Global.loadWidgetByName(FormItemType.AWESOME_BOX);return a=a.AComboBox({api_class:i,allow_multiple_selection:!0,layout_name:t,show_search_inputs:!0,set_empty:!0,field:e})}getSortComboBox(e){var t=r.Global.loadWidgetByName(FormItemType.AWESOME_BOX);return t=t.AComboBox({field:e,allow_drag_to_order:!0,allow_multiple_selection:!0,set_empty:!0,layout_name:"global_sort_columns"})}getSimpleTComboBox(e,t){r.Global.isSet(t)||(t=!0);var i=r.Global.loadWidgetByName(FormItemType.AWESOME_BOX);return i=i.AComboBox({field:e,set_empty:!0,allow_multiple_selection:t,layout_name:"global_option_column",key:"value"})}getComboBox(e){var t=r.Global.loadWidgetByName(FormItemType.COMBO_BOX);return t=t.TComboBox({field:e,set_empty:!0})}initSourceData(e,t){var i=null,a="",o=this;switch(e){case"sort":a="columns",(i=this.api).getOptions(a,{onResult:function(e){n(e)}});break;case"kpi_group_id":TTAPI.APIKPIGroup.getKPIGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"qualification_group_id":TTAPI.APIQualificationGroup.getQualificationGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"product_group_id":TTAPI.APIProductGroup.getProductGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"client_group_id":TTAPI.APIClientGroup.getClientGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"user_group_id":TTAPI.APIUserGroup.getUserGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"job_group_id":TTAPI.APIJobGroup.getJobGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"job_item_group_id":TTAPI.APIJobItemGroup.getJobItemGroup("",!1,!1,{onResult:function(e){e=e.getResult(),e=r.Global.buildTreeRecord(e),t.setSourceData(e)}});break;case"job_vacancy_employment_status_id":i=TTAPI.APIJobVacancy,a="employment_status";break;case"job_vacancy_level_id":i=TTAPI.APIJobVacancy,a="level";break;case"job_vacancy_status_id":i=TTAPI.APIJobVacancy,a="status";break;case"job_vacancy_type_id":i=TTAPI.APIJobVacancy,a="type";break;case"job_vacancy_wage_type_id":i=TTAPI.APIJobVacancy,a="wage_type";break;case"job_application_status_id":i=TTAPI.APIJobApplication,a="status";break;case"job_application_type_id":i=TTAPI.APIJobApplication,a="type";break;case"job_applicant_sex_id":i=TTAPI.APIJobApplicant,a="sex";break;case"job_applicant_status_id":i=TTAPI.APIJobApplicant,a="status";break;case"user_review_control_type_id":i=TTAPI.APIUserReviewControl,a="type";break;case"user_review_control_status_id":i=TTAPI.APIUserReviewControl,a="status";break;case"severity_id":i=TTAPI.APIUserReviewControl,a="severity";break;case"term_id":i=TTAPI.APIUserReviewControl,a="term";break;case"kpi_status_id":i=TTAPI.APIKPI,a="status";break;case"kpi_type_id":i=TTAPI.APIKPI,a="type";break;case"proficiency_id":i=TTAPI.APIUserSkill,a="proficiency";break;case"fluency_id":i=TTAPI.APIUserLanguage,a="fluency";break;case"competency_id":i=TTAPI.APIUserLanguage,a="competency";break;case"user_status_id":i=TTAPI.APIUser,a="status";break;case"pay_stub_status_id":i=TTAPI.APIPayStub,a="filtered_status";break;case"ownership_id":i=TTAPI.APIUserMembership,a="ownership";break;case"license_expiry_date":i=this.api,a="license_expiry_date";break;case"membership_renewal_date":i=this.api,a="membership_renewal_date";break;case"skill_expiry_date":i=this.api,a="skill_expiry_date";break;case"education_graduate_date":i=this.api,a="education_graduate_date";break;case"group":case"sub_total":case"page_break":i=this.api,a="static_columns";break;case"pay_period_time_sheet_verify_status_id":i=TTAPI.APIPayPeriodTimeSheetVerify,a="filter_report_status";break;case"job_status_id":i=TTAPI.APIJob,a="status";break;case"custom_filter":i=this.api,a="report_custom_filters";break;case"log_action_id":i=TTAPI.APILog,a="action";break;case"log_table_name_id":i=TTAPI.APILog,a="table_name";break;case"filter":"ScheduleSummaryReport"===this.script_name?(i=TTAPI.APISchedule,a="status"):"InvoiceTransactionSummaryReport"===this.script_name?(i=TTAPI.APITransaction,a="type"):"PayStubSummaryReport"===this.script_name?(i=TTAPI.APIPayStub,a="status"):"ActiveShiftReport"===this.script_name&&(i=TTAPI.APIUser,a="status");break;case"accrual_policy_type_id":i=TTAPI.APIAccrualPolicy,a="type";break;case"accrual_type_id":i=TTAPI.APIAccrual,a="type";break;case"qualification_type_id":i=TTAPI.APIQualification,a="type";break;case"exception_policy_type_id":i=TTAPI.APIExceptionPolicy,a="type";break;case"exception_policy_severity_id":i=TTAPI.APIExceptionPolicy,a="severity";break;case"expense_policy_require_receipt_id":i=TTAPI.APIExpensePolicy,a="require_receipt";break;case"expense_policy_type_id":i=TTAPI.APIExpensePolicy,a="type";break;case"user_expense_payment_method_id":i=TTAPI.APIUserExpense,a="payment_method";break;case"user_expense_status_id":i=TTAPI.APIUserExpense,a="status";break;case"job_item_status_id":i=TTAPI.APIJobItem,a="status";break;case"client_status_id":i=TTAPI.APIClient,a="status";break;case"invoice_status_id":i=TTAPI.APIInvoice,a="status";break;case"invoice_transaction_type_id":i=TTAPI.APITransaction,a="type";break;case"product_type_id":i=TTAPI.APIProduct,a="type";break;case"pay_stub_type_id":i=TTAPI.APIPayStub,a="type";break;case"transaction_type_id":i=this.api,a="type";break;case"transaction_status_id":i=this.api,a="status";break;case"pay_stub_run_id":for(var s={},_=1;_<=128;_++)s[_]=_;return s=r.Global.buildRecordArray(s),void t.setSourceData(s);default:if(t.getAPI&&t.getAPI())return;if(!t.setSourceData)return;e.replace("_id",""),i=this.api,a=e,e.indexOf("time_period")>=0&&(a="time_period")}function n(i){var a=i.getResult();a=r.Global.buildRecordArray(a),"sort"===e?a=o.buildSortSelectorUnSelectColumns(a):e.indexOf("time_period")>=0&&(o.time_period_array=a),t.setSourceData(a)}i&&(!this.need_refresh_display_columns||"columns"!==a&&"custom_filter"!=e?i.getOptions(a,{onResult:function(e){n(e)}}):i.getOptions(a,{noCache:!0,onResult:function(e){n(e)}}))}getDatePicker(e){var t=r.Global.loadWidgetByName(FormItemType.DATE_PICKER);return t.TDatePicker({field:e}),t}putInputToInsideFormItem(e,t){var i=$(r.Global.loadWidgetByName(WidgetNamesDic.EDIT_VIEW_SUB_FORM_ITEM)),a=i.find(".edit-view-form-item-label"),o=i.find(".edit-view-form-item-input-div");return i.addClass("remove-margin"),a.text($.i18n._(t)+": "),o.append(e),i}onLicenseExpiryDate(e,t){var i=this,a=e.getValue();this.visible_report_widgets.license_expiry_date=null,this.visible_report_widgets.start_date_3=null,this.visible_report_widgets.end_date_3=null,this.visible_report_widgets.pay_period_id_3=null,this.visible_report_widgets.pay_period_schedule_id_3=null,"custom_date"===a?function(){var e=i.edit_view.find("#report_license_expiry_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("license_expiry_date",!1,!1);i.initSourceData("license_expiry_date",s),s.setValue(a);var _=i.getDatePicker("start_date_3"),n=i.getDatePicker("end_date_3");t&&(_.setValue(t.start_date),n.setValue(t.end_date));var d=i.putInputToInsideFormItem(s,$.i18n._("Section")),l=i.putInputToInsideFormItem(_,$.i18n._("Start Date")),c=i.putInputToInsideFormItem(n,$.i18n._("End Date"));i.visible_report_widgets.license_expiry_date=s,i.visible_report_widgets.start_date_3=_,i.visible_report_widgets.end_date_3=n,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),o.append(d),o.append("<div class='clear-both-div'></div>"),o.append(l),o.append("<div class='clear-both-div'></div>"),o.append(c),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70),r.append(o)}():"custom_pay_period"===a?function(){var e=i.edit_view.find("#report_license_expiry_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("license_expiry_date",!1,!1);i.initSourceData("license_expiry_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_id_3","global_Pay_period",TTAPI.APIPayPeriod);_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)}));var n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period"));i.visible_report_widgets.license_expiry_date=s,i.visible_report_widgets.pay_period_id_3=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_id);r.append(o),o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70)}():"this_pay_period"===a||"last_pay_period"===a||"to_last_pay_period"===a||"to_this_pay_period"===a?function(){var e=i.edit_view.find("#report_license_expiry_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("license_expiry_date",!1,!1);i.initSourceData("license_expiry_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_schedule_id_3","global_pay_period_schedule",TTAPI.APIPayPeriodSchedule),n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period Schedule"));i.visible_report_widgets.license_expiry_date=s,i.visible_report_widgets.pay_period_schedule_id_3=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_schedule_id);o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),120),r.append(o)}():function(){var e=i.edit_view.find("#report_license_expiry_date_div"),t=$(e.children()[1]);t.empty();var r=i.getSimpleTComboBox("license_expiry_date",!1,!1);t.append(r),r.setValue(a),i.initSourceData("license_expiry_date",r),r.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),i.visible_report_widgets.license_expiry_date=r}()}onEducationGraduateDate(e,t){var i=this,a=e.getValue();this.visible_report_widgets.education_graduate_date=null,this.visible_report_widgets.start_date_4=null,this.visible_report_widgets.end_date_4=null,this.visible_report_widgets.pay_period_id_4=null,this.visible_report_widgets.pay_period_schedule_id_4=null,"custom_date"===a?function(){var e=i.edit_view.find("#report_education_graduate_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("education_graduate_date",!1,!1);i.initSourceData("education_graduate_date",s),s.setValue(a);var _=i.getDatePicker("start_date_4"),n=i.getDatePicker("end_date_4");t&&(_.setValue(t.start_date),n.setValue(t.end_date));var d=i.putInputToInsideFormItem(s,$.i18n._("Section")),l=i.putInputToInsideFormItem(_,$.i18n._("Start Date")),c=i.putInputToInsideFormItem(n,$.i18n._("End Date"));i.visible_report_widgets.education_graduate_date=s,i.visible_report_widgets.start_date_4=_,i.visible_report_widgets.end_date_4=n,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),o.append(d),o.append("<div class='clear-both-div'></div>"),o.append(l),o.append("<div class='clear-both-div'></div>"),o.append(c),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70),r.append(o)}():"custom_pay_period"===a?function(){var e=i.edit_view.find("#report_education_graduate_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("education_graduate_date",!1,!1);i.initSourceData("education_graduate_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_id_4","global_Pay_period",TTAPI.APIPayPeriod);_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)}));var n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period"));i.visible_report_widgets.education_graduate_date=s,i.visible_report_widgets.pay_period_id_4=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_id);r.append(o),o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70)}():"this_pay_period"===a||"last_pay_period"===a||"to_last_pay_period"===a||"to_this_pay_period"===a?function(){var e=i.edit_view.find("#report_education_graduate_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("education_graduate_date",!1,!1);i.initSourceData("education_graduate_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_schedule_id_4","global_pay_period_schedule",TTAPI.APIPayPeriodSchedule),n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period Schedule"));i.visible_report_widgets.education_graduate_date=s,i.visible_report_widgets.pay_period_schedule_id_4=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_schedule_id);o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),120),r.append(o)}():function(){var e=i.edit_view.find("#report_education_graduate_date_div"),t=$(e.children()[1]);t.empty();var r=i.getSimpleTComboBox("education_graduate_date",!1,!1);t.append(r),r.setValue(a),i.initSourceData("education_graduate_date",r),r.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),i.visible_report_widgets.education_graduate_date=r}()}onSkillExpiryDate(e,t){var i=this,a=e.getValue();this.visible_report_widgets.skill_expiry_date=null,this.visible_report_widgets.start_date_2=null,this.visible_report_widgets.end_date_2=null,this.visible_report_widgets.pay_period_id_2=null,this.visible_report_widgets.pay_period_schedule_id_2=null,"custom_date"===a?function(){var e=i.edit_view.find("#report_skill_expiry_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("skill_expiry_date",!1,!1);i.initSourceData("skill_expiry_date",s),s.setValue(a);var _=i.getDatePicker("start_date_2"),n=i.getDatePicker("end_date_2");t&&(_.setValue(t.start_date),n.setValue(t.end_date));var d=i.putInputToInsideFormItem(s,$.i18n._("Section")),l=i.putInputToInsideFormItem(_,$.i18n._("Start Date")),c=i.putInputToInsideFormItem(n,$.i18n._("End Date"));i.visible_report_widgets.skill_expiry_date=s,i.visible_report_widgets.start_date_2=_,i.visible_report_widgets.end_date_2=n,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),o.append(d),o.append("<div class='clear-both-div'></div>"),o.append(l),o.append("<div class='clear-both-div'></div>"),o.append(c),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70),r.append(o)}():"custom_pay_period"===a?function(){var e=i.edit_view.find("#report_skill_expiry_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("skill_expiry_date",!1,!1);i.initSourceData("skill_expiry_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_id_2","global_Pay_period",TTAPI.APIPayPeriod);_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)}));var n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period"));i.visible_report_widgets.skill_expiry_date=s,i.visible_report_widgets.pay_period_id_2=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_id);r.append(o),o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70)}():"this_pay_period"===a||"last_pay_period"===a||"to_last_pay_period"===a||"to_this_pay_period"===a?function(){var e=i.edit_view.find("#report_skill_expiry_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("skill_expiry_date",!1,!1);i.initSourceData("skill_expiry_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_schedule_id_2","global_pay_period_schedule",TTAPI.APIPayPeriodSchedule),n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period Schedule"));i.visible_report_widgets.skill_expiry_date=s,i.visible_report_widgets.pay_period_schedule_id_2=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_schedule_id);o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),120),r.append(o)}():function(){var e=i.edit_view.find("#report_skill_expiry_date_div"),t=$(e.children()[1]);t.empty();var r=i.getSimpleTComboBox("skill_expiry_date",!1,!1);t.append(r),r.setValue(a),i.initSourceData("skill_expiry_date",r),r.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),i.visible_report_widgets.skill_expiry_date=r}()}onMembershipRenewalDateChange(e,t){var i=this,a=e.getValue();this.visible_report_widgets.membership_renewal_date=null,this.visible_report_widgets.start_date_1=null,this.visible_report_widgets.end_date_1=null,this.visible_report_widgets.pay_period_id_1=null,this.visible_report_widgets.pay_period_schedule_id_1=null,"custom_date"===a?function(){var e=i.edit_view.find("#report_membership_renewal_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("membership_renewal_date",!1,!1);i.initSourceData("membership_renewal_date",s),s.setValue(a);var _=i.getDatePicker("start_date_1"),n=i.getDatePicker("end_date_1");t&&(_.setValue(t.start_date),n.setValue(t.end_date));var d=i.putInputToInsideFormItem(s,$.i18n._("Section")),l=i.putInputToInsideFormItem(_,$.i18n._("Start Date")),c=i.putInputToInsideFormItem(n,$.i18n._("End Date"));i.visible_report_widgets.membership_renewal_date=s,i.visible_report_widgets.start_date_1=_,i.visible_report_widgets.end_date_1=n,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),o.append(d),o.append("<div class='clear-both-div'></div>"),o.append(l),o.append("<div class='clear-both-div'></div>"),o.append(c),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),62),r.append(o)}():"custom_pay_period"===a?function(){var e=i.edit_view.find("#report_membership_renewal_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("membership_renewal_date",!1,!1);i.initSourceData("membership_renewal_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_id_1","global_Pay_period",TTAPI.APIPayPeriod);_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)}));var n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period"));i.visible_report_widgets.membership_renewal_date=s,i.visible_report_widgets.pay_period_id_1=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_id);r.append(o),o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),70)}():"this_pay_period"===a||"last_pay_period"===a||"to_last_pay_period"===a||"to_this_pay_period"===a?function(){var e=i.edit_view.find("#report_membership_renewal_date_div"),r=$(e.children()[1]);r.empty();var o=$("<div class='v-box'></div>"),s=i.getSimpleTComboBox("membership_renewal_date",!1,!1);i.initSourceData("membership_renewal_date",s),s.setValue(a);var _=i.getTComboBox("pay_period_schedule_id_1","global_pay_period_schedule",TTAPI.APIPayPeriodSchedule),n=i.putInputToInsideFormItem(s,$.i18n._("Section")),d=i.putInputToInsideFormItem(_,$.i18n._("Pay Period Schedule"));i.visible_report_widgets.membership_renewal_date=s,i.visible_report_widgets.pay_period_schedule_id_1=_,s.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&_.setValue(t.pay_period_schedule_id);o.append(n),o.append("<div class='clear-both-div'></div>"),o.append(d),o.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(o.find(".edit-view-form-item-sub-label-div > span"),120),r.append(o)}():function(){var e=i.edit_view.find("#report_membership_renewal_date_div"),t=$(e.children()[1]);t.empty();var r=i.getSimpleTComboBox("membership_renewal_date",!1,!1);t.append(r),r.setValue(a),i.initSourceData("membership_renewal_date",r),r.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),i.visible_report_widgets.membership_renewal_date=r}()}onTimePeriodChange(e,t){var i=this,a=e.getValue(),r=e.getField();this.visible_report_widgets[r]=null,"custom_date"===a?function(){var e=i.edit_view.find("#report_"+r+"_div"),o=$(e.children()[1]);o.empty();var s=$("<div class='v-box'></div>"),_=i.getSimpleTComboBox(r,!1,!1);i.initSourceData(r,_),_.setValue(a);var n=i.getDatePicker("start_date"),d=i.getDatePicker("end_date");n.attr("time_period_key",r),d.attr("time_period_key",r),t&&(n.setValue(t.start_date),d.setValue(t.end_date));var l=i.putInputToInsideFormItem(_,$.i18n._("Section")),c=i.putInputToInsideFormItem(n,$.i18n._("Start Date")),p=i.putInputToInsideFormItem(d,$.i18n._("End Date"));i.visible_report_widgets[r]=_,_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),d.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),s.append(l),s.append("<div class='clear-both-div'></div>"),s.append(c),s.append("<div class='clear-both-div'></div>"),s.append(p),s.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(s.find(".edit-view-form-item-sub-label-div > span"),62),o.append(s)}():"custom_pay_period"===a?function(){var e=i.edit_view.find("#report_"+r+"_div"),o=$(e.children()[1]);o.empty();var s=$("<div class='v-box'></div>"),_=i.getSimpleTComboBox(r,!1,!1);i.initSourceData(r,_),_.setValue(a);var n=i.getTComboBox("pay_period_id","global_Pay_period",TTAPI.APIPayPeriod);n.attr("time_period_key",r),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)}));var d=i.putInputToInsideFormItem(_,$.i18n._("Section")),l=i.putInputToInsideFormItem(n,$.i18n._("Pay Period"));i.visible_report_widgets[r]=_,_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&n.setValue(t.pay_period_id);o.append(s),s.append(d),s.append("<div class='clear-both-div'></div>"),s.append(l),s.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(s.find(".edit-view-form-item-sub-label-div > span"),70)}():"this_pay_period"===a||"last_pay_period"===a||"to_last_pay_period"===a||"to_this_pay_period"===a||"this_year_this_pay_period"===a||"this_year_last_pay_period"===a?function(){var e=i.edit_view.find("#report_"+r+"_div"),o=$(e.children()[1]);o.empty();var s=$("<div class='v-box'></div>"),_=i.getSimpleTComboBox(r,!1,!1);i.initSourceData(r,_),_.setValue(a);var n=i.getTComboBox("pay_period_schedule_id","global_pay_period_schedule",TTAPI.APIPayPeriodSchedule);n.attr("time_period_key",r);var d=i.putInputToInsideFormItem(_,$.i18n._("Section")),l=i.putInputToInsideFormItem(n,$.i18n._("Pay Period Schedule"));i.visible_report_widgets[r]=_,_.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),n.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),t&&n.setValue(t.pay_period_schedule_id);s.append(d),s.append("<div class='clear-both-div'></div>"),s.append(l),s.append("<div class='clear-both-div'></div>"),i.setEditFieldSize(s.find(".edit-view-form-item-sub-label-div > span"),120),o.append(s)}():function(){var e=i.edit_view.find("#report_"+r+"_div"),t=$(e.children()[1]);t.empty();var o=i.getSimpleTComboBox(r,!1,!1);t.append(o),o.setValue(a),i.initSourceData(r,o),o.unbind("formItemChange").bind("formItemChange",(function(e,t){i.onFormItemChange(t)})),i.visible_report_widgets[r]=o}()}setErrorTips(e,t){this.clearErrorTips();var i=e.getDetails()[0],a=!1;this.edit_view_tab.find("#tab_report"),this.edit_view_tab.find("#tab_setup");for(var o in i)i.hasOwnProperty(o)&&r.Global.isSet(this.edit_view_ui_dic[o])&&("time_period"===o||"membership_renewal_date"===o||"skill_expiry_date"===o||"license_expiry_date"===o||"education_graduate_date"===o?(this.visible_report_widgets[o]&&this.visible_report_widgets[o].is(":visible")?(this.visible_report_widgets[o].setErrorStyle(i[o],!0),a=!0):this.visible_report_widgets[o]&&this.visible_report_widgets[o].setErrorStyle(i[o]),this.edit_view_error_ui_dic[o]=this.visible_report_widgets[o]):(this.edit_view_ui_dic[o].is(":visible")?(this.edit_view_ui_dic[o].setErrorStyle(i[o],!0),a=!0):this.edit_view_ui_dic[o].setErrorStyle(i[o]),this.edit_view_error_ui_dic[o]=this.edit_view_ui_dic[o]));a||this.showEditViewError(e)}buildSortSelectorUnSelectColumns(e){var t=[],i=100;return $.each(e,(function(e,a){var r=$.extend({},a);r.id=i,r.sort="asc",t.push(r),i+=1})),t}setEditViewWidgetsMode(){var e={};for(var t in this.edit_view_ui_dic){var i=this.edit_view_ui_dic[t];i.css("opacity",1);var a=i.parent().parent().parent(),o=a.parent().attr("id");a.hasClass("v-box")||(e[o]||(e[o]=!0),r.Global.isSet(i.setEnabled)&&i.setEnabled(!0))}}buildReportUIBaseOnSetupFields(){var e=this.current_edit_record.setup_field;e&&e.length>0&&this.createUI(e)}getFormValues(){var e={};return e.page_orientation=this.current_edit_record.page_orientation,e.font_size=this.current_edit_record.font_size,e.auto_refresh=this.current_edit_record.auto_refresh,e.disable_grand_total=this.current_edit_record.disable_grand_total,e.maximum_page_limit=this.current_edit_record.maximum_page_limit,e.show_duplicate_values=this.current_edit_record.show_duplicate_values,this.current_saved_report&&r.Global.isSet(this.current_saved_report.name)&&(e.report_name=this.current_saved_report.name,e.report_description=this.current_saved_report.description),e}getChartValues(){var e={};return e.enable=this.current_edit_record.enable,e.display_mode=this.current_edit_record.display_mode,e.type=this.current_edit_record.type,e.include_sub_total=this.current_edit_record.include_sub_total,e.axis_scale_static=this.current_edit_record.axis_scale_static,e.combine_columns=this.current_edit_record.combine_columns,e}convertSortValues(e){for(var t=[],i=0;i<e.length;i++){var a=e[i];if(!r.Global.isSet(a.fullValue)){t=e;break}var o={};o[a.value]=a.sort,t.push(o)}return t}addOrderFix(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var a=this.visible_report_widgets_order_fix[i];a>0&&(t["-"+a+"-"+i]=e[i])}return t}validate(e){var t=this,i=this.getFormValues(),a=this.getChartValues();this.buildReportUIBaseOnSetupFields();var r=this.visible_report_values;r.sort&&(r.sort=this.convertSortValues(r.sort));var o=r=this.addOrderFix(r);if(o["-1000-template"]=this.current_edit_record.template,o.other=i,o.chart=a,this.include_form_setup&&(o.form=this.getFormSetupData(!0)),r.sort&&(r.sort=this.convertSortValues(r.sort)),!e)return this.api.validateReport(o,"pdf",{onResult:function(e){t.validateResult(e)}}),null;var s=this.api.validateReport(o,"pdf",{async:!1});return s?(this.validateResult(s),s.getResult()):void 0}onViewExcelClick(e){var t=this.getPostReportJson(),i={0:t,1:"csv"};if(this.include_form_setup){if(this.show_empty_message){var a=$.i18n._("Setup data for this report has not been completed yet. Please click on the Form Setup tab to do so now.");return e&&(a=e),void TAlertManager.showAlert(a)}t.form=this.getFormSetupData(!0)}this.doFormIFrameCall(i);var r="Excel";LocalCacheData.getAllURLArgs()&&LocalCacheData.getAllURLArgs().sm&&(r=LocalCacheData.getAllURLArgs().sm+"@Excel"),$().TFeedback({source:r,force_source:!0,delay:5e3})}getVisibleReportValues(){for(var e in this.visible_report_values.filter)this.visible_report_values.filter[e]==TTUUID.zero_id&&delete this.visible_report_values.filter[e];return this.visible_report_values}getPostReportJson(e){var t=this.getFormValues(),i=this.getChartValues(),a=this.getVisibleReportValues();a.sort&&(a.sort=this.convertSortValues(a.sort),e&&(a.sort_=a.sort,delete a.sort)),e||(a=this.addOrderFix(a));var r=a;return e?r.template=this.current_edit_record.template:r["-1000-template"]=this.current_edit_record.template,r.other=t,r.chart=i,r}onContextMenuClick(e,t){if(ProgressBar.showOverlay(),1!=window.clickProcessing){var i;if(window.clickProcessing=!0,window.clickProcessingHandle=window.setTimeout((function(){1==window.clickProcessing&&(window.clickProcessing=!1,ProgressBar.closeOverlay(),TTPromise.wait())}),1e3),r.Global.isSet(t))i=t;else if(e=$(e),i=$(e.find(".ribbon-sub-menu-icon")).attr("id"),e.hasClass("disable-image"))return void ProgressBar.closeOverlay();switch(i){case ContextMenuIconName.view:ProgressBar.showOverlay(),this.onViewClick();break;case ContextMenuIconName.view_html:ProgressBar.showOverlay(),this.onViewClick("html");break;case ContextMenuIconName.view_html_new_window:ProgressBar.showOverlay(),this.onViewClick("html",!0);break;case ContextMenuIconName.export_excel:this.onViewExcelClick();break;case ContextMenuIconName.cancel:this.onCancelClick();break;case ContextMenuIconName.save_existed_report:this.onSaveExistedReportClick();break;case ContextMenuIconName.save_new_report:this.onSaveNewReportClick();break;case ContextMenuIconName.save_setup:this.onSaveSetup();break;case ContextMenuIconName.view_form:this.onViewClick("pdf_form");break;case ContextMenuIconName.e_file:this.onViewClick("efile");break;case ContextMenuIconName.timesheet_view:this.onViewClick("pdf_timesheet");break;case ContextMenuIconName.timesheet_view_detail:this.onViewClick("pdf_timesheet_detail");break;default:ProgressBar.closeOverlay(),this.onCustomContextClick(i,e)}r.Global.triggerAnalyticsContextMenuClick(e,t)}}onSaveSetup(e){var t=this,i=this.getFormSetupData();null==e&&(e=$.i18n._("Form setup")),null!=this.save_export_setup_data&&(i=this.save_export_setup_data),t.show_empty_message=!1,t.form_setup_changed=!1,i?this.api.setCompanyFormConfig(i,{onResult:function(i){i.isValid()?TAlertManager.showAlert(e+" "+$.i18n._("has been saved successfully")):(t.show_empty_message=!0,t.form_setup_changed=!0,TAlertManager.showAlert(e+" "+$.i18n._("save failed, please try again")))}}):TAlertManager.showAlert(e+" "+$.i18n._("invalid, please try again"))}getFormSetupData(){}onViewClick(e,t,i){if(e||(e="pdf"),this.validate(!0)){var a=this.getPostReportJson(),o={0:a,1:e};if(this.include_form_setup){if(this.show_empty_message){var s=$.i18n._("Setup data for this report has not been completed yet. Please click on the Form Setup tab to do so now.");return i&&(s=i),void TAlertManager.showAlert(s)}a.form=this.getFormSetupData(!0)}if("html"===e){var _=ServiceCaller.getAPIURL("Class="+this.api.className+"&Method=get"+this.api.key_name+"&v=2");r.Global.getStationID()&&(_=_+"&StationID="+r.Global.getStationID()),_=_+"&MessageID="+TTUUID.generateUUID();var n="<script>";n+="var timeout_handler;",n+="function remainTime() {",n+="\tif ( auto_refresh_time && auto_refresh_time >= 0 ) {",n+="\t\tif ( auto_refresh_time == 0 ) {",n+="\t\t\tclearTimeout( timeout_handler );",n+="\t\t\tstartRefresh();",n+="\t\t} else {",n+='\t\t\ttimeout_handler = setTimeout( "remainTime()", 1000 );',n+="\t\t\tauto_refresh_time = ( auto_refresh_time - 1 );",n+="\t\t}",n+="\t}",n+="}",n+="function startRefresh() {",n+=" try {",n+="\t\t$.ajax({",n+='\t\t\tdataType: "JSON",',n+="\t\t\tdata: {json:'"+JSON.stringify(o).replace(/'/g,"\\'")+"'},",n+='\t\t\ttype: "POST",',n+="            url: '"+_+"',",n+="\t\t\tsuccess: function(result) {",n+='\t\t\tif(console){ console.log( "Auto refreshing report: "+ Date() ) }',n+="\t\t\tvar newDoc = result.api_retval + $('body').children(':last')[0].outerHTML; document.open(\"text/html\"); document.write(newDoc); document.close(); ",n+="\t\t\t}",n+="\t\t})",n+="\t} catch(e) {}",n+="}",n+="remainTime();",n+='$( "body" ).mousemove( function( e ) {',n+="\twindow.parent.Global.doPingIfNecessary()",n+="} );",n+="<\/script>",this.api["get"+this.api.key_name](a,e,{onResult:function(e){var i=e.getResult();if(i)if(!1===r.Global.isEmpty(i))if(i+=n,t){var a=window.open();a.document.writeln(i),a.document.close()}else i&&(IndexViewController.openWizard("ReportViewWizard",i),ProgressBar.closeOverlay());else TAlertManager.showAlert($.i18n._("NO DATA MATCHES CRITERIA",LocalCacheData.getApplicationName()),$.i18n._("NOTICE"));else TAlertManager.showErrorAlert(e)}})}else if("pdf_form_publish_employee"===e)this.api["get"+this.api.key_name](a,e,{onResult:function(e){var t=e.getResult();t?(UserGenericStatusWindowController.open(t,LocalCacheData.getLoginUser().id,(function(){})),ProgressBar.closeOverlay()):TAlertManager.showAlert($.i18n._("NO DATA MATCHES CRITERIA",LocalCacheData.getApplicationName()),$.i18n._("NOTICE"))}});else{this.doFormIFrameCall(o),ProgressBar.closeOverlay();var d="PDF";LocalCacheData.getAllURLArgs()&&LocalCacheData.getAllURLArgs().sm&&(d=LocalCacheData.getAllURLArgs().sm+"@PDF"),$().TFeedback({source:d,force_source:!0,delay:5e3})}}}processTransactions(e){var t={0:{filter_data:this.getPostReportJson(!0)},1:!0,2:e},i=TTAPI.APIPayStub,a=ServiceCaller.getAPIURL("Class="+i.className+"&Method=get"+i.key_name);r.Global.APIFileDownload(i.className,i.key_name,t,a)}setEditMenuViewIcon(e,t){}doFormIFrameCall(e){var t=ServiceCaller.getAPIURL("Class="+this.api.className+"&Method=get"+this.api.key_name);r.Global.APIFileDownload(this.api.className,this.api.key_name,e,t)}onSaveNewReportClick(){var e=this,t=this.getPostReportJson(!0),i=this.current_edit_record.setup_field;t.template&&i.unshift("template");var a={data:{}};a.data.config=t,a.data.template=i,a.script=this.script_name,this.sub_saved_report_view_controller?(e.sub_saved_report_view_controller.edit_only_mode=!0,e.sub_saved_report_view_controller.buildContextMenu(!0),e.sub_saved_report_view_controller.onAddClick(a)):this.initSubSavedReportView((function(){e.sub_saved_report_view_controller.edit_only_mode=!0,e.sub_saved_report_view_controller.onAddClick(a)}))}onSaveExistedReportClick(){var e=this,t=this.getPostReportJson(!0),i=this.current_edit_record.setup_field;t.template&&i.unshift("template");var a=this.current_saved_report;a||(a={}),a.data={},a.data.config=t,a.data.template=i,a.script||(a.script=this.script_name),this.sub_saved_report_view_controller?(e.sub_saved_report_view_controller.edit_only_mode=!0,e.sub_saved_report_view_controller.buildContextMenu(!0),e.sub_saved_report_view_controller.onAddClick(a)):this.initSubSavedReportView((function(){e.sub_saved_report_view_controller.edit_only_mode=!0,e.sub_saved_report_view_controller.onAddClick(a)}))}onSaveDoneCallback(e,t){var i=e.getResult();0==TTUUID.isUUID(i)&&t&&t.id&&(i=t.id),this.refreshNav(i)}refreshNav(e){var t=this;this.navigation.setSourceData(null),t.getReportData((function(i){if(i&&i.length>0){if(TTUUID.isUUID(e))for(var a=0;a<i.length;a++){if(i[a].id===e){t.current_saved_report=i[a];break}}else t.current_saved_report=t.getDefaultReport(i);t.saved_report_array=i}else t.current_saved_report=null,t.saved_report_array=[];t.current_edit_record={},t.visible_report_values={},t.initEditView()}))}}o.ReportMissedField=null}}]);
//# sourceMappingURL=reports-ReportBaseViewController.bundle.js.map?v=5260330e9838f5bc022b