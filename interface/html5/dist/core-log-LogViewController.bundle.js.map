{"version":3,"sources":["webpack://timetrex/./interface/html5/views/core/log/LogViewController.js"],"names":["LogViewController","BaseViewController","options","_","defaults","el","tables","log_detail_grid","log_detail_script_name","super","this","edit_view_tpl","context_menu_name","$","i18n","navigation_label","viewId","script_name","api","TTAPI","APILog","noticeDiv","render","sub_view_mode","buildContextMenu","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_audit_details_column1","edit_view_tab","find","form_item_input","Global","loadWidgetByName","FormItemType","TEXT","TText","field","addEditFieldToColumn","initLogDetailsView","set_default_menu","page_action","page_number","callBack","isSet","$this","filter","filter_columns","getFilterColumnsFromDisplayColumns","filter_items_per_page","pager_data","LocalCacheData","paging_type","filter_page","next_page","previous_page","last_page_number","current_page","select_layout","data","parent_key","filter_data","parent_value","getSubViewFilter","convertLayoutFilterToAPIFilter","filter_sort","TTUUID","isUUID","refresh_id","last_select_ids","getGridSelectIdArray","key_name","onResult","result","len","result_data","getResult","isArray","removeNoResultCover","__createRowId","formatGridData","length","showNoResultCover","setAuditInfo","grid_source_data","grid","getGridParam","type","found","new_record","i","setRowData","push","setData","getPagerData","paging_widget","setPagerData","paging_widget_2","concat","processResultData","setGridColumnsWidth","resizeSubGrid","reSelectLastSelectItems","setGridCellBackGround","ProgressBar","closeOverlay","setDefaultMenu","is_last_page","css","autoOpenEditViewIfNecessary","searchDone","container_selector","sub_grid_mode","onResizeGrid","multiselect","onSelectRow","onGridSelectRow","onCellSelect","onSelectAll","onGridSelectAll","ondblClickRow","e","onGridDblClickRow","onRightClickRow","rowId","indexOf","resetSelection","setSelection","setGridSize","baseViewSubTabGridResize","header_size","setGridHeight","parent","height","updated_info","parent_edit_record","created_info","text","current_doing_context_action","edit_id_for_next_open_view","onViewClick","autoOpenEditOnlyViewIfNecessary","column_start_from","edit_view","attr","column_info_array","display_columns","label","value","start_from","view_column_data","column_info","name","index","width","sortable","title","grid_setup","TTGrid","initEditViewData","getProductEdition","html","getUpgradeMessage","onViewDetailClick","key","current_edit_record","widget","edit_view_ui_dic","setValue","setLogDetailsViewData","collectUIDataToCurrentEditRecord","setEditViewDataDone","log_detail_data","showDetailNoResultCover","setLogDetailGridSize","is","tab_audit_details","first_row","setGridWidth","no_result_box","WidgetNamesDic","NO_RESULT_BOX","NoResultBox","related_view_controller","is_new","append","editId","noRefreshUI","is_viewing","openEditView","selectedId","grid_selected_id_array","grid_selected_length","getFilterColumnsForViewDetails","initEditView","column_filter","context_menu_array","selectContextMenu","setTotalDisplaySpan","context_btn","removeClass","ContextMenuIconName","view_detail","addClass","exclude","include","group","icon","Icons","cancel","table_name_key","trigger","TTPromise","resolve","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","loadViewSource","args","updated","created","template","sub_log_view_controller"],"mappings":"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","file":"core-log-LogViewController.bundle.js?v=0a01cf7824cf97dd9500","sourcesContent":["export class LogViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#log_view_container',\n\t\t\ttables: {\n\t\t\t\t'product': ['product', 'product_price'],\n\t\t\t\t'user_contact': ['user_contact'],\n\t\t\t\t'users': ['users', 'user_preference', 'user_wage', 'authentication'],\n\t\t\t\t'user_wage': ['user_wage'],\n\t\t\t\t'user_title': ['user_title'],\n\t\t\t\t'user_preference': ['user_preference'],\n\t\t\t\t'bank_account': ['bank_account'],\n\t\t\t\t'user_default': ['user_default'],\n\t\t\t\t'user_group': ['user_group'],\n\t\t\t\t'company': ['company'],\n\t\t\t\t'pay_period_schedule': ['pay_period_schedule', 'pay_period', 'pay_period_schedule_user'],\n\t\t\t\t'pay_period': ['pay_period'],\n\t\t\t\t'branch': ['branch'],\n\t\t\t\t'department': ['department'],\n\t\t\t\t'hierarchy_control': ['hierarchy_control', 'hierarchy_object_type', 'hierarchy_user', 'hierarchy_level'],\n\t\t\t\t'wage_group': ['wage_group'],\n\t\t\t\t'ethnic_group': ['ethnic_group'],\n\t\t\t\t'currency': ['currency'],\n\t\t\t\t'currency_rate': ['currency_rate'],\n\t\t\t\t'permission_control': ['permission_control', 'permission_user'],\n\t\t\t\t'other_field': ['other_field'],\n\t\t\t\t'station': ['station', 'station_user_group', 'station_branch', 'station_department', 'station_include_user', 'station_exclude_user'],\n\t\t\t\t'pay_stub_amendment': ['pay_stub_amendment'],\n\t\t\t\t'recurring_ps_amendment': ['recurring_ps_amendment', 'recurring_ps_amendment_user'],\n\t\t\t\t'pay_stub_entry_account': ['pay_stub_entry_account'],\n\t\t\t\t'company_deduction': ['company_deduction', 'user_deduction', 'company_deduction_pay_stub_entry_account'],\n\t\t\t\t'user_expense': ['user_expense'],\n\t\t\t\t'round_interval_policy': ['round_interval_policy'],\n\t\t\t\t'meal_policy': ['meal_policy'],\n\t\t\t\t'break_policy': ['break_policy'],\n\t\t\t\t'over_time_policy': ['over_time_policy'],\n\t\t\t\t'absence_policy': ['absence_policy'],\n\t\t\t\t'recurring_holiday': ['recurring_holiday'],\n\t\t\t\t'holiday_policy': ['holiday_policy', 'holiday_policy_recurring_holiday'],\n\t\t\t\t'holidays': ['holidays'],\n\t\t\t\t'premium_policy': ['premium_policy'],\n\t\t\t\t'policy_group': ['policy_group', 'policy_group_user'],\n\t\t\t\t'document': ['document', 'document_revision'],\n\t\t\t\t'document_group': ['document_group'],\n\t\t\t\t'document_revision': ['document_revision'],\n\t\t\t\t'schedule_policy': ['schedule_policy'],\n\t\t\t\t'accrual_policy': ['accrual_policy', 'accrual_policy_milestone', 'accrual_policy_user_modifier'],\n\t\t\t\t'client': ['client', 'client_contact', 'client_payment'],\n\t\t\t\t'report_custom_column': ['report_custom_column'],\n\t\t\t\t'client_contact': ['client_contact'],\n\t\t\t\t'client_payment': ['client_payment'],\n\t\t\t\t'invoice_transaction': ['invoice_transaction'],\n\t\t\t\t'invoice': ['invoice'],\n\t\t\t\t'job': ['job', 'job_exclude_job_item', 'job_exclude_user', 'job_include_job_item', 'job_include_user', 'job_job_item_group', 'job_user_branch', 'job_user_group', 'job_user_department'],\n\t\t\t\t'client_group': ['client_group'],\n\t\t\t\t'product_group': ['product_group'],\n\t\t\t\t'job_item': ['job_item'],\n\t\t\t\t'job_group': ['job_group'],\n\t\t\t\t'job_item_group': ['job_item_group'],\n\t\t\t\t'report_schedule': ['report_schedule'],\n\t\t\t\t'accrual_policy_account': ['accrual_policy_account'],\n\t\t\t\t'accrual': ['accrual'],\n\t\t\t\t'accrual_balance': ['accrual_balance'],\n\t\t\t\t'schedule': ['schedule'],\n\t\t\t\t'recurring_schedule_control': ['recurring_schedule_control', 'recurring_schedule_user'],\n\t\t\t\t'recurring_schedule_template_control': ['recurring_schedule_template_control', 'recurring_schedule_template'],\n\t\t\t\t'punch': ['punch', 'punch_control'],\n\t\t\t\t'kpi': ['kpi'],\n\t\t\t\t'kpi_group': ['kpi_group'],\n\t\t\t\t'qualification': ['qualification'],\n\t\t\t\t'qualification_group': ['qualification_group'],\n\t\t\t\t'user_skill': ['user_skill'],\n\t\t\t\t'user_education': ['user_education'],\n\t\t\t\t'user_membership': ['user_membership'],\n\t\t\t\t'user_license': ['user_license'],\n\t\t\t\t'user_language': ['user_language'],\n\t\t\t\t'job_vacancy': ['job_vacancy'],\n\t\t\t\t'job_application': ['job_application'],\n\t\t\t\t'job_applicant': ['job_applicant'],\n\t\t\t\t'invoice_district': ['invoice_district'],\n\t\t\t\t'job_applicant_employment': ['job_applicant_employment'],\n\t\t\t\t'job_applicant_reference': ['job_applicant_reference'],\n\t\t\t\t'job_applicant_location': ['job_applicant_location'],\n\t\t\t\t'job_applicant_skill': ['job_applicant_skill'],\n\t\t\t\t'job_applicant_education': ['job_applicant_education'],\n\t\t\t\t'job_applicant_license': ['job_applicant_license'],\n\t\t\t\t'job_applicant_membership': ['job_applicant_membership'],\n\t\t\t\t'job_applicant_language': ['job_applicant_language'],\n\t\t\t\t'tax_policy': ['tax_policy'],\n\t\t\t\t'area_policy': ['area_policy'],\n\t\t\t\t'shipping_policy': ['shipping_policy'],\n\t\t\t\t'payment_gateway': ['payment_gateway'],\n\t\t\t\t'request': ['request'],\n\t\t\t\t'exception_policy_control': ['exception_policy_control', 'exception_policy'],\n\t\t\t\t'user_review_control': ['user_review_control', 'user_review'],\n\t\t\t\t'roe': ['roe'],\n\t\t\t\t'expense_policy': ['expense_policy'],\n\t\t\t\t'user_report_data': ['user_report_data'],\n\t\t\t\t'regular_time_policy': ['regular_time_policy'],\n\t\t\t\t'pay_code': ['pay_code'],\n\t\t\t\t'pay_formula_policy': ['pay_formula_policy'],\n\t\t\t\t'contributing_pay_code_policy': ['contributing_pay_code_policy'],\n\t\t\t\t'contributing_shift_policy': ['contributing_shift_policy'],\n\t\t\t\t'accrual_policy_user_modifier': ['accrual_policy_user_modifier'],\n\t\t\t\t'job_item_amendment': ['job_item_amendment'],\n\t\t\t\t'user_date_total': ['user_date_total'],\n\t\t\t\t'pay_stub': ['pay_stub', 'pay_stub_entry'],\n\t\t\t\t'legal_entity': ['legal_entity'],\n\t\t\t\t'payroll_remittance_agency': ['payroll_remittance_agency'],\n\t\t\t\t'payroll_remittance_agency_event': ['payroll_remittance_agency_event'],\n\t\t\t\t'remittance_source_account': ['remittance_source_account'],\n\t\t\t\t'remittance_destination_account': ['remittance_destination_account'],\n\t\t\t\t'geo_fence': ['geo_fence']\n\t\t\t},\n\t\t\tlog_detail_grid: null,\n\t\t\tlog_detail_script_name: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'LogEditView.html';\n\t\tthis.context_menu_name = $.i18n._( 'Audit' );\n\t\tthis.navigation_label = $.i18n._( 'Audit' ) + ':';\n\t\tthis.viewId = 'Log';\n\t\tthis.script_name = 'LogView';\n\t\tthis.log_detail_script_name = 'LogDetailView';\n\t\tthis.api = TTAPI.APILog;\n\t\tthis.noticeDiv = $( '.audit-info' );\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar tab_model = {\n\t\t\t'tab_audit_details': { 'label': $.i18n._( 'Audit Details' ) },\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APILog,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_log',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\tvar tab_audit_details = this.edit_view_tab.find( '#tab_audit_details' );\n\t\tvar tab_audit_details_column1 = tab_audit_details.find( '.first-row' );\n\t\t// tab_audit_details column1\n\n\t\t// Date\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( {\n\t\t\tfield: 'date'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_audit_details_column1, '' );\n\n\t\t// Action\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( {\n\t\t\tfield: 'action'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Action' ), form_item_input, tab_audit_details_column1 );\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\n\t\tform_item_input.TText( {\n\t\t\tfield: 'user_name'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_audit_details_column1 );\n\n\t\t// Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( {\n\t\t\tfield: 'description'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_audit_details_column1, '' );\n\n\t\t// set the log details information.\n\t\tthis.initLogDetailsView();\n\t}\n\n\tsearch( set_default_menu, page_action, page_number, callBack ) {\n\n\t\tif ( !Global.isSet( set_default_menu ) ) {\n\t\t\tset_default_menu = true;\n\t\t}\n\n\t\tvar $this = this;\n\t\tvar filter = {};\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_sort = {};\n\t\tfilter.filter_columns = this.getFilterColumnsFromDisplayColumns();\n\t\tfilter.filter_items_per_page = 0; // Default to 0 to load user preference defined\n\n\t\tif ( this.pager_data ) {\n\n\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\tif ( page_action === 'next' ) {\n\t\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t\t} else {\n\t\t\t\t\tfilter.filter_page = 1;\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tswitch ( page_action ) {\n\t\t\t\t\tcase 'next':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'last':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.previous_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'start':\n\t\t\t\t\t\tfilter.filter_page = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'end':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.last_page_number;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'go_to':\n\t\t\t\t\t\tfilter.filter_page = page_number;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.current_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\t\t\tfilter.filter_page = 1;\n\t\t}\n\n\t\tif ( this.select_layout && this.select_layout.data ) {\n\t\t\tif ( this.sub_view_mode && this.parent_key ) {\n\t\t\t\tthis.select_layout.data.filter_data[this.parent_key] = this.parent_value;\n\t\t\t}\n\n\t\t\t//If sub view controller set custom filters, get it\n\t\t\tif ( Global.isSet( this.getSubViewFilter ) ) {\n\t\t\t\tthis.select_layout.data.filter_data = this.getSubViewFilter( this.select_layout.data.filter_data );\n\t\t\t}\n\n\t\t\t//select_layout will not be null, it's set in setSelectLayout function\n\t\t\tfilter.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\t\tfilter.filter_sort = this.select_layout.data.filter_sort;\n\t\t}\n\n\t\tif ( TTUUID.isUUID( this.refresh_id ) ) {\n\t\t\tfilter.filter_data = {};\n\t\t\tfilter.filter_data.id = [this.refresh_id];\n\n\t\t\tthis.last_select_ids = filter.filter_data.id;\n\t\t} else {\n\t\t\tthis.last_select_ids = this.getGridSelectIdArray();\n\t\t}\n\n\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\t\t\t\tvar len;\n\n\t\t\t\tif ( !Global.isArray( result_data ) ) {\n\t\t\t\t\t$this.showNoResultCover();\n\t\t\t\t} else {\n\t\t\t\t\t$this.removeNoResultCover();\n\t\t\t\t\tif ( Global.isSet( $this.__createRowId ) ) {\n\t\t\t\t\t\tresult_data = $this.__createRowId( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_data = Global.formatGridData( result_data, $this.api.key_name );\n\n\t\t\t\t\tlen = result_data.length;\n\t\t\t\t}\n\t\t\t\t$this.setAuditInfo();\n\t\t\t\tif ( TTUUID.isUUID( $this.refresh_id ) ) {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t\tvar grid_source_data = $this.grid.grid.getGridParam( 'data' );\n\t\t\t\t\tlen = grid_source_data.length;\n\n\t\t\t\t\tif ( $.type( grid_source_data ) !== 'array' ) {\n\t\t\t\t\t\tgrid_source_data = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tvar found = false;\n\t\t\t\t\tvar new_record = result_data[0];\n\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'id' of undefined in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-084605 line 4851\n\t\t\t\t\tif ( new_record ) {\n\t\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\t\tvar record = grid_source_data[i];\n\n\t\t\t\t\t\t\t//Fixed === issue. The id set by jQGrid is string type.\n\t\t\t\t\t\t\t// if ( !isNaN( parseInt( record.id ) ) ) {\n\t\t\t\t\t\t\t// \trecord.id = parseInt( record.id );\n\t\t\t\t\t\t\t// }\n\n\t\t\t\t\t\t\tif ( record.id == new_record.id ) {\n\t\t\t\t\t\t\t\t$this.grid.grid.setRowData( new_record.id, new_record );\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( !found ) {\n\t\t\t\t\t\t\tgrid_source_data.push( new_record );\n\t\t\t\t\t\t\t$this.grid.setData( grid_source_data );\n\n\t\t\t\t\t\t\t// if ( $this.sub_view_mode && Global.isSet( $this.resizeSubGrid ) ) {\n\t\t\t\t\t\t\t// \tlen = Global.isSet( len ) ? len : 0;\n\t\t\t\t\t\t\t// \t$this.resizeSubGrid( len + 1 );\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\t//Set Page data to widget, next show display info when setDefault Menu\n\t\t\t\t\t$this.pager_data = result.getPagerData();\n\n\t\t\t\t\t//CLick to show more mode no need this step\n\t\t\t\t\tif ( LocalCacheData.paging_type !== 0 ) {\n\t\t\t\t\t\t$this.paging_widget.setPagerData( $this.pager_data );\n\t\t\t\t\t\t$this.paging_widget_2.setPagerData( $this.pager_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( LocalCacheData.paging_type === 0 && page_action === 'next' ) {\n\t\t\t\t\t\tvar current_data = $this.grid.getGridParam( 'data' );\n\t\t\t\t\t\tresult_data = current_data.concat( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Process result_data if necessary, this always needs override.\n\t\t\t\t\tresult_data = $this.processResultData( result_data );\n\n\t\t\t\t\tif ( $this.grid ) {\n\t\t\t\t\t\t$this.grid.setData( result_data );\n\t\t\t\t\t\t$this.setGridColumnsWidth();\n\t\t\t\t\t\tif ( $this.sub_view_mode && Global.isSet( $this.resizeSubGrid ) ) {\n\t\t\t\t\t\t\t$this.resizeSubGrid( len );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.reSelectLastSelectItems();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$this.setGridCellBackGround(); //Set cell background for some views\n\n\t\t\t\tProgressBar.closeOverlay(); //Add this in initData\n\n\t\t\t\tif ( set_default_menu ) {\n\t\t\t\t\t$this.setDefaultMenu( true );\n\t\t\t\t}\n\n\t\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\t\tif ( !$this.pager_data || $this.pager_data.is_last_page ) {\n\t\t\t\t\t\t$this.paging_widget.css( 'display', 'none' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.paging_widget.css( 'display', 'block' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack( result );\n\t\t\t\t}\n\n\t\t\t\t// when call this from save and new result, we don't call auto open, because this will call onAddClick twice\n\t\t\t\tif ( set_default_menu ) {\n\t\t\t\t\t$this.autoOpenEditViewIfNecessary();\n\t\t\t\t}\n\n\t\t\t\t$this.searchDone();\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetGridSetup() {\n\t\tvar $this = this;\n\t\treturn {\n\t\t\tcontainer_selector: this.sub_view_mode ? '.edit-view-tab-bar' : 'body',\n\t\t\tsub_grid_mode: this.sub_view_mode,\n\t\t\tonResizeGrid: true,\n\t\t\tmultiselect: false,\n\t\t\tonSelectRow: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonCellSelect: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonSelectAll: function() {\n\t\t\t\t$this.onGridSelectAll();\n\t\t\t},\n\t\t\tondblClickRow: function( e ) {\n\t\t\t\t$this.onGridDblClickRow( e );\n\t\t\t},\n\t\t\tonRightClickRow: function( rowId ) {\n\t\t\t\tvar id_array = $this.getGridSelectIdArray();\n\t\t\t\tif ( id_array.indexOf( rowId ) < 0 ) {\n\t\t\t\t\t$this.grid.grid.resetSelection();\n\t\t\t\t\t$this.grid.grid.setSelection( rowId );\n\t\t\t\t\t$this.onGridSelectRow();\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetGridSize: function() {\n\t\t\t\t$this.baseViewSubTabGridResize( 'tab_audit' ); //Works for Edit Employee -> Audit tab\n\t\t\t}\n\t\t};\n\t}\n\n\t_setGridSizeGridHeight( header_size ) {\n\t\t// if ( !this.sub_view_mode ) {\n\t\t// \tthis.grid.setGridHeight( ($( this.el ).height() - (this.search_panel && this.search_panel.is( ':visible' ) ? this.search_panel.height() : 0) - 68 - header_size) );\n\t\t// } else if ( !Global.isSet( this.resizeSubGrid ) ) {\n\t\tif ( this.pager_data && this.pager_data.last_page_number > 1 ) {\n\t\t\tthis.grid.setGridHeight( $( this.el ).parent().parent().parent().height() - 101 - header_size );\n\t\t} else {\n\t\t\tthis.grid.setGridHeight( $( this.el ).parent().parent().parent().height() - 78 - header_size );\n\t\t}\n\n\t\t// }\n\t}\n\n\tsetAuditInfo() {\n\t\tvar updated_info = ( this.parent_edit_record['updated_date'] || $.i18n._( 'N/A' ) ) + ' ' + $.i18n._( 'by' ) + ' ' + ( this.parent_edit_record['updated_by'] || $.i18n._( 'N/A' ) ) + ' ';\n\t\tvar created_info = ( this.parent_edit_record['created_date'] || $.i18n._( 'N/A' ) ) + ' ' + $.i18n._( 'by' ) + ' ' + ( this.parent_edit_record['created_by'] || $.i18n._( 'N/A' ) ) + ' ';\n\t\tthis.noticeDiv.find( '.left > .info' ).text( updated_info );\n\t\tthis.noticeDiv.find( '.right > .info' ).text( created_info );\n\t}\n\n\tautoOpenEditViewIfNecessary() {\n\t\t//Auto open edit view. Should set in IndexController\n\t\tswitch ( LocalCacheData.current_doing_context_action ) {\n\t\t\tcase 'view':\n\t\t\t\tif ( LocalCacheData.edit_id_for_next_open_view ) {\n\t\t\t\t\tthis.onViewClick( LocalCacheData.edit_id_for_next_open_view );\n\t\t\t\t\tLocalCacheData.edit_id_for_next_open_view = null;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.autoOpenEditOnlyViewIfNecessary();\n\t}\n\n\tinitLogDetailsView( column_start_from ) {\n\n\t\tvar grid = this.edit_view.find( '#grid' );\n\n\t\tif ( grid ) {\n\t\t\tgrid.attr( 'id', this.log_detail_script_name + '_grid' );  //Grid's id is ScriptName + _grid\n\t\t}\n\n\t\t//grid = this.edit_view.find( '#' + this.log_detail_script_name + '_grid' );\n\n\t\tvar column_info_array = [];\n\t\tvar display_columns = [\n\t\t\t{ label: $.i18n._( 'Field' ), value: 'display_field' },\n\t\t\t{ label: $.i18n._( 'Before' ), value: 'old_value' },\n\t\t\t{ label: $.i18n._( 'After' ), value: 'new_value' }\n\t\t];\n\n\t\t//Set Data Grid on List view\n\t\tvar len = display_columns.length;\n\n\t\tvar start_from = 0;\n\n\t\tif ( Global.isSet( column_start_from ) && column_start_from > 0 ) {\n\t\t\tstart_from = column_start_from;\n\t\t}\n\n\t\tfor ( var i = start_from; i < len; i++ ) {\n\t\t\tvar view_column_data = display_columns[i];\n\n\t\t\tvar column_info = {\n\t\t\t\tname: view_column_data.value,\n\t\t\t\tindex: view_column_data.value,\n\t\t\t\tlabel: view_column_data.label,\n\t\t\t\twidth: 100,\n\t\t\t\tsortable: false,\n\t\t\t\ttitle: false\n\t\t\t};\n\t\t\tcolumn_info_array.push( column_info );\n\t\t}\n\n\t\tvar grid_setup = {\n\t\t\tcontainer_selector: this.sub_view_mode ? '.edit-view-tab-bar' : 'body',\n\t\t\tsub_grid_mode: this.sub_view_mode,\n\t\t\tonResizeGrid: true,\n\t\t\tmultiselect: false,\n\t\t};\n\n\t\tthis.log_detail_grid = new TTGrid( this.log_detail_script_name + '_grid', grid_setup, column_info_array );\n\t}\n\n\tinitEditViewData() {\n\t\tsuper.initEditViewData();\n\t\tif ( Global.getProductEdition() >= 15 ) {\n\t\t\tthis.edit_view_tab.find( '#tab_audit_details' ).find( '.detail-grid-row' ).css( 'display', 'block' );\n\t\t\tthis.edit_view.find( '.permission-defined-div' ).css( 'display', 'none' );\n\t\t} else {\n\t\t\tthis.edit_view_tab.find( '#tab_audit_details' ).find( '.detail-grid-row' ).css( 'display', 'none' );\n\t\t\tthis.edit_view.find( '.permission-defined-div' ).css( 'display', 'block' );\n\t\t\tthis.edit_view.find( '.permission-message' ).html( Global.getUpgradeMessage() );\n\t\t}\n\n\t\tthis.log_detail_grid.setGridColumnsWidth();\n\t}\n\n\tonGridDblClickRow() {\n\t\tthis.onViewDetailClick();\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'user_name':\n\t\t\t\t\t\twidget.setValue( this.current_edit_record['first_name'] + ' ' + this.current_edit_record['last_name'] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'details':\n\t\t\t\t\t\tthis.setLogDetailsViewData( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetLogDetailsViewData( log_detail_data ) {\n\n\t\tvar $this = this;\n\n\t\tif ( !Global.isArray( log_detail_data ) ) {\n\t\t\t$this.showDetailNoResultCover();\n\t\t} else {\n\t\t\t$this.removeNoResultCover();\n\t\t}\n\n\t\tlog_detail_data = Global.formatGridData( log_detail_data );\n\n\t\t$this.log_detail_grid.setData( log_detail_data );\n\n\t\t$this.setLogDetailGridSize();\n\t}\n\n\tsetLogDetailGridSize() {\n\n\t\tif ( !this.log_detail_grid || !$( this.log_detail_grid.grid ).is( ':visible' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tab_audit_details = this.edit_view.find( '#tab_audit_details_content_div' );\n\t\tvar first_row = this.edit_view.find( '.first-row' );\n\t\tthis.log_detail_grid.grid.setGridWidth( tab_audit_details.width() );\n\t\tthis.log_detail_grid.grid.setGridHeight( tab_audit_details.height() - first_row.height() );\n\t}\n\n\tshowDetailNoResultCover() {\n\t\tthis.removeNoResultCover();\n\t\tthis.no_result_box = Global.loadWidgetByName( WidgetNamesDic.NO_RESULT_BOX );\n\t\tthis.no_result_box.NoResultBox( { related_view_controller: this, is_new: false } );\n\n\t\tvar grid_div = this.edit_view.find( '.grid-div' );\n\n\t\tgrid_div.append( this.no_result_box );\n\t}\n\n\tshowNoResultCover() {\n\t\tsuper.showNoResultCover( false );\n\t}\n\n\tonEditClick( editId, noRefreshUI ) {\n\n\t\tthis.onViewDetailClick( editId, noRefreshUI );\n\t}\n\n\tonViewDetailClick( editId ) {\n\n\t\tvar $this = this;\n\t\tthis.is_viewing = false;\n\t\tLocalCacheData.current_doing_context_action = 'view_detail';\n\t\t$this.openEditView();\n\n\t\tvar filter = {};\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\tvar selectedId;\n\t\tif ( Global.isSet( editId ) ) {\n\t\t\tselectedId = editId;\n\t\t} else {\n\n\t\t\tif ( this.is_viewing ) {\n\t\t\t\tselectedId = this.current_edit_record.id;\n\t\t\t} else if ( grid_selected_length > 0 ) {\n\t\t\t\tselectedId = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = [selectedId];\n\t\t//If sub view controller set custom filters, get it\n\t\tif ( Global.isSet( this.getSubViewFilter ) ) {\n\n\t\t\tfilter.filter_data = this.getSubViewFilter( filter.filter_data );\n\n\t\t}\n\t\tfilter.filter_columns = this.getFilterColumnsForViewDetails();\n\n\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( !result_data ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\tresult_data = result_data[0];\n\n\t\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t\t\t}\n\n\t\t\t\t$this.current_edit_record = result_data;\n\n\t\t\t\t$this.initEditView();\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetFilterColumnsFromDisplayColumns() {\n\t\tvar column_filter = {};\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.table_name = true;\n\n\t\t// Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tvar display_columns = [];\n\t\tif ( this.grid ) {\n\t\t\tdisplay_columns = this.grid.getGridParam( 'colModel' );\n\t\t}\n\n\t\tif ( display_columns ) {\n\t\t\tvar len = display_columns.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar column_info = display_columns[i];\n\t\t\t\tcolumn_filter[column_info.name] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tgetFilterColumnsForViewDetails() {\n\t\tvar display_columns = this.grid.getGridParam( 'colModel' );\n\n\t\tvar column_filter = {};\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.table_name = true;\n\t\tcolumn_filter.details = true;\n\n\t\tvar len = display_columns.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar column_info = display_columns[i];\n\t\t\tcolumn_filter[column_info.name] = true;\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tsetDefaultMenu() {\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Employee&a=edit&id=42411&tab=Wage line 282\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.selectContextMenu();\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.view_detail:\n\t\t\t\t\tif ( grid_selected_length === 1 ) {\n\t\t\t\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.view_detail:\n\t\t\t\tthis.onViewDetailClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetEditMenu() {\n\n\t\tthis.selectContextMenu();\n\t\tvar len = this.context_menu_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.view_detail:\n\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['default'],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'View Details' ),\n\t\t\t\t\tid: ContextMenuIconName.view_detail,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.view_detail\n\t\t\t\t},\n\t\t\t\tContextMenuIconName.cancel\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tgetSubViewFilter( filter ) {\n\t\tif ( Global.isSet( this.table_name_key ) ) {\n\t\t\tfilter['table_name'] = this.tables[this.table_name_key];\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\tsearchDone() {\n\t\t$( 'window' ).trigger( 'resize' );\n\t\tTTPromise.resolve( 'initSubAudit', 'init' );\n\t\tsuper.searchDone();\n\n\t}\n\n}\n\nLogViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'Log', 'SubLogView.html', function( result ) {\n\n\t\tvar args = {\n\t\t\tupdated: $.i18n._( 'Updated' ),\n\t\t\tcreated: $.i18n._( 'Created' )\n\t\t};\n\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tafterViewLoadedFun( sub_log_view_controller );\n\t\t\t}\n\t\t}\n\t} );\n};\n"],"sourceRoot":""}