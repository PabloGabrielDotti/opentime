(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["policy-recurring_holiday-RecurringHolidayViewController"],{2625:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"RecurringHolidayViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#recurring_holiday_view_container",special_day_array:null,type_array:null,day_of_month_array:null,day_of_week_array:null,month_of_year_array:null,always_week_day_array:null,week_interval_array:null,pivot_day_direction_array:null,date_api:null}),super(e)}init(e){this.edit_view_tpl="RecurringHolidayEditView.html",this.permission_id="holiday_policy",this.viewId="RecurringHoliday",this.script_name="RecurringHolidayView",this.table_name_key="recurring_holiday",this.context_menu_name=$.i18n._("Recurring Holiday"),this.navigation_label=$.i18n._("Recurring Holiday")+":",this.api=TTAPI.APIRecurringHoliday,this.date_api=TTAPI.APITTDate,this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary("RecurringHoliday")}initOptions(){var e=this;this.initDropDownOption("special_day","special_day"),this.initDropDownOption("week_interval","week_interval"),this.initDropDownOption("type"),this.initDropDownOption("pivot_day_direction"),this.initDropDownOption("always_week_day","always_week_day"),this.date_api.getDayOfMonthArray({onResult:function(t){t=t.getResult(),e.day_of_month_array=t}}),this.date_api.getMonthOfYearArray({onResult:function(t){t=t.getResult(),e.month_of_year_array=t}}),this.date_api.getDayOfWeekArray({onResult:function(t){t=t.getResult(),e.day_of_week_array=t}})}buildEditViewUI(){super.buildEditViewUI();var e=this,t={"tab_recurring_holiday":{"label":$.i18n._("Recurring Holiday")},"tab_audit":!0};this.setTabModel(t),this.navigation.AComboBox({api_class:TTAPI.APIRecurringHoliday,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_recurring_holiday",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var i=this.edit_view_tab.find("#tab_recurring_holiday").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(i);var a=Global.loadWidgetByName(FormItemType.TEXT_INPUT);a.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),a,i,""),a.parent().width("45%"),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"special_day"}),a.setSourceData(e.special_day_array),this.addEditFieldToColumn($.i18n._("Special Day"),a,i),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type_id",set_empty:!1}),a.setSourceData(e.type_array),this.addEditFieldToColumn($.i18n._("Type"),a,i,"",null,!0),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"week_interval"}),a.setSourceData(e.week_interval_array),this.addEditFieldToColumn($.i18n._("Week Interval"),a,i,"",null,!0),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"day_of_week"}),a.setSourceData($.extend({},e.day_of_week_array)),this.addEditFieldToColumn($.i18n._("Day of the week"),a,i,"",null,!0),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"pivot_day_direction_id"}),a.setSourceData(e.pivot_day_direction_array),this.addEditFieldToColumn($.i18n._("Pivot Day Direction"),a,i,"",null,!0),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"day_of_month"}),a.setSourceData(e.day_of_month_array),this.addEditFieldToColumn($.i18n._("Day of the Month"),a,i,"",null,!0),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"month_int"}),a.setSourceData(e.month_of_year_array),this.addEditFieldToColumn($.i18n._("Month"),a,i,"",null,!0),(a=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"always_week_day_id"}),a.setSourceData(e.always_week_day_array),this.addEditFieldToColumn($.i18n._("Always On Week Day"),a,i,"")}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),a=e.getValue();this.current_edit_record[i]=a,"special_day"===i&&this.onSpecialDayChange(),"type_id"===i&&this.onTypeChange(),t||this.validate()}setEditViewDataDone(){super.setEditViewDataDone(),this.onSpecialDayChange(),this.onTypeChange()}onSpecialDayChange(){this.detachElement("type_id"),this.detachElement("week_interval"),this.detachElement("day_of_week"),this.detachElement("pivot_day_direction_id"),this.detachElement("day_of_month"),this.detachElement("month_int"),Global.isFalseOrNull(this.current_edit_record.special_day)&&(this.current_edit_record.special_day=0),0===parseInt(this.current_edit_record.special_day)&&(this.attachElement("type_id"),this.detachElement("week_interval"),this.detachElement("day_of_week"),this.detachElement("pivot_day_direction_id"),this.attachElement("day_of_month"),this.attachElement("month_int")),this.editFieldResize()}onTypeChange(){0===parseInt(this.current_edit_record.special_day)&&(10==this.current_edit_record.type_id?(this.detachElement("week_interval"),this.detachElement("day_of_week"),this.detachElement("pivot_day_direction_id"),this.attachElement("day_of_month"),this.attachElement("month_int")):20==this.current_edit_record.type_id?(this.attachElement("week_interval"),this.attachElement("day_of_week"),this.detachElement("pivot_day_direction_id"),this.detachElement("day_of_month"),this.attachElement("month_int")):30==this.current_edit_record.type_id&&(this.detachElement("week_interval"),this.attachElement("day_of_week"),this.attachElement("pivot_day_direction_id"),this.attachElement("day_of_month"),this.attachElement("month_int"))),this.editFieldResize()}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Name"),in_column:1,field:"name",multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX})]}}}}]);
//# sourceMappingURL=policy-recurring_holiday-RecurringHolidayViewController.bundle.js.map?v=5b0abd963aa80c9f8e9d