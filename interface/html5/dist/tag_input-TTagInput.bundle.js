(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["tag_input-TTagInput"],{4466:()=>{var e;(e=jQuery).fn.TTagInput=function(t){var a,n,i,r=e.extend({},e.fn.TTagInput.defaults,t),o=this,s=null,c=[],l=null,u=!0,d="",h=-1;return this.showErrorTip=function(t){Global.isSet(t)||(t=2),n||(n=(n=Global.loadWidgetByName(WidgetNamesDic.ERROR_TOOLTIP)).ErrorTipBox()),e(this).hasClass("warning-tip")?n.show(this,d,t,!0):n.show(this,d,t)},this.hideErrorTip=function(){Global.isSet(n)&&n.remove()},this.getEnabled=function(){return u},this.setEnabled=function(e){u=e,!1===e||""===e?(o.addClass("t-tag-input-readonly"),s.addClass("add-tag-input-readonly"),s.attr("disabled",!0)):(o.removeClass("t-tag-input-readonly"),s.removeClass("add-tag-input-readonly"),s.removeAttr("disabled"))},this.setCheckBox=function(e){l&&(l.children().eq(0)[0].checked=e)},this.isChecked=function(){return!(!l||!0!==l.children().eq(0)[0].checked)},this.setMassEditMode=function(t){t?((l=e(' <div class="mass-edit-checkbox-wrapper tag-mass-edit-checkbox-wrapper"><input type="checkbox" class="mass-edit-checkbox"></input><label for="checkbox-input-1" class="input-helper input-helper--checkbox"></label></div>')).insertBefore(e(this)),l.change((function(){o.trigger("formItemChange",[o])}))):l&&(l.remove(),l=null)},this.clearErrorStyle=function(){},this.getField=function(){return a},Global.addCss("global/widgets/tag_input/TTagInput.css"),this.getValue=function(){var e="";for(var t in c)c[t]&&(e=e+c[t].find(".tag-span").text()+",");return e=e.substring(0,e.length-1)},this.setValue=function(e){o.buildTagSpan(e)},this.buildTagSpan=function(t){for(var a in t||(t=""),c)c[a]&&c[a].remove();c={};var n=t.split(",");n&&1===n.length&&""===n[0]||e.each(n,(function(t,a){var n=!1;(a.indexOf("[search-deleted]")>0||0===a.indexOf("-"))&&(a=a.split("[search-deleted]")[0],n=!0);var i=e("<div class='tag-span-div'></div>"),r=e("<span  class='close-btn'>X</span>"),s=e("<span class='tag-span'></span>");n&&i.addClass("removed"),r.attr("data-value",a),s.text(a);var d=!1;r.dblclick((function(t){if(d=!0,u){var a=e(this).attr("data-value");Global.isSet(c[a])&&c[a].remove(),delete c[a],l&&o.setCheckBox(!0),o.trigger("formItemChange",[o]),setTimeout((function(){d=!1}),200)}})),r.click((function(t){setTimeout((function(){d||function(){if(u){var t=e(a).attr("data-value"),n=c[t],i="";n&&(0===t.indexOf("-")?(i=t.substr(1),n.removeClass("removed")):(i="-"+t,n.addClass("removed")),c[t].find(".tag-span").text(i),delete c[t],e(a).attr("data-value",i),c[i]=n,l&&o.setCheckBox(!0),o.trigger("formItemChange",[o]))}}()}),200);var a=this})),i.append(s),i.append(r),e(o).prepend(i),c[a]=i}))},this.createTag=function(t){var a=e("<div class='tag-span-div new'></div>"),n=e("<span class='close-btn'>X</span>"),i=e("<span class='tag-span'></span>");n.attr("data-value",t),i.text(t);var r=!1;n.dblclick((function(t){if(r=!0,u){var a=e(this).attr("data-value");Global.isSet(c[a])&&c[a].remove(),delete c[a],l&&o.setCheckBox(!0),o.trigger("formItemChange",[o]),setTimeout((function(){r=!1}),200)}})),n.click((function(t){setTimeout((function(){r||function(){if(u){var t=e(a).attr("data-value"),n=c[t],i="";0===t.indexOf("-")?(i=t.substr(1),n.removeClass("removed")):(i="-"+t,n.addClass("removed")),c[t].find(".tag-span").text(i),delete c[t],e(a).attr("data-value",i),c[i]=n,o.trigger("formItemChange",[o])}}()}),200);var a=this})),Global.isSet(c[n.attr("data-value")])||(a.append(i),a.append(n),a.insertBefore(s),c[t]=a)},this.each((function(){var t=e.meta?e.extend({},r,e(this).data()):r;a=t.field,t.object_type_id&&(h=t.object_type_id),s=e("<input class='add-tag-input' autocomplete='On'></input>"),i=TTAPI.APICompanyGenericTag,s.autocomplete({source:[],select:function(e,t){o.createTag(t.item.value),l&&o.setCheckBox(!0),s.autocomplete("option",{source:[]}),o.trigger("formItemChange",[o]),o.isSelectedItem=!0},close:function(e,t){o.isSelectedItem&&s.val("")}}),e(this).append(s),e(this).click((function(){s.focus(),u||l||(LocalCacheData.current_open_sub_controller&&LocalCacheData.current_open_sub_controller.edit_view&&LocalCacheData.current_open_sub_controller.is_viewing||LocalCacheData.current_open_primary_controller&&LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.is_viewing)&&(d=Global.view_mode_message,o.showErrorTip(10))})),e(this).contextmenu((function(e){e.preventDefault(),e.stopImmediatePropagation()})),e(this).mouseout((function(){o.hideErrorTip()})),s.bind("focusout",(function(t){if("ui-active-menuitem"!==e(t.relatedTarget).attr("id")&&s.val().length>0){if(!u)return;o.createTag(s.val()),s.val(""),l&&o.setCheckBox(!0),o.trigger("formItemChange",[o])}})),s.bind("keyup",(function(e){if(40===e.which||38===e.which)return e.preventDefault(),!1;e.preventDefault();var t={filter_data:{}};return t.filter_data.object_type_id=[h],t.filter_data.name=s.val(),i.getCompanyGenericTag(t,{onResult:function(e){for(var t=e.getResult(),a=[],n=0;n<t.length;n++)a.push(t[n].name);s.autocomplete("option",{source:a})}}),!1})),s.bind("keydown",(function(e){return 40===e.which||38===e.which?(e.preventDefault(),!1):(13===e.which||44===e.which||32===e.which||9===e.which||188===e.which)&&s.val().length>0?(e.preventDefault(),!!u&&(o.createTag(s.val()),s.val(""),l&&o.setCheckBox(!0),o.trigger("formItemChange",[o]),!1)):void 0}))})),this},e.fn.TTagInput.defaults={}}}]);
//# sourceMappingURL=tag_input-TTagInput.bundle.js.map?v=995d3cb812017a069407