{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageAdvBrowser.js"],"names":["$","jQuery","fn","TImageAdvBrowser","options","Global","addCss","field","image","result_form_data","opts","extend","defaults","$this","this","accept_filter","default_width","default_height","callBack","setEnable","val","btn","children","eq","show","hide","clearErrorStyle","getField","getValue","setImage","attr","d","Date","getTime","getCookie","css","onImageLoad","image_height","height","naturalHeight","image_width","width","naturalWidth","trigger","setValue","setEnableDelete","find","removeAttr","each","o","meta","data","text","i18n","_","show_browser","isSet","name","deleteImageHandler","on","bind","IndexViewController","openWizard","form_data"],"mappings":"4GAAA,IAAYA,KA+KPC,QA7KFC,GAAGC,iBAAmB,SAAUC,GAEjCC,OAAOC,OAAQ,gDACf,IAGIC,EAYAC,EAEAC,EAjBAC,EAAOV,EAAEW,OAAQ,GAAIX,EAAEE,GAAGC,iBAAiBS,SAAUR,GAErDS,EAAQC,KAIRC,EAAgB,GAEhBC,EAAgB,IAChBC,EAAiB,GAEjBC,EAAW,KAyJf,OAjJAJ,KAAKK,UAAY,SAAUC,GAG1B,IAAIC,EAAMP,KAAKQ,WAAWC,GAAI,GACxBH,EAGLC,EAAIG,OAFJH,EAAII,QAONX,KAAKY,gBAAkB,aAIvBZ,KAAKa,SAAW,WACf,OAAOpB,GAGRO,KAAKc,SAAW,WACf,OAAOnB,GAGRK,KAAKe,SAAW,SAAUT,GACzB,IAAMA,EAGL,OAFAZ,EAAMsB,KAAM,MAAO,SACnBtB,EAAMiB,OAIP,IAAIM,EAAI,IAAIC,KACZxB,EAAMiB,OACNjB,EAAMsB,KAAM,MAAOV,EAAM,MAAQW,EAAEE,UAAY,iBAAmBC,UAAW,eAC7E1B,EAAM2B,IAAK,SAAU,QACrB3B,EAAM2B,IAAK,QAAS,SAIrBrB,KAAKsB,YAAc,SAAU5B,GAE5B,IAAI6B,EAAerC,EAAGQ,GAAQ8B,SAAW,EAAItC,EAAGQ,GAAQ8B,SAAW9B,EAAM+B,cACrEC,EAAcxC,EAAGQ,GAAQiC,QAAU,EAAIzC,EAAGQ,GAAQiC,QAAUjC,EAAMkC,aAEjEL,EAAepB,GACnBjB,EAAGQ,GAAQ2B,IAAK,SAAUlB,GAItBuB,EAAcxB,IAClBhB,EAAGQ,GAAQ2B,IAAK,QAASnB,GACzBhB,EAAGQ,GAAQ2B,IAAK,SAAU,SAG3BtB,EAAM8B,QAAS,WAEVN,EAAe,EACnBrC,EAAGQ,GAAQiB,OAEXzB,EAAGQ,GAAQgB,QAKbV,KAAK8B,SAAW,SAAUxB,GAEnBA,IACLA,EAAM,KAKRN,KAAK+B,gBAAkB,SAAUzB,GAChC,IAAIZ,EAAQK,EAAMiC,KAAM,UAClB1B,EAILZ,EAAMsB,KAAM,gBAAiB,GAH7BtB,EAAMuC,WAAY,kBAOpBjC,KAAKkC,MAAM,WAEV,IAAIC,EAAIjD,EAAEkD,KAAOlD,EAAEW,OAAQ,GAAID,EAAMV,EAAGc,MAAOqC,QAAWzC,EAE1DH,EAAQ0C,EAAE1C,MAIVP,EAAGc,MAAOgC,KAAM,iBAAkBM,KAAMpD,EAAEqD,KAAKC,EAAG,iBAE7CL,EAAE/B,WACNA,EAAW+B,EAAE/B,WAGU,IAAnB+B,EAAEM,cACNvD,EAAGc,MAAOQ,WAAWC,GAAI,GAAIE,OAGzBwB,EAAEjC,cAAgB,IACtBA,EAAgBiC,EAAEjC,eAGdiC,EAAEhC,eAAiB,IACvBA,EAAiBgC,EAAEhC,gBAGfZ,OAAOmD,MAAOP,EAAEQ,OACbR,EAAEQ,KAGLpD,OAAOmD,MAAOzC,KAClBA,EAAgBkC,EAAElC,eAGdV,OAAOmD,MAAOP,EAAES,qBACpB7C,EAAMiC,KAAM,iBAAkBa,GAAI,eAAe,WAChDV,EAAES,wBAKU1D,EAAGc,MAAOQ,WAAWC,GAAI,GAC/BqC,KAAM,SAAS,WACtBC,oBAAoBC,WAAY,kBAAmB,MAAM,SAAUC,GAE7D7C,GACJA,EAAU6C,GAGXtD,EAAmBsD,SAKrBvD,EAAQR,EAAGc,MAAOQ,WAAWC,GAAI,IAC3BoC,GAAI,QAAQ,WACjB9C,EAAMuB,YAAatB,SAGpBN,EAAMiB,UAIAX,MAIRd,EAAEE,GAAGC,iBAAiBS,SAAW","file":"filebrowser-TImageAdvBrowser.bundle.js?v=2907f70a939f17018a95","sourcesContent":["( function( $ ) {\n\n\t$.fn.TImageAdvBrowser = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageAdvBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar name = 'filedata';\n\n\t\tvar accept_filter = '';\n\n\t\tvar default_width = 177;\n\t\tvar default_height = 42;\n\n\t\tvar callBack = null;\n\n\t\tvar enabled = true;\n\n\t\tvar image;\n\n\t\tvar result_form_data;\n\n\t\tthis.setEnable = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.children().eq( 1 );\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.hide();\n\t\t\t} else {\n\t\t\t\tbtn.show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn result_form_data;\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() + '&X-CSRF-Token=' + getCookie( 'CSRF-Token' ) );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tthis.onImageLoad = function( image ) {\n\n\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n\n\t\t\tif ( image_height > default_height ) {\n\t\t\t\t$( image ).css( 'height', default_height );\n\n\t\t\t}\n\n\t\t\tif ( image_width > default_width ) {\n\t\t\t\t$( image ).css( 'width', default_width );\n\t\t\t\t$( image ).css( 'height', 'auto' );\n\t\t\t}\n\n\t\t\t$this.trigger( 'setSize' );\n\n\t\t\tif ( image_height < 5 ) {\n\t\t\t\t$( image ).hide();\n\t\t\t} else {\n\t\t\t\t$( image ).show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setEnableDelete = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\tif ( !val ) {\n\t\t\t\timage.removeAttr( 'enable-delete' );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\timage.attr( 'enable-delete', 1 );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tvar $$this = this;\n\n\t\t\t$( this ).find( '#upload_image' ).text( $.i18n._( 'Upload Image' ) );\n\n\t\t\tif ( o.callBack ) {\n\t\t\t\tcallBack = o.callBack;\n\t\t\t}\n\n\t\t\tif ( o.show_browser === false ) {\n\t\t\t\t$( this ).children().eq( 1 ).hide();\n\t\t\t}\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( accept_filter ) ) {\n\t\t\t\taccept_filter = o.accept_filter;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.deleteImageHandler ) ) {\n\t\t\t\t$this.find( '.file-browser' ).on( 'deleteClick', function() {\n\t\t\t\t\to.deleteImageHandler();\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar browser = $( this ).children().eq( 1 );\n\t\t\tbrowser.bind( 'click', function() {\n\t\t\t\tIndexViewController.openWizard( 'UserPhotoWizard', null, function( form_data ) {\n\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack( form_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_form_data = form_data;\n\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\timage = $( this ).children().eq( 0 );\n\t\t\timage.on( 'load', function() {\n\t\t\t\t$this.onImageLoad( this );\n\t\t\t} );\n\n\t\t\timage.hide();\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageAdvBrowser.defaults = {};\n\n} )( jQuery );"],"sourceRoot":""}