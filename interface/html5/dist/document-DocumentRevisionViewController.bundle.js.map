{"version":3,"sources":["webpack://timetrex/./interface/html5/views/document/DocumentRevisionViewController.js"],"names":["DocumentRevisionViewController","BaseViewController","options","_","defaults","el","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIDocumentRevision","render","sub_view_mode","buildContextMenu","initData","groups","download","label","id","exclude","ContextMenuIconName","export_excel","mass_edit","copy","include","group","icon","Icons","view_file","view","doNotSetFocus","context_menu_array","Global","isSet","selectContextMenu","setTotalDisplaySpan","len","length","grid_selected_length","getGridSelectIdArray","i","context_btn","find","attr","removeClass","add","setDefaultMenuAddIcon","edit","setDefaultMenuEditIcon","setDefaultMenuViewIcon","setDefaultMenuMassEditIcon","setDefaultMenuCopyIcon","delete_icon","setDefaultMenuDeleteIcon","delete_and_next","setDefaultMenuDeleteAndNextIcon","save","setDefaultMenuSaveIcon","save_and_next","setDefaultMenuSaveAndNextIcon","save_and_continue","setDefaultMenuSaveAndContinueIcon","save_and_new","setDefaultMenuSaveAndAddIcon","save_and_copy","setDefaultMenuSaveAndCopyIcon","copy_as_new","setDefaultMenuCopyAsNewIcon","cancel","setDefaultMenuCancelIcon","setDefaultMenuDownIcon","setContextMenuGroupVisibility","pId","addClass","is_mass_editing","setEditMenuSaveIcon","setEditMenuAddIcon","setEditMenuEditIcon","setEditMenuViewIcon","setEditMenuMassEditIcon","setEditMenuCopyIcon","setEditMenuDeleteIcon","setEditMenuDeleteAndNextIcon","setEditMenuSaveAndContinueIcon","setEditMenuSaveAndAddIcon","setEditMenuSaveAndNextIcon","setEditMenuSaveAndCopyIcon","setEditMenuCopyAndAddIcon","setEditMenuDownloadIcon","onDownloadClick","$this","setCurrentEditViewState","openEditView","parent_key","args","parent_value","key_name","onResult","result","onAddResult","current_edit_record","document_revision_result","super_fun_name","document_revision_id","getResult","file_data","file_browser","getValue","uploadFile","upload_file_result","handleSaveResult","url","ServiceCaller","getURLByObjectType","document_id","APIFileDownload","edit_view","doFormIFrameCall","selectedId","filter","grid_selected_id_array","filter_data","result_data","async","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_revision_column1","edit_view_tab","edit_view_tabs","push","form_item_input","loadWidgetByName","FormItemType","TEXT_INPUT","TTextInput","field","width","addEditFieldToColumn","FILE_BROWSER","TImageBrowser","name","accept_filter","TEXT_AREA","TTextArea","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","loadViewSource","template","html","TTPromise","wait","sub_document_revision_view_controller"],"mappings":"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","file":"document-DocumentRevisionViewController.bundle.js?v=d57a71f76a80ded1bc09","sourcesContent":["export class DocumentRevisionViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#document_revision_view_container'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'DocumentRevisionEditView.html';\n\t\tthis.permission_id = 'document';\n\t\tthis.viewId = 'DocumentRevision';\n\t\tthis.script_name = 'DocumentRevisionView';\n\t\tthis.table_name_key = 'document_revision';\n\t\tthis.context_menu_name = $.i18n._( 'Revisions' );\n\t\tthis.navigation_label = $.i18n._( 'Revision' ) + ':';\n\t\tthis.api = TTAPI.APIDocumentRevision;\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {\n\t\t\t\tdownload: {\n\t\t\t\t\tlabel: $.i18n._( 'Download' ),\n\t\t\t\t\tid: this.script_name + 'download'\n\t\t\t\t}\n\t\t\t},\n\t\t\texclude: [\n\t\t\t\tContextMenuIconName.export_excel,\n\t\t\t\tContextMenuIconName.mass_edit,\n\t\t\t\tContextMenuIconName.copy\n\t\t\t],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Download' ),\n\t\t\t\t\tid: ContextMenuIconName.download,\n\t\t\t\t\tgroup: 'download',\n\t\t\t\t\ticon: Icons.download\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'View' ),\n\t\t\t\t\tid: ContextMenuIconName.view_file,\n\t\t\t\t\tgroup: 'download',\n\t\t\t\t\ticon: Icons.view\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tsetDefaultMenu( doNotSetFocus ) {\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Employee&a=edit&id=42411&tab=Wage line 282\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !Global.isSet( doNotSetFocus ) || !doNotSetFocus ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setDefaultMenuAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setDefaultMenuMassEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setDefaultMenuCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setDefaultMenuDeleteIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setDefaultMenuSaveIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\t\tthis.setDefaultMenuSaveAndContinueIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setDefaultMenuSaveAndAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setDefaultMenuSaveAndCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ContextMenuIconName.download:\n\t\t\t\tcase ContextMenuIconName.view_file:\n\t\t\t\t\tthis.setDefaultMenuDownIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetDefaultMenuDownIcon( context_btn, grid_selected_length, pId ) {\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\t//\n\t// setDefaultMenuCancelIcon( context_btn, grid_selected_length, pId ) {\n\t// \tif ( this.sub_view_mode ) {\n\t// \t\tcontext_btn.addClass( 'disable-image' );\n\t// \t}\n\t// },\n\n\tsetEditMenu() {\n\t\tthis.selectContextMenu();\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tswitch ( id ) {\n\t\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setEditMenuAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setEditMenuMassEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setEditMenuCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setEditMenuDeleteIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setEditMenuDeleteAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\t\tthis.setEditMenuSaveAndContinueIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setEditMenuSaveAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setEditMenuSaveAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setEditMenuSaveAndCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setEditMenuCopyAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.download:\n\t\t\t\tcase ContextMenuIconName.view_file:\n\t\t\t\t\tthis.setEditMenuDownloadIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.download:\n\t\t\t\tthis.onDownloadClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonAddClick() {\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\t$this.openEditView();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tif ( this.parent_key === 'document_id' ) {\n\n\t\t\t\tvar args = this.parent_value;\n\n\t\t\t\t$this.api['get' + $this.api.key_name + 'DefaultData']( args, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.onAddResult( result );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t$this.api['get' + $this.api.key_name + 'DefaultData']( {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onAddResult( result );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetEditMenuDownloadIcon( context_btn, pId ) {\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\thandleSaveResult( document_revision_result, super_fun_name ) {\n\t\tvar $this = this;\n\t\tvar document_revision_id = ( document_revision_result.getResult() === true && this.current_edit_record.id ) ? this.current_edit_record.id : document_revision_result.getResult();\n\n\t\tvar file_data = $this.file_browser.getValue();\n\n\t\t//Save a document revision data if has upload file, otherwise don't\n\t\tif ( file_data ) {\n\n\t\t\t$this.api.uploadFile( file_data, 'object_type=document_revision&object_id=' + document_revision_id, {\n\t\t\t\tonResult: ( upload_file_result ) => {\n\t\t\t\t\tsuper[super_fun_name]( document_revision_result );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} else {\n\t\t\tsuper[super_fun_name]( document_revision_result );\n\t\t}\n\t}\n\n\tonSaveResult( result ) {\n\t\treturn this.handleSaveResult( result, 'onSaveResult' );\n\t}\n\n\tonSaveAndContinueResult( result ) {\n\t\treturn this.handleSaveResult( result, 'onSaveAndContinueResult' );\n\t}\n\n\tonSaveAndNewResult( result ) {\n\t\treturn this.handleSaveResult( result, 'onSaveAndNewResult' );\n\t}\n\n\tonSaveAndCopyResult( result ) {\n\t\treturn this.handleSaveResult( result, 'onSaveAndCopyResult' );\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.download:\n\t\t\tcase ContextMenuIconName.view_file:\n\t\t\t\tthis.onDownloadClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tdoFormIFrameCall() {\n\t\tvar url = ServiceCaller.getURLByObjectType( 'file_download' ) + '&object_type=document&parent_id=' + this.current_edit_record.document_id + '&object_id=' + this.current_edit_record.id;\n\t\tGlobal.APIFileDownload( null, null, null, url );\n\t}\n\n\tonDownloadClick() {\n\t\tvar $this = this;\n\t\tif ( this.edit_view && this.current_edit_record.id ) {\n\t\t\tthis.doFormIFrameCall();\n\n\t\t} else {\n\n\t\t\tvar filter = {};\n\n\t\t\tvar selectedId;\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tselectedId = grid_selected_id_array[0];\n\t\t\t}\n\t\t\tfilter.filter_data = {};\n\t\t\tfilter.filter_data.id = [selectedId];\n\n\t\t\tvar result = this.api['get' + this.api.key_name]( filter, { async: false } );\n\t\t\tvar result_data = result.getResult();\n\n\t\t\tif ( !result_data ) {\n\t\t\t\tresult_data = [];\n\t\t\t}\n\n\t\t\tresult_data = result_data[0];\n\n\t\t\t$this.current_edit_record = result_data;\n\n\t\t\t$this.doFormIFrameCall();\n\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_revision': { 'label': $.i18n._( 'Revision' ) },\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIDocumentRevision,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_document_revison',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_revision = this.edit_view_tab.find( '#tab_revision' );\n\n\t\tvar tab_revision_column1 = tab_revision.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_revision_column1 );\n\n\t\t// Revision\n\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'revision', width: 114 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Revision' ), form_item_input, tab_revision_column1, '' );\n\n\t\t// File\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.FILE_BROWSER );\n\n\t\tthis.file_browser = form_item_input.TImageBrowser( { field: '', name: 'filedata', accept_filter: '*' } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'File' ), form_item_input, tab_revision_column1, '', null, false, true );\n\n\t\t// Change log\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'change_log' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Change Log' ), form_item_input, tab_revision_column1, '', null, false, true );\n\n\t}\n\n}\n\nDocumentRevisionViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'DocumentRevision', 'SubDocumentRevisionView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_document_revision_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n};"],"sourceRoot":""}