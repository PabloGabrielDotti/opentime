(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["awesomebox-ADropDown"],{3234:()=>{var e;(e=jQuery).fn.ADropDown=function(t){var i,r,n,l,a,d,s,o,c,g,u,h,f=e.extend({},e.fn.ADropDown.defaults,t),p=null,v=null,b=null,m=null,G=null,S="id",w=null,D=this,y=[],C=[],x=!1,I=null,T=null,k=null,P=null,R=null,j=!1,A=!1,E="",q="",U=!0,W=null,M=null,N=null,H="",L=150,O=null,z=null,F=!1,B=!1,K=!1,V=null,Q=null,X=null,Y=!0,$="",J={},Z=!1,ee=!1,te=!1,ie=function(e,t){if(e.resetSelection(),!t){for(var i=e.getGridParam("data"),r=i.length,n=0;n<r;n++){var l=i[n];Global.isSet(l.id)?e.grid.jqGrid("setSelection",l.id,!1):e.grid.jqGrid("setSelection",n+1,!1)}e.grid.parents(".cbox-header").prop("checked",!0)}};Global.addCss("global/widgets/awesomebox/ADropDown.css"),this.isChanged=function(){return K},this.setIsChanged=function(e){K=e},this.unSelectAll=function(e){ie(e,!0)},this.getFocusInSeletGrid=function(){return F},this.selectAll=function(){ie(F?v:p)},this.gridScrollTop=function(){p.grid.parent().parent().scrollTop(0)},this.gridScrollDown=function(){p.grid.parent().parent().scrollTop(1e4)},this.getBoxWidth=function(){return u},this.setErrorStyle=function(t,i,r){r?e(this).addClass("warning-tip"):e(this).addClass("error-tip"),H=t,i&&this.showErrorTip()},this.showErrorTip=function(t){Global.isSet(t)||(t=2),g||(g=(g=Global.loadWidgetByName(WidgetNamesDic.ERROR_TOOLTIP)).ErrorTipBox()),e(this).hasClass("warning-tip")?g.show(this,H,t,!0):g.show(this,H,t)},this.hideErrorTip=function(){Global.isSet(g)&&g.remove()},this.clearErrorStyle=function(){e(this).removeClass("error-tip"),e(this).removeClass("warning-tip"),this.hideErrorTip(),H=""},this.getField=function(){return c},this.setValue=function(e){this.setSelectGridData(e)},this.getValue=function(){return this.getSelectItems()},this.getSelectGridSortMap=function(){return P},this.getUnSelectGridSortMap=function(){return k},this.getUnSelectGridMap=function(){return I||(I={}),I},this.getUnSelectGrid=function(){return p},this.getSelectGrid=function(){return v},this.getSelectGridMap=function(){T||(T={});var e=[];if(U)for(var t=D.getSelectItems(),i=0;i<t.length;i++)e.push(t[i][S]);return e.length>0&&(T.id=e,T)},this.collectUnselectGridColumns=function(){var t=p.getGridParam("colModel"),i=t?t.length:0;y=[];for(var r=0;r<i;r++){var n=t[r],l=e(this).find("div #jqgh_unselect_grid_"+G+"_"+n.name);y.push(l.TGridHeader({column_model:n})),l.bind("headerClick",a)}function a(e,t,i){if(w&&w.getAPI()){var r=i.name;"cb"!==r&&(t.metaKey||t.ctrlKey?D.buildSortCondition(!1,r,"unselect_grid"):D.buildSortCondition(!0,r,"unselect_grid"),w.setCachedSortFilter(k),D.setGridHeaderStyle("unselect_grid"),w.onADropDownSearch("unselect_grid"))}}D.setGridHeaderStyle("unselect_grid")},this.buildSortCondition=function(e,t,i){var r=null,n="desc";if(r="unselect_grid"===i?k:P,e){if(r&&r.length>0){var l=r.length,a=!1;for(o=0;o<l;o++){var d=r[o];for(var s in d)s===t&&(n="asc"===d[s]?"desc":"asc",a=!0);if(a)break}}(r=[{}])[0][t]=n}else if(r){l=r.length,a=!1;for(var o=0;o<l;o++){for(var s in d=r[o])s===t&&("asc"===d[s]?d[s]="desc":d[s]="asc",a=!0);if(a)break}a||(r.push({}),r[l][t]="desc")}else(r=[{}])[0][t]="desc";"unselect_grid"===i?k=r:P=r},this.setGridHeaderStyle=function(e){var t=[],i=[];"unselect_grid"===e?(t=y,i=k):(t=C,i=P);for(var r=t.length,n=0;n<r;n++){var l=t[n],a=l.getColumnModel().name;if(l.cleanSortStyle(),i)for(var d=i.length,s=0;s<d;s++){var o=i[s],c=Global.getFirstKeyFromObject(o);c===a&&(d>1?l.setSortStyle(o[c],s+1):l.setSortStyle(o[c],0))}}},this.collectSelectGridColumns=function(){var t=v.getGridParam("colModel"),i=t?t.length:0;C=[];for(var r=0;r<i;r++){var n=t[r],l=e(this).find("div #jqgh_select_grid_"+G+"_"+n.name);C.push(l.TGridHeader({column_model:n})),l.bind("headerClick",a)}function a(e,t,i){if(w&&w.getAPI()){var r=i.name;"cb"!==r&&(t.metaKey||t.ctrlKey?D.buildSortCondition(!1,r,"select_grid"):D.buildSortCondition(!0,r,"select_grid"),w.setCachedSelectedGridSortFilter(P),D.setGridHeaderStyle("select_grid"),w.onADropDownSearch("select_grid"))}}D.setGridHeaderStyle("select_grid")},this.setSelectItem=function(e,t){t||(t=p);var i=t.getGridParam("data");if(e&&(R=e),i&&i.length>0){for(var r=0;r<i.length;r++){var n=i[r],l=e;!e&&(l=i[0]);var a=S;if(j&&"id"==S&&(a="_id_"),n[a]==l[S]){var d="id";return j&&(d="_id_"),t.grid.find('tr[id="'+n[d]+'"]').focus(),t.grid.hasClass("unselect-grid")?(E&&t.grid.jqGrid("saveRow",E),E=n[d]):(q&&t.grid.jqGrid("saveRow",q),q=n[d]),t.grid.jqGrid("setSelection",n[d],!1),t.grid.jqGrid("editRow",n[d],!0),e&&(R=n),!1}}this.setTotalDisplaySpan()}},this.getUnSelectGridData=function(){return p.getGridParam("data")},this.getSelectItem=function(){return R},this.getSelectItems=function(){E.length>0&&(p.grid.jqGrid("saveRow",E),E=""),q.length>0&&(v.grid.jqGrid("saveRow",q),q="");var e=null;return e=x&&N&&N.length>0?N:v.getGridParam("data"),0==Global.isArray(e)?Array():e},this.setRealSelectItems=function(e,t){if(N=[],t!=TTUUID.zero_id&&t.length>0)for(var i=0;i<e.length;i++)-1!=t.indexOf(e[i].id)&&N.push(e[i]);return N},this.getAllowMultipleSelection=function(){return U},this.getResizeGrids=function(){return te},this.setResizeGrids=function(e){te=e,e&&this.setGridColumnsWidths()},this.getTreeMode=function(){return j},this.setUnselectedGridData=function(e){m=e,j?this.reSetUnSelectGridTreeData(e):(p.setData(e),this.setTotalDisplaySpan()),this.setUnSelectGridDragAble(),this.setGridsHeight()},this.setGridColumnsWidths=function(){var t=p,i=v,r=t.getData(),n=i.getData();if(n&&0!=n.length&&r&&0==r.length){var l=t;t=i,i=l}var a=(Global.bodyWidth()-e(this).offset().left-100)/2,d=t.setGridColumnsWidth(null,{max_grid_width:a}),s=t.getColumnModel();i.setGridColumnsWidth(s);var o=200,c=28,g=0;if(s){for(var u=0;u<s.length;u++)g+=s[u].widthOrg+1;"cb"==s[0].name&&(c+=2)}c=j?26:22,g<=o||s.length<5?o=t.grid.parents(".unselect-grid-div, .select-grid-div").width()-c:d>(o=g)&&(o=d),t.setGridWidth(o),i.setGridWidth(o),this.resizeUnSelectSearchInputs(),this.resizeSelectSearchInputs()},this.getPagerData=function(){return W},this.setPagerData=function(e){W=e,0===LocalCacheData.paging_type?(M.parent().length>0&&M.remove(),M.css("width",p.width()),p.append(M),M.click((function(){$this.onPaging()})),!W||W.is_last_page||W.last_page_number<0?M.css("display","none"):M.css("display","inline-block")):!W||W.last_page_number<0?(a.css("display","none"),d.css("display","none")):(a.css("display","inline-block"),d.css("display","inline-block"),!0===W.is_last_page?(d.addClass("disabled"),d.addClass("disabled-image"),o=!1):(d.removeClass("disabled"),d.removeClass("disabled-image"),o=!0),W.is_first_page?(a.addClass("disabled"),a.addClass("disabled-image"),s=!1):(a.removeClass("disabled"),a.removeClass("disabled-image"),s=!0)),D.setTotalDisplaySpan()},this.onPaging=function(){w.onADropDownSearch("unselect_grid","next")},this.reSetUnSelectGridTreeData=function(t){var i=p.grid.parent().parent().scrollTop();if(p.getData().length>0&&t.length>0)p.setData(t,!j);else{var r=p.getGridParam("colModel");if(!p.grid.is(":visible"))return;p.grid.jqGrid("GridUnload"),p=(p=e(this).find(".unselect-grid")).grid=new TTGrid(e(this).find(".unselect-grid").attr("id"),{container_selector:".unselect-grid-div",altRows:!0,datastr:t,datatype:"jsonstring",sortable:!1,width:440,onResizeGrid:te,colNames:[],rowNum:1e4,colModel:r,ondblClickRow:D.onUnSelectGridDoubleClick,gridview:!0,treeGrid:!0,treeGridModel:"adjacency",treedatatype:"local",ExpandColumn:"name",multiselect:U,multiselectPosition:"none",winMultiSelect:U,onCellSelect:function(t,i,r,n){if(-1!=e(n.target).prop("class").indexOf("ui-icon-triangle"))return!1;if(t=Global.convertToNumberIfPossible(t),!U){var l=p.getGridParam("data");e.each(l,(function(e,i){if(j&&"id"==S&&(S="_id_"),i[S]==t)return R=i,K=!0,void(LocalCacheData.currently_collapsing_navigation_tree_element||D.trigger("close",[D]))}))}A&&A(t,LocalCacheData.currently_collapsing_navigation_tree_element)},beforeSelectRow:function(t,i){var r=e(i.target).closest("tr.jqgrow>td"),n=r.length>0?r[0].cellIndex:-1,l=e(this).jqGrid("getGridParam"),a=n>=0?l.colModel[n]:null;return!(null!=a&&a.name===l.ExpandColumn&&e(i.target).closest(".tree-wrap").length>0)},jsonReader:{repeatitems:!1,root:function(e){return e},page:function(e){return 1},total:function(e){return 1},records:function(e){return e.length}},onResizeGrid:te},r)}i>0&&p.grid.parent().parent().scrollTop(i),this.setGridsHeight();var n=this.getSelectItems();e(this).find("tr").removeClass("selected-tree-cell");for(var l=n.length-1;l>=0;l--)e(this).find(".unselect-grid-div").find("tr#"+n[l].id).addClass("selected-tree-cell")},this.setGridsHeight=function(){if(ee)return p.grid.setGridHeight(ee),void(U&&v.grid.setGridHeight(ee));if(w){var e=w.offset().top,t=Global.bodyHeight()-e-30,i=e>t?e:t;i-=130;var r=w.getStaticSourceData();if(r){var n=23*r.length;n<L?i=L:n>L&&n<i&&(i=n)}else i=L;Z&&Z<i&&(i=Z),p.grid.setGridHeight(i),U&&v.grid.setGridHeight(i),this.setPosition(e,i)}},this.setPosition=function(e,t){e+t+130<Global.bodyHeight()?D.parent().css("top",e+25):D.parent().css("top",e-t-125)},this.onTreeCellFormat=function(e,t,i){for(var r=D.getSelectItems(),n=0,l=r.length;n<l;n++)if(r[n].name===e)return'<span class="selected-tree-cell">'+e+"</span>";return e},this.setColumns=function(t){for(var i=0;i<t.length;i++)t[i].resizable=!1;p.grid.jqGrid("GridUnload"),(p=e(this).find(".unselect-grid")).getGridParam();var r=e(this).find(".unselect-grid-search-div"),n=e(this).find(".select-grid-search-div"),l=e(".unselect-grid-border-div").width()-2;if(x&&(l-=15),(l=125*t.length)<438&&(u=l=438),t.length>1?(u=l,U&&l>Global.bodyWidth()/2-30-15?u=Global.bodyWidth()/2-30-15:!U&&l>Global.bodyWidth()-30-15&&(u=Global.bodyWidth()-30-15),this.find(".unselect-grid-div").width(null),this.find(".unselect-grid-border-div").width(null),this.find(".select-grid-div").width(null),this.find(".select-grid-border-div").width(null),x&&(r.css("width",null),n.css("width",null))):u=l,j){if(j){var a=_.map(t,_.clone);_.map(a,(function(e){e.formatter=D.onTreeCellFormat}))}p=new TTGrid(e(p).attr("id"),{container_selector:".unselect-grid-div",altRows:!0,datastr:[],datatype:"jsonstring",sortable:!1,width:l,maxHeight:L,colNames:[],rowNum:1e4,colModel:a,ondblClickRow:D.onUnSelectGridDoubleClick,onCellSelect:function(){D.onUnSelectGridSelectRow()},gridview:!0,treeGrid:!0,treeGridModel:"adjacency",treedatatype:"local",ExpandColumn:"name",multiselect:!1,jsonReader:{repeatitems:!1,root:function(e){return e},page:function(e){return 1},total:function(e){return 1},records:function(e){return e.length}},onSelectRow:function(e){A&&A(e),e=Global.convertToNumberIfPossible(e)},onResizeGrid:te},a)}else p=new TTGrid(e(p).attr("id"),{container_selector:".unselect-grid-div",altRows:!0,data:[],datatype:"local",sortable:!1,width:l,colNames:[],rowNum:1e4,keep_scroll_place:!0,ondblClickRow:D.onUnSelectGridDoubleClick,colModel:t,multiselect:U,multiboxonly:U,viewrecords:!0,editurl:"clientArray",resizeStop:function(){D.resizeUnSelectSearchInputs()},onCellSelect:function(t){if(t=Global.convertToNumberIfPossible(t),!U){var i=p.getGridParam("data");e.each(i,(function(e,i){if("id"!==S){if(i.id==t)return R=i,K=!0,D.trigger("close",[D]),!1}else if(i[S]==t)return R=i,K=!0,D.trigger("close",[D]),!1}))}E&&p.grid.jqGrid("saveRow",E),p.grid.jqGrid("editRow",t,!0),E=t,D.setTotalDisplaySpan()},onResizeGrid:te},t);this.collectUnselectGridColumns(),x&&w.getAPI()&&this.buildUnSelectSearchInputs(),v.grid.jqGrid("GridUnload"),v=e(this).find(".select-grid"),v=new TTGrid(e(v).attr("id"),{container_selector:".select-grid-div",altRows:!0,data:[],datatype:"local",sortable:!1,width:l,colNames:[],rowNum:1e4,ondblClickRow:this.onSelectGridDoubleClick,colModel:t,multiselect:U,multiboxonly:U,viewrecords:!0,keep_scroll_place:!0,resizeStop:function(){D.resizeSelectSearchInputs()},onCellSelect:function(e){e&&(q&&v.grid.jqGrid("saveRow",q),v.grid.jqGrid("editRow",e,!0),q=e)},onResizeGrid:te},t),this.collectSelectGridColumns(),x&&w.getAPI()&&this.buildSelectSearchInputs()},this.buildSelectSearchInputs=function(){for(var t=C.length,i=e(this).find(".select-grid-search-div"),r=0,n=[],l=0;l<t;l++){var a=C[l];if(0!==l){if(U&&1===l){var d=e("<input type='text' class='search-input'>");d.css("width",a.getWidth()+r)}else(d=e("<input type='text' class='search-input'>")).css("width",a.getWidth());d.on("drop",(function(e){e.preventDefault()})),d.ASearchInput({column_model:a.getColumnModel()}),i.append(d),n.push(d),T&&d.setFilter(T),d.bind("searchEnter",(function(e,t,i){D.getValue().length<1||(T||(T={}),delete T.id,t?T[i]=t:delete T[i],w.setCachedSelectGridSearchInputsFilter(Global.clone(T)),w.onADropDownSearch())}))}else r=a.getWidth()}var s=e('<button class="close-btn"><img src="'+Global.getRealImagePath("images/close.png")+'"></img></button>');i.prepend(s),s.click((function(){T={},w.setCachedSelectGridSearchInputsFilter(T),w.onADropDownSearch();for(var e=0;e<n.length;e++)n[e].clearValue()}))},this.resizeUnSelectSearchInputs=function(){var t,i,r=e(this).find(".unselect-grid-search-div").find(".search-input"),n=e(this).find(".unselect-grid-search-div"),l=r.length;if(U)if(y[0].width(),1==l)t=y[1],(i=e(r[0])).css("width",t.getWidth());else for(var a=0;a<l;a++)t=y[a+1],i=e(r[a]),a==l-1?i.css("width",t.getWidth()):i.css("width",t.getWidth()+1);else for(a=0;a<l;a++)t=y[a],i=e(r[a]),0===a?i.css("width",t.getWidth()-22):i.css("width",t.getWidth()+1);var d=p.grid.parents(".ui-jqgrid-jquery-ui").width()?p.grid.parent().parent().width():100;p.setGridWidth(d);var s=d;j&&(d=p.getWidth());var o=d+22,c=d+4,g=e("body").width()-30;U&&(g=e("body").width()/2-30),o>g&&(o=g,c=g-17),p.grid.parents(".unselect-grid-div").css("width",o),p.grid.parents(".unselect-grid-border-div").css("width",c),n.css("width",s)},this.resizeSelectSearchInputs=function(){var t=e(this).find(".select-grid-search-div").find(".search-input"),i=e(this).find(".select-grid-search-div"),r=t.length;if(C[0].width(),1==r)l=y[1],(a=e(t[0])).css("width",l.getWidth());else for(var n=0;n<r;n++){var l=C[n+1],a=e(t[n]);n==r-1?a.css("width",l.getWidth()):a.css("width",l.getWidth()+1)}var d=v.grid.parents(".ui-jqgrid-jquery-ui").width()?v.grid.parent().parent().width():100;v.setGridWidth(d);var s=d+22,o=d+4,c=e("body").width()/2-30;s>c&&(s=c,o=c-17),v.grid.parents(".select-grid-div").css("width",s),v.grid.parents(".select-grid-border-div").css("width",o),i.css("width",d)},this.buildUnSelectSearchInputs=function(){for(var t=y.length,i=e(this).find(".unselect-grid-search-div"),r=0,n=[],l=0;l<t;l++){var a=y[l];if(U&&0===l)r=a.getWidth();else{if(U&&1===l){var d=e("<input type='text' class='search-input unselect-grid-search-input'>"),s=a.getWidth()+r-2;d.css("width",s)}else d=e("<input type='text' class='search-input'>"),l==t-1?d.css("width",a.getWidth()+1+"px"):d.css("width",a.getWidth()+"px");d.on("drop",(function(e){e.preventDefault()})),d.ASearchInput({column_model:a.getColumnModel()}),i.append(d),n.push(d),I&&d.setFilter(I),d.bind("searchEnter",(function(e,t,i){I||(I={}),t?I[i]=t:delete I[i],w.setCachedSearchInputsFilter(I),w.onADropDownSearch("unselect_grid")}))}}var o=e('<button class="close-btn"><img src="'+Global.getRealImagePath("images/close.png")+'"></img></button>');i.prepend(o),o.click((function(){I={},w.setCachedSearchInputsFilter(I),w.onADropDownSearch("unselect_grid");for(var e=0;e<n.length;e++)n[e].clearValue()}))},setSelectItem=function(e){R=e},this.setSelectGridSearchResult=function(e){N&&0!=N.length||(N=this.getSelectItems().slice()),v.setData(e)},this.setSelectGridData=function(e,t){w&&w.getAPI()&&(e=Global.formatGridData(e,w.getAPI().key_name)),("[object Array]"!==Object.prototype.toString.call(m)||m.length<1)&&(m=[]),e||(e=[]);var i,r,n,l,a,d=m.slice();if(d&&d.length>0){var s=e.length;if(B){for(a=d.length,r=0;r<a;r++)for(o=d[r],i=0;i<s;i++)if(n=e[i],Global.isSet(n[S])||((n=[])[S]=e[i],Global.isSet(l)||(l=[])),o[S]==n[S]){!n.hasOwnProperty("id")&&o.hasOwnProperty("id")&&(n.id=o.id),Global.isSet(l)&&l.push(o),j||(d.splice(r,1),a-=1,r-=1);break}}else for(i=0;i<s;i++)for(n=e[i],Global.isSet(n[S])||((n=[])[S]=e[i],Global.isSet(l)||(l=[])),a=d.length,r=0;r<a;r++){var o=d[r];if(o[S]==n[S]){!n.hasOwnProperty("id")&&o.hasOwnProperty("id")&&(n.id=o.id),Global.isSet(l)&&l.push(o),j||d.splice(r,1);break}}}(l&&l.length===e.length||e.length>0&&!e[0].hasOwnProperty(S))&&(e=l),t||"object"==typeof e&&v.setData(e),j?D.reSetUnSelectGridTreeData(d):(p.setData(d),this.setTotalDisplaySpan()),D.setSelectGridDragAble(),D.setUnSelectGridDragAble()},this.setUnSelectGridHighlight=function(t){p.resetSelection(),e.each(t,(function(e,t){p.grid.jqGrid("setSelection",t,!1)}))},this.showNoResultCover=function(t){this.removeNoResultCover(t);var i,r=Global.loadWidgetByName(WidgetNamesDic.NO_RESULT_BOX);r.NoResultBox({related_view_controller:this}),"unselect_grid"===t?(r.attr("id",G+t+"_no_result_box"),i=e(this).find("#gbox_unselect_grid_"+G),O=r):(r.attr("id",G+t+"_no_result_box"),i=e(this).find("#gbox_select_grid_"+G),z=r),i.append(r)},this.removeNoResultCover=function(e){"unselect_grid"===e?O&&(O.remove(),O=null):z&&(z.remove(),z=null)},this.setSelectGridHighlight=function(t){v.resetSelection(),e.each(t,(function(e,t){v.grid.jqGrid("setSelection",t,!1)}))},this.setUnSelectGridDragAble=function(){var t=null,i=p.grid.find("tr.ui-widget-content").attr("draggable","true");i.unbind("dragstart").bind("dragstart",(function(i){var r=e(i.target),n=e("<table class='drag-holder-table'></table>"),l=(t=p.grid.find("tr.ui-state-highlight")).length;if(0===l?(l=1,p.grid.jqGrid("setSelection",r.attr("id"),!1)):r.hasClass("ui-state-highlight")||(ie(p,!0),p.grid.jqGrid("setSelection",r.attr("id"),!1),l=1),1===l){t=p.grid.find("tr.ui-state-highlight");var a=e(t[0]).clone();a.children().eq(0).remove(),a.find("td").css("padding-right",10),a.find("td").css("padding-left",10),n.append(a)}else n.append(l+" "+e.i18n._("item(s) selected"));return e("body").find(".drag-holder-table").remove(),e("body").append(n),i.originalEvent.dataTransfer.setData("Text","un_select_grid"),i.originalEvent.dataTransfer.setDragImage&&i.originalEvent.dataTransfer.setDragImage(n[0],-10,0),!0})),p.grid.parent().parent().unbind("dragover").bind("dragover",(function(e){e.preventDefault()})),p.grid.parent().parent().unbind("drop").bind("drop",(function(t){if(t.preventDefault(),t.stopPropagation&&t.stopPropagation(),e(".drag-holder-table").remove(),"select_grid"===t.originalEvent.dataTransfer.getData("Text")){var i=v.grid.jqGrid("getGridParam","selarrrow");i.length>0&&D.moveItems(!1,i)}})),i.unbind("dragend").bind("dragend",(function(t){e(".drag-holder-table").remove()})),p.grid.parent().parent().unbind("dragend").bind("dragend",(function(t){e(".drag-holder-table").remove()}))},this.setSelectGridDragAble=function(){var t=null,i=this,r=v.grid.find("tr.ui-widget-content").attr("draggable","true");r.attr("draggable",!0),r.unbind("dragstart").bind("dragstart",(function(i){var r=e(i.target),n=e("<table class='drag-holder-table' from='select_grid'></table>"),l=(t=v.grid.find("tr.ui-state-highlight")).length;if(0===l?(l=1,v.grid.jqGrid("setSelection",r.attr("id"),!1)):r.hasClass("ui-state-highlight")||(ie(v,!0),v.grid.jqGrid("setSelection",r.attr("id"),!1),l=1),1===l){t=v.grid.find("tr.ui-state-highlight");var a=e(t[0]).clone();a.children().eq(0).remove(),a.find("td").css("padding-right",10),a.find("td").css("padding-left",10),n.append(a)}else n.append(l+" "+e.i18n._("item(s) selected"));return e(".drag-holder-table").remove(),e("body").append(n),i.originalEvent.dataTransfer.setData("Text","select_grid"),i.originalEvent.dataTransfer.setDragImage&&i.originalEvent.dataTransfer.setDragImage(n[0],-10,0),!0})),v.grid.parent().parent().unbind("dragover").bind("dragover",(function(e){e.preventDefault()})),v.grid.parent().parent().unbind("drop").bind("drop",(function(t){if(t.preventDefault(),t.stopPropagation&&t.stopPropagation(),e(".drag-holder-table").remove(),"un_select_grid"!==t.originalEvent.dataTransfer.getData("Text"));else if(j){var i=p.grid.jqGrid("getGridParam","selrow");D.moveItems(!0,[i])}else{var r=p.grid.jqGrid("getGridParam","selarrrow");r.length>0&&D.moveItems(!0,r)}}));var n=v.grid.parent().parent().parent();(n=n.find(".ui-jqgrid-labels")).unbind("dragover").bind("dragover",(function(t){t.preventDefault(),e(this).addClass("drag-over-bottom")})),n.unbind("dragleave").bind("dragleave",(function(t){e(this).removeClass("drag-over-bottom")})),r.unbind("dragend").bind("dragend",(function(t){e(".drag-holder-table").remove()})),v.grid.parent().parent().unbind("dragend").bind("dragend",(function(t){e(".drag-holder-table").remove()})),n.unbind("dragend").bind("dragend",(function(t){e(".drag-holder-table").remove()})),n.unbind("drop").bind("drop",(function(r){if(r.preventDefault(),r.stopPropagation&&r.stopPropagation(),e(".drag-holder-table").remove(),e(this).removeClass("drag-over-bottom"),"select_grid"===r.originalEvent.dataTransfer.getData("Text")){var n=v.grid.find("tr.ui-widget-content")[0];if(!n)return;for(var l=v.grid.find("tr.ui-state-highlight"),a=l.length-1;a>=0;a--){var d=l[a],s=e(d),o=0,c=D.getSelectItems(),g=d.rowIndex-1;c.splice(o,0,c.splice(g,1)[0]),e(s).insertAfter(n)}var u=v.grid.parents(".ui-jqgrid-bdiv").scrollTop();K=!0,v.grid.trigger("reloadGrid"),i.setSelectGridDragAble(),l=v.grid.find("tr.ui-widget-content"),e.each(t,(function(t,i){var r=e(i).find("td")[1].innerHTML;e.each(l,(function(t,i){var n=i,l=e(n).find("td")[1].innerHTML;if(r===l)return v.grid.jqGrid("setSelection",e(n).attr("id"),!1),!1}))})),v.grid.parents(".ui-jqgrid-bdiv").scrollTop(u)}else if("un_select_grid"===r.originalEvent.dataTransfer.getData("Text")){o=-1;var h=p.grid.jqGrid("getGridParam","selarrrow");h.length>0&&D.moveItems(!0,h,o)}D.trigger("formItemChange",[D])})),r.unbind("dragover").bind("dragover",(function(t){e(this).addClass("drag-over-bottom")})),r.unbind("dragleave").bind("dragleave",(function(t){e(this).removeClass("drag-over-bottom")})),r.unbind("drop").bind("drop",(function(r){r.preventDefault(),r.stopPropagation&&r.stopPropagation(),e(this).removeClass("drag-over-bottom");var n=this;if("select_grid"===r.originalEvent.dataTransfer.getData("Text")){for(var l=v.grid.find("tr.ui-state-highlight"),a=l.length-1;a>=0;a--){var d=l[a],s=e(d);if(d!==this){var o=n.rowIndex-1,c=D.getSelectItems(),g=d.rowIndex-1;o>=g?c.splice(o,0,c.splice(g,1)[0]):c.splice(o+1,0,c.splice(g,1)[0]),e(s).insertAfter(n)}}K=!0;var u=v.grid.closest(".ui-jqgrid-bdiv").scrollTop();v.grid.trigger("reloadGrid"),i.setSelectGridDragAble(),l=v.grid.find("tr.ui-widget-content"),e.each(t,(function(t,i){var r=e(i).find("td")[1].innerHTML;e.each(l,(function(t,i){var n=e(s=i).find("td")[1].innerHTML;if(r===n)return v.grid.jqGrid("setSelection",e(s).attr("id"),!1),!1}))})),v.grid.closest(".ui-jqgrid-bdiv").scrollTop(u)}else if("un_select_grid"===r.originalEvent.dataTransfer.getData("Text"))if(j){var h=p.grid.jqGrid("getGridParam","selrow");D.moveItems(!0,[h])}else{o=n.rowIndex-1;var f=p.grid.jqGrid("getGridParam","selarrrow");f.length>0&&D.moveItems(!0,f,o,e(n).attr("id"))}D.trigger("formItemChange",[D])}))},this.setTotalDisplaySpan=function(){var t;(t=U?p.grid.jqGrid("getGridParam","selarrrow"):p.grid.jqGrid("getGridParam","selrow")?[p.grid.jqGrid("getGridParam","selrow")]:[])&&t.length;var i,r=0,n=0,l=0,a=p&&Global.isArray(p.getGridParam("data"))?p.getGridParam("data").length:0;if(0===LocalCacheData.paging_type||!W||W&&W.last_page_number<0?W?(r=W.total_rows,n=1,l=a):(r=a,n=1,l=a):W?(r=W.total_rows,n=0,l=0,W.last_page_number>1?W.is_last_page?(n=r-a+1,l=r):l=(n=(W.current_page-1)*W.rows_per_page+1)+W.rows_per_page-1:(n=1,l=r)):(r=0,n=0,l=0),U){var d=this.getSelectItems().length;0===a?(l=0,n=0):(l=a+n,1===n&&(l-=1)),r?(l>r&&(r=l),i=n+" - "+l+" "+e.i18n._("of")+" "+r+" "+e.i18n._("total")+". "):i=n+" - "+l+".",b.text(e.i18n._("Displaying")+" "+i+" "+e.i18n._("Selected")+": "+d)}else 0===l&&(n=0),r?(l>r&&(r=l),i=n+" - "+l+" "+e.i18n._("of")+" "+r+" "+e.i18n._("total")+". "):i=n+" - "+l+".",b.text(e.i18n._("Displaying")+" "+i)},this.onUnSelectGridSelectRow=function(){this.setTotalDisplaySpan()},this.onUnSelectGridDoubleClick=function(){if(U)if(j){var e=p.grid.jqGrid("getGridParam","selrow");D.moveItems(!0,[e])}else{var t=p.grid.jqGrid("getGridParam","selarrrow");t.length>0&&D.moveItems(!0,t)}},this.onSelectGridDoubleClick=function(){var e=v.grid.jqGrid("getGridParam","selarrrow");e.length>0&&D.moveItems(!1,e)},this.moveItems=function(t,i,r,n){this.removeNoResultCover("unselect_grid"),this.removeNoResultCover("select_grid"),K=!0;for(var l=e(p.grid).find(".editable"),a=0;a<l.length;a++){var d=e(l[a]).parents("tr").prop("id");p.grid.saveRow(d)}var s=e(v.grid).find(".editable");for(a=0;a<s.length;a++)d=e(s[a]).parents("tr").prop("id"),v.grid.saveRow(d);var o=i.slice();if(t)var c=p,g=v,u=p.getGridParam("data"),h=v.getGridParam("data");else c=v,g=p,u=v.getGridParam("data"),h=p.getGridParam("data");if(Global.isArray(h)||(h=[]),u[0]&&u[0].hasOwnProperty("id"))for(Global.isSet(r)||(i=i.reverse()),a=i.length-1;a>=0;a--)for(var f=i[a],_=0;_<u.length;_++){var b=u[_];if(b.id==f){var m=b;if(j&&t||(c.grid.jqGrid("delRowData",f),a+=1),!j||t)if(j){for(var G=h.length,y=!1,C=0;C<G;C++)if(h[C][S]===m[S]){y=!0;break}y||(r>=0?(g.grid.addRowData(f,m,"after",n),h.splice(h.length-1,1),h.splice(r+1,0,m)):-1===r?(g.grid.addRowData(f,m,"first"),h.splice(h.length-1,1),h.unshift(m)):(g.grid.addRowData(f,m),h[h.length-1]=m))}else r>=0?(g.grid.addRowData(f,m,"after",n),h.splice(h.length-1,1),h.splice(r+1,0,m)):-1===r?(g.grid.addRowData(f,m,"first"),h.splice(h.length-1,1),h.unshift(m)):(g.grid.addRowData(f,m),h[h.length-1]=m);break}}j?t?D.reSetUnSelectGridTreeData(u):D.reSetUnSelectGridTreeData(h):g.grid.trigger("reloadGrid"),D.setSelectGridDragAble(),D.setUnSelectGridDragAble(),D.updateRealSelectItemsIfNecessary(t,o),D.setTotalDisplaySpan(),w||D.trigger("formItemChange",[D])},this.updateRealSelectItemsIfNecessary=function(t,i){if(N&&0!=N.length)if(t){var r=v.getGridParam("data");e.each(i,(function(t,i){e.each(r,(function(e,t){if(t[S]==i)return N.push(t),!1}))}))}else e.each(i,(function(t,i){e.each(N,(function(e,t){if(t[S]==i)return N.splice(e,1),!1}))}))},this.setHeight=function(e){Z&&Z<e&&(e=Z),p.grid.setGridHeight(e),U&&v.grid.setGridHeight(e)};var re,ne,le=function(){var t=D.find("#unSelectedItemsLabel"),i=D.find("#unDeselectAllBtn"),r=D.find("#unselect_all_btn"),n=D.find("#un_clear_btn"),l=D.find("#show_all_check_box_label");U?t.text(e.i18n._("UNSELECTED ITEMS")):t.text(e.i18n._("PLEASE SELECT ITEM")),i.text(e.i18n._("Deselect All")),r.text(e.i18n._("Select All")),n.text(e.i18n._("Move All")),l.text(e.i18n._("Show All"));var a=D.find("#selectedItemsLabel"),d=D.find("#delete_all_btn"),s=D.find("#select_all_btn"),o=D.find("#clear_btn");a.text(e.i18n._("SELECTED ITEMS")),d.text(e.i18n._("Deselect All")),s.text(e.i18n._("Select All")),o.text(e.i18n._("Move All"))};this.selectNextItem=function(t){var i,r;if(39===t.keyCode)U&&!e(t.target).hasClass("search-input")&&(t.preventDefault(),D.onUnSelectGridDoubleClick());else if(37===t.keyCode)U&&!e(t.target).hasClass("search-input")&&(t.preventDefault(),D.onSelectGridDoubleClick());else{h&&clearTimeout(h);var n=e(":focus");if(n.length>0&&e(n[0]).hasClass("search-input"))return;if(h=setTimeout((function(){$=""}),200),t.preventDefault(),$+=Global.KEYCODES[t.which],U||j){if($){r=D.getFocusInSeletGrid()?D.getSelectGrid():D.getUnSelectGrid();var l,a=J[$]?J[$]:0,d=e(r.grid.find("tr").find("td:eq(1)").filter((function(){return 0==e.text([this]).toLowerCase().indexOf($)})));(a<0||a>d.length)&&(a=0),l=e(d[a]),D.unSelectAll(r.grid,!0),i=l.parent().index()-1;for(var s=!1,o=r.getData(),c=0;c<o.length;c++)if(o[c].id==l.parents("tr").attr("id")){s=o[c];break}R=s,D.setSelectItem(s,r),(J={})[$]=a+1}}else $&&(a=J[$]?J[$]:0,d=e(D.getUnSelectGrid().find("tr").find("td:first").filter((function(){return 0==e.text([this]).toLowerCase().indexOf($)}))),a>0&&a<d.length||(a=0),i=(l=e(d[a])).parent().index()-1,s=this.getItemByIndex(i),R=s,D.setSelectItem(s),(J={})[$]=a+1)}};for(var ae=0;ae<this.length;ae++){var de=e(this[ae]),se=e.meta?e.extend({},f,de.data()):f;se.default_height>150&&(L=se.default_height),c=se.field,se.search_input_filter&&(I=se.search_input_filter),se.select_grid_search_input_filter&&(T=se.select_grid_search_input_filter),se.default_sort_filter&&(k=se.default_sort_filter),se.default_select_grid_sort_filter&&(P=se.default_select_grid_sort_filter),se.auto_sort&&(B=se.auto_sort),Global.isSet(se.allow_multiple_selection)&&(U=se.allow_multiple_selection),se.column_option_key&&(X=se.column_option_key),se.api&&(V=se.api),se.hasOwnProperty("display_column_settings")&&(Y=se.display_column_settings),te=!!se.resize_grids&&se.resize_grids,a=de.find(".left-buttons-div"),d=de.find(".right-buttons-div"),i=de.find(".start"),r=de.find(".last"),n=de.find(".next"),l=de.find(".end"),i.text(e.i18n._("Start")),r.text(e.i18n._("Previous")),n.text(e.i18n._("Next")),l.text(e.i18n._("End")),i.click((function(){s&&w.onADropDownSearch("unselect_grid","start")})),r.click((function(){s&&w.onADropDownSearch("unselect_grid","last")})),n.click((function(){o&&w.onADropDownSearch("unselect_grid","next")})),l.click((function(){o&&w.onADropDownSearch("unselect_grid","end")})),a.css("display","none"),d.css("display","none"),10!==LocalCacheData.paging_type&&(M=Global.loadWidgetByName(WidgetNamesDic.PAGING)),b=de.find(".total-number-span"),U?b.text(e.i18n._("Displaying")+" 0 "+e.i18n._("of")+" 0 "+e.i18n._("total")):b.text(e.i18n._("Displaying")+" 0 - 0 "+e.i18n._("of")+" 0 "+e.i18n._("total")+". "+e.i18n._("Selected")+": 0"),U||de.find(".unselect-grid-border-div").addClass("single-mode-border"),de.find(".unselect-grid-div").bind("click",(function(){F=!1}));var oe=de.find(".select-grid-div"),ce=de.find(".left-and-right-div"),ge=de.find("#unselected_items_label"),ue=de.find("#selected_items_label");if(oe.bind("click",(function(){F=!0})),U?(oe.css("display","inline-block"),ce.css("display","inline-block"),ge.text(e.i18n._("UNSELECTED ITEMS")),ue.text(e.i18n._("SELECTED ITEMS"))):(oe.css("display","none"),ce.css("display","none"),ge.text(e.i18n._("SELECT AN ITEM"))),Global.isSet(se.allow_drag_to_order)&&se.allow_drag_to_order,!0===se.display_show_all){var he=de.find("#show_all_check_box");he.css("display","normal"),de.find("#show_all_check_box_label").css("display","normal"),!0===se.show_all?he.prop("checked","true"):he.prop("checked",void 0),de.find("#show_all_check_box").click((function(){var e=!1;"checked"!==he.prop("checked")&&!0!==he[0].checked||(e=!0),w.onShowAll(e)}))}else de.find("#show_all_check_box").css("display","none"),de.find("#show_all_check_box_label").css("display","none");se.comboBox?(w=se.comboBox).allow_multiple_selection&&de.css("min-Width",958):de.css("min-Width",958),G=se.id,de.attr("id",se.id+"ADropDown"),se.max_height&&(Z=se.max_height),se.static_height&&(ee=se.static_height,Z=se.static_height),se.key&&(S=se.key),se.show_search_inputs&&(x=se.show_search_inputs),se.tree_mode&&(j=se.tree_mode),se.on_tree_grid_row_select&&(A=se.on_tree_grid_row_select),le(),re=void 0,ne=void 0,re=e(D).find(".edit-columnIcon-div"),ne=e(D).find(".edit_column_icon"),Y&&!j?(re.show(),re.css("display","inline-block"),ne.attr("src",Global.getRealImagePath("images/edit.png")),re.click((function(t){t.preventDefault(),t.stopPropagation(),w.getEnabled()&&V.getOptions(X,{onResult:function(t){Q=Global.loadWidget("global/widgets/column_editor/ColumnEditor.html"),(Q=e(Q)).find("#save_btn").text(e.i18n._("Save and Close")),Q.find("#close_btn").text(e.i18n._("Close")),Q.find(".rows-per-page").text(e.i18n._("Rows Per Page")+":"),Q.find(".choose-layout").text(e.i18n._("Choose Layout")+":"),Q=Q.ColumnEditor({parent_awesome_box:w});var i=t.getResult();w.setAllColumns(Global.buildColumnArray(i)),w.setDisplayColumnsForEditor(w.buildDisplayColumnsForEditor()),Q.show()}})}))):re.hide(),(p=de.find(".unselect-grid")).attr("id","unselect_grid_"+G);var fe={};fe=j?{width:440,sortname:"id",onCellSelect:D.onUnSelectGridSelectRow,ondblClickRow:D.onUnSelectGridDoubleClick,multiselect:U,winMultiSelect:U,gridview:!0,treeGrid:!0,treeGridModel:"adjacency",treedatatype:"local",ExpandColumn:"name",jsonReader:{repeatitems:!1,root:function(e){return e},page:function(e){return 1},total:function(e){return 1},records:function(e){return e.length}}}:{width:440,onCellSelect:D.onUnSelectGridSelectRow,ondblClickRow:D.onUnSelectGridDoubleClick,multiselect:U,winMultiSelect:U,multiboxonly:U},Z&&(fe.maxHeight=Z),ee&&(fe.static_height=ee),p=new TTGrid("unselect_grid_"+G,fe,[]),(v=de.find(".select-grid")).attr("id","select_grid_"+G),v=new TTGrid("select_grid_"+G,{container_selector:".select-grid-div",altRows:!0,data:[],datatype:"local",sortable:!1,width:440,rowNum:1e4,colNames:[],colModel:[],ondblClickRow:D.onSelectGridDoubleClick,multiselect:U,winMultiSelect:U,multiboxonly:!0,viewrecords:!0,onResizeGrid:te,maxHeight:Z,static_height:ee||null},[]);var pe=de.find(".a-grid-right-arrow"),ve=de.find(".a-grid-left-arrow");pe.attr("src",Global.getRealImagePath("css/global/widgets/awesomebox/images/nav_right.png")),ve.attr("src",Global.getRealImagePath("css/global/widgets/awesomebox/images/nav_left.png")),pe.click((function(){if(j){var e=p.grid.jqGrid("getGridParam","selrow");D.moveItems(!0,[e])}else{var t=p.grid.jqGrid("getGridParam","selarrrow");t.length>0&&D.moveItems(!0,t)}})),ve.click((function(){var e=v.grid.jqGrid("getGridParam","selarrrow");e.length>0&&D.moveItems(!1,e)}));var _e=de.find("#unselect_all_btn");_e.click((function(){ie(p)}));var be=de.find("#unDeselectAllBtn");be.click((function(){ie(p,!0)}));var me=de.find("#un_clear_btn");me.click((function(){we(0,!0)})),j||!U?(_e.css("display","none"),be.css("display","none"),me.css("display","none")):(_e.css("display","inline-block"),be.css("display","inline-block"),me.css("display","inline-block")),de.find("#select_all_btn").click((function(){ie(v)})),de.find("#delete_all_btn").click((function(){ie(v,!0)})),de.find("#clear_btn").click((function(){we()}));var Ge=de.find("#select_grid_close_btn"),Se=de.find("#unselect_grid_close_btn");function we(e,t){D.removeNoResultCover("unselect_grid"),D.removeNoResultCover("select_grid"),K=!0;var i=[];if(t)var r=p,n=v,l=p.getData(),a=v.getData();else r=v,n=p,l=v.getData(),a=p.getData();j?(r.clearGridData(),r.grid.trigger("reloadGrid"),D.setTotalDisplaySpan(),D.getUnSelectGrid().grid.find("tr").removeClass("selected-tree-cell")):(i=a.concat(l),n.setData(i),N=t?i:[],r.clearGridData(),r.grid.trigger("reloadGrid"),D.setTotalDisplaySpan()),w||D.trigger("formItemChange",[D]),D.setSelectGridDragAble(),D.setUnSelectGridDragAble()}U?Se.css("display","none"):(Se.css("display","inline-block"),Se.click((function(){D.trigger("close",[D])}))),Global.isSet(se.display_close_btn)&&!se.display_close_btn?Ge.css("display","none"):(Ge.css("display","inline-block"),Ge.click((function(){D.trigger("close",[D])})))}return this},e.fn.ADropDown.defaults={}}}]);
//# sourceMappingURL=awesomebox-ADropDown.bundle.js.map?v=425c6760ccb9de84ca93