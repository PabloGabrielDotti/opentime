{"version":3,"sources":["webpack://timetrex/./interface/html5/views/employees/user_contact/UserContactViewController.js"],"names":["UserContactViewController","BaseViewController","options","_","defaults","el","user_api","company_api","ethnic_group_api","status_array","type_array","sex_array","country_array","province_array","e_province_array","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIUserContact","APIUser","APICompany","APIEthnicGroup","document_object_type_id","render","sub_view_mode","buildContextMenu","initData","exclude","ContextMenuIconName","copy","include","initDropDownOption","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","key","getField","edit_view_ui_dic","setValue","current_edit_record","getValue","validate","onCountryChange","setSelectLayout","buildEditViewUI","$this","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_employee_contact","edit_view_tab","find","tab_employee_contact_column1","tab_employee_contact_column2","edit_view_tabs","push","form_item_input","Global","loadWidgetByName","FormItemType","AWESOME_BOX","field","set_empty","default_args","setDefaultArgs","addEditFieldToColumn","COMBO_BOX","TComboBox","setSourceData","TEXT_INPUT","TTextInput","width","DATE_PICKER","TDatePicker","TEXT_AREA","TTextArea","TAG_INPUT","TTagInput","object_type_id","search_fields","SearchField","label","in_column","multiple","basic_search","adv_search","form_item_type","val","m","getOptions","onResult","res","getResult","buildRecordArray","adv_search_field_ui_dic","refresh","province_widget","length","province","value","search_panel","getSelectTabIndex","select_value","setProvince","change","proxy","selectVal","searchDone","TTPromise","resolve","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","loadViewSource","result","template","isSet","html","sub_user_contact_view_controller"],"mappings":"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","file":"employees-user_contact-UserContactViewController.bundle.js?v=97188d908c37dc124b74","sourcesContent":["export class UserContactViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#user_contact_view_container',\n\n\n\n\t\t\tuser_api: null,\n\t\t\tcompany_api: null,\n\t\t\tethnic_group_api: null,\n\t\t\tstatus_array: null,\n\t\t\ttype_array: null,\n\t\t\tsex_array: null,\n\t\t\tcountry_array: null,\n\t\t\tprovince_array: null,\n\t\t\te_province_array: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'UserContactEditView.html';\n\t\tthis.permission_id = 'user_contact';\n\t\tthis.viewId = 'UserContact';\n\t\tthis.script_name = 'UserContactView';\n\t\tthis.table_name_key = 'user_contact';\n\t\tthis.context_menu_name = $.i18n._( 'Employee Contacts' );\n\t\tthis.navigation_label = $.i18n._( 'Employee Contact' ) + ':';\n\t\tthis.api = TTAPI.APIUserContact;\n\t\tthis.user_api = TTAPI.APIUser;\n\t\tthis.company_api = TTAPI.APICompany;\n\t\tthis.ethnic_group_api = TTAPI.APIEthnicGroup;\n\t\tthis.document_object_type_id = 115;\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\n\t\t//this.setSelectRibbonMenuIfNecessary( 'UserContact' )\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [ContextMenuIconName.copy],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'type' );\n\t\tthis.initDropDownOption( 'sex' );\n\t\tthis.initDropDownOption( 'country', 'country', this.company_api );\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tswitch ( key ) {\n\t\t\tcase 'country':\n\t\t\t\tvar widget = this.edit_view_ui_dic['province'];\n\t\t\t\twidget.setValue( null );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.current_edit_record[key] = target.getValue();\n\n\t\tif ( key === 'country' ) {\n\t\t\tthis.onCountryChange();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tsetSelectLayout() {\n\t\tif ( this.sub_view_mode ) {\n\t\t\tsuper.setSelectLayout( ['employee_first_name', 'employee_last_name', 'title', 'user_group', 'default_branch', 'default_department'] );\n\t\t} else {\n\t\t\tsuper.setSelectLayout();\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_employee_contact': { 'label': $.i18n._( 'Employee Contact' ) },\n\t\t\t'tab_attachment': true,\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUserContact,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user_contact',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\tvar tab_employee_contact = this.edit_view_tab.find( '#tab_employee_contact' );\n\t\tvar tab_employee_contact_column1 = tab_employee_contact.find( '.first-column' );\n\t\tvar tab_employee_contact_column2 = tab_employee_contact.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_employee_contact_column1 );\n\t\tthis.edit_view_tabs[0].push( tab_employee_contact_column2 );\n\n\t\t// tab_employee_contact column1\n\n\t\t// Employee\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user',\n\t\t\tfield: 'user_id',\n\t\t\tset_empty: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'user_contact';\n\t\tform_item_input.setDefaultArgs( default_args );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_employee_contact_column1, '' );\n\n\t\t// Status\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( {\n\t\t\tfield: 'status_id'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Type\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( {\n\t\t\tfield: 'type_id'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// First Name\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'first_name',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'First Name' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Middle Name\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'middle_name',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Middle Name' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Last Name\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'last_name',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Last Name' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Gender\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( {\n\t\t\tfield: 'sex_id'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.sex_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Gender' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Ethnicity\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIEthnicGroup,\n\t\t\tfield: 'ethnic_group_id',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_ethnic_group',\n\t\t\tshow_search_inputs: true\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Ethnicity' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Home Address(Line 1)\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'address1',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Home Address (Line 1)' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Home Address(Line 2)\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'address2',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Home Address (Line 2)' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// City\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'city',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'City' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Country\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( {\n\t\t\tfield: 'country'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Country' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Province/State\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( {\n\t\t\tfield: 'province'\n\t\t} );\n\t\tform_item_input.setSourceData( [] );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Province/State' ), form_item_input, tab_employee_contact_column1 );\n\n\t\t// Postal / ZIP Code\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'postal_code',\n\t\t\twidth: 90\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Postal/ZIP Code' ), form_item_input, tab_employee_contact_column1, '' );\n\n\t\t// tab_employee_contact column2\n\n\t\t// Work Phone\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'work_phone',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Work Phone' ), form_item_input, tab_employee_contact_column2, '' );\n\n\t\t// Work Phone Ext\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'work_phone_ext',\n\t\t\twidth: 90\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Work Phone Ext' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Home Phone\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'home_phone',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Home Phone' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Mobile Phone\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'mobile_phone',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Mobile Phone' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Fax\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'fax_phone',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Fax' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Work Email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'work_email',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Work Email' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Home Email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'home_email',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Home Email' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Birth Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( {\n\t\t\tfield: 'birth_date'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Birth Date' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// SIN / SSN\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( {\n\t\t\tfield: 'sin',\n\t\t\twidth: 200\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'SIN / SSN' ), form_item_input, tab_employee_contact_column2 );\n\n\t\t// Note\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( {\n\t\t\tfield: 'note'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Note' ), form_item_input, tab_employee_contact_column2, '', null, null, true );\n\n\t\t// Tags\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\t\tform_item_input.TTagInput( {\n\t\t\tfield: 'tag',\n\t\t\tobject_type_id: 230\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), form_item_input, tab_employee_contact_column2, '', null, null, true );\n\t}\n\n\tbuildSearchFields() {\n\t\t//super.buildSearchFields();\n\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'user_contact';\n\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tdefault_args: default_args,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'First Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'first_name',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Last Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'last_name',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Phone' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'any_phone',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Email' ),\n\t\t\t\tfield: 'any_email',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 1,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Gender' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'sex_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Tags' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'tag',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tobject_type_id: 230,\n\t\t\t\tform_item_type: FormItemType.TAG_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Country' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'country',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.COMBO_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Province/State' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'province',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'City' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'city',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'SIN/SSN' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'sin',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} )\n\n\t\t];\n\t}\n\n\tsetProvince( val, m ) {\n\t\tvar $this = this;\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.province_array = [];\n\t\t\tthis.adv_search_field_ui_dic['province'].setSourceData( [] );\n\t\t} else {\n\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.province_array = Global.buildRecordArray( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['province'].setSourceData( $this.province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.e_province_array = Global.buildRecordArray( res );\n\t\t\t\t\tif ( refresh && $this.e_province_array.length > 0 ) {\n\t\t\t\t\t\t$this.current_edit_record.province = $this.e_province_array[0].value;\n\t\t\t\t\t\tprovince_widget.setValue( $this.current_edit_record.province );\n\t\t\t\t\t}\n\n\t\t\t\t\tprovince_widget.setSourceData( $this.e_province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tonSetSearchFilterFinished() {\n\n\t\tif ( this.search_panel.getSelectTabIndex() === 1 ) {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar select_value = combo.getValue();\n\t\t\tthis.setProvince( select_value );\n\t\t}\n\t}\n\n\tonBuildAdvUIFinished() {\n\n\t\tthis.adv_search_field_ui_dic['country'].change( $.proxy( function() {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar selectVal = combo.getValue();\n\n\t\t\tthis.setProvince( selectVal );\n\n\t\t\tthis.adv_search_field_ui_dic['province'].setValue( null );\n\n\t\t}, this ) );\n\t}\n\n\tsearchDone() {\n\t\tsuper.searchDone();\n\t\tTTPromise.resolve( 'ContactView', 'init' );\n\t}\n}\n\nUserContactViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'UserContact', 'SubUserContactView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tafterViewLoadedFun( sub_user_contact_view_controller );\n\t\t\t}\n\t\t}\n\t} );\n};"],"sourceRoot":""}