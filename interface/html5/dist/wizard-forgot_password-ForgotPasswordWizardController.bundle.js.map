{"version":3,"sources":["webpack://timetrex/./interface/html5/views/wizard/forgot_password/ForgotPasswordWizardController.js"],"names":["ForgotPasswordWizardController","BaseWizardController","options","_","defaults","el","super","this","title","$","i18n","steps","current_step","default_data","api_class","api","TTAPI","APIAuthentication","render","window","resize","initCurrentStep","$this","content_div","empty","stepsWidgetDic","form_item","Global","loadWidget","form_item_label","find","form_item_input_div","item","getTextInput","text","unbind","bind","e","keyCode","onDoneClick","append","getField","focus","stepsDataDic","current_step_data","current_step_ui","key","hasOwnProperty","getValue","remove","LocalCacheData","current_open_wizard_controller","extra_filter_for_next_open_view","saveCurrentStep","email","clearErrorStyle","resetPassword","onResult","result","isValid","onCloseClick","call_back","TAlertManager","showErrorAlert","setErrorStyle","details","getDetails","getDescription","error_string","isArray","each","index","val","error","IndexViewController","instance","router","showTipModal"],"mappings":"8MAAO,MAAMA,UAAuCC,qBACnD,YAAaC,EAAU,IACtBC,EAAEC,SAAUF,EAAS,CACpBG,GAAI,eAGLC,MAAOJ,GAGR,OAGCK,KAAKC,MAAQC,EAAEC,KAAKP,EAAG,kBACvBI,KAAKI,MAAQ,EACbJ,KAAKK,aAAe,EACfL,KAAKM,mBAAsD,IAA/BN,KAAKM,aAAaC,UAClDP,KAAKQ,IAAMR,KAAKM,aAAaC,UAE7BP,KAAKQ,IAAMC,MAAMC,kBAElBV,KAAKW,SAGN,SAECZ,MAAMY,SAMNT,EAAGU,QAASC,QAAQ,eAKpBb,KAAKc,kBAGN,qBAEC,IAAIC,EAAQf,KAKZ,OAJAA,KAAKgB,YAAYC,QAEjBjB,KAAKkB,eAAelB,KAAKK,cAAgB,GAEhCL,KAAKK,cACb,KAAK,EACJ,IAAIc,EAAYjB,EAAGkB,OAAOC,WAAY,wDAClCC,EAAkBH,EAAUI,KAAM,oBAClCC,EAAsBL,EAAUI,KAAM,wBACtCE,EAAOzB,KAAK0B,aAAc,SAC9BJ,EAAgBK,KAAMzB,EAAEC,KAAKP,EAAG,iBAAoB,KACpD4B,EAAoBI,OAAQ,WAAYC,KAAM,WAAW,SAAUC,GAC/C,KAAdA,EAAEC,SACNhB,EAAMiB,iBAGRR,EAAoBS,OAAQR,GAC5BzB,KAAKgB,YAAYiB,OAAQd,GACzBnB,KAAKkB,eAAelB,KAAKK,cAAcoB,EAAKS,YAAcT,EAC1DzB,KAAKkB,eAAelB,KAAKK,cAAcoB,EAAKS,YAAYC,SAK3D,kBACCnC,KAAKoC,aAAapC,KAAKK,cAAgB,GACvC,IAAIgC,EAAoBrC,KAAKoC,aAAapC,KAAKK,cAC3CiC,EAAkBtC,KAAKkB,eAAelB,KAAKK,cAG7C,IAAM,IAAIkC,KAFHvC,KAAKK,aAEKiC,EACVA,EAAgBE,eAAgBD,KAGtCF,EAAkBE,GAAOD,EAAgBC,GAAKE,YAMlD,wBAGA,eACCvC,EAAGF,KAAKF,IAAK4C,SACbC,eAAeC,+BAAiC,KAChDD,eAAeE,gCAAkC,KAGlD,cACC,IAAI9B,EAAQf,KACZD,MAAMiC,cACNhC,KAAK8C,kBAEL,IAAIC,EAAQ/C,KAAKoC,aAAa,GAAGW,MAEjC/C,KAAKkB,eAAe,GAAG6B,MAAMC,kBAEvBD,EAGL/C,KAAKQ,IAAIyC,cAAeF,EAAO,CAC9BG,SAAU,SAAUC,GACbA,EAAOC,WAGZrC,EAAMsC,eACDtC,EAAMuC,WACVvC,EAAMuC,UAAWH,IAJlBI,cAAcC,eAAgBL,MALjCnD,KAAKkB,eAAe,GAAG6B,MAAMU,cAAevD,EAAEC,KAAKP,EAAG,4BAA6B,GAiBrF,eAAgBuD,GACf,IAAIO,EAAUP,EAAOQ,aAIfD,IACLA,EAAUP,EAAOS,kBAElB,IAAIC,EAAe,GAEdzC,OAAO0C,QAASJ,IAAgC,iBAAZA,EAExCxD,EAAE6D,KAAML,GAAS,SAAUM,EAAOC,GAMjC,IAAM,IAAI1B,KAJL0B,EAAIzB,eAAgB,WACxByB,EAAMA,EAAIC,OAGMD,EAChBJ,EAAeA,EAAeI,EAAI1B,GAAO,UAK3CsB,EAAeH,EAEhBS,oBAAoBC,SAASC,OAAOC,aAAcT","file":"wizard-forgot_password-ForgotPasswordWizardController.bundle.js?v=44d1c9ac8cf5e9c7c5cd","sourcesContent":["export class ForgotPasswordWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit() {\n\t\t//this._super('initialize' );\n\n\t\tthis.title = $.i18n._( 'Password Reset' );\n\t\tthis.steps = 1;\n\t\tthis.current_step = 1;\n\t\tif ( this.default_data && typeof this.default_data.api_class != 'undefined' ) {\n\t\t\tthis.api = this.default_data.api_class;\n\t\t} else {\n\t\t\tthis.api = TTAPI.APIAuthentication;\n\t\t}\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tsuper.render();\n\n\t\t// $( this.el ).css( {left:  ( Global.bodyWidth() - $(this.el ).width() )/2} );\n\n//\t\tthis.content_div.css( {height: $(this.el ).height() - 145} );\n\n\t\t$( window ).resize( function() {\n\t\t\t// $( $this.el ).css( {left:  ( Global.bodyWidth() - $($this.el ).width() )/2} );\n//\t\t\t$this.content_div.css( {height: $($this.el ).height() - 145} );\n\t\t} );\n\n\t\tthis.initCurrentStep();\n\t}\n\n\tbuildCurrentStepUI() {\n\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\t\t\t\tvar item = this.getTextInput( 'email' );\n\t\t\t\tform_item_label.text( $.i18n._( 'Email Address' ) + ':' );\n\t\t\t\tform_item_input_div.unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\t\t\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t\t\t$this.onDoneClick();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tform_item_input_div.append( item );\n\t\t\t\tthis.content_div.append( form_item );\n\t\t\t\tthis.stepsWidgetDic[this.current_step][item.getField()] = item;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][item.getField()].focus();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tdefault:\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\tonCloseClick() {\n\t\t$( this.el ).remove();\n\t\tLocalCacheData.current_open_wizard_controller = null;\n\t\tLocalCacheData.extra_filter_for_next_open_view = null;\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar email = this.stepsDataDic[1].email;\n\n\t\tthis.stepsWidgetDic[1].email.clearErrorStyle();\n\n\t\tif ( !email ) {\n\t\t\tthis.stepsWidgetDic[1].email.setErrorStyle( $.i18n._( 'Email must be specified' ), true );\n\t\t} else {\n\t\t\tthis.api.resetPassword( email, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.onCloseClick();\n\t\t\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t\t\t$this.call_back( result );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tshowErrorAlert( result ) {\n\t\tvar details = result.getDetails();\n\t\t// if ( details.hasOwnProperty( 'error' ) ) {\n\t\t//\n\t\t// }\n\t\tif ( !details ) {\n\t\t\tdetails = result.getDescription(); // If the details is empty, try to get description to show.\n\t\t}\n\t\tvar error_string = '';\n\n\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\n\t\t\t$.each( details, function( index, val ) {\n\n\t\t\t\tif ( val.hasOwnProperty( 'error' ) ) {\n\t\t\t\t\tval = val.error;\n\t\t\t\t}\n\n\t\t\t\tfor ( var key in val ) {\n\t\t\t\t\terror_string = error_string + val[key] + '<br>';\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\n\t\t\terror_string = details;\n\t\t}\n\t\tIndexViewController.instance.router.showTipModal( error_string );\n\t}\n}"],"sourceRoot":""}