(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["policy-expense_policy-ExpensePolicyViewController"],{6859:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"ExpensePolicyViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#expense_policy_view_container",type_array:null,require_receipt_array:null}),super(e)}init(e){this.edit_view_tpl="ExpensePolicyEditView.html",this.permission_id="expense_policy",this.viewId="ExpensePolicy",this.script_name="ExpensePolicyView",this.table_name_key="expense_policy",this.context_menu_name=$.i18n._("Expense Policy"),this.navigation_label=$.i18n._("Expense Policy")+":",this.api=TTAPI.APIExpensePolicy,this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary("ExpensePolicy")}initOptions(){this.initDropDownOption("type"),this.initDropDownOption("require_receipt")}buildEditViewUI(){super.buildEditViewUI();var e={"tab_expense_policy":{"label":$.i18n._("Expense Policy")},"tab_audit":!0};this.setTabModel(e),this.navigation.AComboBox({api_class:TTAPI.APIExpensePolicy,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_expense_policy",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var t=this.edit_view_tab.find("#tab_expense_policy").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(t);var i=Global.loadWidgetByName(FormItemType.TEXT_INPUT);i.TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),i,t,"first"),i.parent().width("45%"),(i=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"description",width:"100%"}),this.addEditFieldToColumn($.i18n._("Description"),i,t,"",null,null,!0),i.parent().width("45%"),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type_id",set_empty:!1}),i.setSourceData(this.type_array),this.addEditFieldToColumn($.i18n._("Type"),i,t),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"unit_name",width:200}),this.addEditFieldToColumn($.i18n._("Unit Name"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"amount",width:100}),this.addEditFieldToColumn($.i18n._("Percent"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"min_amount",width:100}),this.addEditFieldToColumn($.i18n._("Minimum Amount"),i,t),(i=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"max_amount",width:100}),this.addEditFieldToColumn($.i18n._("Maximum Amount"),i,t);var a={filter_data:{}};a.filter_data.type_id=[40,50],(i=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIExpensePolicy,allow_multiple_selection:!0,layout_name:"global_expense_policy",set_empty:!0,show_search_inputs:!0,field:"expense_policy"}),i.setDefaultArgs(a),this.addEditFieldToColumn($.i18n._("Taxes"),i,t),(i=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"require_receipt_id",set_empty:!1}),i.setSourceData(this.require_receipt_array),this.addEditFieldToColumn($.i18n._("Require Receipt"),i,t),(i=Global.loadWidgetByName(FormItemType.CHECKBOX)).TCheckbox({field:"is_reimbursable"}),this.addEditFieldToColumn($.i18n._("Reimbursable"),i,t),(i=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIPayStubEntryAccount,allow_multiple_selection:!1,layout_name:"global_PayStubAccount",set_empty:!0,show_search_inputs:!0,field:"pay_stub_entry_account_id"}),this.addEditFieldToColumn($.i18n._("Pay Stub Account"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIProduct,allow_multiple_selection:!1,layout_name:"global_product",set_empty:!0,show_search_inputs:!0,field:"product_id"}),this.addEditFieldToColumn($.i18n._("Product"),i,t)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Name"),in_column:1,field:"name",basic_search:!0,adv_search:!1,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Require Receipt"),in_column:1,field:"require_receipt_id",multiple:!0,basic_search:!0,adv_search:!1,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Product"),in_column:2,field:"product_id",layout_name:"global_product",api_class:TTAPI.APIProduct,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!1,form_item_type:FormItemType.AWESOME_BOX})]}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField();this.current_edit_record[i]=e.getValue(),"type_id"!==i&&"is_reimbursable"!==i||this.onTypeChange(),t||this.validate()}setCurrentEditRecordData(){for(var e in this.setDefaultData({"type_id":10}),this.current_edit_record)if(this.current_edit_record.hasOwnProperty(e)){var t=this.edit_view_ui_dic[e];if(Global.isSet(t))switch(e){case"pay_stub_entry_account_id":default:t.setValue(this.current_edit_record[e])}}this.onTypeChange(),this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}onTypeChange(){10==this.current_edit_record.type_id?(this.detachElement("amount"),this.detachElement("unit_name")):20==this.current_edit_record.type_id||40==this.current_edit_record.type_id?(this.edit_view_form_item_dic.amount.find(".edit-view-form-item-label").text($.i18n._("Percent")+": "),this.attachElement("amount"),this.detachElement("unit_name")):30==this.current_edit_record.type_id?(this.edit_view_form_item_dic.amount.find(".edit-view-form-item-label").text($.i18n._("Amount/Unit")+": "),this.attachElement("amount"),this.attachElement("unit_name")):50==this.current_edit_record.type_id?(this.edit_view_form_item_dic.amount.find(".edit-view-form-item-label").text($.i18n._("Amount")+": "),this.detachElement("unit_name")):(this.detachElement("amount"),this.detachElement("unit_name")),1==this.edit_view_ui_dic.is_reimbursable.getValue()?this.attachElement("pay_stub_entry_account_id"):this.detachElement("pay_stub_entry_account_id"),this.editFieldResize()}}}}]);
//# sourceMappingURL=policy-expense_policy-ExpensePolicyViewController.bundle.js.map?v=b67b144196ac4cdac0b0