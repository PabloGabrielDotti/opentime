{"version":3,"sources":["webpack://timetrex/./interface/html5/views/wizard/reset_password/ResetPasswordWizardController.js"],"names":["ResetPasswordWizardController","BaseWizardController","options","_","defaults","el","super","this","title","$","i18n","steps","current_step","default_data","api_class","api","TTAPI","APIAuthentication","render","initCurrentStep","content_div","empty","stepsWidgetDic","label","getLabel","text","message","append","form_item","Global","loadWidget","form_item_label","find","form_item_input_div","user_name","getText","current_password","getPasswordInput","new_password","confirm_password","getField","focus","stepsDataDic","current_step_data","current_step_ui","key","hasOwnProperty","getValue","remove","LocalCacheData","current_open_wizard_controller","extra_filter_for_next_open_view","$this","onDoneClick","saveCurrentStep","clearErrorStyle","setErrorStyle","TAlertManager","showAlert","changePassword","onResult","result","isValid","onCloseClick","call_back","showErrorAlert","type"],"mappings":"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","file":"wizard-reset_password-ResetPasswordWizardController.bundle.js?v=63e9fb6441b7e1990107","sourcesContent":["export class ResetPasswordWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.title = $.i18n._( 'Reset Password' );\n\t\tthis.steps = 1;\n\t\tthis.current_step = 1;\n\t\tif ( this.default_data && typeof this.default_data.api_class != 'undefined' ) {\n\t\t\tthis.api = this.default_data.api_class;\n\t\t} else {\n\t\t\tthis.api = TTAPI.APIAuthentication;\n\t\t}\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\tbuildCurrentStepUI() {\n\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\t//Error: TypeError: this.default_data is null in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 32\n\t\t\t\tlabel.text( this.default_data ? this.default_data.message : '' );\n\t\t\t\tthis.content_div.append( label );\n\n\t\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar user_name = this.getText();\n\n\t\t\t\tuser_name.text( this.default_data ? this.default_data.user_name : '' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'User Name' ) + ':' );\n\t\t\t\tform_item_input_div.append( user_name );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar current_password = this.getPasswordInput( 'current_password' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'Current Password' ) + ':' );\n\t\t\t\tform_item_input_div.append( current_password );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar new_password = this.getPasswordInput( 'new_password' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'New Password' ) + ':' );\n\t\t\t\tform_item_input_div.append( new_password );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar confirm_password = this.getPasswordInput( 'confirm_password' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'New Password (Confirm)' ) + ':' );\n\t\t\t\tform_item_input_div.append( confirm_password );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step][current_password.getField()] = current_password;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][new_password.getField()] = new_password;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][confirm_password.getField()] = confirm_password;\n\n\t\t\t\tcurrent_password.focus();\n\n\t\t\t\tbreak;\n\n\t\t}\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tdefault:\n\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t}\n\n\tonCloseClick() {\n\n\t\t$( this.el ).remove();\n\t\tLocalCacheData.current_open_wizard_controller = null;\n\t\tLocalCacheData.extra_filter_for_next_open_view = null;\n\t}\n\n\tonDoneClick() {\n\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar current_password = this.stepsDataDic[1].current_password;\n\t\tvar new_password = this.stepsDataDic[1].new_password;\n\t\tvar confirm_password = this.stepsDataDic[1].confirm_password;\n\n\t\tthis.stepsWidgetDic[1].current_password.clearErrorStyle();\n\t\tthis.stepsWidgetDic[1].new_password.clearErrorStyle();\n\t\tthis.stepsWidgetDic[1].confirm_password.clearErrorStyle();\n\n\t\tif ( !current_password ) {\n\t\t\tthis.stepsWidgetDic[1].current_password.setErrorStyle( $.i18n._( 'Current password can\\'t be empty' ), true );\n\t\t} else if ( !new_password ) {\n\t\t\tthis.stepsWidgetDic[1].new_password.setErrorStyle( $.i18n._( 'New password can\\'t be empty' ), true );\n\t\t} else if ( new_password !== confirm_password ) {\n\t\t\tthis.stepsWidgetDic[1].new_password.setErrorStyle( $.i18n._( 'New password does not match' ), true );\n\t\t} else {\n\t\t\tif ( !this.default_data || !this.default_data.user_name ) {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Invalid user name' ) );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.api.changePassword( this.default_data.user_name,\n\t\t\t\tcurrent_password,\n\t\t\t\tnew_password,\n\t\t\t\tconfirm_password,\n\t\t\t\t{\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t\t\tTAlertManager.showErrorAlert( result );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.onCloseClick();\n\n\t\t\t\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t\t\t\t$this.call_back();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}\n\t}\n\n}\n\nResetPasswordWizardController.type = '';"],"sourceRoot":""}