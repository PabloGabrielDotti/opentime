(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["JobApplicationSubViewController","portal-hr-my_profile-JobApplicantSubBaseViewController","JobApplicantSubBaseViewController"],{3757:(e,i,t)=>{"use strict";t.r(i),t.d(i,{"JobApplicantSubBaseViewController":()=>l});var a=t(97),n=t(7526),o=t(4936);class l extends a.PortalBaseViewController{constructor(e={}){_.defaults(e,{events:{'change input[type="text"]':"onFormItemChange",'change input[type="checkbox"]':"onFormItemChange","change select.form-control":"onFormItemChange","change textarea.form-control":"onFormItemChange"}}),super(e)}preInit(e){this.api=n.y.APIJobApplicantPortal,this.qualification_api=n.y.APIQualificationPortal,this.company_api=n.y.APICompanyPortal,this.sub_view_id=e.sub_view_id,this.display_columns=e.display_columns,this.table_container=e.table_container,this.available_fields=e.available_fields,this._delegate=e._delegate,this.edit_view_error_ui_dic={},this.enable_add_qualification=e.enable_add_qualification||!1}postInit(){this.model.id?this.render():this.setEditView()}render(){var e=this,i=Global.loadWidget("views/portal/hr/my_profile/MyProfileSubView.html"),t=this.sub_view_id+"-"+this.model.id;if(this.unique_id=t,this.sub_view=_.template(i)({}),0==this.table_container.find(".table-container").length&&this.table_container.html('<div class="table-responsive"><table class="table table-condensed table-bordered table-container"><thead></thead><tbody></tbody></table></div>'),0===this.table_container.find("#"+t).length){var a=$("<tr>").attr("id",t);$(this.table_container.find("tbody")[0]).append(a)}else this.table_container.find("#"+t).html("");var n=$("<tr>");for(var o in this.display_columns)if(this.display_columns.hasOwnProperty(o)){var l;switch(o){case"is_current_employer":case"is_contact_available":l=this.model.get(o)?$.i18n._("Yes"):$.i18n._("No");break;default:l=this.model.get(o)?this.model.get(o):""}n.append("<th>"+this.display_columns[o]+"</th>"),this.table_container.find("#"+t).append("<td>"+l+"</td>")}n.append("<th>"+$.i18n._("Action")+"</th>"),""===this.table_container.find("thead").html()&&this.table_container.find("thead").html(n),this.table_container.find("#"+t).append(this.sub_view),this.table_container.find("#"+t).find(".edit-icon").unbind("click").bind("click",(function(i){e["get"+e.sub_view_id]((function(){e.setEditView()}))})),this.table_container.find("#"+t).find(".delete-icon").unbind("click").bind("click",(function(i){e["get"+e.sub_view_id]((function(){e.onDeleteClick()}))}))}initOptions(){var e=this,i={},t={};t.type_id=[this.qualification_type_id],i.filter_data=t,i.filter_columns={"id":!0,"name":!0},this.qualification_api.getQualification(i,!0,{onResult:function(i){var t=i.getResult(),a={};for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];a[o.id]=$.i18n._(o.name)}e.setSourceData("qualification_id",a,!0)}})}onSelectClick(e){var i=$(e.currentTarget).parent().find("select");document.createEvent?((e=document.createEvent("MouseEvents")).initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i[0].dispatchEvent(e)):element.fireEvent&&i[0].fireEvent("onmousedown")}setEditView(){var e=Global.loadWidget("views/portal/hr/my_profile/"+this.sub_view_id+"SubEditView.html");this.setElement(_.template(e)({available_fields:this.available_fields,enable_add_qualification:this.enable_add_qualification})),this.initOptions(),this.registerDatePicker(),this.setCurrentEditRecordData(),this.openEditView()}onDeleteClick(){var e=this;IndexViewController.instance.router.showConfirmModal(Global.delete_confirm_message,{title:"",actions:[{label:"No",isClose:!0},{label:"Yes",callBack:function(i){e.closeConfirmModal(),ProgressBar.showOverlay(),e.api["delete"+e.sub_view_id](e.model.id,{onResult:function(i){ProgressBar.closeOverlay(),i.isValid()?e._delegate.setSubViews(e.sub_view_id,e.display_columns):e.showErrorAlert(i)}})}}]})}setSourceData(e,i,t){var a=this,n='select[name="'+e+'"]';if(this.$(n)&&this.$(n)[0])switch(this.$(n).empty(),Global.isSet(this.model.get(e))||this.model.set(e,""),0==_.size(i)&&(t=!0,this.model.set(e,"")),e){case"qualification_id":if(this.enable_add_qualification){var o;switch(this.sub_view_id){case"JobApplicantSkill":o=$.i18n._("Add New Skill");break;case"JobApplicantEducation":o=$.i18n._("Add New Course");break;case"JobApplicantLicense":o=$.i18n._("Add New Type");break;case"JobApplicantLanguage":o=$.i18n._("Add New Language");break;case"JobApplicantMembership":o=$.i18n._("Add New Membership")}t=!1,this.$(n).append($("<option></option>").prop("value","").text("-- "+o+" --"))}default:!0===t&&this.$(n).append($("<option></option>").prop("value","").text("-- "+$.i18n._("None")+" --")),_.size(i)>0&&$.each(i,(function(i,t){a.$(n).append($("<option></option>").prop("value",i).text(t)),a.model.get(e)==i&&a.$(n).val(i)})),a.$(n).selectpicker()}}registerDatePicker(){var e,i=!1,t=[$.i18n._("Sun"),$.i18n._("Mon"),$.i18n._("Tue"),$.i18n._("Wed"),$.i18n._("Thu"),$.i18n._("Fri"),$.i18n._("Sat")],a=[$.i18n._("Jan"),$.i18n._("Feb"),$.i18n._("Mar"),$.i18n._("Apr"),$.i18n._("May"),$.i18n._("Jun"),$.i18n._("Jul"),$.i18n._("Aug"),$.i18n._("Sep"),$.i18n._("Oct"),$.i18n._("Nov"),$.i18n._("Dec")],n={showTime:!1,dateFormat:"dd-M-y",showHour:!1,showMinute:!1,changeMonth:!0,changeYear:!0,showButtonPanel:!0,duration:"",showAnim:"",yearRange:"-100:+10",showOn:"",dayNamesMin:t,currentText:$.i18n._("Today"),monthNamesShort:a,closeText:$.i18n._("Close"),beforeShow:function(){},onSelect:function(e){$(this).change()},onClose:function(){e=setTimeout((function(){i=!1}),100)}};this.$('input[type="text"].datepicker').datepicker(n),this.$('input[type="text"].datepicker').attr("placeholder","dd-mmm-yy"),this.$('input[type="text"].datepicker').bind("mouseup",(function(){i?(i=!1,e&&(clearTimeout(e),e=null)):($(this).datepicker("show"),i=!0)})).next(".glyphicon").bind("mouseup",(function(){$(this).prev().trigger("mouseup")}))}setCurrentEditRecordData(){var e=this,i=this.$(".detail-form").serializeArray();$.map(i,(function(i,t){Global.isSet(e.model.get(i.name))||e.model.set(i.name,i.value)})),this.model.has("qualification_id")||this.model.set("qualification_id",!1)}addQualification(){var e=this,i={};i.type_id=this.qualification_type_id;var t=i.name=this.getQualificationWidget().val();this.qualification_api.setQualification(i,{onResult:function(i){if(i.isValid()){e.$("select[name='qualification_id']").selectpicker("destroy");var a=i.getResult();$("<option>").attr({selected:"selected",value:a}).text(t).appendTo(e.$("select[name='qualification_id']")),e.$("select[name='qualification_id']").selectpicker(),e.$("select[name='qualification_id']").trigger("change")}else e.setErrorTips(i)}})}getAddQualificationContainer(){return this.$(".add-qualification-container")}getQualificationWidget(){return this.getAddQualificationContainer().find('input[name="name"]')}showAddQualificationContainer(){var e=this,i=this.getAddQualificationContainer();i.css("display","table"),i.off("click").on("click",(function(){e.addQualification()}));var t=this.getQualificationWidget();return t.val(""),t.unbind("keydown").bind("keydown",(function(i){13===i.keyCode&&e.addQualification()})),i}hideAddQualificationContainer(){var e=this.getAddQualificationContainer();return e.css("display","none"),e}openEditView(){var e=this;IndexViewController.instance.router.showFormModal(this.$el,{title:"",actions:[{label:"Close",isClose:!0,callBack:function(i){e.clearErrorTips(!0)}},{label:"Save Changes",callBack:function(i){e.onSaveClick()}}]})}closeEditView(){IndexViewController.instance.router.hideFormModal()}closeConfirmModal(){IndexViewController.instance.router.hideConfirmModal()}onFormItemChange(e,i){var t=e.currentTarget.name;switch(this.model.set(t,$(e.currentTarget).val()),t){case"name":i=!0;break;case"qualification_id":""===this.model.get(t)&&this.enable_add_qualification?(this.showAddQualificationContainer(),i=!0):this.hideAddQualificationContainer()}i||this.validate()}validate(){var e=this;this.api["validate"+this.sub_view_id](this.model.toJSON(),{onResult:function(i){e.validateResult(i)}})}validateResult(e){this.setErrorTips(e)}clearErrorTips(e){for(var i in this.edit_view_error_ui_dic)(""!==this.edit_view_error_ui_dic[i].val()||e)&&(this.edit_view_error_ui_dic[i].removeClass("error-tip"),this.edit_view_error_ui_dic[i].tooltip().tooltip("dispose"))}setErrorTips(e){this.clearErrorTips(!0);var i=e.getDetails()?e.getDetails()[0]:{};for(var t in i&&i.hasOwnProperty("error")&&(i=i.error),i){var a,n;if(i.hasOwnProperty(t))if(this.$('input[name="'+t+'"]')[0]?a=this.$('input[name="'+t+'"]'):this.$('select[name="'+t+'"]')[0]?a=this.$('select[name="'+t+'"]').parents(".styled-select"):this.$('textarea[name="'+t+'"]')[0]&&(a=this.$('textarea[name="'+t+'"]')),a)a.addClass("error-tip"),n=_.isArray(i[t])?i[t][0]:i[t],a.tooltip({title:n,container:"body",trigger:"hover focus"}),a.tooltip("show"),this.edit_view_error_ui_dic[t]=a}}showErrorAlert(e){var i=e.getDetails();i.hasOwnProperty("error"),i||(i=e.getDescription());var t="";Global.isArray(i)||"object"==typeof i?$.each(i,(function(e,i){for(var a in i.hasOwnProperty("error")&&(i=i.error),i)t=t+i[a]+"<br>"})):t=i,this.showAlert(t)}onSaveClick(){var e=this;this.api["set"+this.sub_view_id](this.model.toJSON(),{onResult:function(i){if(i.isValid()){var t=i.getResult();!0!==t&&o.d.isUUID(t)&&t!=o.d.zero_id&&t!=o.d.not_exist_id&&e.model.set("id",t),e.edit_view_error_ui_dic={},e["get"+e.sub_view_id]((function(){e.render(),e.closeEditView()}))}else e.setErrorTips(i)}})}showAlert(e){IndexViewController.instance.router.showTipModal(e)}}},3510:(e,i,t)=>{"use strict";t.r(i),t.d(i,{"JobApplicationSubViewController":()=>n});var a=t(3757);class n extends a.JobApplicantSubBaseViewController{constructor(e={}){_.defaults(e,{}),super(e)}render(){var e=this,i=Global.loadWidget("views/portal/hr/my_profile/MyProfileSubView.html"),t=this.sub_view_id+"-"+this.model.id;if(this.unique_id=t,this.sub_view=_.template(i)({}),0==this.table_container.find(".table-container").length&&this.table_container.html('<div class="table-responsive"><table class="table table-condensed table-bordered table-container"><thead></thead><tbody></tbody></table></div>'),0===this.table_container.find("#"+t).length){var a=$("<tr>").attr("id",t);$(this.table_container.find("tbody")[0]).append(a)}else this.table_container.find("#"+t).html("");var n=$("<tr>");for(var o in this.display_columns)if(this.display_columns.hasOwnProperty(o)){var l;if(l=this.model.get(o)?this.model.get(o):"","job_vacancy"===o){var s=Global.getBaseURL()+"#!m=PortalJobVacancyDetail&id="+this.model.get("job_vacancy_id")+"&company_id="+LocalCacheData.getAllURLArgs().company_id;this.table_container.find("#"+t).append('<td><a href="'+s+'">'+l+"</a></td>")}else this.table_container.find("#"+t).append("<td>"+l+"</td>");n.append("<th>"+this.display_columns[o]+"</th>")}n.append("<th>"+$.i18n._("Action")+"</th>"),""===this.table_container.find("thead").html()&&this.table_container.find("thead").html(n),this.table_container.find("#"+t).append(this.sub_view),this.table_container.find("#"+t).find(".edit-icon").remove(),this.table_container.find("#"+t).find(".delete-icon").unbind("click").bind("click",(function(i){e["get"+e.sub_view_id]((function(){e.onDeleteClick()}))}))}getJobApplication(e){var i=this,t={filter_data:{}};t.filter_data.id=this.model.id,this.api.getJobApplication(t,{onResult:function(t){if(t.isValid()){var a=t.getResult();a||(a=[]),a=a[0],i.model.set(a),e&&e()}else i.showErrorAlert(t),ProgressBar.closeOverlay()}})}}}}]);
//# sourceMappingURL=JobApplicationSubViewController.bundle.js.map?v=8cf8f063e313e979f8a6