{"version":3,"sources":["webpack://timetrex/./interface/html5/views/attendance/job/JobViewController.js"],"names":["JobViewController","BaseViewController","options","_","defaults","el","status_array","job_group_array","job_group_api","user_group_api","job_item_group_api","job_detail_report_api","user_group_selection_type_array","user_branch_selection_type_array","user_department_selection_type_array","job_item_group_selection_type_array","user_group_array","sub_document_view_controller","sub_job_item_amendment_view_controller","document_object_type_id","date_api","report_template","country_array","province_array","e_province_array","company_api","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIJob","APITTDate","APIJobGroup","APIUserGroup","APIJobItemGroup","APIJobDetailReport","APICompany","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","$this","initDropDownOption","getJobGroup","onResult","res","getResult","Global","buildTreeRecord","sub_view_mode","basic_search_field_ui_dic","setSourceData","adv_search_field_ui_dic","getUserGroup","getJobItemGroup","job_item_group_array","getTemplate","exclude","include","label","id","ContextMenuIconName","job_invoice","group","icon","Icons","invoice","permission_result","PermissionManager","checkTopLevelPermission","permission","import_icon","sort_order","print","map","onOtherIconsClick","generatePDFReport","getProductEdition","is_viewing","ProgressBar","showProgressBar","data","filter_columns","name","address1","address2","city","province","country","postal_code","latitude","longitude","ids","getGridSelectIdArray","filter_data","convertLayoutFilterToAPIFilter","select_layout","length","cells","getJob","async","is_mass_editing","then","module","processed_data_for_map","TTConvertMapData","processBasicFromGenericViewController","IndexViewController","openEditView","catch","importErrorHandler","full_item","LocalCacheData","getLoginUser","grid_selected_id_array","include_job_ids","edit_view","current_edit_record","push","each","index","value","grid_selected_row","getRecordFromGridById","TAlertManager","showAlert","closeOverlay","include_job_id","postData","doFormIFrameCall","APIFileDownload","removeEditView","wizard_id","openWizard","search","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","form_item_input","widgetContainer","tab_job","edit_view_tab","find","tab_job_column1","edit_view_tabs","loadWidgetByName","FormItemType","COMBO_BOX","TComboBox","field","addEditFieldToColumn","TEXT_INPUT","TTextInput","width","parent","AWESOME_BOX","tree_mode","set_empty","APIClient","APIBranch","APIDepartment","APIUser","APIJobItem","APIGEOFence","TAG_INPUT","TTagInput","object_type_id","tab_job_column2","DATE_PICKER","TDatePicker","mode","need_parser_sec","note","append","TEXT_AREA","TTextArea","tab_location_column1","tab_employee_criteria_column1","v_box","form_item","putInputToInsideFormItem","form_item_input_1","tab_task_criteria_column1","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type","tab","retval","validate","checkTabPermissions","setDefaultMenu","parent_key","parent_value","parent_edit_record","parent_view_controller","loadScript","firstColumn","trackView","JobItemAmendmentViewController","loadSubView","beforeLoadView","afterLoadView","TTPromise","resolve","subViewController","key","setDefaultData","widget","edit_view_ui_dic","isSet","getCurrentCompany","eSetProvince","setValue","collectUIDataToCurrentEditRecord","setEditViewDataDone","onEmployeeGroupSelectionTypeChange","onBranchSelectionTypeChange","onDepartmentSelectionTypeChange","isDisableIncludeEmployees","onJobItemGroupSelectionTypeChange","isDisableIncludeTasks","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","getField","c_value","getValue","onCountryChange","val","refresh","province_widget","getOptions","buildRecordArray","getEnabled","setEnabled","column_filter","enable_system_columns","undefined","_getFilterColumnsFromDisplayColumns"],"mappings":"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","file":"attendance-job-JobViewController.bundle.js?v=89be93d05552fda6cde7","sourcesContent":["export class JobViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#job_view_container',\n\n\t\t\t// _required_files: {\n\t\t\t// \t15: ['leaflet-timetrex']\n\t\t\t// },\n\t\t\tstatus_array: null,\n\n\t\t\tjob_group_array: null,\n\t\t\tjob_group_api: null,\n\t\t\tuser_group_api: null,\n\t\t\tjob_item_group_api: null,\n\t\t\tjob_detail_report_api: null,\n\n\t\t\tuser_group_selection_type_array: null,\n\t\t\tuser_branch_selection_type_array: null,\n\t\t\tuser_department_selection_type_array: null,\n\t\t\tjob_item_group_selection_type_array: null,\n\n\t\t\tuser_group_array: null,\n\n\t\t\tsub_document_view_controller: null,\n\n\t\t\tsub_job_item_amendment_view_controller: null,\n\n\t\t\tdocument_object_type_id: null,\n\t\t\tdate_api: null,\n\t\t\treport_template: null,\n\t\t\tcountry_array: null,\n\t\t\tprovince_array: null,\n\n\t\t\te_province_array: null,\n\n\t\t\tcompany_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'JobEditView.html';\n\t\tthis.permission_id = 'job';\n\t\tthis.viewId = 'Job';\n\t\tthis.script_name = 'JobView';\n\t\tthis.table_name_key = 'job';\n\t\tthis.context_menu_name = $.i18n._( 'Job' );\n\t\tthis.navigation_label = $.i18n._( 'Job' ) + ':';\n\n\t\tthis.document_object_type_id = 60;\n\t\tthis.api = TTAPI.APIJob;\n\t\tthis.date_api = TTAPI.APITTDate;\n\t\tthis.job_group_api = TTAPI.APIJobGroup;\n\t\tthis.user_group_api = TTAPI.APIUserGroup;\n\t\tthis.job_item_group_api = TTAPI.APIJobItemGroup;\n\t\tthis.job_detail_report_api = TTAPI.APIJobDetailReport;\n\t\tthis.company_api = TTAPI.APICompany;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary( 'Job' );\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'user_group_selection_type' );\n\t\tthis.initDropDownOption( 'user_branch_selection_type' );\n\t\tthis.initDropDownOption( 'user_department_selection_type' );\n\t\tthis.initDropDownOption( 'job_item_group_selection_type' );\n\n\t\tthis.initDropDownOption( 'country', 'country', this.company_api );\n\n\t\tthis.job_group_api.getJobGroup( '', false, false, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildTreeRecord( res );\n\n\t\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['group_id'] ) {\n\t\t\t\t\t$this.basic_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t}\n\n\t\t\t\t$this.job_group_array = res;\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.user_group_api.getUserGroup( '', false, false, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildTreeRecord( res );\n\t\t\t\t$this.user_group_array = res;\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.job_item_group_api.getJobItemGroup( '', false, false, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildTreeRecord( res );\n\t\t\t\t$this.job_item_group_array = res;\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.job_detail_report_api.getTemplate( 'view_job_detail', {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tres = res.getResult();\n\t\t\t\t$this.report_template = res;\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Invoice' ),\n\t\t\t\t\tid: ContextMenuIconName.job_invoice,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.invoice,\n\t\t\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'JobInvoice' ),\n\t\t\t\t\tpermission: null\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Import' ),\n\t\t\t\t\tid: ContextMenuIconName.import_icon,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.import_icon,\n\t\t\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ImportCSVJob' ),\n\t\t\t\t\tpermission: null,\n\t\t\t\t\tsort_order: 8000\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Report' ),\n\t\t\t\t\tid: ContextMenuIconName.print,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.print\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Map' ),\n\t\t\t\t\tid: ContextMenuIconName.map,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.map\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.import_icon:\n\t\t\t\tthis.onOtherIconsClick( 'ImportCSVWizard' );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.job_invoice:\n\t\t\t\tthis.onOtherIconsClick( 'JobInvoiceWizard' );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.print:\n\t\t\t\tthis.generatePDFReport();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonMapClick() {\n\t\t// only trigger map load in specific product editions.\n\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\tthis.is_viewing = false;\n\t\t\tProgressBar.showProgressBar();\n\t\t\tvar data = {\n\t\t\t\tfilter_columns: {\n\t\t\t\t\tid: true,\n\t\t\t\t\tname: true,\n\t\t\t\t\taddress1: true,\n\t\t\t\t\taddress2: true,\n\t\t\t\t\tcity: true,\n\t\t\t\t\tprovince: true,\n\t\t\t\t\tcountry: true,\n\t\t\t\t\tpostal_code: true,\n\t\t\t\t\tlatitude: true,\n\t\t\t\t\tlongitude: true\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar ids = this.getGridSelectIdArray();\n\t\t\tdata.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\t\tif ( ids.length > 0 ) {\n\t\t\t\tdata.filter_data.id = ids;\n\t\t\t}\n\t\t\tvar cells = this.api.getJob( data, { async: false } ).getResult();\n\t\t\tif ( !this.is_mass_editing ) {\n\t\t\t\timport( /* webpackChunkName: \"leaflet-timetrex\" */ '@/framework/leaflet/leaflet-timetrex' ).then(( module )=>{\n\t\t\t\t\tvar processed_data_for_map = module.TTConvertMapData.processBasicFromGenericViewController( cells );\n\t\t\t\t\tIndexViewController.openEditView( this, 'Map', processed_data_for_map );\n\t\t\t\t}).catch( Global.importErrorHandler );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectEmployee( full_item ) {\n\t\tvar user;\n\t\tif ( full_item ) {\n\t\t\tuser = LocalCacheData.getLoginUser();\n\t\t} else {\n\t\t\tuser = LocalCacheData.getLoginUser().id;\n\t\t}\n\n\t\treturn user;\n\t}\n\n\tgeneratePDFReport() {\n\n\t\tvar $this = this;\n\n\t\tvar grid_selected_id_array;\n\n\t\tvar include_job_ids = [];\n\n\t\tif ( $this.edit_view && $this.current_edit_record.id ) {\n\t\t\tinclude_job_ids.push( $this.current_edit_record.id );\n\t\t} else {\n\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t\tvar grid_selected_row = $this.getRecordFromGridById( value );\n\t\t\t\tinclude_job_ids.push( grid_selected_row.id );\n\t\t\t} );\n\t\t}\n\n\t\tif ( include_job_ids.length > 0 ) {\n\t\t\tif ( this.report_template ) {\n\t\t\t\tthis.report_template.include_job_id = include_job_ids;\n\t\t\t\tvar postData = [];\n\t\t\t\tpostData.push( this.report_template );\n\t\t\t\tpostData.push( 'pdf_job_detail' );\n\t\t\t\tthis.doFormIFrameCall( postData );\n\t\t\t}\n\t\t} else {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'No selected record' ) );\n\t\t\tProgressBar.closeOverlay();\n\t\t\treturn;\n\t\t}\n\t}\n\n\tdoFormIFrameCall( postData ) {\n\t\tGlobal.APIFileDownload( 'APIJobDetailReport', 'getJobDetailReport', postData );\n\t}\n\n\tremoveEditView() {\n\t\tsuper.removeEditView();\n\t\tthis.sub_job_item_amendment_view_controller = null;\n\t}\n\n\tonOtherIconsClick( wizard_id ) {\n\t\tvar $this = this;\n\t\tIndexViewController.openWizard( wizard_id, null, function() {\n\t\t\t$this.search();\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_job': { 'label': $.i18n._( 'Job' ) },\n\t\t\t'tab_location': { 'label': $.i18n._( 'Location' ) },\n\t\t\t'tab_employee_criteria': { 'label': $.i18n._( 'Employee Criteria' ) },\n\t\t\t'tab_task_criteria': { 'label': $.i18n._( 'Task Criteria' ) },\n\t\t\t'tab_task_amendments': {\n\t\t\t\t'label': $.i18n._( 'Task Amendments' ),\n\t\t\t\t'init_callback': 'initSubJobItemAmendmentView',\n\t\t\t\t'display_on_mass_edit': false\n\t\t\t},\n\t\t\t'tab_attachment': true,\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJob,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_job = this.edit_view_tab.find( '#tab_job' );\n\n\t\tvar tab_job_column1 = tab_job.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_job_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t//Status\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id' } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_job_column1, '' );\n\n//\t\t  Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_job_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_job_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Code\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'manual_id', width: 65 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Code' ), form_item_input, tab_job_column1 );\n\n\t\t//Group\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\ttree_mode: true,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_tree_column',\n\t\t\tset_empty: true,\n\t\t\tfield: 'group_id'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.job_group_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Group' ), form_item_input, tab_job_column1 );\n\n\t\t// Client\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIClient,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_client',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'client_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Client' ), form_item_input, tab_job_column1 );\n\n\t\t//Branch\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_branch',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'branch_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Branch' ), form_item_input, tab_job_column1 );\n\n\t\t//Department\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_department',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'department_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Department' ), form_item_input, tab_job_column1 );\n\n\t\t//Supervisor\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'supervisor_user_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Supervisor' ), form_item_input, tab_job_column1 );\n\n\t\t//Default Task\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job_item',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'default_item_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default Task' ), form_item_input, tab_job_column1 );\n\n\t\t//Allowed GEO Fences\n\t\tif ( Global.getProductEdition() >= 20 ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIGEOFence,\n\t\t\t\tallow_multiple_selection: true,\n\t\t\t\tlayout_name: 'global_geo_fence',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'geo_fence_ids'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Allowed GEO Fences' ), form_item_input, tab_job_column1 );\n\t\t}\n\n\t\t//Tags\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\n\t\tform_item_input.TTagInput( { field: 'tag', object_type_id: 600 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), form_item_input, tab_job_column1, '', null, null, true );\n\n\t\tvar tab_job_column2 = tab_job.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0].push( tab_job_column2 );\n\n\t\t//Start Date\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_job_column2 );\n\n\t\t//End Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_job_column2 );\n\n\t\t//Estimate Time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'estimate_time', mode: 'time_unit', need_parser_sec: true } );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\tvar note = $( '<span style=\\'margin-bottom: 5px; margin-top: 0; width: 300px; display: block;\\'>' + $.i18n._( 'Set estimates to 0 to use Task Billable Amounts instead.' ) + ' </span>' );\n\t\twidgetContainer.append( note );\n\t\twidgetContainer.append( form_item_input );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimate Time' ), form_item_input, tab_job_column2, '', widgetContainer, true, false );\n\n\t\t//Billable Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'billable_rate', width: 86 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Billable Rate' ), form_item_input, tab_job_column2 );\n\n\t\t//Minimum Time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'minimum_time', mode: 'time_unit', need_parser_sec: true } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Time' ), form_item_input, tab_job_column2, '', null );\n\n\t\t//Estimate Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'estimate_quantity', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimate Quantity' ), form_item_input, tab_job_column2 );\n\n\t\t//Estimate Bad Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'estimate_bad_quantity', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimate Bad Quantity' ), form_item_input, tab_job_column2 );\n\n\t\t//Bad Quantity Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'bad_quantity_rate', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Bad Quantity Rate' ), form_item_input, tab_job_column2 );\n\n\t\t//Note\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextArea( { field: 'note', width: '100%' } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Note' ), form_item_input, tab_job_column2, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Location\n\t\tvar tab_location = this.edit_view_tab.find( '#tab_location' );\n\t\tvar tab_location_column1 = tab_location.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[1] = [];\n\n\t\tthis.edit_view_tabs[1].push( tab_location_column1 );\n\n\t\t// Address1\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'address1', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Address (Line 1)' ), form_item_input, tab_location_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Address2\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'address2', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Address (Line 2)' ), form_item_input, tab_location_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// city\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'city', width: 149 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'City' ), form_item_input, tab_location_column1 );\n\n\t\t//Country\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'country', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Country' ), form_item_input, tab_location_column1 );\n\n\t\t//Province / State\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'province' } );\n\t\tform_item_input.setSourceData( [] );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Province/State' ), form_item_input, tab_location_column1 );\n\n\t\t//Postal/ZIP Code\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'postal_code', width: 149 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Postal/ZIP Code' ), form_item_input, tab_location_column1 );\n\n\t\t//Location Note\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextArea( { field: 'location_note', width: '100%' } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Location Note' ), form_item_input, tab_location_column1, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\tvar tab_employee_criteria = this.edit_view_tab.find( '#tab_employee_criteria' );\n\n\t\tvar tab_employee_criteria_column1 = tab_employee_criteria.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[2] = [];\n\n\t\tthis.edit_view_tabs[2].push( tab_employee_criteria_column1 );\n\n\t\t// Employee Criteria\n\t\tvar v_box = $( '<div class=\\'v-box\\'></div>' );\n\n\t\t//Selection Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'user_group_selection_type_id' } );\n\t\tform_item_input.setSourceData( $this.user_group_selection_type_array );\n\n\t\tvar form_item = this.putInputToInsideFormItem( form_item_input, $.i18n._( 'Selection Type' ) );\n\n\t\tv_box.append( form_item );\n\t\tv_box.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\t//Selection\n\t\tvar form_item_input_1 = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input_1.AComboBox( {\n\t\t\ttree_mode: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_tree_column',\n\t\t\tset_empty: true,\n\t\t\tfield: 'user_group_ids'\n\t\t} );\n\t\tform_item_input_1.setSourceData( $this.user_group_array );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input_1, $.i18n._( 'Selection' ) );\n\n\t\tv_box.append( form_item );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee Groups' ), [form_item_input, form_item_input_1], tab_employee_criteria_column1, '', v_box, false, true );\n\n\t\t//Branches\n\t\tv_box = $( '<div class=\\'v-box\\'></div>' );\n\t\t//Selection Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'user_branch_selection_type_id' } );\n\t\tform_item_input.setSourceData( $this.user_branch_selection_type_array );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input, $.i18n._( 'Selection Type' ) );\n\n\t\tv_box.append( form_item );\n\t\tv_box.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\t//Selection\n\t\tform_item_input_1 = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input_1.AComboBox( {\n\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_branch',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'user_branch_ids'\n\t\t} );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input_1, $.i18n._( 'Selection' ) );\n\n\t\tv_box.append( form_item );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Branches' ), [form_item_input, form_item_input_1], tab_employee_criteria_column1, '', v_box, false, true );\n\n\t\t// Departments\n\t\tv_box = $( '<div class=\\'v-box\\'></div>' );\n\t\t// Selection Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'user_department_selection_type_id' } );\n\t\tform_item_input.setSourceData( $this.user_department_selection_type_array );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input, $.i18n._( 'Selection Type' ) );\n\t\tv_box.append( form_item );\n\t\tv_box.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\t//Selection\n\t\tform_item_input_1 = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input_1.AComboBox( {\n\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_department',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'user_department_ids'\n\t\t} );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input_1, $.i18n._( 'Selection' ) );\n\n\t\tv_box.append( form_item );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Departments' ), [form_item_input, form_item_input_1], tab_employee_criteria_column1, '', v_box, false, true );\n\n\t\t// Include Employees\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'include_user_ids'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Include Employees' ), form_item_input, tab_employee_criteria_column1 );\n\n\t\t// Exclude Employees\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'exclude_user_ids'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Exclude Employees' ), form_item_input, tab_employee_criteria_column1, '' );\n\n\t\tvar tab_task_criteria = this.edit_view_tab.find( '#tab_task_criteria' );\n\n\t\tvar tab_task_criteria_column1 = tab_task_criteria.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[3] = [];\n\n\t\tthis.edit_view_tabs[3].push( tab_task_criteria_column1 );\n\n\t\t// Task Groups\n\t\tv_box = $( '<div class=\\'v-box\\'></div>' );\n\n\t\t//Selection Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'job_item_group_selection_type_id' } );\n\t\tform_item_input.setSourceData( $this.job_item_group_selection_type_array );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input, $.i18n._( 'Selection Type' ) );\n\n\t\tv_box.append( form_item );\n\t\tv_box.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\t//Selection\n\t\tform_item_input_1 = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input_1.AComboBox( {\n\t\t\ttree_mode: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_tree_column',\n\t\t\tset_empty: true,\n\t\t\tfield: 'job_item_group_ids'\n\t\t} );\n\t\tform_item_input_1.setSourceData( $this.job_item_group_array );\n\n\t\tform_item = this.putInputToInsideFormItem( form_item_input_1, $.i18n._( 'Selection' ) );\n\n\t\tv_box.append( form_item );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Task Groups' ), [form_item_input, form_item_input_1], tab_task_criteria_column1, '', v_box, false, true );\n\n\t\t// Include Tasks\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_job_item',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'include_job_item_ids'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Include Tasks' ), form_item_input, tab_task_criteria_column1 );\n\n\t\t// Exclude Tasks\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_job_item',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'exclude_job_item_ids'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Exclude Tasks' ), form_item_input, tab_task_criteria_column1, '' );\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Code' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'manual_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Description' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'description',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Supervisor' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'supervisor',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Tags' ),\n\t\t\t\tfield: 'tag',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 1,\n\t\t\t\tobject_type_id: 600,\n\t\t\t\tform_item_type: FormItemType.TAG_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Group' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tmultiple: true,\n\t\t\t\tfield: 'group_id',\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\ttree_mode: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Branch' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'branch_id',\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Department' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'department_id',\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Client' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'client_id',\n\t\t\t\tlayout_name: 'global_client',\n\t\t\t\tapi_class: TTAPI.APIClient,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tcheckTabPermissions( tab ) {\n\t\tvar retval = false;\n\n\t\tswitch ( tab ) {\n\t\t\tcase 'tab_task_amendments':\n\t\t\t\tif ( PermissionManager.validate( 'job_item', 'edit' ) || PermissionManager.validate( 'job_item', 'edit_child' ) || PermissionManager.validate( 'job_item', 'edit_own' ) ) {\n\t\t\t\t\tretval = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tretval = super.checkTabPermissions( tab );\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tinitSubJobItemAmendmentView() {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_job_item_amendment_view_controller ) {\n\t\t\tthis.sub_job_item_amendment_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_job_item_amendment_view_controller.setDefaultMenu();\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_key = 'job_id';\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_job_item_amendment_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/attendance/job_item_amendment/JobItemAmendmentViewController.js', function() {\n\t\t\tvar tab_employee_criteria = $this.edit_view_tab.find( '#tab_task_amendments' );\n\t\t\tvar firstColumn = tab_employee_criteria.find( '.first-column-sub-view' );\n\t\t\tGlobal.trackView( 'Sub' + 'JobItemAmendment' + 'View' );\n\t\t\tJobItemAmendmentViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_job_item_amendment_view_controller = subViewController;\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_key = 'job_id';\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_job_item_amendment_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_job_item_amendment_view_controller.initData();\n\t\t}\n\t}\n\n\tsetCurrentEditRecordData() {\n\n\t\t// When mass editing, these fields may not be the common data, so their value will be undefined, so this will cause their change event cannot work properly.\n\t\tthis.setDefaultData( {\n\t\t\t'user_branch_selection_type_id': 10,\n\t\t\t'user_department_selection_type_id': 10,\n\t\t\t'user_group_selection_type_id': 10,\n\t\t\t'job_item_group_selection_type_id': 10\n\t\t} );\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'country': //popular case\n\t\t\t\t\t\tif ( !this.current_edit_record[key] ) {\n\t\t\t\t\t\t\tthis.current_edit_record[key] = LocalCacheData.getCurrentCompany().country;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.eSetProvince( this.current_edit_record[key] );\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'province':\n\t\t\t\t\t\tif ( !this.current_edit_record[key] ) {\n\t\t\t\t\t\t\tthis.current_edit_record[key] = LocalCacheData.getCurrentCompany().province;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.onEmployeeGroupSelectionTypeChange();\n\t\tthis.onBranchSelectionTypeChange();\n\t\tthis.onDepartmentSelectionTypeChange();\n\t\tthis.isDisableIncludeEmployees();\n\t\tthis.onJobItemGroupSelectionTypeChange();\n\t\tthis.isDisableIncludeTasks();\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tswitch ( key ) {\n\t\t\tcase 'country':\n\t\t\t\tvar widget = this.edit_view_ui_dic['province'];\n\t\t\t\twidget.setValue( null );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tif ( key === 'country' ) {\n\t\t\tthis.onCountryChange();\n\t\t}\n\t\tif ( key === 'user_group_selection_type_id' ) {\n\t\t\tthis.onEmployeeGroupSelectionTypeChange();\n\t\t}\n\t\tif ( key === 'user_branch_selection_type_id' ) {\n\t\t\tthis.onBranchSelectionTypeChange();\n\t\t}\n\t\tif ( key === 'user_department_selection_type_id' ) {\n\t\t\tthis.onDepartmentSelectionTypeChange();\n\t\t}\n\t\tif ( key === 'job_item_group_selection_type_id' ) {\n\t\t\tthis.onJobItemGroupSelectionTypeChange();\n\t\t}\n\t\tthis.isDisableIncludeEmployees();\n\t\tthis.isDisableIncludeTasks();\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\t\t\t\t\t$this.e_province_array = Global.buildRecordArray( res );\n\t\t\t\t\tif ( refresh && $this.e_province_array.length > 0 ) {\n\t\t\t\t\t\t$this.current_edit_record.province = $this.e_province_array[0].value;\n\t\t\t\t\t\tprovince_widget.setValue( $this.current_edit_record.province );\n\t\t\t\t\t}\n\t\t\t\t\tprovince_widget.setSourceData( $this.e_province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tisDisableIncludeEmployees() {\n\t\tif ( this.edit_view_ui_dic['user_group_ids'].getEnabled() || this.edit_view_ui_dic['user_branch_ids'].getEnabled() || this.edit_view_ui_dic['user_department_ids'].getEnabled() ) {\n\t\t\tthis.edit_view_ui_dic['include_user_ids'].setEnabled( true );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic['include_user_ids'].setEnabled( false );\n\t\t}\n\t}\n\n\tisDisableIncludeTasks() {\n\t\tif ( this.edit_view_ui_dic['job_item_group_ids'].getEnabled() ) {\n\t\t\tthis.edit_view_ui_dic['include_job_item_ids'].setEnabled( true );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic['include_job_item_ids'].setEnabled( false );\n\t\t}\n\t}\n\n\tonEmployeeGroupSelectionTypeChange() {\n\t\tif ( this.current_edit_record['user_group_selection_type_id'] == 10 ) {\n\t\t\tthis.edit_view_ui_dic['user_group_ids'].setEnabled( false );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic['user_group_ids'].setEnabled( true );\n\t\t}\n\t}\n\n\tonBranchSelectionTypeChange() {\n\t\tif ( this.current_edit_record['user_branch_selection_type_id'] == 10 ) {\n\t\t\tthis.edit_view_ui_dic['user_branch_ids'].setEnabled( false );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic['user_branch_ids'].setEnabled( true );\n\t\t}\n\t}\n\n\tonDepartmentSelectionTypeChange() {\n\t\tif ( this.current_edit_record['user_department_selection_type_id'] == 10 ) {\n\t\t\tthis.edit_view_ui_dic['user_department_ids'].setEnabled( false );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic['user_department_ids'].setEnabled( true );\n\t\t}\n\t}\n\n\tonJobItemGroupSelectionTypeChange() {\n\t\tif ( this.current_edit_record['job_item_group_selection_type_id'] == 10 ) {\n\t\t\tthis.edit_view_ui_dic['job_item_group_ids'].setEnabled( false );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic['job_item_group_ids'].setEnabled( true );\n\t\t}\n\t}\n\n\tgetFilterColumnsFromDisplayColumns( column_filter, enable_system_columns ) {\n\t\tif ( column_filter == undefined ) {\n\t\t\tcolumn_filter = {};\n\t\t}\n\t\tcolumn_filter.latitude = true;\n\t\tcolumn_filter.longitude = true;\n\t\treturn this._getFilterColumnsFromDisplayColumns( column_filter, enable_system_columns );\n\t}\n\n}\n"],"sourceRoot":""}