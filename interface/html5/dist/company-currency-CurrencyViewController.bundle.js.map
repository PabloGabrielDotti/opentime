{"version":3,"sources":["webpack://timetrex/./interface/html5/views/company/currency/CurrencyViewController.js"],"names":["CurrencyViewController","BaseViewController","options","_","defaults","el","status_array","iso_codes_array","round_decimal_places_array","sub_currency_rate_view_controller","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APICurrency","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","$this","initDropDownOption","getISOCodesArray","onResult","res","getResult","Global","buildRecordArray","basic_search_field_ui_dic","setSourceData","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","form_item_input","widgetContainer","tab_currency_column1","edit_view_tab","find","edit_view_tabs","push","loadWidgetByName","FormItemType","COMBO_BOX","TComboBox","field","addEditFieldToColumn","TEXT_INPUT","TTextInput","width","parent","CHECKBOX","TCheckbox","conversion_rate_clarification_box","append","removeEditView","current_edit_record","setDefaultMenu","parent_key","parent_value","parent_edit_record","loadScript","firstColumn","trackView","LocalCacheData","current_doing_context_action","CurrencyRateViewController","loadSubView","beforeLoadView","afterLoadView","TTPromise","resolve","subViewController","parent_view_controller","buildSearchFields","search_fields","SearchField","label","in_column","multiple","basic_search","form_item_type","AWESOME_BOX","adv_search","APIUser","target","doNotValidate","getField","setConversionRateExampleText","getValue","edit_view_ui_dic","iso_code","onFormItemChange","editId","noRefreshUI","initEditView","conversion_rate"],"mappings":"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","file":"company-currency-CurrencyViewController.bundle.js?v=f0c3b4f7d08374812c6e","sourcesContent":["export class CurrencyViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#currency_view_container',\n\n\t\t\tstatus_array: null,\n\t\t\tiso_codes_array: null,\n\t\t\tround_decimal_places_array: null,\n\t\t\tsub_currency_rate_view_controller: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'CurrencyEditView.html';\n\t\tthis.permission_id = 'currency';\n\t\tthis.viewId = 'Currency';\n\t\tthis.script_name = 'CurrencyView';\n\t\tthis.table_name_key = 'currency';\n\t\tthis.context_menu_name = $.i18n._( 'Currencies' );\n\t\tthis.navigation_label = $.i18n._( 'Currency' ) + ':';\n\t\tthis.api = TTAPI.APICurrency;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary( 'Currency' );\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'round_decimal_places', 'round_decimal_places' );\n\t\tthis.api.getISOCodesArray( '', false, false, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tres = res.getResult();\n\t\t\t\tres = Global.buildRecordArray( res );\n\t\t\t\t$this.basic_search_field_ui_dic['iso_code'].setSourceData( res );\n\t\t\t\t$this.iso_codes_array = res;\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_currency': { 'label': $.i18n._( 'Currency' ) },\n\t\t\t'tab_rates': {\n\t\t\t\t'label': $.i18n._( 'Rates' ),\n\t\t\t\t'init_callback': 'initSubCurrencyRateView',\n\t\t\t\t'display_on_mass_edit': false\n\t\t\t},\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_currency = this.edit_view_tab.find( '#tab_currency' );\n\n\t\tvar tab_currency_column1 = tab_currency.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_currency_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\n\t\t//Status\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id' } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_currency_column1, '' );\n\n\t\t// ISO Currency\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'iso_code' } );\n\t\tform_item_input.setSourceData( $this.iso_codes_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'ISO Currency' ), form_item_input, tab_currency_column1 );\n\n\t\t//Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_currency_column1 );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Base Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'is_base' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Base Currency' ), form_item_input, tab_currency_column1 );\n\n\t\t// Conversion Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'conversion_rate', width: 114 } );\n\n\t\twidgetContainer = $( '<div class=\\'\\'></div>' );\n\t\tvar conversion_rate_clarification_box = $( '<span id=\\'conversion_rate_clarification_box\\'></span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( conversion_rate_clarification_box );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Conversion Rate' ), [form_item_input], tab_currency_column1, '', widgetContainer, false, true );\n\n\t\t// Default Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'is_default' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Default Currency' ), form_item_input, tab_currency_column1 );\n\n\t\t// Auto Update\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'auto_update' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Auto Update' ), form_item_input, tab_currency_column1 );\n\n\t\t// Decimal Places\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'round_decimal_places' } );\n\t\tform_item_input.setSourceData( $this.round_decimal_places_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Decimal Places' ), form_item_input, tab_currency_column1, '' );\n\t}\n\n\tremoveEditView() {\n\t\tsuper.removeEditView();\n\n\t\tthis.sub_currency_rate_view_controller = null;\n\t}\n\n\tinitSubCurrencyRateView() {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_currency_rate_view_controller ) {\n\t\t\tthis.sub_currency_rate_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_currency_rate_view_controller.setDefaultMenu();\n\t\t\t$this.sub_currency_rate_view_controller.parent_key = 'currency_id';\n\t\t\t$this.sub_currency_rate_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_currency_rate_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_currency_rate_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/company/currency/CurrencyRateViewController.js', function() {\n\t\t\tvar tab = $this.edit_view_tab.find( '#tab_rates' );\n\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\t\t\tGlobal.trackView( 'Sub' + 'CurrencyRate' + 'View', LocalCacheData.current_doing_context_action );\n\t\t\tCurrencyRateViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_currency_rate_view_controller = subViewController;\n\t\t\t$this.sub_currency_rate_view_controller.parent_key = 'currency_id';\n\t\t\t$this.sub_currency_rate_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_currency_rate_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_currency_rate_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_currency_rate_view_controller.initData();\n\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'ISO Currency' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'iso_code',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tif ( target.getField() == 'conversion_rate' ) {\n\t\t\tthis.setConversionRateExampleText( target.getValue(), this.edit_view_ui_dic.iso_code.getValue() );\n\t\t}\n\t\tsuper.onFormItemChange( target, doNotValidate );\n\t}\n\n\tinitEditView( editId, noRefreshUI ) {\n\t\tsuper.initEditView();\n\t\tthis.setConversionRateExampleText( this.edit_view_ui_dic.conversion_rate.getValue(), this.edit_view_ui_dic.iso_code.getValue() );\n\t}\n}\n"],"sourceRoot":""}