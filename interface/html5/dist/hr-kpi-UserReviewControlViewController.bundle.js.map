{"version":3,"sources":["webpack://timetrex/./interface/html5/views/hr/kpi/UserReviewControlViewController.js"],"names":["UserReviewControlViewController","BaseViewController","options","_","defaults","el","type_array","status_array","term_array","severity_array","kpi_group_array","document_object_type_id","kpi_group_api","user_review_api","kpi_api","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIUserReviewControl","APIKPIGroup","APIUserReview","APIKPI","render","sub_view_mode","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","groups","review","label","id","exclude","ContextMenuIconName","mass_edit","include","group","icon","Icons","print","$this","initDropDownOption","getKPIGroup","onResult","res","Global","clone","getResult","name","all","level","TTUUID","not_exist_id","hasOwnProperty","children","unshift","buildTreeRecord","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_review","edit_view_tab","find","tab_review_column1","tab_review_column2","tab_review_column4","edit_view_tabs","push","form_item_input","loadWidgetByName","FormItemType","AWESOME_BOX","APIUser","set_empty","field","default_args","setDefaultArgs","addEditFieldToColumn","COMBO_BOX","TComboBox","setSourceData","TEXT_INPUT","TTextInput","width","DATE_PICKER","TDatePicker","TAG_INPUT","TTagInput","object_type_id","is_add","is_edit","tree_mode","tab_review_column3","css","text","append","edit_view_ui_dic","getField","bind","e","target","doNotValidate","onFormItemChange","TEXT_AREA","TTextArea","height","inside_editor_div","args","serial","rating","note","editor","INSIDE_EDITOR","InsideEditor","addRow","insideEditorAddRow","removeRow","insideEditorRemoveRow","getValue","insideEditorGetValue","setValue","insideEditorSetValue","onInsideFormItemChange","parent_controller","render_args","row_render","widgets","column","firstOrLastRecord","widgetContainer","saveFormItemDiv","setResizeEvent","saveFormItemDivKey","hasKeyEvent","customLabelWidget","form_item","WidgetNamesDic","EDIT_VIEW_FORM_ITEM","form_item_label_div","form_item_label","form_item_input_div","parent","remove","widget","isArray","i","length","unbind","onFormItemKeyUp","onFormItemKeyDown","isSet","edit_view_form_item_dic","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type","removeEditView","setEditViewDataDone","initInsideEditorData","setIsChanged","setMassEditingFieldsWhenFormChange","key","c_value","filter","filter_data","group_id","key_name","setInsideEditorData","current_edit_record","validate","clearErrorStyle","minimum_rate","parseInt","attr","maximum_rate","setEditMenu","setErrorStyle","setErrorMenu","user_review_control_id","edit_view","data","initInsideEditorUI","row","is_existed","kpi_id","editor_data","item","getRowRender","getRender","TEXT","TText","eq","description","type_id","setWidgetEnableBaseOnParentController","CHECKBOX","TCheckbox","style","is_viewing","hide","rows_widgets_array","addIconsEvent","removeLastRowLine","result","isValid","result_data","refresh_id","isUUID","zero_id","saveInsideEditorData","search","onSaveDone","setErrorTips","editId","noRefreshUI","onEditClick","callBack","setUserReview","current_edit_item_id","len","LocalCacheData","current_doing_context_action","setTabStatus","is_changed","ProgressBar","closeOverlay","_continueDoCopyAsNew","onAddClick","onCopyAsNewClick","onRightArrowClick","onLeftArrowClick","searchDone","TTPromise","resolve","context_btn","grid_selected_length","pId","payStubReportIconsValidate","addClass","viewOwnerOrChildPermissionValidate","removeClass","postData","APIFileDownload","grid_selected_id_array","ids","getGridSelectIdArray","each","index","value","grid_selected_row","getRecordFromGridById","doFormIFrameCall","0","1","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","loadViewSource","template","html","wait","sub_user_review_control_view_controller"],"mappings":"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","file":"hr-kpi-UserReviewControlViewController.bundle.js?v=be2d9c508c381cc7b99c","sourcesContent":["export class UserReviewControlViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#user_review_control_view_container',\n\n\n\n\t\t\ttype_array: null,\n\t\t\tstatus_array: null,\n\t\t\tterm_array: null,\n\t\t\tseverity_array: null,\n\n\t\t\tkpi_group_array: null,\n\n\t\t\tdocument_object_type_id: null,\n\n\t\t\tkpi_group_api: null,\n\n\t\t\tuser_review_api: null,\n\n\t\t\tkpi_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'UserReviewControlEditView.html';\n\t\tthis.permission_id = 'user_review';\n\t\tthis.viewId = 'UserReviewControl';\n\t\tthis.script_name = 'UserReviewControlView';\n\t\tthis.table_name_key = 'user_review_control';\n\t\tthis.context_menu_name = $.i18n._( 'Reviews' );\n\t\tthis.navigation_label = $.i18n._( 'Review' ) + ':';\n\t\tthis.api = TTAPI.APIUserReviewControl;\n\t\tthis.kpi_group_api = TTAPI.APIKPIGroup;\n\t\tthis.user_review_api = TTAPI.APIUserReview;\n\t\tthis.kpi_api = TTAPI.APIKPI;\n\t\tthis.document_object_type_id = 220;\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t}\n\n\t\t//call init data in parent view\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.initData();\n\t\t}\n\n\t\tthis.setSelectRibbonMenuIfNecessary( 'UserReviewControl' );\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {\n\t\t\t\treview: {\n\t\t\t\t\tlabel: $.i18n._( 'Review' ),\n\t\t\t\t\tid: this.viewId + 'Review'\n\t\t\t\t}\n\t\t\t},\n\t\t\texclude: [ContextMenuIconName.mass_edit],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Print' ),\n\t\t\t\t\tid: 'pdf_review_print',\n\t\t\t\t\tgroup: 'review',\n\t\t\t\t\ticon: Icons.print,\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'type' );\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'term' );\n\t\tthis.initDropDownOption( 'severity' );\n\n\t\tthis.kpi_group_api.getKPIGroup( false, false, false, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tres = Global.clone( res.getResult() );\n\n\t\t\t\t//Error: Uncaught TypeError: Cannot set property 'name' of undefined in /interface/html5/#!m=Employee&a=edit&id=41499&tab=Reviews line 60\n\t\t\t\tif ( !res || !res[0] ) {\n\t\t\t\t\t$this.kpi_group_array = [];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tres[0].name = '-- ' + $.i18n._( 'Add KPIs' ) + ' --';\n\n\t\t\t\tvar all = {};\n\t\t\t\tall.name = '-- ' + $.i18n._( 'All' ) + ' --';\n\t\t\t\tall.level = 1;\n\t\t\t\tall.id = TTUUID.not_exist_id;\n\n\t\t\t\tif ( res.hasOwnProperty( '0' ) && res[0].hasOwnProperty( 'children' ) ) {\n\t\t\t\t\tres[0].children.unshift( all );\n\t\t\t\t} else {\n\t\t\t\t\tres = [\n\t\t\t\t\t\t{ children: [all], id: 0, level: 0, name: '-- ' + $.i18n._( 'Add KPIs' ) + ' --' }\n\t\t\t\t\t];\n\t\t\t\t}\n\n\t\t\t\tres = Global.buildTreeRecord( res );\n\n\t\t\t\t$this.kpi_group_array = res;\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_review': { 'label': $.i18n._( 'Review' ) },\n\t\t\t'tab_attachment': true,\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUserReviewControl,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_kpi_review_control',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_review = this.edit_view_tab.find( '#tab_review' );\n\n\t\tvar tab_review_column1 = tab_review.find( '.first-column' );\n\t\tvar tab_review_column2 = tab_review.find( '.second-column' );\n\t\tvar tab_review_column4 = tab_review.find( '.forth-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_review_column1 );\n\t\tthis.edit_view_tabs[0].push( tab_review_column2 );\n\n\t\t// Employee\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'user_id'\n\t\t} );\n\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'user_review';\n\t\tform_item_input.setDefaultArgs( default_args );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_review_column1, '' );\n\n\t\t// Reviewer\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'reviewer_user_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Reviewer' ), form_item_input, tab_review_column1 );\n\n\t\t// Status\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'status_id' } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_review_column1 );\n\n\t\t// Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'type_id' } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_review_column1 );\n\n\t\t// Terms\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'term_id' } );\n\t\tform_item_input.setSourceData( $this.term_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Terms' ), form_item_input, tab_review_column1 );\n\n\t\t// Rating\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'rating', width: 50 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Rating' ), form_item_input, tab_review_column1, '' );\n\n\t\t// Severity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'severity_id' } );\n\t\tform_item_input.setSourceData( $this.severity_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Severity' ), form_item_input, tab_review_column2, '' );\n\n\t\t// Start Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_review_column2, '', null );\n\n\t\t// End Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_review_column2, '', null );\n\n\t\t// Due Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'due_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Due Date' ), form_item_input, tab_review_column2, '', null );\n\n\t\t//Tags\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\n\t\tform_item_input.TTagInput( { field: 'tag', object_type_id: 320 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), form_item_input, tab_review_column2, '', null, null, true );\n\n\t\tif ( this.is_add || this.is_edit ) {\n\t\t\t// Add KPIs from Groups\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\ttree_mode: true,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'group_id'\n\t\t\t} );\n\t\t\tform_item_input.setSourceData( $this.kpi_group_array );\n\n\t\t\tvar tab_review_column3 = tab_review.find( '.third-column' ).css( {\n\t\t\t\t'float': 'left',\n\t\t\t\t'margin-top': '10px',\n\t\t\t\t'margin-bottom': '10px'\n\t\t\t} );\n\t\t\ttab_review_column3.find( '.column-form-item-label' ).css( {\n\t\t\t\t'float': 'left',\n\t\t\t\t'margin-right': '10px',\n\t\t\t\t'margin-top': '5px'\n\t\t\t} ).text( $.i18n._( 'Add KPIs from Groups' ) );\n\t\t\ttab_review_column3.find( '.column-form-item-input' ).css( { 'float': 'left' } ).append( form_item_input );\n\n\t\t\tthis.edit_view_ui_dic[form_item_input.getField()] = form_item_input;\n\n\t\t\tform_item_input.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t} );\n\t\t}\n\n\t\t// Note\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextArea( { field: 'note', width: '100%', height: 66 } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Note' ), form_item_input, tab_review_column4, 'first_last', null, null, true );\n\t}\n\n\tinitInsideEditorUI() {\n\t\t//Inside editor\n\t\tvar tab_review = this.edit_view_tab.find( '#tab_review' );\n\n\t\tvar inside_editor_div = tab_review.find( '.inside-editor-div' );\n\n\t\tvar args = {\n\t\t\tserial: '#',\n\t\t\tname: $.i18n._( 'Key Performance Indicator' ) + '<br>(' + $.i18n._('Hover for Description') + ')',\n\t\t\trating: $.i18n._( 'Result' ),\n\t\t\tnote: $.i18n._( 'Note' )\n\t\t};\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\tthis.editor.InsideEditor( {\n\t\t\taddRow: this.insideEditorAddRow,\n\t\t\tremoveRow: this.insideEditorRemoveRow,\n\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\tonFormItemChange: this.onInsideFormItemChange,\n\t\t\tparent_controller: this,\n\t\t\tapi: this.user_review_api,\n\t\t\trender: 'views/hr/kpi/UserReviewViewInsideEditorRender.html',\n\t\t\trender_args: args,\n\t\t\trow_render: 'views/hr/kpi/UserReviewViewInsideEditorRow.html'\n\n\t\t} );\n\n\t\tinside_editor_div.append( this.editor );\n\t}\n\n\t/* jshint ignore:start */\n\n\taddEditFieldToColumn( label, widgets, column, firstOrLastRecord, widgetContainer, saveFormItemDiv, setResizeEvent, saveFormItemDivKey, hasKeyEvent, customLabelWidget ) {\n\n\t\tvar $this = this;\n\t\tvar form_item = $( Global.loadWidgetByName( WidgetNamesDic.EDIT_VIEW_FORM_ITEM ) );\n\t\tvar form_item_label_div = form_item.find( '.edit-view-form-item-label-div' );\n\t\tvar form_item_label = form_item.find( '.edit-view-form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.edit-view-form-item-input-div' );\n\n\t\tif ( customLabelWidget ) {\n\t\t\tform_item_label.parent().append( customLabelWidget );\n\t\t\tform_item_label.remove();\n\t\t} else {\n\t\t\tform_item_label.text( $.i18n._( label ) + ': ' );\n\t\t}\n\n\t\tvar widget = widgets;\n\n\t\tif ( Global.isArray( widgets ) ) {\n\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\twidget.css( 'opacity', 0 );\n\n\t\t\t\tthis.edit_view_ui_dic[widget.getField()] = widget;\n\n\t\t\t\twidget.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t\t} );\n\n\t\t\t\tif ( hasKeyEvent ) {\n\t\t\t\t\twidget.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t\t} );\n\n\t\t\t\t\twidget.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\n\t\t\twidget.css( 'opacity', 0 );\n\n\t\t\tthis.edit_view_ui_dic[widget.getField()] = widget;\n\n\t\t\twidget.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t} );\n\n\t\t\tif ( hasKeyEvent ) {\n\t\t\t\twidget.bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\twidget.bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Global.isSet( widgetContainer ) ) {\n\t\t\tform_item_input_div.append( widgetContainer );\n\n\t\t} else {\n\t\t\tform_item_input_div.append( widget );\n\t\t}\n\n\t\tif ( setResizeEvent ) {\n\n\t\t\tif ( widget.getField() === 'note' ) {\n\n\t\t\t\tform_item_input_div.css( 'width', '80%' );\n\t\t\t\tform_item_label_div.css( 'height', '80' );\n\t\t\t\twidget.css( { 'width': '100%', 'resize': 'none' } );\n\n\t\t\t} else {\n\n\t\t\t\tform_item.bind( 'resize', function() {\n\n\t\t\t\t\tif ( form_item_label_div.height() !== form_item.height() && form_item.height() !== 0 ) {\n\t\t\t\t\t\tform_item_label_div.css( 'height', form_item.height() );\n\t\t\t\t\t\tform_item.unbind( 'resize' );\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\twidget.bind( 'setSize', function() {\n\t\t\t\t\tform_item_label_div.css( 'height', widget.height() + 5 );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\n\t\tif ( saveFormItemDiv ) {\n\n\t\t\tif ( Global.isArray( widgets ) ) {\n\t\t\t\tthis.edit_view_form_item_dic[widgets[0].getField()] = form_item;\n\t\t\t} else {\n\t\t\t\tthis.edit_view_form_item_dic[widget.getField()] = form_item;\n\t\t\t}\n\n\t\t}\n\n\t\tcolumn.append( form_item );\n\t\t//column.append( \"<div class='clear-both-div'></div>\" );\n\t}\n\n\t/* jshint ignore:end */\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\n\t\tvar default_args = {};\n\t\tdefault_args.permission_section = 'user_review';\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tdefault_args: default_args,\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Reviewer' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'reviewer_user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Tags' ),\n\t\t\t\tfield: 'tag',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 1,\n\t\t\t\tobject_type_id: 320,\n\t\t\t\tform_item_type: FormItemType.TAG_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Terms' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'term_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Severity' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'severity_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Start Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'start_date',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'End Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'end_date',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Due Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'due_date',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'KPI' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'kpi_id',\n\t\t\t\tlayout_name: 'global_kpi',\n\t\t\t\tapi_class: TTAPI.APIKPI,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tremoveEditView() {\n\t\tsuper.removeEditView();\n\t\tthis.editor = null;\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.initInsideEditorData();\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tswitch ( key ) {\n\t\t\tcase 'group_id':\n\t\t\t\tvar filter = {};\n\t\t\t\tfilter.filter_data = {};\n\t\t\t\t// why need [c_value, -1], -1 will return all, the filter won't work correct if send -1,remove for testting\n\t\t\t\tfilter.filter_data.group_id = [c_value];\n\t\t\t\tthis.kpi_api['get' + this.kpi_api.key_name]( filter, false, true, {\n\t\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t\t$this.setInsideEditorData( res );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.current_edit_record[key] = c_value;\n\t\t\t\tif ( !doNotValidate ) {\n\t\t\t\t\tthis.validate();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonInsideFormItemChange( target, doNotValidate ) {\n\t\ttarget.clearErrorStyle();\n\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tswitch ( key ) {\n\t\t\tcase 'rating':\n\t\t\t\tvar minimum_rate = parseInt( target.attr( 'minimum_rate' ) );\n\t\t\t\tvar maximum_rate = parseInt( target.attr( 'maximum_rate' ) );\n\t\t\t\tif ( c_value !== '' ) {\n\t\t\t\t\tc_value = parseInt( c_value );\n\t\t\t\t\tif ( c_value >= minimum_rate && c_value <= maximum_rate ) {\n\t\t\t\t\t\ttarget.clearErrorStyle();\n\t\t\t\t\t\tthis.parent_controller.setEditMenu();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget.setErrorStyle( $.i18n._( 'Rating must between' ) + ' ' + minimum_rate + ' ' + $.i18n._( 'and' ) + ' ' + maximum_rate, true );\n\t\t\t\t\t\tthis.parent_controller.setErrorMenu();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tinitInsideEditorData() {\n\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\n\t\tif ( this.current_edit_record.id ) {\n\n\t\t\targs.filter_data.user_review_control_id = this.current_edit_record['id'];\n\n\t\t\t$this.user_review_api['get' + $this.user_review_api.key_name]( args, true, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t$this.setInsideEditorData( res );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t/* jshint ignore:start */\n\n\tsetInsideEditorData( res ) {\n\t\tvar data = res.getResult();\n\t\tvar len = data.length;\n\n\t\tif ( len > 0 ) {\n\n\t\t\tif ( !this.editor ) {\n\t\t\t\tthis.initInsideEditorUI();\n\t\t\t}\n\n\t\t\tvar serial = 1;\n\t\t\tfor ( var key in data ) {\n\t\t\t\tvar row = data[key];\n\t\t\t\tvar is_existed = false;\n\t\t\t\tif ( !row.kpi_id ) {\n\t\t\t\t\trow.kpi_id = row.id;\n\t\t\t\t\trow.id = false;\n\t\t\t\t}\n\t\t\t\t// the row.kpi_id if existed in this.editor.editor_data?\n\t\t\t\tif ( this.editor.editor_data ) {\n\n\t\t\t\t\tfor ( var i = 0; i < this.editor.editor_data.length; i++ ) {\n\t\t\t\t\t\tvar item = this.editor.editor_data[i];\n\t\t\t\t\t\tif ( row.kpi_id === item.kpi_id ) {\n\t\t\t\t\t\t\tis_existed = true; // the current row has already displayed.\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !is_existed ) {\n\t\t\t\t\t\tserial = this.editor.editor_data.length + 1;\n\t\t\t\t\t\trow.serial = serial;\n\t\t\t\t\t\tthis.editor.editor_data.push( row );\n\t\t\t\t\t}\n\n//\t\t\t\t\tserial++;\n\n\t\t\t\t} else {\n\t\t\t\t\trow.serial = serial;\n\t\t\t\t\tdata[key] = row;\n\t\t\t\t\tserial++;\n\t\t\t\t}\n\n\t\t\t\tif ( !is_existed ) {\n\t\t\t\t\tthis.editor.addRow( row );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( !this.editor.editor_data ) {\n\t\t\t\tthis.editor.editor_data = data;\n\t\t\t}\n\n\t\t}\n\n//\t\t$this.editor.setValue( data );\n\t}\n\n\t/* jshint ignore:end */\n\n//\tinsideEditorSetValue( val ) {\n//\t\tvar len = val.length;\n//\t\tthis.removeAllRows();\n//\n//\t\tif ( len > 0 ) {\n//\t\t\tvar serial = 1;\n//\t\t\tfor ( var i = 0; i < val.length; i++ ) {\n//\t\t\t\tif ( Global.isSet( val[i] ) ) {\n//\t\t\t\t\tvar row = val[i];\n//\t\t\t\t\trow.serial = serial;\n//\t\t\t\t\tthis.addRow( row );\n//\t\t\t\t\tserial++;\n//\t\t\t\t}\n//\t\t\t}\n//\t\t}\n//\n//\t},\n\n\tinsideEditorAddRow( data ) {\n\t\tvar $this = this;\n\t\tif ( !data ) {\n//\t\t\tthis.getDefaultData();\n\t\t} else {\n\t\t\tvar row = this.getRowRender(); //Get Row render\n\t\t\tvar render = this.getRender(); //get render, should be a table\n\t\t\tvar widgets = data; //Save each row's widgets\n\n\t\t\t//Build row widgets\n\n\t\t\t// #\n\t\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'serial', width: 50 } );\n\t\t\tform_item_input.setValue( data.serial ? data.serial : null );\n//\t\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\t\trow.children().eq( 0 ).append( form_item_input );\n\n\t\t\t// Key Performance Indicator\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'name', width: 600 } );\n\t\t\tform_item_input.setValue( data.name ? data.name : null );\n\t\t\tform_item_input.attr( 'title', data.description ? data.description : '' );\n\n\t\t\trow.children().eq( 1 ).append( form_item_input );\n\n\t\t\t// Rating\n\t\t\tif ( data.type_id == 10 ) {\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_input.TTextInput( { field: 'rating', width: 40 } );\n\t\t\t\tform_item_input.setValue( data.rating ? data.rating : null );\n\t\t\t\tform_item_input.attr( { 'minimum_rate': data.minimum_rate, 'maximum_rate': data.maximum_rate } );\n\t\t\t\tform_item_input.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t\t} );\n\t\t\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\t\t\trow.children().eq( 2 ).append( form_item_input );\n\n\t\t\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t\t} else if ( data.type_id == 20 ) {\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\t\tform_item_input.TCheckbox( { field: 'rating' } );\n\t\t\t\tform_item_input.setValue( data.rating ? ( data.rating >= 1 ? true : false ) : null ); //Rating is numeric, so make sure we pass true/false to TCheckbox.\n\t\t\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\t\t\trow.children().eq( 2 ).append( form_item_input );\n\n\t\t\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\t\t\t}\n\n\t\t\t// Note\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\t\tform_item_input.TTextArea( {\n\t\t\t\tfield: 'note',\n\t\t\t\tstyle: { width: '300px', height: '20px', 'min-height': '10px' }\n\t\t\t} );\n\t\t\tform_item_input.setValue( data.note ? data.note : null );\n\t\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\t\trow.children().eq( 3 ).css( 'text-align', 'right' ).append( form_item_input );\n\t\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t\t// end\n\n\t\t\t$( render ).append( row );\n\n\t\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\t\trow.find( '.control-icon' ).hide();\n\t\t\t}\n\n\t\t\tthis.rows_widgets_array.push( widgets );\n\n\t\t\tthis.addIconsEvent( row ); //Bind event to add and minus icon\n\t\t\tthis.removeLastRowLine();\n\t\t}\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onSaveDone( result );\n\n\t\t\t\t$this.removeEditView();\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\t// onSaveAndContinueResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onEditClick( $this.refresh_id, true );\n\t//\n\t// \t\t\t$this.onSaveAndContinueDone( result );\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tonEditClick( editId, noRefreshUI ) {\n\t\tvar $this = this;\n\t\tif ( $this.editor ) {\n\t\t\t$this.editor.remove();\n\t\t\t$this.editor = null;\n\t\t}\n\n\t\tsuper.onEditClick( editId, noRefreshUI );\n\t}\n\n\tsaveInsideEditorData( callBack ) {\n\t\tvar $this = this;\n\n\t\tif ( !this.editor ) {\n\t\t\tcallBack();\n\t\t} else {\n\t\t\tvar data = this.editor.getValue( this.refresh_id );\n\t\t\tthis.user_review_api.setUserReview( data, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tinsideEditorGetValue( current_edit_item_id ) {\n\t\tvar len = this.rows_widgets_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tif ( row.rating ) {\n\t\t\t\trow.rating = row.rating.getValue();\n\t\t\t}\n\t\t\trow.note = row.note.getValue();\n\n\t\t\trow.user_review_control_id = current_edit_item_id;\n\n\t\t\tthis.rows_widgets_array[i] = row;\n\t\t}\n\n\t\treturn this.rows_widgets_array;\n\t}\n\n\t_continueDoCopyAsNew() {\n\n\t\tvar $this = this;\n\t\tthis.is_add = true;\n\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\n\t\t\tthis.current_edit_record.id = '';\n\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\t\t\tnavigation_div.css( 'display', 'none' );\n\t\t\tif ( this.editor ) {\n\t\t\t\tthis.editor.remove();\n\t\t\t\tthis.editor = null;\n\t\t\t}\n\t\t\tthis.setEditMenu();\n\t\t\tthis.setTabStatus();\n\t\t\tthis.is_changed = false;\n\t\t\tProgressBar.closeOverlay();\n\n\t\t} else {\n\t\t\tsuper._continueDoCopyAsNew();\n\t\t}\n\t}\n\n\tonSaveAndNewResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\tif ( $this.editor ) {\n\t\t\t\t\t$this.editor.remove();\n\t\t\t\t\t$this.editor = null;\n\t\t\t\t}\n\t\t\t\t$this.onAddClick( true );\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\tif ( $this.editor ) {\n\t\t\t\t\t$this.editor.remove();\n\t\t\t\t\t$this.editor = null;\n\t\t\t\t}\n\t\t\t\t$this.onCopyAsNewClick();\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndNextResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.onRightArrowClick();\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onSaveAndNextDone( result );\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tonRightArrowClick() {\n\t\tif ( this.editor ) {\n\t\t\tthis.editor.remove();\n\t\t\tthis.editor = null;\n\t\t}\n\t\tsuper.onRightArrowClick();\n\t}\n\n\tonLeftArrowClick() {\n\t\tif ( this.editor ) {\n\t\t\tthis.editor.remove();\n\t\t\tthis.editor = null;\n\t\t}\n\t\tsuper.onLeftArrowClick();\n\t}\n\n\tsearchDone() {\n\t\tsuper.searchDone();\n\t\tTTPromise.resolve( 'ReviewView', 'init' );\n\t}\n\n\tsetDefaultMenuReportRelatedIcons( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.payStubReportIconsValidate() ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length > 0 && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetCustomDefaultMenuIcon( id, context_btn, grid_selected_length ) {\n\t\tswitch ( id ) {\n\t\t\tcase 'pdf_review_print':\n\t\t\t\tif ( grid_selected_length > 0 && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t\t} else {\n\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tdoFormIFrameCall( postData ) {\n\t\tGlobal.APIFileDownload( 'APIKPIReport', 'getKPIReport', postData );\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tvar $this = this;\n\n\t\tswitch ( id ) {\n\t\t\tcase 'pdf_review_print':\n\t\t\t\tvar grid_selected_id_array;\n\n\t\t\t\tvar ids = [];\n\t\t\t\tif ( $this.edit_view && $this.current_edit_record.id ) {\n\t\t\t\t\tids.push( $this.current_edit_record.id );\n\t\t\t\t} else {\n\t\t\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t\t\t\tvar grid_selected_row = $this.getRecordFromGridById( value );\n\t\t\t\t\t\tids.push( grid_selected_row.id );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\tthis.doFormIFrameCall( { 0: { 'user_review_control_id': ids }, 1: 'pdf_review_print' } );\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nUserReviewControlViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\tGlobal.loadViewSource( 'UserReviewControl', 'SubUserReviewControlView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_user_review_control_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n};"],"sourceRoot":""}