{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/inside_editor/InsideEditor.js"],"names":["$","jQuery","fn","InsideEditor","options","Global","addCss","row_render","render","opts","extend","defaults","$this","this","rows_widgets_array","delete_ids","addRow","setValue","getValue","removeRow","updateAllRows","editor_data","onFormItemChange","parent_controller","api","val","length","getRender","getRowRender","clone","clearErrorStyle","getField","setTitle","children","eq","text","removeLastRowLine","table","find","trs","removeClass","addClass","removeAllRows","include_header","each","remove","setWidgetEnableBaseOnParentController","form_item_input","is_viewing","setEnabled","addIconsEvent","row","plus_icon","minus_icon","click","parents","index","getDefaultData","isSet","key_name","onResult","result","result_data","getResult","id","o","meta","data","title","loadWidget","args","render_args","template","_","render_div","append","bind","e","target","setIsChanged"],"mappings":"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","file":"inside_editor-InsideEditor.bundle.js?v=aaa5e90e38282a068c30","sourcesContent":["( function( $ ) {\n\n\t$.fn.InsideEditor = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/inside_editor/InsideEditor.css' );\n\t\tvar opts = $.extend( {}, $.fn.InsideEditor.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar row_render;\n\t\tvar render;\n\n\t\tthis.rows_widgets_array = null;\n\t\tthis.delete_ids = null;\n\t\tthis.addRow = null;\n\t\tthis.setValue = null;\n\t\tthis.getValue = null; // set outside\n\t\tthis.removeRow = null;\n\t\tthis.updateAllRows = null;\n\t\tthis.editor_data = null;\n\t\tthis.onFormItemChange = null;\n\n\t\tthis.parent_controller = null;\n//\t\tthis.parent_id = null;\n\n\t\tthis.api = null;\n\n\t\tthis.setValue = function( val ) {\n\t\t\tif ( val && val.length > 0 ) {\n\t\t\t\tthis.setValue( val );\n\t\t\t} else {\n\t\t\t\tthis.addRow();\n\t\t\t}\n\t\t};\n\n\t\tthis.getRender = function() {\n\t\t\treturn render;\n\t\t};\n\n\t\tthis.getRowRender = function() {\n\t\t\treturn row_render.clone();\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.setTitle = function( val ) {\n\t\t\tvar title = $this.children().eq( 0 );\n\n\t\t\ttitle.text( val );\n\n\t\t};\n\n\t\tthis.removeLastRowLine = function() {\n\t\t\tvar table = this.find( '.inside-editor-render' );\n\t\t\tvar trs = table.find( 'tr' );\n\t\t\ttable.find( 'td' ).removeClass( 'no-line' );\n\n\t\t\tvar last_tr = trs.eq( trs.length - 1 );\n\n\t\t\tlast_tr.find( 'td' ).addClass( 'no-line' );\n\t\t};\n\n\t\tthis.removeAllRows = function( include_header ) {\n\t\t\tvar table = this.find( '.inside-editor-render' );\n\t\t\tvar trs = table.find( 'tr' );\n\t\t\tif ( include_header ) {\n\n\t\t\t\ttable.find( 'tr' ).each( function() {\n\t\t\t\t\t$( this ).remove();\n\t\t\t\t} );\n\n\t\t\t} else {\n\t\t\t\ttable.find( 'tr.inside-editor-row' ).remove();\n\t\t\t}\n\n\t\t\tthis.rows_widgets_array = [];\n\t\t};\n\n\t\tthis.setWidgetEnableBaseOnParentController = function( form_item_input ) {\n\t\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\t\tform_item_input.setEnabled( false );\n\t\t\t} else {\n\t\t\t\tform_item_input.setEnabled( true );\n\t\t\t}\n\t\t};\n\n\t\tthis.addIconsEvent = function( row ) {\n\t\t\tvar plus_icon = row.find( '.plus-icon' );\n\t\t\tvar minus_icon = row.find( '.minus-icon' );\n\n\t\t\tplus_icon.click( function() {\n\t\t\t\t$this.addRow( null, $( this ).parents( 'tr' ).index(), row );\n\t\t\t} );\n\n\t\t\tminus_icon.click( function() {\n\t\t\t\t$this.removeRow( row );\n\n\t\t\t\tif ( render.find( 'tr' ).length === 1 ) {\n\t\t\t\t\t$this.addRow();\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t};\n\n\t\tthis.getDefaultData = function( index ) {\n\n\t\t\tif ( Global.isSet( this.api ) ) {\n\t\t\t\tthis.api['get' + this.api.key_name + 'DefaultData']( {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\t\tresult_data.id = false;\n\n\t\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.addRow( result_data, index );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\t\t\tif ( o.title ) {\n\t\t\t\t$this.setTitle( o.title );\n\t\t\t}\n\t\t\tif ( o.onFormItemChange ) {\n\t\t\t\t$this.onFormItemChange = o.onFormItemChange;\n\t\t\t}\n\t\t\t$this.rows_widgets_array = [];\n\t\t\t$this.delete_ids = [];\n\t\t\t$this.addRow = o.addRow;\n\t\t\t$this.removeRow = o.removeRow;\n\t\t\t$this.getValue = o.getValue;\n\t\t\t$this.setValue = o.setValue;\n\t\t\t$this.parent_controller = o.parent_controller;\n\t\t\t$this.api = o.api;\n\t\t\t$this.updateAllRows = o.updateAllRows;\n\t\t\trender = Global.loadWidget( o.render );\n\t\t\trow_render = $( Global.loadWidget( o.row_render ) );\n\t\t\tvar args = o.render_args;\n\t\t\tvar template = _.template( render );\n\t\t\tvar render_div = $this.children().eq( 1 );\n\t\t\trender_div.append( template( args ) );\n\t\t\trender = $( render_div.find( '.inside-editor-render' ) );\n\n\t\t} );\n\n\t\t// Sets data as modified when a widget triggers onFormItemChange.\n\t\t// Some inside editor widgets bind their own formItemChange and to prevent unintended interactions we only set data changed.\n\t\t$this.bind( 'formItemChange', function( e, target ) {\n\t\t\t// Fix issue #2885: Error: Uncaught TypeError: o.parent_controller.setIsChanged is not a function.\n\t\t\t// This was happening in TimeSheet -> New Punch and opening the inside editor for dates and changing a date.\n\t\t\tif ( typeof $this.parent_controller.setIsChanged === 'function' ) {\n\t\t\t\t$this.parent_controller.setIsChanged( target );\n\t\t\t}\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.InsideEditor.defaults = {};\n\n} )( jQuery );"],"sourceRoot":""}