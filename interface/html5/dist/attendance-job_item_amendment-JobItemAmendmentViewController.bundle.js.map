{"version":3,"sources":["webpack://timetrex/./interface/html5/views/attendance/job_item_amendment/JobItemAmendmentViewController.js"],"names":["JobItemAmendmentViewController","BaseViewController","options","_","defaults","el","current_default_record","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIJobItemAmendment","job_api","APIJob","job_item_api","APIJobItem","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","exclude","ContextMenuIconName","copy","include","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","form_item_input","widgetContainer","tab_task_amendment_column1","edit_view_tab","find","edit_view_tabs","push","Global","loadWidgetByName","FormItemType","AWESOME_BOX","set_empty","setRealValueCallBack","val","job_coder","setValue","manual_id","field","TEXT_INPUT","TTextInput","disable_keyup_event","addClass","append","addEditFieldToColumn","job_item_coder","mode","need_parser_sec","width","key","isFalseOrNull","current_edit_record","LocalCacheData","getLoginUser","widget","edit_view_ui_dic","isSet","args","filter_data","job_id","setDefaultArgs","collectUIDataToCurrentEditRecord","setEditViewDataDone","target","doNotValidate","$this","setIsChanged","setMassEditingFieldsWhenFormChange","getField","c_value","getValue","setJobItemValueWhenJobChanged","setCheckBox","setJobItemAmendmentDefaultData","onJobQuickSearch","TTPromise","wait","validate","record","is_mass_editing","sub_view_mode","parent_key","parent_value","hasOwnProperty","isChecked","getEnabled","uniformVariable","key_name","onResult","result","validateResult","job_item_id","TTUUID","isUUID","item_id","zero_id","is_add","result_data","getResult","setCurrentEditRecordData","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","loadViewSource","template","html","sub_job_item_amendment_view_controller"],"mappings":"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","file":"attendance-job_item_amendment-JobItemAmendmentViewController.bundle.js?v=c85ec86bcfa52ee6a3ad","sourcesContent":["export class JobItemAmendmentViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#job_item_amendment_view_container',\n\n\n\t\t\tcurrent_default_record: {}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'JobItemAmendmentEditView.html';\n\t\tthis.permission_id = 'job_item';\n\t\tthis.viewId = 'JobItemAmendment';\n\t\tthis.script_name = 'JobItemAmendmentView';\n\t\tthis.table_name_key = 'job_item_amendment';\n\t\tthis.context_menu_name = $.i18n._( 'Task Amendments' );\n\t\tthis.navigation_label = $.i18n._( 'Task Amendment' ) + ':';\n\n\t\tthis.api = TTAPI.APIJobItemAmendment;\n\n\t\tthis.job_api = TTAPI.APIJob;\n\t\tthis.job_item_api = TTAPI.APIJobItem;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary( 'JobItemAmendment' );\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [ContextMenuIconName.copy],\n\t\t\tinclude: []\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_task_amendment': { 'label': $.i18n._( 'Task Amendment' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItemAmendment,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job_item_amendment',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_task_amendment = this.edit_view_tab.find( '#tab_task_amendment' );\n\n\t\tvar tab_task_amendment_column1 = tab_task_amendment.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_task_amendment_column1 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t//Job\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJob,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: false,\n\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\tif ( val ) {\n\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t}\n\t\t\t} ),\n\t\t\tfield: 'job_id'\n\t\t} );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\tjob_coder.addClass( 'job-coder' );\n\n\t\twidgetContainer.append( job_coder );\n\t\twidgetContainer.append( form_item_input );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_task_amendment_column1, '', widgetContainer );\n\n\t\t// Task\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_job_item',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\tif ( val ) {\n\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t}\n\t\t\t} ),\n\t\t\tfield: 'item_id'\n\t\t} );\n\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\twidgetContainer.append( job_item_coder );\n\t\twidgetContainer.append( form_item_input );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_task_amendment_column1, '', widgetContainer );\n\n\t\t//Estimated Time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'estimate_time', mode: 'time_unit', need_parser_sec: true } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimated Time' ), form_item_input, tab_task_amendment_column1, '', null, true, true );\n\n\t\t//Billable Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'billable_rate', width: 86 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Billable Rate' ), form_item_input, tab_task_amendment_column1 );\n\n\t\t//Minimum Time\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'minimum_time', mode: 'time_unit', need_parser_sec: true } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Billable Time' ), form_item_input, tab_task_amendment_column1, '', null );\n\n\t\t//Estimated Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'estimate_quantity', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimated Quantity' ), form_item_input, tab_task_amendment_column1 );\n\n\t\t//Estimated Bad Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'estimate_bad_quantity', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Estimated Bad Quantity' ), form_item_input, tab_task_amendment_column1 );\n\n\t\t//Bad Quantity Rate\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'bad_quantity_rate', width: 150 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Bad Quantity Rate' ), form_item_input, tab_task_amendment_column1 );\n\t}\n\n\t/* jshint ignore:start */\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\n\t\tif ( Global.isFalseOrNull( this.current_edit_record['user_id'] ) ) {\n\t\t\tthis.current_edit_record['user_id'] = LocalCacheData.getLoginUser().id;\n\t\t}\n\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'item_id':\n\t\t\t\t\t\tvar args = {};\n\t\t\t\t\t\targs.filter_data = { job_id: this.current_edit_record.job_id };\n\t\t\t\t\t\twidget.setDefaultArgs( args );\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_quick_search':\n//\t\t\t\t\t\twidget.setValue( this.current_edit_record['job_id'] ? this.current_edit_record['job_id'] : 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'job_item_quick_search':\n//\t\t\t\t\t\twidget.setValue( this.current_edit_record['item_id'] ? this.current_edit_record['item_id'] : 0 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif ( Global.isSet( this.current_default_record[key] ) ) {\n\t\t\t\t\t\t\tthis.current_edit_record[key] = this.current_default_record[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tthis.current_default_record = {};\n\t\tsuper.setEditViewDataDone();\n\t}\n\n\t/* jshint ignore:start */\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tvar amount_arr = false;\n\n\t\tswitch ( key ) {\n\t\t\tcase 'job_id':\n\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\tthis.setJobItemValueWhenJobChanged( target.getValue( true ), 'item_id', { job_id: $this.current_edit_record.job_id } );\n\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t\tbreak;\n\t\t\tcase 'item_id':\n\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\tthis.setJobItemAmendmentDefaultData();\n\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\t\tbreak;\n\t\t\tcase 'job_quick_search':\n\t\t\tcase 'job_item_quick_search':\n\t\t\t\tthis.onJobQuickSearch( key, c_value, 'job_id', 'item_id' );\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'onJobQuickSearch', function() {\n\t\t\t\t\t$this.setJobItemAmendmentDefaultData();\n\t\t\t\t} );\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'setJobItemValueWhenJobChanged', function() {\n\t\t\t\t\t$this.setJobItemAmendmentDefaultData();\n\t\t\t\t} );\n\n\t\t\t\t//Don't validate immediately as onJobQuickSearch is doing async API calls, and it would cause a guaranteed validation failure.\n\t\t\t\tvar doNotValidate = true;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tvalidate() {\n\n\t\tvar $this = this;\n\n\t\tvar record = {};\n\n\t\tif ( this.is_mass_editing ) {\n\n\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\trecord[$this.parent_key] = $this.parent_value;\n\t\t\t}\n\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\t\trecord[key] = widget.getValue();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\trecord = this.current_edit_record;\n\t\t}\n\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.api['validate' + this.api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.validateResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tsetJobItemAmendmentDefaultData() {\n\t\tvar $this = this;\n\t\tvar job_item_id;\n\t\tif ( TTUUID.isUUID( this.current_edit_record.item_id ) && this.current_edit_record.item_id != TTUUID.zero_id && this.is_add ) {\n\t\t\tjob_item_id = this.current_edit_record.item_id;\n\t\t\tthis.api['get' + this.api.key_name + 'DefaultData']( job_item_id, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\tif ( !result_data ) {\n\t\t\t\t\t\tresult_data = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.current_default_record = result_data;\n\t\t\t\t\t$this.setCurrentEditRecordData();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t/* jshint ignore:end */\n\n}\n\nJobItemAmendmentViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'JobItemAmendment', 'SubJobItemAmendmentView.html', function( result ) {\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_job_item_amendment_view_controller );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t} );\n};\n"],"sourceRoot":""}