{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImage.js","webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageAdvBrowser.js","webpack://timetrex/./interface/html5/views/invoice/settings/InvoiceConfigViewController.js"],"names":["$","fn","TImage","options","Global","addCss","field","opts","extend","defaults","this","clearErrorStyle","getField","getValue","setValue","val","d","Date","attr","getTime","each","o","meta","data","document","on","e","$this_image_widget","target","parents","height","top","file_browser_overlay","css","append","parent","find","TAlertManager","showConfirmAlert","i18n","_","flag","type","message","time","trigger","off","remove","jQuery","TImageAdvBrowser","image","result_form_data","$this","accept_filter","default_width","default_height","callBack","setEnable","btn","children","eq","show","hide","setImage","getCookie","onImageLoad","image_height","naturalHeight","image_width","width","naturalWidth","setEnableDelete","removeAttr","text","show_browser","isSet","name","deleteImageHandler","bind","IndexViewController","openWizard","form_data","InvoiceConfigViewController","BaseViewController","super","edit_view_tpl","permission_id","viewId","script_name","context_menu_name","api","TTAPI","APIInvoiceConfig","render","initData","exclude","include","ContextMenuIconName","save","cancel","export_excel","key_name","onResult","result","result_data","getResult","isArray","getInvoiceConfigDefaultData","result_2","key","current_edit_record","widget","edit_view_ui_dic","file_browser","ServiceCaller","getURLByObjectType","collectUIDataToCurrentEditRecord","setEditViewDataDone","edit_only_mode","initOptions","getInvoiceConfigData","buildContextMenu","TTPromise","add","edit_view","initEditViewUI","wait","initEditView","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","c_value","validate","len","context_menu_array","length","i","context_btn","id","removeClass","addClass","buildEditViewUI","tab_model","setTabModel","form_item_input","tab_invoice_settings_column1","edit_view_tab","edit_view_tabs","push","FormData","loadWidgetByName","FormItemType","IMAGE_BROWSER","TImageBrowser","uploadFile","toLowerCase","showAlert","IMAGE_AVD_BROWSER","addEditFieldToColumn","SEPARATED_BOX","SeparatedBox","label","CHECKBOX","TCheckbox","TEXT_AREA","TTextArea","TEXT_INPUT","TTextInput","resolve"],"mappings":"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","file":"invoice-settings-InvoiceConfigViewController.bundle.js?v=272425b18237c5db630a","sourcesContent":["( function( $ ) {\n\n\t$.fn.TImage = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImage.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn null;\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\tthis.attr( 'src', '' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar d = new Date();\n\t\t\tthis.attr( 'src', val + '&t=' + d.getTime() );\n\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImage.defaults = {};\n\n\t$( document ).on( 'mouseover', '.file-browser img', function( e ) {\n\t\tvar $this_image_widget = $( e.target ).parents( '.file-browser' );\n\n\t\tif ( !$( '.file_browser_overlay' )[0] && $( e.target ).attr( 'enable-delete' ) == 1 ) {\n\t\t\tvar height = $( e.target ).height();\n\t\t\tvar top = ( height - 32 ) / 2;\n\t\t\tvar left = top;\n\n\t\t\tvar file_browser_overlay = $( '<div class=\"file_browser_overlay\"><img src=\"theme/default/images/delete-512.png\" style=\"position:absolute;width:32px;height:32px;top:' + top + 'px;left:' + left + 'px;\"></div>' );\n\t\t\tfile_browser_overlay.css( 'position', 'absolute' );\n\t\t\tfile_browser_overlay.css( 'top', '0px' );\n\t\t\tfile_browser_overlay.css( 'left', '0' );\n\t\t\tfile_browser_overlay.css( 'cursor', 'pointer' );\n\t\t\tfile_browser_overlay.css( 'height', height + 'px' );\n\t\t\tfile_browser_overlay.css( 'width', '100%' );\n\t\t\tfile_browser_overlay.css( 'background', 'rgba(255,255,255,0.85)' );\n\n\t\t\t$( e.target ).parents( '.file-browser' ).append( file_browser_overlay );\n\n\t\t\t$( document ).on( 'click', '.file_browser_overlay', function( e ) {\n\t\t\t\tvar img_src = $( e.target ).parent().find( 'img' ).attr( 'src' );\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'This will permanently delete the image. Are you sure?' ), '', function( flag ) {\n\t\t\t\t\tif ( flag ) {\n\t\t\t\t\t\tvar e = { type: 'deleteClick', message: 'Delete image clicked.', time: new Date() };\n\t\t\t\t\t\t$this_image_widget.trigger( e );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t$( document ).on( 'mouseleave', '.file-browser', function() {\n\t\t\t\t$( document ).off( 'click', '.file_browser_overlay' );\n\t\t\t\tif ( $( '.file_browser_overlay' )[0] ) {\n\t\t\t\t\tvar file_browser_overlay = $( this ).find( '.file_browser_overlay' );\n\t\t\t\t\tfile_browser_overlay.off().remove();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TImageAdvBrowser = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageAdvBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar name = 'filedata';\n\n\t\tvar accept_filter = '';\n\n\t\tvar default_width = 177;\n\t\tvar default_height = 42;\n\n\t\tvar callBack = null;\n\n\t\tvar enabled = true;\n\n\t\tvar image;\n\n\t\tvar result_form_data;\n\n\t\tthis.setEnable = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.children().eq( 1 );\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.hide();\n\t\t\t} else {\n\t\t\t\tbtn.show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn result_form_data;\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() + '&X-CSRF-Token=' + getCookie( 'CSRF-Token' ) );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tthis.onImageLoad = function( image ) {\n\n\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n\n\t\t\tif ( image_height > default_height ) {\n\t\t\t\t$( image ).css( 'height', default_height );\n\n\t\t\t}\n\n\t\t\tif ( image_width > default_width ) {\n\t\t\t\t$( image ).css( 'width', default_width );\n\t\t\t\t$( image ).css( 'height', 'auto' );\n\t\t\t}\n\n\t\t\t$this.trigger( 'setSize' );\n\n\t\t\tif ( image_height < 5 ) {\n\t\t\t\t$( image ).hide();\n\t\t\t} else {\n\t\t\t\t$( image ).show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setEnableDelete = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\tif ( !val ) {\n\t\t\t\timage.removeAttr( 'enable-delete' );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\timage.attr( 'enable-delete', 1 );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tvar $$this = this;\n\n\t\t\t$( this ).find( '#upload_image' ).text( $.i18n._( 'Upload Image' ) );\n\n\t\t\tif ( o.callBack ) {\n\t\t\t\tcallBack = o.callBack;\n\t\t\t}\n\n\t\t\tif ( o.show_browser === false ) {\n\t\t\t\t$( this ).children().eq( 1 ).hide();\n\t\t\t}\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( accept_filter ) ) {\n\t\t\t\taccept_filter = o.accept_filter;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.deleteImageHandler ) ) {\n\t\t\t\t$this.find( '.file-browser' ).on( 'deleteClick', function() {\n\t\t\t\t\to.deleteImageHandler();\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar browser = $( this ).children().eq( 1 );\n\t\t\tbrowser.bind( 'click', function() {\n\t\t\t\tIndexViewController.openWizard( 'UserPhotoWizard', null, function( form_data ) {\n\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack( form_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_form_data = form_data;\n\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\timage = $( this ).children().eq( 0 );\n\t\t\timage.on( 'load', function() {\n\t\t\t\t$this.onImageLoad( this );\n\t\t\t} );\n\n\t\t\timage.hide();\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageAdvBrowser.defaults = {};\n\n} )( jQuery );","import '@/global/widgets/filebrowser/TImage';\nimport '@/global/widgets/filebrowser/TImageAdvBrowser';\n\nexport class InvoiceConfigViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\t// _required_files: ['TImageAdvBrowser', 'TImage']\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'InvoiceConfigEditView.html';\n\t\tthis.permission_id = 'invoice_config';\n\t\tthis.viewId = 'InvoiceConfig';\n\t\tthis.script_name = 'InvoiceConfigView';\n\t\tthis.context_menu_name = $.i18n._( 'Preferences' );\n\t\tthis.api = TTAPI.APIInvoiceConfig;\n\n\t\tthis.render();\n\t\tthis.initData();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\t}\n\n\tinitOptions( callBack ) {\n\n\t\tcallBack();\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['default'],\n\t\t\tinclude: [\n\t\t\t\tContextMenuIconName.save,\n\t\t\t\tContextMenuIconName.cancel,\n\t\t\t\tContextMenuIconName.export_excel,\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tgetInvoiceConfigData( callBack ) {\n\t\tvar $this = this;\n\n\t\t$this.api['get' + $this.api.key_name]( {\n\t\t\tonResult: function( result ) {\n\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( Global.isArray( result_data ) && Global.isSet( result_data[0] ) ) {\n\t\t\t\t\tcallBack( result_data[0] );\n\t\t\t\t} else {\n\t\t\t\t\t$this.api.getInvoiceConfigDefaultData( {\n\t\t\t\t\t\tonResult: function( result_2 ) {\n\t\t\t\t\t\t\tresult_data = result_2.getResult();\n\t\t\t\t\t\t\tcallBack( result_data );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.file_browser.setImage( ServiceCaller.getURLByObjectType( 'invoice_config' ) );\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\topenEditView() {\n\t\tvar $this = this;\n\n\t\tif ( $this.edit_only_mode ) {\n\n\t\t\t$this.initOptions( function() {\n\n\t\t\t\t$this.getInvoiceConfigData( function( result_data ) {\n\n\t\t\t\t\t$this.buildContextMenu();\n\t\t\t\t\tTTPromise.add( 'InvoiceConfig', 'openEditView' );\n\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\t$this.initEditViewUI( $this.viewId, $this.edit_view_tpl );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Waiting for the API returns data to set the current edit record.\n\t\t\t\t\t$this.current_edit_record = result_data;\n\n\t\t\t\t\tTTPromise.wait( 'InvoiceConfig', 'openEditView', function() {\n\t\t\t\t\t\t$this.initEditView();\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\n\t\tvar key = target.getField();\n\t\t//this.current_edit_record[key] = target.getValue();\n\t\tvar c_value = target.getValue();\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tsetErrorMenu() {\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\t\tvar $this = this;\n\t\tsuper.buildEditViewUI();\n\n\t\tvar tab_model = {\n\t\t\t'tab_invoice_settings': { 'label': $.i18n._( 'Invoice Settings' ) },\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\t//Tab 0 start\n\n\t\tvar tab_invoice_settings = this.edit_view_tab.find( '#tab_invoice_settings' );\n\n\t\tvar tab_invoice_settings_column1 = tab_invoice_settings.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_invoice_settings_column1 );\n\n\t\tvar form_item_input;\n\t\t// Logo\n\n\t\tif ( typeof FormData == 'undefined' ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.IMAGE_BROWSER );\n\n\t\t\tthis.file_browser = form_item_input.TImageBrowser( { field: '', default_width: 128, default_height: 128 } );\n\n\t\t\tthis.file_browser.bind( 'imageChange', function( e, target ) {\n\n\t\t\t\tnew ServiceCaller().uploadFile( target.getValue(), 'object_type=invoice_config', {\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tif ( result.toLowerCase() === 'true' ) {\n\t\t\t\t\t\t\t$this.file_browser.setImage( ServiceCaller.getURLByObjectType( 'invoice_config' ) );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tTAlertManager.showAlert( result, 'Error' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t} );\n\t\t} else {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.IMAGE_AVD_BROWSER );\n\n\t\t\tthis.file_browser = form_item_input.TImageAdvBrowser( {\n\t\t\t\tfield: '', default_width: 128, default_height: 128, callBack: function( form_data ) {\n\t\t\t\t\tnew ServiceCaller().uploadFile( form_data, 'object_type=invoice_config', {\n\t\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\t\tif ( result.toLowerCase() === 'true' ) {\n\t\t\t\t\t\t\t\t$this.file_browser.setImage( ServiceCaller.getURLByObjectType( 'invoice_config' ) );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( result, 'Error' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Logo' ), form_item_input, tab_invoice_settings_column1, '', null, false, true );\n\n\t\t//SEPARATED_BOX\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Display on Invoice' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Company Address\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'display_company_address' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Company Address' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Phone\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'display_company_work_phone' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Phone' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Fax\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'display_company_fax_phone' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Fax' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Part Numbers\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'display_part_number' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Part Numbers' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t//Payment Information\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'display_payment' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Payment Information' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t//Payment Signature\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'display_payment_signature' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Payment Signature' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Note\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'note', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Note' ), form_item_input, tab_invoice_settings_column1, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Invoice Email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Invoice Email' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, tab_invoice_settings_column1 );\n\n\t\t// From Address\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'email_from' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'From Address' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Bcc Address\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'email_bcc' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Bcc Address' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Subject\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'email_subject' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Subject' ), form_item_input, tab_invoice_settings_column1 );\n\n\t\t// Body\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'email_body', width: 400, height: 300 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Body' ), form_item_input, tab_invoice_settings_column1, '', null, null, true );\n\n\t\tTTPromise.resolve( 'InvoiceConfig', 'openEditView' );\n\t}\n\n}"],"sourceRoot":""}