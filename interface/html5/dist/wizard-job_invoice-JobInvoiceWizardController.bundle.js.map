{"version":3,"sources":["webpack://timetrex/./interface/html5/views/wizard/job_invoice/JobInvoiceWizardController.js"],"names":["JobInvoiceWizardController","BaseWizardController","options","_","defaults","el","super","this","title","$","i18n","steps","current_step","render","initCurrentStep","$this","content_div","empty","stepsWidgetDic","label","getLabel","text","a_combobox","getAComboBox","TTAPI","APIJob","div","append","getField","form_item","Global","loadWidget","form_item_label","find","form_item_input_div","combobox","getComboBox","start_picker","getDatePicker","end_picker","pay_period","APIPayPeriod","pay_period_schedule","APIPayPeriodSchedule","bind","e","target","onTimePeriodChange","label2","date_picker","check_box","getCheckBox","check_box_label","prepend","value","getValue","start_date_div","parent","end_date_div","pay_period_div","pay_period_schedule_div","css","current_step_data","stepsDataDic","current_step_ui","key","hasOwnProperty","setValue","APIJobSummaryReport","getOptions","onResult","result","setSourceData","buildRecordArray","getResult","date","Date","effective_date","format","time_period","onDoneClick","saveCurrentStep","effect_date","job_id","flags","create_invoices","include_pending_transactions","overwrite_duplicate_transactions","generateInvoices","isValid","user_generic_status_batch_id","getAttributeInAPIDetails","TTUUID","isUUID","zero_id","not_exist_id","UserGenericStatusWindowController","open","LocalCacheData","getLoginUser","id","onCloseClick","call_back","is","default_data"],"mappings":"iMAAO,MAAMA,UAAmCC,qBAC/C,YAAaC,EAAU,IACtBC,EAAEC,SAAUF,EAAS,CACpBG,GAAI,eAGLC,MAAOJ,GAGR,KAAMA,GAGLK,KAAKC,MAAQC,EAAEC,KAAKP,EAAG,sBACvBI,KAAKI,MAAQ,EACbJ,KAAKK,aAAe,EAEpBL,KAAKM,SAGN,SACCP,MAAMO,SAENN,KAAKO,kBAIN,qBACC,IAAIC,EAAQR,KAIZ,OAHAA,KAAKS,YAAYC,QAEjBV,KAAKW,eAAeX,KAAKK,cAAgB,GAChCL,KAAKK,cACb,KAAK,EACJ,IAAIO,EAAQZ,KAAKa,WACjBD,EAAME,KAAMZ,EAAEC,KAAKP,EAAG,+CAAkD,KAExE,IAAImB,EAAaf,KAAKgB,aAAcC,MAAMC,QAAQ,EAAM,aAAc,UAAU,GAC5EC,EAAMjB,EAAG,4CACbiB,EAAIC,OAAQL,GAEZf,KAAKS,YAAYW,OAAQR,GACzBZ,KAAKS,YAAYW,OAAQD,GAEzBnB,KAAKW,eAAeX,KAAKK,cAAcU,EAAWM,YAAcN,EAEhE,MACD,KAAK,GACJH,EAAQZ,KAAKa,YACPC,KAAMZ,EAAEC,KAAKP,EAAG,sDAAyD,KAE/EI,KAAKS,YAAYW,OAAQR,GAEzB,IAAIU,EAAYpB,EAAGqB,OAAOC,WAAY,wDAClCC,EAAkBH,EAAUI,KAAM,oBAClCC,EAAsBL,EAAUI,KAAM,wBAEtCE,EAAW5B,KAAK6B,YAAa,eAAe,GAEhDJ,EAAgBX,KAAMZ,EAAEC,KAAKP,EAAG,eAAkB,MAClD+B,EAAoBP,OAAQQ,GAE5B5B,KAAKS,YAAYW,OAAQE,GAGzBG,GADAH,EAAYpB,EAAGqB,OAAOC,WAAY,yDACNE,KAAM,oBAClCC,EAAsBL,EAAUI,KAAM,wBAEtC,IAAII,EAAe9B,KAAK+B,cAAe,cAEvCN,EAAgBX,KAAMZ,EAAEC,KAAKP,EAAG,cAAiB,MACjD+B,EAAoBP,OAAQU,GAE5B9B,KAAKS,YAAYW,OAAQE,GAGzBG,GADAH,EAAYpB,EAAGqB,OAAOC,WAAY,yDACNE,KAAM,oBAClCC,EAAsBL,EAAUI,KAAM,wBAEtC,IAAIM,EAAahC,KAAK+B,cAAe,YAErCN,EAAgBX,KAAMZ,EAAEC,KAAKP,EAAG,YAAe,MAC/C+B,EAAoBP,OAAQY,GAE5BhC,KAAKS,YAAYW,OAAQE,GAGzBG,GADAH,EAAYpB,EAAGqB,OAAOC,WAAY,yDACNE,KAAM,oBAClCC,EAAsBL,EAAUI,KAAM,wBAEtC,IAAIO,EAAajC,KAAKgB,aAAcC,MAAMiB,cAAc,EAAM,oBAAqB,iBAEnFT,EAAgBX,KAAMZ,EAAEC,KAAKP,EAAG,cAAiB,MACjD+B,EAAoBP,OAAQa,GAE5BjC,KAAKS,YAAYW,OAAQE,GAGzBG,GADAH,EAAYpB,EAAGqB,OAAOC,WAAY,yDACNE,KAAM,oBAClCC,EAAsBL,EAAUI,KAAM,wBAEtC,IAAIS,EAAsBnC,KAAKgB,aAAcC,MAAMmB,sBAAsB,EAAM,6BAA8B,0BAE7GX,EAAgBX,KAAMZ,EAAEC,KAAKP,EAAG,uBAA0B,MAC1D+B,EAAoBP,OAAQe,GAE5BnC,KAAKS,YAAYW,OAAQE,GAEzBM,EAASS,KAAM,kBAAkB,SAAUC,EAAGC,GAC7C/B,EAAMgC,mBAAoBD,MAG3B,IAAIE,EAASzC,KAAKa,WAClB4B,EAAO3B,KAAMZ,EAAEC,KAAKP,EAAG,kDAAqD,KAE5EI,KAAKS,YAAYW,OAAQqB,GAEzB,IAAIC,EAAc1C,KAAK+B,cAAe,kBAEtC/B,KAAKS,YAAYW,OAAQsB,GAEzB1C,KAAKW,eAAeX,KAAKK,cAAcuB,EAASP,YAAcO,EAC9D5B,KAAKW,eAAeX,KAAKK,cAAcqC,EAAYrB,YAAcqB,EACjE1C,KAAKW,eAAeX,KAAKK,cAAcyB,EAAaT,YAAcS,EAClE9B,KAAKW,eAAeX,KAAKK,cAAc2B,EAAWX,YAAcW,EAChEhC,KAAKW,eAAeX,KAAKK,cAAc4B,EAAWZ,YAAcY,EAChEjC,KAAKW,eAAeX,KAAKK,cAAc8B,EAAoBd,YAAcc,EAEzE3B,EAAMgC,mBAAoBZ,GAE1B,MACD,KAAK,GACJhB,EAAQZ,KAAKa,YACPC,KAAMZ,EAAEC,KAAKP,EAAG,kCAEtBuB,EAAMjB,EAAG,2DAETF,KAAKS,YAAYW,OAAQR,GAEzB,IAAI+B,EAAYnC,EAAMoC,YAAa,mBAC/BC,EAAkB3C,EAAG,gEAAkEA,EAAEC,KAAKP,EAAG,mBAAsB,YAC3HiD,EAAgBC,QAASH,GACzBxB,EAAIC,OAAQyB,GACZ7C,KAAKW,eAAeX,KAAKK,cAAcsC,EAAUtB,YAAcsB,EAE/DA,EAAYnC,EAAMoC,YAAa,iCAC/BC,EAAkB3C,EAAG,gEAAkEA,EAAEC,KAAKP,EAAG,gEAAmE,aACpJkD,QAASH,GACzBxB,EAAIC,OAAQyB,GACZ7C,KAAKW,eAAeX,KAAKK,cAAcsC,EAAUtB,YAAcsB,EAE/DA,EAAYnC,EAAMoC,YAAa,qCAC/BC,EAAkB3C,EAAG,gEAAkEA,EAAEC,KAAKP,EAAG,qDAAwD,aACzIkD,QAASH,GACzBxB,EAAIC,OAAQyB,GACZ7C,KAAKW,eAAeX,KAAKK,cAAcsC,EAAUtB,YAAcsB,EAE/D3C,KAAKS,YAAYW,OAAQD,IAO5B,mBAAoBoB,GACnB,IAAIQ,EAAQR,EAAOS,WAEfC,EAAiBjD,KAAKW,eAAeX,KAAKK,cAA0B,WAAE6C,SAASA,SAC/EC,EAAenD,KAAKW,eAAeX,KAAKK,cAAwB,SAAE6C,SAASA,SAC3EE,EAAiBpD,KAAKW,eAAeX,KAAKK,cAA6B,cAAE6C,SAASA,SAClFG,EAA0BrD,KAAKW,eAAeX,KAAKK,cAAsC,uBAAE6C,SAASA,SAEzF,gBAAVH,GACJE,EAAeK,IAAK,UAAW,SAC/BH,EAAaG,IAAK,UAAW,SAC7BF,EAAeE,IAAK,UAAW,QAC/BD,EAAwBC,IAAK,UAAW,SACnB,sBAAVP,GACXE,EAAeK,IAAK,UAAW,QAC/BH,EAAaG,IAAK,UAAW,QAC7BF,EAAeE,IAAK,UAAW,SAC/BD,EAAwBC,IAAK,UAAW,SACnB,oBAAVP,GAAyC,oBAAVA,GAAyC,uBAAVA,GAA4C,uBAAVA,GAC3GE,EAAeK,IAAK,UAAW,QAC/BH,EAAaG,IAAK,UAAW,QAC7BF,EAAeE,IAAK,UAAW,QAC/BD,EAAwBC,IAAK,UAAW,WAExCL,EAAeK,IAAK,UAAW,QAC/BH,EAAaG,IAAK,UAAW,QAC7BF,EAAeE,IAAK,UAAW,QAC/BD,EAAwBC,IAAK,UAAW,SAI1C,uBACC,IAAI9C,EAAQR,KACRuD,EAAoBvD,KAAKwD,aAAaxD,KAAKK,cAC3CoD,EAAkBzD,KAAKW,eAAeX,KAAKK,cAE/C,OAASL,KAAKK,cACb,KAAK,EACJ,GAAMkD,EAUL,IAAM,IAAIG,KAAOH,EACVA,EAAkBI,eAAgBD,IAIxCD,EAAgBC,GAAKE,SAAUL,EAAkBG,SAdlD,IAAM,IAAIA,KAAOD,EAEVA,EAAgBE,eAAgBD,IAGtCD,EAAgBC,GAAKE,UAAW,GAalC,MACD,KAAK,EACJ3C,MAAM4C,oBAAoBC,WAAY,cAAe,CACpDC,SAAU,SAAUC,GAInB,GAFAP,EAA6B,YAAEQ,cAAe1C,OAAO2C,iBAAkBF,EAAOG,cAExEZ,EAML,IAAM,IAAIG,KAAOH,EACVA,EAAkBI,eAAgBD,IAIxCD,EAAgBC,GAAKE,SAAUL,EAAkBG,QAXzB,CACzB,IAAIU,EAAO,IAAIC,KAEfZ,EAAgBa,eAAeV,SAAUQ,EAAKG,UAC9Cd,EAAgBe,YAAYZ,SAAU,SAWvCpD,EAAMgC,mBAAoBiB,EAA6B,gBAGzD,MACD,KAAK,EAEJ,GAAMF,EASL,IAAM,IAAIG,KAAOH,EACVA,EAAkBI,eAAgBD,IAIxCD,EAAgBC,GAAKE,SAAUL,EAAkBG,SAblD,IAAM,IAAIA,KAAOD,EACVA,EAAgBE,eAAgBD,IAItCD,EAAgBC,GAAKE,UAAU,GAYjC,MACD,QACC,IAAM,IAAIF,KAAOH,EACVA,EAAkBI,eAAgBD,IAIxCD,EAAgBC,GAAKE,SAAUL,EAAkBG,KAMrD,cACC,IAAIlD,EAAQR,KACZD,MAAM0E,cACNzE,KAAK0E,kBAEL,IAAIF,EAAc,GAGlB,IAAM,IAAId,KAFVc,EAAYA,YAAcxE,KAAKwD,aAAa,GAAGgB,YAE9BxE,KAAKwD,aAAa,GAC5BxD,KAAKwD,aAAa,GAAGG,eAAgB,CAACD,KAAkB,gBAARA,GAAiC,mBAARA,IAI/Ec,EAAYd,GAAO1D,KAAKwD,aAAa,GAAGE,IAIzC,IAAIiB,EAAc3E,KAAKwD,aAAa,GAAGc,eAEnCM,EAAS5E,KAAKwD,aAAa,GAAGoB,OAE9BC,EAAQ,GAEZA,EAAMC,gBAAkB9E,KAAKwD,aAAa,GAAoB,gBAC9DqB,EAAME,6BAA+B/E,KAAKwD,aAAa,GAAiC,6BACxFqB,EAAMG,iCAAmChF,KAAKwD,aAAa,GAAqC,iCAEhGvC,MAAMC,OAAO+D,iBAAkBT,EAAaG,EAAaC,EAAQC,EAAO,CACvEd,SAAU,SAAUC,GACnB,GAAKA,EAAOkB,UAAY,CACvB,IAAIC,EAA+BnB,EAAOoB,yBAA0B,gCAE/DD,GAAgCE,OAAOC,OAAQH,IAAkCA,GAAgCE,OAAOE,SAAWJ,GAAgCE,OAAOG,cAC9KC,kCAAkCC,KAAMP,EAA8B,CAACQ,eAAeC,eAAeC,KAIvGrF,EAAMsF,eAEDtF,EAAMuF,WACVvF,EAAMuF,eAMV,kBACC/F,KAAKwD,aAAaxD,KAAKK,cAAgB,GACvC,IAAIkD,EAAoBvD,KAAKwD,aAAaxD,KAAKK,cAC3CoD,EAAkBzD,KAAKW,eAAeX,KAAKK,cAC/C,OAASL,KAAKK,cACb,KAAK,EACJ,IAAM,IAAIqD,KAAOD,EACVA,EAAgBE,eAAgBD,IAIjCD,EAAgBC,GAAKsC,GAAI,cAC7BzC,EAAkBG,GAAOD,EAAgBC,GAAKV,YAIhD,MAED,QAEC,IAAM,IAAIU,KAAOD,EACVA,EAAgBE,eAAgBD,KAItCH,EAAkBG,GAAOD,EAAgBC,GAAKV,aAMlD,wBAEC,IAAMhD,KAAKiG,aACV,OAAO","file":"wizard-job_invoice-JobInvoiceWizardController.bundle.js?v=e0a1986ac08b9c73af86","sourcesContent":["export class JobInvoiceWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg'\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\n\t\tthis.title = $.i18n._( 'Job Invoice Wizard' );\n\t\tthis.steps = 3;\n\t\tthis.current_step = 1;\n\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\t//Create each page UI\n\tbuildCurrentStepUI() {\n\t\tvar $this = this;\n\t\tthis.content_div.empty();\n\n\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select one or more jobs you wish to invoice' ) + ':' );\n\n\t\t\t\tvar a_combobox = this.getAComboBox( TTAPI.APIJob, true, 'global_job', 'job_id', true );\n\t\t\t\tvar div = $( '<div class=\\'wizard-acombobox-div\\'></div>' );\n\t\t\t\tdiv.append( a_combobox );\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( div );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step][a_combobox.getField()] = a_combobox;\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Select the date range you wish to invoice jobs for' ) + ':' );\n\n\t\t\t\tthis.content_div.append( label );\n\n\t\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar combobox = this.getComboBox( 'time_period', true );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'Time Period' ) + ': ' );\n\t\t\t\tform_item_input_div.append( combobox );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar start_picker = this.getDatePicker( 'start_date' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'Start Date' ) + ': ' );\n\t\t\t\tform_item_input_div.append( start_picker );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar end_picker = this.getDatePicker( 'end_date' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'End Date' ) + ': ' );\n\t\t\t\tform_item_input_div.append( end_picker );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar pay_period = this.getAComboBox( TTAPI.APIPayPeriod, true, 'global_Pay_period', 'pay_period_id' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'Pay Period' ) + ': ' );\n\t\t\t\tform_item_input_div.append( pay_period );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tform_item = $( Global.loadWidget( 'global/widgets/wizard_form_item/WizardFormItem.html' ) );\n\t\t\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\t\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\t\t\tvar pay_period_schedule = this.getAComboBox( TTAPI.APIPayPeriodSchedule, true, 'global_pay_period_schedule', 'pay_period_schedule_id' );\n\n\t\t\t\tform_item_label.text( $.i18n._( 'Pay Period Schedule' ) + ': ' );\n\t\t\t\tform_item_input_div.append( pay_period_schedule );\n\n\t\t\t\tthis.content_div.append( form_item );\n\n\t\t\t\tcombobox.bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.onTimePeriodChange( target );\n\t\t\t\t} );\n\n\t\t\t\tvar label2 = this.getLabel();\n\t\t\t\tlabel2.text( $.i18n._( 'Select the date to be displayed on the invoice' ) + ':' );\n\n\t\t\t\tthis.content_div.append( label2 );\n\n\t\t\t\tvar date_picker = this.getDatePicker( 'effective_date' );\n\n\t\t\t\tthis.content_div.append( date_picker );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step][combobox.getField()] = combobox;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][date_picker.getField()] = date_picker;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][start_picker.getField()] = start_picker;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][end_picker.getField()] = end_picker;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][pay_period.getField()] = pay_period;\n\t\t\t\tthis.stepsWidgetDic[this.current_step][pay_period_schedule.getField()] = pay_period_schedule;\n\n\t\t\t\t$this.onTimePeriodChange( combobox );\n\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Please select invoice options' ) );\n\n\t\t\t\tdiv = $( '<div style=\"text-align: left;margin-left: 15px;\"></div>' );\n\n\t\t\t\tthis.content_div.append( label );\n\n\t\t\t\tvar check_box = $this.getCheckBox( 'create_invoices' );\n\t\t\t\tvar check_box_label = $( '<label class=\"wizard-checkbox-label\" style=\"display: block;\">' + $.i18n._( 'Create Invoices' ) + '</label>' );\n\t\t\t\tcheck_box_label.prepend( check_box );\n\t\t\t\tdiv.append( check_box_label );\n\t\t\t\tthis.stepsWidgetDic[this.current_step][check_box.getField()] = check_box;\n\n\t\t\t\tcheck_box = $this.getCheckBox( 'include_pending_transactions' );\n\t\t\t\tcheck_box_label = $( '<label class=\"wizard-checkbox-label\" style=\"display: block;\">' + $.i18n._( 'Include all non-invoiced transactions in the same date range' ) + '</label>' );\n\t\t\t\tcheck_box_label.prepend( check_box );\n\t\t\t\tdiv.append( check_box_label );\n\t\t\t\tthis.stepsWidgetDic[this.current_step][check_box.getField()] = check_box;\n\n\t\t\t\tcheck_box = $this.getCheckBox( 'overwrite_duplicate_transactions' );\n\t\t\t\tcheck_box_label = $( '<label class=\"wizard-checkbox-label\" style=\"display: block;\">' + $.i18n._( 'Overwrite already existing duplicate transactions' ) + '</label>' );\n\t\t\t\tcheck_box_label.prepend( check_box );\n\t\t\t\tdiv.append( check_box_label );\n\t\t\t\tthis.stepsWidgetDic[this.current_step][check_box.getField()] = check_box;\n\n\t\t\t\tthis.content_div.append( div );\n\n\t\t\t\tbreak;\n\n\t\t}\n\t}\n\n\tonTimePeriodChange( target ) {\n\t\tvar value = target.getValue();\n\n\t\tvar start_date_div = this.stepsWidgetDic[this.current_step]['start_date'].parent().parent();\n\t\tvar end_date_div = this.stepsWidgetDic[this.current_step]['end_date'].parent().parent();\n\t\tvar pay_period_div = this.stepsWidgetDic[this.current_step]['pay_period_id'].parent().parent();\n\t\tvar pay_period_schedule_div = this.stepsWidgetDic[this.current_step]['pay_period_schedule_id'].parent().parent();\n\n\t\tif ( value === 'custom_date' ) {\n\t\t\tstart_date_div.css( 'display', 'block' );\n\t\t\tend_date_div.css( 'display', 'block' );\n\t\t\tpay_period_div.css( 'display', 'none' );\n\t\t\tpay_period_schedule_div.css( 'display', 'none' );\n\t\t} else if ( value === 'custom_pay_period' ) {\n\t\t\tstart_date_div.css( 'display', 'none' );\n\t\t\tend_date_div.css( 'display', 'none' );\n\t\t\tpay_period_div.css( 'display', 'block' );\n\t\t\tpay_period_schedule_div.css( 'display', 'none' );\n\t\t} else if ( value === 'this_pay_period' || value === 'last_pay_period' || value === 'to_last_pay_period' || value === 'to_this_pay_period' ) {\n\t\t\tstart_date_div.css( 'display', 'none' );\n\t\t\tend_date_div.css( 'display', 'none' );\n\t\t\tpay_period_div.css( 'display', 'none' );\n\t\t\tpay_period_schedule_div.css( 'display', 'block' );\n\t\t} else {\n\t\t\tstart_date_div.css( 'display', 'none' );\n\t\t\tend_date_div.css( 'display', 'none' );\n\t\t\tpay_period_div.css( 'display', 'none' );\n\t\t\tpay_period_schedule_div.css( 'display', 'none' );\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t\tvar $this = this;\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tif ( !current_step_data ) {\n\t\t\t\t\tfor ( var key in current_step_ui ) {\n\n\t\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent_step_ui[key].setValue( -1 );\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tTTAPI.APIJobSummaryReport.getOptions( 'time_period', {\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tcurrent_step_ui['time_period'].setSourceData( Global.buildRecordArray( result.getResult() ) );\n\n\t\t\t\t\t\tif ( !current_step_data ) {\n\t\t\t\t\t\t\tvar date = new Date();\n\n\t\t\t\t\t\t\tcurrent_step_ui.effective_date.setValue( date.format() );\n\t\t\t\t\t\t\tcurrent_step_ui.time_period.setValue( 'today' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.onTimePeriodChange( current_step_ui['time_period'] );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\n\t\t\t\tif ( !current_step_data ) {\n\t\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent_step_ui[key].setValue( true );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfor ( var key in current_step_data ) {\n\t\t\t\t\tif ( !current_step_data.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_ui[key].setValue( current_step_data[key] );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar time_period = {};\n\t\ttime_period.time_period = this.stepsDataDic[2].time_period;\n\n\t\tfor ( var key in this.stepsDataDic[2] ) {\n\t\t\tif ( !this.stepsDataDic[2].hasOwnProperty( [key] ) || key === 'time_period' || key === 'effective_date' ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttime_period[key] = this.stepsDataDic[2][key];\n\n\t\t}\n\n\t\tvar effect_date = this.stepsDataDic[2].effective_date;\n\n\t\tvar job_id = this.stepsDataDic[1].job_id;\n\n\t\tvar flags = {};\n\n\t\tflags.create_invoices = this.stepsDataDic[3]['create_invoices'];\n\t\tflags.include_pending_transactions = this.stepsDataDic[3]['include_pending_transactions'];\n\t\tflags.overwrite_duplicate_transactions = this.stepsDataDic[3]['overwrite_duplicate_transactions'];\n\n\t\tTTAPI.APIJob.generateInvoices( time_period, effect_date, job_id, flags, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\tvar user_generic_status_batch_id = result.getAttributeInAPIDetails( 'user_generic_status_batch_id' );\n\n\t\t\t\t\tif ( user_generic_status_batch_id && TTUUID.isUUID( user_generic_status_batch_id ) && user_generic_status_batch_id != TTUUID.zero_id && user_generic_status_batch_id != TTUUID.not_exist_id ) {\n\t\t\t\t\t\tUserGenericStatusWindowController.open( user_generic_status_batch_id, [LocalCacheData.getLoginUser().id] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$this.onCloseClick();\n\n\t\t\t\tif ( $this.call_back ) {\n\t\t\t\t\t$this.call_back();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 2:\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( current_step_ui[key].is( ':visible' ) ) {\n\t\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tfor ( var key in current_step_ui ) {\n\t\t\t\t\tif ( !current_step_ui.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrent_step_data[key] = current_step_ui[key].getValue();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n}"],"sourceRoot":""}