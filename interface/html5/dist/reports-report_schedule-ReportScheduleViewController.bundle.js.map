{"version":3,"sources":["webpack://timetrex/./interface/html5/views/reports/report_schedule/ReportScheduleViewController.js"],"names":["ReportScheduleViewController","BaseViewController","options","_","defaults","el","status_array","priority_array","minute_array","hour_array","day_of_month_array","month_array","day_of_week_array","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIReportSchedule","render","sub_view_mode","buildContextMenu","initData","result","$this","result_data","getResult","company","LocalCacheData","current_company","name","parent_key","parent_value","current_edit_record","initEditView","initDropDownOption","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","APIUserReportData","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_report_schedule_column1","edit_view_tab","find","edit_view_tabs","push","form_item_input","Global","loadWidgetByName","FormItemType","COMBO_BOX","TComboBox","field","set_empty","setSourceData","addEditFieldToColumn","TEXT_INPUT","TTextInput","width","parent","TEXT_AREA","format_input","getReportOutputFormatOptions","parent_edit_record","onResult","buildRecordArray","DATE_PICKER","TDatePicker","AWESOME_BOX","key","CHECKBOX","TCheckbox","trigger","TTPromise","resolve","searchDone","loadSubView","container","beforeViewLoadedFun","afterViewLoadedFun","loadViewSource","template","isSet","html","wait","sub_report_schedule_view"],"mappings":"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","file":"reports-report_schedule-ReportScheduleViewController.bundle.js?v=691bd04445a13f18883b","sourcesContent":["export class ReportScheduleViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#report_schedule_view_container',\n\n\t\t\tstatus_array: null,\n\t\t\tpriority_array: null,\n\t\t\tminute_array: null,\n\t\t\thour_array: null,\n\t\t\tday_of_month_array: null,\n\t\t\tmonth_array: null,\n\t\t\tday_of_week_array: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\n\t\tthis.edit_view_tpl = 'ReportScheduleEditView.html';\n\t\tthis.permission_id = 'report';\n\t\tthis.viewId = 'ReportSchedule';\n\t\tthis.script_name = 'ReportScheduleView';\n\t\tthis.table_name_key = 'report_schedule';\n\t\tthis.context_menu_name = $.i18n._( 'Report Schedule' );\n\t\tthis.navigation_label = $.i18n._( 'Report Schedule' ) + ':';\n\t\tthis.api = TTAPI.APIReportSchedule;\n\n\t\tthis.render();\n\n\t\tif ( this.sub_view_mode ) {\n\t\t\tthis.buildContextMenu( true );\n\t\t\t//call init data in parent view, don't call initData\n\t\t} else {\n\t\t\tthis.buildContextMenu();\n\t\t\tif ( !this.sub_view_mode ) {\n\t\t\t\tthis.initData();\n\t\t\t}\n\t\t}\n\t}\n\n\tonAddResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tresult_data = [];\n\t\t}\n\n\t\tresult_data.company = LocalCacheData.current_company.name;\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.current_edit_record[this.parent_key] = this.parent_value;\n\t\t$this.initEditView();\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'priority' );\n\t\tthis.initDropDownOption( 'minute' );\n\t\tthis.initDropDownOption( 'hour' );\n\t\tthis.initDropDownOption( 'day_of_month' );\n\t\tthis.initDropDownOption( 'month' );\n\t\tthis.initDropDownOption( 'day_of_week' );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_report_schedule': { 'label': $.i18n._( 'Report Schedule' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUserReportData,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_branch',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_report_schedule = this.edit_view_tab.find( '#tab_report_schedule' );\n\n\t\tvar tab_report_schedule_column1 = tab_report_schedule.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_report_schedule_column1 );\n\n\t\t//Status\n\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_report_schedule_column1, '' );\n\n\t\t// Name\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_report_schedule_column1 );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Description\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_report_schedule_column1, '', null, null, true );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Format\n\n\t\tvar format_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tformat_input.TComboBox( { field: 'output_format', set_empty: false } );\n\n\t\tthis.api.getReportOutputFormatOptions( this.parent_edit_record.id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tformat_input.setSourceData( Global.buildRecordArray( result.getResult() ) );\n\t\t\t}\n\t\t} );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Format' ), format_input, tab_report_schedule_column1 );\n\n\t\t//Priority\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'priority_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.priority_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Priority' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Start Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//End Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Minute\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'minute',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.minute_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minute' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Hour\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'hour',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.hour_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Hour' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Day of month\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'day_of_month',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.day_of_month_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Day of Month' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//month\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'month',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.month_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Month' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Day of Week\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'day_of_week',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.day_of_week_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Day of Week' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t// Email Even If Blank\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\n\t\tform_item_input.TCheckbox( { field: 'email_blank_report' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Email Even If Blank' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t// Send Report to Home Email\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\n\t\tform_item_input.TCheckbox( { field: 'home_email_cc' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Send Report to Home Email' ), form_item_input, tab_report_schedule_column1 );\n\n\t\t//Other email\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'other_email', width: 300 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Send Report to Other Email' ), form_item_input, tab_report_schedule_column1 );\n\t}\n\n\tsearchDone() {\n\t\t$( 'window' ).trigger( 'resize' );\n\t\tif ( this.sub_view_mode ) {\n\t\t\tTTPromise.resolve( 'initSubReportScheduleView', 'init' );\n\t\t}\n\t\tsuper.searchDone();\n\t}\n}\n\nReportScheduleViewController.loadSubView = function( container, beforeViewLoadedFun, afterViewLoadedFun ) {\n\n\tGlobal.loadViewSource( 'ReportSchedule', 'SubReportScheduleView.html', function( result ) {\n\n\t\tvar args = {};\n\t\tvar template = _.template( result );\n\n\t\tif ( Global.isSet( beforeViewLoadedFun ) ) {\n\t\t\tbeforeViewLoadedFun();\n\t\t}\n\n\t\tif ( Global.isSet( container ) ) {\n\t\t\tcontainer.html( template( args ) );\n\t\t\tif ( Global.isSet( afterViewLoadedFun ) ) {\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'initialize', function() {\n\t\t\t\t\tafterViewLoadedFun( sub_report_schedule_view );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n};"],"sourceRoot":""}