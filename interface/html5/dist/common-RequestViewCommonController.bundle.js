(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["common-RequestViewCommonController"],{2343:(e,i,t)=>{"use strict";t.r(i),t.d(i,{"RequestViewCommonController":()=>d});class d extends BaseViewController{constructor(e={}){_.defaults(e,{authorization_history:null,selected_absence_policy_record:null,enable_edit_view_ui:!1}),super(e)}setGridCellBackGround(){if(this.grid){var e=this.grid.getGridParam("data");if(e)for(var i=e.length,t=0;t<i;t++){var d=e[t];30==d.status_id&&$("tr#"+d.id).addClass("bolder-request")}}}onCancelClick(e,i,t){TTPromise.add("base","onCancelClick");var d=this;if(this.current_edit_record&&this.current_edit_record.id)var a=this.current_edit_record.id;function _(){!d.edit_view&&d.parent_view_controller&&d.sub_view_mode?(d.parent_view_controller.is_changed=!1,d.parent_view_controller.buildContextMenu(!0),d.parent_view_controller.onCancelClick()):d.is_edit&&a?(d.setCurrentEditViewState("view"),d.onViewClick(a,!0),d.setEditMenu()):d.removeEditView(),t&&t(),d.search(),Global.setUIInitComplete(),ProgressBar.closeOverlay(),TTPromise.resolve("base","onCancelClick")}LocalCacheData.current_doing_context_action="cancel",this.is_changed&&!e?TAlertManager.showConfirmAlert(Global.modify_alert_message,null,(function(e){!0===e&&_()})):_()}onCloseIconClick(){this.onCancelClick()}buildDataForAPI(e){if("RequestAuthorization"==this.viewId&&(!e.request_schedule_id||e.request_schedule_id<=0))return e;var i=LocalCacheData.loginUser.id;Global.isSet(this.current_edit_record.user_id)&&(i=this.current_edit_record.user_id);var t={"user_id":i},d={},a=this.getAdvancedFieldNames();for(var _ in this.current_edit_record)"start_date"==_&&this.edit_view_ui_dic[_]&&(t.date_stamp=this.edit_view_ui_dic[_].getValue()),a.indexOf(_)>-1?"request_schedule_id"==_?d.id=this.current_edit_record.request_schedule_id:"request_schedule_status_id"==_?d.status_id=this.edit_view_ui_dic.request_schedule_status_id.getValue():this.edit_view_ui_dic[_]&&(d[_]=this.edit_view_ui_dic[_].getValue()):"available_balance"==_||"job_item_quick_search"==_||"job_quick_search"==_||(t[_]=this.current_edit_record[_]);return Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")&&(30==this.current_edit_record.type_id||40==this.current_edit_record.type_id)&&(t.request_schedule={0:d}),t}buildDataFromAPI(e){if(Global.isSet(e)&&Global.isSet(e.request_schedule)){for(var i in e.request_schedule)"id"==i?e.request_schedule_id=e.request_schedule.id:"status_id"==i?e.request_schedule_status_id=e.request_schedule.status_id:void 0===e[i]&&(e[i]=e.request_schedule[i]);delete e.request_schedule,this.pre_request_schedule=!1}else this.pre_request_schedule=!0;return $.extend(this.current_edit_record,e)}showAdvancedFields(e){if(!(Global.getProductEdition()>=15&&(PermissionManager.validate("request","add_advanced")||TTUUID.isUUID(this.current_edit_record.request_schedule_id)&&this.current_edit_record.request_schedule_id!=TTUUID.zero_id&&this.current_edit_record.request_schedule_id!=TTUUID.not_exist_id))||30!=this.current_edit_record.type_id&&40!=this.current_edit_record.type_id||this.pre_request_schedule&&!this.is_add)this.edit_view_ui_dic.date_stamp&&this.edit_view_ui_dic.date_stamp.parents(".edit-view-form-item-div").show(),this.hideAdvancedFields();else{var i=this.getAdvancedFieldNames();if(this.edit_view_ui_dic){for(var t=0;t<i.length;t++)"absence_policy_id"==i[t]&&this.edit_view_ui_dic.request_schedule_status_id&&20!=this.edit_view_ui_dic.request_schedule_status_id.getValue()?this.edit_view_ui_dic[i[t]].parents(".edit-view-form-item-div").hide():this.edit_view_ui_dic[i[t]]&&(("branch_id"!=i[t]||this.show_branch_ui)&&("department_id"!=i[t]||this.show_department_ui)&&("job_id"!=i[t]||this.show_job_ui)&&("job_item_id"!=i[t]||this.show_job_item_ui)&&("available_balance"!=i[t]||this.is_viewing)?this.edit_view_ui_dic[i[t]].parents(".edit-view-form-item-div").show():this.edit_view_ui_dic[i[t]].parents(".edit-view-form-item-div").hide());this.edit_view_ui_dic.date&&this.edit_view_ui_dic.date_stamp.parents(".edit-view-form-item-div").hide(),this.edit_view_ui_dic.available_balance&&1==this.is_viewing&&"Request"==this.viewId&&this.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").hide(),30!=this.current_edit_record.type_id&&40!=this.current_edit_record.type_id?this.edit_view_ui_dic.total_time&&this.edit_view_ui_dic.total_time.parents(".edit-view-form-item-div").hide():0!=e&&this.getScheduleTotalTime()}}}hideAdvancedFields(){var e=this.getAdvancedFieldNames();if(this.edit_view_ui_dic){for(var i=0;i<e.length;i++)this.edit_view_ui_dic[e[i]]&&this.edit_view_ui_dic[e[i]].parents(".edit-view-form-item-div").hide();this.edit_view_ui_dic.date&&this.edit_view_ui_dic.date.parents(".edit-view-form-item-div").show()}}getAdvancedFieldNames(){return["request_id","request_schedule_status_id","request_schedule_id","start_date","end_date","sun","mon","tue","wed","thu","fri","sat","start_time","end_time","total_time","schedule_policy_id","absence_policy_id","branch_id","department_id","job_id","job_item_id","schedule_policy","absence_policy","branch","department","job","job_item","available_balance"]}getScheduleTotalTime(){if(Global.getProductEdition()>=15&&(30==this.current_edit_record.type_id||40==this.current_edit_record.type_id)&&this.edit_view_ui_dic&&this.edit_view_ui_dic.total_time){var e=!1;this.current_edit_record.start_date&&this.current_edit_record.start_time&&(e=this.current_edit_record.start_date+" "+this.current_edit_record.start_time);var i=!1;this.current_edit_record.start_date&&this.current_edit_record.end_time&&(i=this.current_edit_record.start_date+" "+this.current_edit_record.end_time);var t=this.current_edit_record.schedule_policy_id?this.current_edit_record.schedule_policy_id:null,d=this.current_edit_record.user_id;if(void 0===d&&LocalCacheData.getLoginUser().id&&(d=LocalCacheData.getLoginUser().id),e&&i){var a=TTAPI.APISchedule.getScheduleTotalTime(e,i,t,d,{async:!1});a.isValid()?this.total_time=a.getResult():this.total_time=0,this.current_edit_record.total_time=this.total_time;var _=Global.getTimeUnit(this.total_time);this.edit_view_ui_dic.total_time.setValue(_),this.edit_view_ui_dic.total_time.parents(".edit-view-form-item-div").show()}else this.edit_view_ui_dic.total_time&&this.edit_view_ui_dic.total_time.parents(".edit-view-form-item-div").hide()}else this.edit_view_ui_dic.total_time&&this.edit_view_ui_dic.total_time.parents(".edit-view-form-item-div").hide();this.onAvailableBalanceChange()}onWorkingStatusChanged(){if(Global.getProductEdition()>=15&&this.edit_view_ui_dic.request_schedule_status_id&&this.edit_view_ui_dic.absence_policy_id){var e=this.edit_view_ui_dic.type_id?this.edit_view_ui_dic.type_id.getValue():this.current_edit_record.type_id;this.showAbsencePolicyField(e,this.edit_view_ui_dic.request_schedule_status_id.getValue(),this.edit_view_ui_dic.absence_policy_id)}}showAbsencePolicyField(e,i,t){20!=i||30!=e&&40!=e?(t.parents(".edit-view-form-item-div").hide(),this.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").hide()):(t.parents(".edit-view-form-item-div").show(),0==("Request"==this.viewId&&this.is_viewing)&&this.onAvailableBalanceChange())}onDateStampChanged(){Global.getProductEdition()>=15&&PermissionManager.validate("request","add_advanced")&&(this.edit_view_ui_dic.start_date.setValue(this.current_edit_record.date_stamp),this.current_edit_record.start_date=this.current_edit_record.date_stamp)}onStartDateChanged(){this.edit_view_ui_dic.date_stamp.setValue(this.current_edit_record.start_date),this.current_edit_record.date_stamp=this.current_edit_record.start_date}getAvailableBalance(){if(!(this.is_viewing&&"Request"==this.viewId||0==Global.isSet(this.current_edit_record)))if(("Request"!=this.viewId||0==this.is_viewing)&&this.current_edit_record.absence_policy_id&&(PermissionManager.validate("request","add_advanced")||TTUUID.isUUID(this.current_edit_record.request_schedule_id)&&this.current_edit_record.request_schedule_id!=TTUUID.zero_id&&this.current_edit_record.request_schedule_id!=TTUUID.not_exist_id)&&LocalCacheData.loginUser.id&&this.current_edit_record.total_time&&"00:00"!=this.current_edit_record.total_time&&this.current_edit_record.start_date){var e=1;if(this.current_edit_record.start_date!=this.current_edit_record.end_date)e=Global.getDaysInSpan(this.current_edit_record.start_date,this.current_edit_record.end_date,this.current_edit_record.sun,this.current_edit_record.mon,this.current_edit_record.tue,this.current_edit_record.wed,this.current_edit_record.thu,this.current_edit_record.fri,this.current_edit_record.sat);var i=this,t=this.current_edit_record.user_id,d=this.current_edit_record.total_time*e,a=this.current_edit_record.date_stamp,_=this.current_edit_record.absence_policy_id?this.current_edit_record.absence_policy_id:0;t&&a&&d&&this.api_absence_policy.getProjectedAbsencePolicyBalance(_,t,a,d,{onResult:function(e){i.edit_view_ui_dic&&i.edit_view_ui_dic.available_balance&&(i.getBalanceHandler(e,a),e&&i.selected_absence_policy_record?i.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").show():i.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").hide())}})}else 0!=this.current_edit_record.absence_policy_id&&this.current_edit_record.absence_policy_id!=TTUUID.zero_id||this.edit_view_ui_dic.available_balance&&this.edit_view_ui_dic.available_balance.parents(".edit-view-form-item-div").hide()}getFilterColumnsFromDisplayColumns(e){var i=[];e?this.authorization_history.authorization_history_grid&&(i=AuthorizationHistory.getAuthorizationHistoryDefaultDisplayColumns()):this.grid&&(i=this.grid.getGridParam("colModel"));var t={is_owner:!0,id:!0,is_child:!0,in_use:!0,first_name:!0,last_name:!0,user_id:!0,status_id:!0};if(i)for(var d=i.length,a=0;a<d;a++){t[i[a].name]=!0}return t}jobUIValidate(){return!(!PermissionManager.validate("job","enabled")||!PermissionManager.validate("punch","edit_job"))}jobItemUIValidate(){return!!PermissionManager.validate("punch","edit_job_item")}branchUIValidate(){return!!PermissionManager.validate("punch","edit_branch")}departmentUIValidate(){return!!PermissionManager.validate("punch","edit_department")}processAPICallbackResult(e){return this.current_edit_record=this.buildDataFromAPI(e[0]),this.current_edit_record.total_time=Global.getTimeUnit(this.current_edit_record.total_time),e}doViewClickResult(e){Global.isSet(this.current_edit_record.start_date)&&this.edit_view_tab&&this.edit_view_tab.find("#tab_request").find(".third-column").show(),this.initEditView(),this.initViewingView(),this.onWorkingStatusChanged();var i=this;return EmbeddedMessage.init(this.current_edit_record.id,50,this,this.edit_view,this.edit_view_tab,this.edit_view_ui_dic,(function(){i.authorization_history=AuthorizationHistory.init(i)})),this.clearCurrentSelectedRecord()}onViewClick(e,i){i&&this.clearEditView(),super.onViewClick(e)}setSubLogViewFilter(){return!!this.sub_log_view_controller&&(this.sub_log_view_controller.getSubViewFilter=function(e){return e.table_name_object_id={"request":[this.parent_edit_record.id],"request_schedule":[this.parent_edit_record.request_schedule_id]},e},!0)}initViewingView(){this.showAdvancedFields()}initEditViewUI(e,i){Global.setUINotready(),TTPromise.add("init","init"),TTPromise.wait();var t=this;this.edit_view&&this.edit_view.remove(),this.edit_view=$(Global.loadViewSource(e,i,null,!0)),this.edit_view_tab=$(this.edit_view.find(".edit-view-tab-bar")),this.edit_view_tab.attr("id",this.ui_id+"_edit_view_tab"),this.setTabOVisibility(!1),this.edit_view_tab=this.edit_view_tab.tabs({activate:function(e,i){t.onTabShow(e,i)}}),this.edit_view_tab.bind("tabsselect",(function(e,i){t.onTabIndexChange(e,i)})),Global.contentContainer().append(this.edit_view),this.initRightClickMenu(RightClickMenuType.EDITVIEW),this.is_viewing?(LocalCacheData.current_doing_context_action="view",this.buildViewUI()):this.is_edit&&(LocalCacheData.current_doing_context_action="edit",this.buildEditViewUI()),t.setEditViewTabHeight()}onEditClick(e,i){this.setCurrentEditViewState("edit"),this.initEditViewUI(this.viewId,this.edit_view_tpl),this.initEditView(),this.edit_view_ui_dic.body.setValue(""),this.setEditMenu()}buildViewUI(){super.buildEditViewUI();var e,i=this,t={"tab_request":{"label":$.i18n._("Request")},"tab_audit":!0};this.setTabModel(t),this.navigation.AComboBox({api_class:TTAPI.APIRequest,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_request",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var d=this.edit_view_tab.find("#tab_request"),a=d.find(".first-column");if(this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(a),(_=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"full_name"}),this.addEditFieldToColumn($.i18n._("Employee"),_,a),(_=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"type",set_empty:!1}),this.addEditFieldToColumn($.i18n._("Type"),_,a),(_=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"date_stamp"}),this.addEditFieldToColumn($.i18n._("Date"),_,a),Global.getProductEdition()>=15){var _;(_=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"request_schedule_status_id",set_empty:!1}),_.setSourceData({10:"Working",20:"Absent"}),this.addEditFieldToColumn($.i18n._("Status"),_,a),_.bind("change",(function(e){i.onWorkingStatusChanged()})),(_=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"start_date"}),this.addEditFieldToColumn($.i18n._("Start Date"),_,a,""),(_=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"end_date"}),this.addEditFieldToColumn($.i18n._("End Date"),_,a,"");var s=Global.loadWidgetByName(FormItemType.CHECKBOX);s.TCheckbox({field:"sun"});var r=Global.loadWidgetByName(FormItemType.CHECKBOX);r.TCheckbox({field:"mon"});var o=Global.loadWidgetByName(FormItemType.CHECKBOX);o.TCheckbox({field:"tue"});var l=Global.loadWidgetByName(FormItemType.CHECKBOX);l.TCheckbox({field:"wed"});var n=Global.loadWidgetByName(FormItemType.CHECKBOX);n.TCheckbox({field:"thu"});var c=Global.loadWidgetByName(FormItemType.CHECKBOX);c.TCheckbox({field:"fri"});var u=Global.loadWidgetByName(FormItemType.CHECKBOX);u.TCheckbox({field:"sat"}),e=$("<div></div>");var h=$("<span class='widget-top-label'> "+$.i18n._("Sun")+" <br>  </span>"),m=$("<span class='widget-top-label'> "+$.i18n._("Mon")+" <br>  </span>"),b=$("<span class='widget-top-label'> "+$.i18n._("Tue")+" <br>  </span>"),v=$("<span class='widget-top-label'> "+$.i18n._("Wed")+" <br>  </span>"),p=$("<span class='widget-top-label'> "+$.i18n._("Thu")+" <br>  </span>"),w=$("<span class='widget-top-label'> "+$.i18n._("Fri")+" <br>  </span>"),g=$("<span class='widget-top-label'> "+$.i18n._("Sat")+" <br>  </span>");if(h.append(s),m.append(r),b.append(o),v.append(l),p.append(n),w.append(c),g.append(u),e.append(h),e.append(m),e.append(b),e.append(v),e.append(p),e.append(w),e.append(g),e.addClass("request_edit_view_effective_days"),this.addEditFieldToColumn($.i18n._("Effective Days"),[s,r,o,l,n,c,u],a,"",e,!1,!0),(_=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"start_time"}),this.addEditFieldToColumn($.i18n._("In"),_,a),(_=Global.loadWidgetByName(FormItemType.TIME_PICKER)).TTimePicker({field:"end_time"}),this.addEditFieldToColumn($.i18n._("Out"),_,a),(_=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"total_time"}),this.addEditFieldToColumn($.i18n._("Total"),_,a),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APISchedulePolicy,allow_multiple_selection:!1,layout_name:"global_schedule",show_search_inputs:!0,set_empty:!0,field:"schedule_policy_id"}),this.addEditFieldToColumn($.i18n._("Schedule Policy"),_,a),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIAbsencePolicy,allow_multiple_selection:!1,layout_name:"global_absences",set_empty:!0,field:"absence_policy_id",customSearchFilter:function(e){return i.setAbsencePolicyFilter(e)},setRealValueCallBack:function(e){i.selected_absence_policy_record=e,i.onAvailableBalanceChange()}}),this.addEditFieldToColumn($.i18n._("Absence Policy"),_,a),(_=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"available_balance"}),e=$("<div class='widget-h-box'></div>"),this.available_balance_info=$('<img class="available-balance-info" src="'+Global.getRealImagePath("images/infox16x16.png")+'">'),e.append(_),e.append(this.available_balance_info),this.addEditFieldToColumn($.i18n._("Available Balance"),_,a,"",e,!0),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIBranch,allow_multiple_selection:!1,layout_name:"global_branch",show_search_inputs:!0,set_empty:!0,field:"branch_id"}),this.addEditFieldToColumn($.i18n._("Branch"),_,a),this.show_branch_ui||this.detachElement("branch_id"),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIDepartment,allow_multiple_selection:!1,layout_name:"global_department",show_search_inputs:!0,set_empty:!0,field:"department_id"}),this.addEditFieldToColumn($.i18n._("Department"),_,a),this.show_department_ui||this.detachElement("department_id"),Global.getProductEdition()>=20){(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIJob,allow_multiple_selection:!1,layout_name:"global_job",show_search_inputs:!0,set_empty:!0,setRealValueCallBack:function(e){e&&T.setValue(e.manual_id)},field:"job_id",added_items:[{value:"-1",label:Global.default_item},{value:"-2",label:Global.selected_item}]}),e=$("<div class='widget-h-box'></div>");var T=Global.loadWidgetByName(FormItemType.TEXT_INPUT);T.TTextInput({field:"job_quick_search",disable_keyup_event:!0}),T.addClass("job-coder"),e.append(T),e.append(_),this.addEditFieldToColumn($.i18n._("Job"),[_,T],a,"",e,!0),this.show_job_ui||this.detachElement("job_id"),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIJobItem,allow_multiple_selection:!1,layout_name:"global_job_item",show_search_inputs:!0,set_empty:!0,setRealValueCallBack:function(e){e&&y.setValue(e.manual_id)},field:"job_item_id",added_items:[{value:"-1",label:Global.default_item},{value:"-2",label:Global.selected_item}]}),e=$("<div class='widget-h-box'></div>");var y=Global.loadWidgetByName(FormItemType.TEXT_INPUT);y.TTextInput({field:"job_item_quick_search",disable_keyup_event:!0}),y.addClass("job-coder"),e.append(y),e.append(_),this.addEditFieldToColumn($.i18n._("Task"),[_,y],a,"",e,!0),this.show_job_item_ui||this.detachElement("job_item_id")}}EmbeddedMessage.initUI(this,d)}setAbsencePolicyFilter(e){return e.filter_data||(e.filter_data={}),e.filter_data.user_id=this.current_edit_record.user_id,e.filter_columns&&(e.filter_columns.absence_policy=!0),e}needShowNavigation(){return!!(this.is_viewing&&this.current_edit_record&&Global.isSet(this.current_edit_record.id)&&this.current_edit_record.id)}onNavigationClick(e){var i,t,d,a,_=this;switch(e){case ContextMenuIconName.timesheet:i={filter_data:{}},Global.isSet(this.current_edit_record)?(i.user_id=this.current_edit_record.user_id?this.current_edit_record.user_id:LocalCacheData.loginUser.id,i.base_date=this.current_edit_record.date_stamp,Global.addViewTab(_.viewId,$.i18n._("Authorization - Request"),window.location.href),IndexViewController.goToView("TimeSheet",i)):(t={},(d=this.getGridSelectIdArray()).length>0&&(a=d[0],t.filter_data={},t.filter_columns={user_id:!0,date_stamp:!0},t.filter_data.id=[a],this.api["get"+this.api.key_name](t,{onResult:function(e){var t=e.getResult();t||(t=[]),t=t[0],i.user_id=t.user_id,i.base_date=t.date_stamp,Global.addViewTab(_.viewId,$.i18n._("Authorization - Request"),window.location.href),IndexViewController.goToView("TimeSheet",i)}})));break;case ContextMenuIconName.edit_employee:i={filter_data:{}},Global.isSet(this.current_edit_record)?IndexViewController.openEditView(this,"Employee",this.current_edit_record.user_id?this.current_edit_record.user_id:LocalCacheData.loginUser.id):(t={},(d=this.getGridSelectIdArray()).length>0&&(a=d[0],t.filter_data={},t.filter_columns={user_id:!0},t.filter_data.id=[a],this.api["get"+this.api.key_name](t,{onResult:function(e){var i=e.getResult();i||(i=[]),i=i[0],IndexViewController.openEditView(_,"Employee",i.user_id)}})));break;case ContextMenuIconName.schedule:i={filter_data:{}};var s=null;Global.isSet(this.current_edit_record)?(s=[this.current_edit_record.user_id?this.current_edit_record.user_id:LocalCacheData.loginUser.id],i.filter_data.include_user_ids={value:s},i.select_date=this.current_edit_record.date_stamp,Global.addViewTab(_.viewId,$.i18n._("Authorization - Request"),window.location.href),IndexViewController.goToView("Schedule",i)):(t={},(d=this.getGridSelectIdArray()).length>0&&(a=d[0],t.filter_data={},t.filter_columns={user_id:!0,date_stamp:!0},t.filter_data.id=[a],this.api["get"+this.api.key_name](t,{onResult:function(e){var t=e.getResult();t||(t=[]),t=t[0],s=[t.user_id],i.filter_data.include_user_ids=s,i.select_date=t.date_stamp,Global.addViewTab(_.viewId,$.i18n._("Authorization - Request"),window.location.href),IndexViewController.goToView("Schedule",i)}})))}}initPermission(){PermissionManager.validate(this.permission_id,"view")||PermissionManager.validate(this.permission_id,"view_child")?this.show_search_tab=!0:this.show_search_tab=!1,this.jobUIValidate()?this.show_job_ui=!0:this.show_job_ui=!1,this.jobItemUIValidate()?this.show_job_item_ui=!0:this.show_job_item_ui=!1,this.branchUIValidate()?this.show_branch_ui=!0:this.show_branch_ui=!1,this.departmentUIValidate()?this.show_department_ui=!0:this.show_department_ui=!1;var e=TTAPI.APICompany;if(e&&_.isFunction(e.isBranchAndDepartmentAndJobAndJobItemEnabled))var i=e.isBranchAndDepartmentAndJobAndJobItemEnabled({async:!1}).getResult();i?(i.branch||(this.show_branch_ui=!1),i.department||(this.show_department_ui=!1),i.job||(this.show_job_ui=!1),i.job_item||(this.show_job_item_ui=!1)):(this.show_branch_ui=!1,this.show_department_ui=!1,this.show_job_ui=!1,this.show_job_item_ui=!1)}setEditMenuEditIcon(e,i){this.editPermissionValidate(i)||e.addClass("invisible-image"),this.editOwnerOrChildPermissionValidate(i)?this.enable_edit_view_ui=!0:this.enable_edit_view_ui=!1,(!this.editOwnerOrChildPermissionValidate(i)||this.is_add||this.is_edit)&&e.addClass("disable-image")}uniformMessageVariable(e){var i={};return i.subject=this.edit_view_ui_dic.subject.getValue(),i.body=this.edit_view_ui_dic.body.getValue(),i.object_id=this.current_edit_record.id,i.object_type_id=50,i}}}}]);
//# sourceMappingURL=common-RequestViewCommonController.bundle.js.map?v=200cb84fbb57fc86617c