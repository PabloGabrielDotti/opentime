{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/filebrowser/CameraBrowser.js","webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImage.js","webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageAdvBrowser.js","webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageBrowser.js","webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageCutArea.js","webpack://timetrex/./interface/html5/views/wizard/user_photo/UserPhotoWizardController.js"],"names":["$","fn","CameraBrowser","options","Global","addCss","field","opts","extend","defaults","$this","this","video","canvas","local_stream","stopCamera","stop","getTracks","forEach","track","showCamera","errorBack","TAlertManager","showAlert","i18n","_","navigator","getUserMedia","webkitGetUserMedia","mozGetUserMedia","msGetUserMedia","oGetUserMedia","mediaDevices","then","stream","srcObject","src","URL","createObjectURL","play","catch","err","window","webkitURL","setEnable","val","btn","children","eq","removeAttr","removeClass","attr","addClass","clearErrorStyle","getField","getValue","getFileName","getImageSrc","toDataURL","setImage","image","hide","d","Date","getTime","css","onImageLoad","show","setValue","each","o","meta","data","take_picture","try_again","prop","bind","parent","setTimeout","getContext","drawImage","trigger","glowAnimation","jQuery","TImage","document","on","e","$this_image_widget","target","parents","height","top","file_browser_overlay","append","find","showConfirmAlert","flag","type","message","time","off","remove","TImageAdvBrowser","result_form_data","accept_filter","default_width","default_height","callBack","getCookie","image_height","naturalHeight","image_width","width","naturalWidth","setEnableDelete","text","show_browser","isSet","name","deleteImageHandler","IndexViewController","openWizard","form_data","TImageBrowser","browser","setEnabled","FormData","changeHandler","FileReader","files","length","reader","readAsDataURL","onloadend","url","result","TImageCutArea","setAfterImage","imgAreaSelect","handles","x1","y1","x2","y2","onSelectEnd","img","selection","rate","sx","sy","getAfterImageSrc","clearSelect","i","$item","UserPhotoWizardController","BaseWizardController","el","super","title","steps","current_step","render","initCurrentStep","content_div","empty","next_btn","label","getLabel","combo_box","getComboBox","setSourceData","value","stepsWidgetDic","step_1_Data","stepsDataDic","image_type","getFileBrowser","getCameraBrowser","unbind","start","getImageCutArea","hide_form","current_step_data","current_step_ui","image_data","setWidgetEnabled","image_cut","img_src","onDoneClick","saveCurrentStep","image_source_array","after_img_src","split","file_name","call_back","onCloseClick","LocalCacheData","current_open_wizard_controller","hasClass","back_btn","default_data","getDefaultData","user_id","pay_period_id"],"mappings":"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","file":"wizard-user_photo-UserPhotoWizardController.bundle.js?v=59625448ea87b64aee06","sourcesContent":["( function( $ ) {\n\n\t$.fn.CameraBrowser = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.CameraBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\n\t\tvar enabled = true;\n\t\tvar video = null;\n\t\tvar canvas = null;\n\n\t\tvar local_stream = null;\n\n\t\tthis.stopCamera = function() {\n\n\t\t\tif ( local_stream ) {\n\t\t\t\tif ( local_stream.stop ) {\n\t\t\t\t\t// This is the legacy method to stop video.\n\t\t\t\t\tlocal_stream.stop();\n\t\t\t\t} else if ( local_stream.getTracks ) {\n\t\t\t\t\t// This is the modern approach for stopping the video. https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamTrack/stop\n\t\t\t\t\tlocal_stream.getTracks().forEach( track => track.stop() );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.showCamera = function() {\n\n\t\t\t// check for getUserMedia support\n\t\t\tnavigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;\n\t\t\tif ( navigator.mediaDevices && navigator.mediaDevices.getUserMedia ) {\n\t\t\t\t// Most up to date as of May 2020 (Aside from using async and await) https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n\n\t\t\t\t// get webcam feed if available\n\t\t\t\tnavigator.mediaDevices.getUserMedia( { video: true } )\n\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\tif ('srcObject' in video) {\n\t\t\t\t\t\t\tvideo.srcObject = stream;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Fallback for older browsers. https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/srcObject#Supporting_fallback_to_the_src_property\n\t\t\t\t\t\t\tvideo.src = URL.createObjectURL( stream );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\tlocal_stream = stream;\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function(err) {\n\t\t\t\t\t\terrorBack();\n\t\t\t\t\t});\n\t\t\t} else if ( navigator.getUserMedia ) {\n\t\t\t\t// Semi-deprecated, legacy, but still works. https://developer.mozilla.org/en-US/docs/Web/API/Navigator/getUserMedia\n\n\t\t\t\t// get webcam feed if available\n\t\t\t\tnavigator.getUserMedia( { video: true }, function( stream ) {\n\t\t\t\t\tif ('srcObject' in video) {\n\t\t\t\t\t\tvideo.srcObject = stream;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Fallback for older browsers. https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/srcObject#Supporting_fallback_to_the_src_property\n\t\t\t\t\t\tvideo.src = URL.createObjectURL( stream );\n\t\t\t\t\t}\n\t\t\t\t\tvideo.play();\n\t\t\t\t\tlocal_stream = stream;\n\t\t\t\t}, errorBack );\n\t\t\t} else if ( navigator.webkitGetUserMedia ) { // WebKit-prefixed\n\t\t\t\tnavigator.webkitGetUserMedia( { video: true }, function( stream ) {\n\t\t\t\t\tvideo.src = window.webkitURL.createObjectURL( stream );\n\t\t\t\t\tvideo.play();\n\t\t\t\t\tlocal_stream = stream;\n\t\t\t\t}, errorBack );\n\t\t\t} else if ( navigator.mozGetUserMedia ) { // Firefox-prefixed\n\t\t\t\tnavigator.mozGetUserMedia( { video: true }, function( stream ) {\n\t\t\t\t\tvideo.src = window.URL.createObjectURL( stream );\n\t\t\t\t\tvideo.play();\n\t\t\t\t\tlocal_stream = stream;\n\t\t\t\t}, errorBack );\n\t\t\t} else {\n\t\t\t\terrorBack();\n\t\t\t}\n\n\t\t\tfunction errorBack() {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Unable to access Camera.<br><br>Please check your camera connections, permissions, and ensure you are using HTTPS. Alternatively, use the File upload method instead.' ) );\n\t\t\t}\n\t\t};\n\n\t\tthis.setEnable = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.children().eq( 1 );\n\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.attr( 'disabled', true );\n\t\t\t\tbtn.removeClass( 'disable-element' ).addClass( 'disable-element' );\n\t\t\t} else {\n\t\t\t\tbtn.removeAttr( 'disabled' );\n\t\t\t\tbtn.removeClass( 'disable-element' );\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn false;\n\t\t};\n\n\t\tthis.getFileName = function() {\n\t\t\treturn 'camera_stream.png';\n\t\t};\n\n\t\tthis.getImageSrc = function() {\n\t\t\treturn canvas[0].toDataURL();\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tvar image = $this.children().eq( 0 );\n\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tthis.onImageLoad = function( image ) {\n\n//\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n//\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n//\n//\t\t\tif ( image_height > default_height ) {\n//\t\t\t\t$( image ).css( 'height', default_height );\n//\n//\t\t\t}\n//\n//\t\t\tif ( image_width > default_width ) {\n//\t\t\t\t$( image ).css( 'width', default_width );\n//\n//\t\t\t\t$( image ).css( 'height', 'auto' );\n//\t\t\t}\n//\n//\t\t\t$this.trigger( 'setSize' );\n\n\t\t\t$( image ).show();\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tvar $$this = this;\n\n\t\t\tvideo = $( this ).children().eq( 0 ).children().eq( 0 )[0];\n\t\t\tcanvas = $( this ).children().eq( 0 ).children().eq( 1 );\n\n\t\t\tvar take_picture = $( this ).children().eq( 1 ).children().eq( 0 );\n\t\t\tvar try_again = $( this ).children().eq( 1 ).children().eq( 1 );\n\n\t\t\t// Set initial states of the buttons.\n\t\t\ttake_picture.prop( 'disabled', false );\n\t\t\ttry_again.prop( 'disabled', true );\n\n\t\t\ttake_picture.bind( 'click', function() {\n\t\t\t\ttake_picture.prop( 'disabled', true );\n\t\t\t\ttry_again.prop( 'disabled', false );\n\t\t\t\t// Global.glowAnimation.start(); // not needed here as its triggered in UserPhotoWizardController.buildCurrentStepUI()\n\n\t\t\t\t// flash the photo area to indicate a picture has been taken.\n\t\t\t\tcanvas.parent().addClass( 'flash' );\n\n\t\t\t\tsetTimeout( function(){\n\t\t\t\t\tcanvas.parent().removeClass( 'flash' );\n\t\t\t\t}, 1000);\t// Timeout must be the same length as the CSS3 transition or longer (or you'll mess up the transition)\n\n\t\t\t\t// handle picture taking\n\t\t\t\tvar ctx = canvas[0].getContext( '2d' );\n\t\t\t\tctx.drawImage( video, 0, 0, 400, 300 );\n\t\t\t\tcanvas.css( 'z-index', 51 );\n\n\t\t\t\t$this.trigger( 'change', [$this] );\n\t\t\t} );\n\n\t\t\ttry_again.bind( 'click', function() {\n\t\t\t\ttake_picture.prop( 'disabled', false );\n\t\t\t\ttry_again.prop( 'disabled', true );\n\t\t\t\tGlobal.glowAnimation.stop();\n\n\t\t\t\tcanvas.css( 'z-index', -1 );\n\n\t\t\t\t$this.trigger( 'NoImageChange', [$this] );\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.CameraBrowser.defaults = {};\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TImage = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImage.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn null;\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\tthis.attr( 'src', '' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar d = new Date();\n\t\t\tthis.attr( 'src', val + '&t=' + d.getTime() );\n\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImage.defaults = {};\n\n\t$( document ).on( 'mouseover', '.file-browser img', function( e ) {\n\t\tvar $this_image_widget = $( e.target ).parents( '.file-browser' );\n\n\t\tif ( !$( '.file_browser_overlay' )[0] && $( e.target ).attr( 'enable-delete' ) == 1 ) {\n\t\t\tvar height = $( e.target ).height();\n\t\t\tvar top = ( height - 32 ) / 2;\n\t\t\tvar left = top;\n\n\t\t\tvar file_browser_overlay = $( '<div class=\"file_browser_overlay\"><img src=\"theme/default/images/delete-512.png\" style=\"position:absolute;width:32px;height:32px;top:' + top + 'px;left:' + left + 'px;\"></div>' );\n\t\t\tfile_browser_overlay.css( 'position', 'absolute' );\n\t\t\tfile_browser_overlay.css( 'top', '0px' );\n\t\t\tfile_browser_overlay.css( 'left', '0' );\n\t\t\tfile_browser_overlay.css( 'cursor', 'pointer' );\n\t\t\tfile_browser_overlay.css( 'height', height + 'px' );\n\t\t\tfile_browser_overlay.css( 'width', '100%' );\n\t\t\tfile_browser_overlay.css( 'background', 'rgba(255,255,255,0.85)' );\n\n\t\t\t$( e.target ).parents( '.file-browser' ).append( file_browser_overlay );\n\n\t\t\t$( document ).on( 'click', '.file_browser_overlay', function( e ) {\n\t\t\t\tvar img_src = $( e.target ).parent().find( 'img' ).attr( 'src' );\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'This will permanently delete the image. Are you sure?' ), '', function( flag ) {\n\t\t\t\t\tif ( flag ) {\n\t\t\t\t\t\tvar e = { type: 'deleteClick', message: 'Delete image clicked.', time: new Date() };\n\t\t\t\t\t\t$this_image_widget.trigger( e );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t$( document ).on( 'mouseleave', '.file-browser', function() {\n\t\t\t\t$( document ).off( 'click', '.file_browser_overlay' );\n\t\t\t\tif ( $( '.file_browser_overlay' )[0] ) {\n\t\t\t\t\tvar file_browser_overlay = $( this ).find( '.file_browser_overlay' );\n\t\t\t\t\tfile_browser_overlay.off().remove();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TImageAdvBrowser = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageAdvBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar name = 'filedata';\n\n\t\tvar accept_filter = '';\n\n\t\tvar default_width = 177;\n\t\tvar default_height = 42;\n\n\t\tvar callBack = null;\n\n\t\tvar enabled = true;\n\n\t\tvar image;\n\n\t\tvar result_form_data;\n\n\t\tthis.setEnable = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.children().eq( 1 );\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.hide();\n\t\t\t} else {\n\t\t\t\tbtn.show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn result_form_data;\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() + '&X-CSRF-Token=' + getCookie( 'CSRF-Token' ) );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tthis.onImageLoad = function( image ) {\n\n\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n\n\t\t\tif ( image_height > default_height ) {\n\t\t\t\t$( image ).css( 'height', default_height );\n\n\t\t\t}\n\n\t\t\tif ( image_width > default_width ) {\n\t\t\t\t$( image ).css( 'width', default_width );\n\t\t\t\t$( image ).css( 'height', 'auto' );\n\t\t\t}\n\n\t\t\t$this.trigger( 'setSize' );\n\n\t\t\tif ( image_height < 5 ) {\n\t\t\t\t$( image ).hide();\n\t\t\t} else {\n\t\t\t\t$( image ).show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setEnableDelete = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\tif ( !val ) {\n\t\t\t\timage.removeAttr( 'enable-delete' );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\timage.attr( 'enable-delete', 1 );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tvar $$this = this;\n\n\t\t\t$( this ).find( '#upload_image' ).text( $.i18n._( 'Upload Image' ) );\n\n\t\t\tif ( o.callBack ) {\n\t\t\t\tcallBack = o.callBack;\n\t\t\t}\n\n\t\t\tif ( o.show_browser === false ) {\n\t\t\t\t$( this ).children().eq( 1 ).hide();\n\t\t\t}\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( accept_filter ) ) {\n\t\t\t\taccept_filter = o.accept_filter;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.deleteImageHandler ) ) {\n\t\t\t\t$this.find( '.file-browser' ).on( 'deleteClick', function() {\n\t\t\t\t\to.deleteImageHandler();\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar browser = $( this ).children().eq( 1 );\n\t\t\tbrowser.bind( 'click', function() {\n\t\t\t\tIndexViewController.openWizard( 'UserPhotoWizard', null, function( form_data ) {\n\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack( form_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_form_data = form_data;\n\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\timage = $( this ).children().eq( 0 );\n\t\t\timage.on( 'load', function() {\n\t\t\t\t$this.onImageLoad( this );\n\t\t\t} );\n\n\t\t\timage.hide();\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageAdvBrowser.defaults = {};\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TImageBrowser = function( options ) {\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar id = 'file_browser';\n\t\tvar name = 'filedata';\n\t\tvar browser;\n\n\t\tvar accept_filter = '';\n\n\t\tvar default_width = 177;\n\t\tvar default_height = 42;\n\t\tvar enabled = true;\n\n\t\tthis.setEnabled = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.find( '.browser-form input' );\n\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.attr( 'disabled', true );\n\t\t\t\tbtn.removeClass( 'disable-element' ).addClass( 'disable-element' );\n\t\t\t} else {\n\t\t\t\tbtn.removeAttr( 'disabled' );\n\t\t\t\tbtn.removeClass( 'disable-element' );\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getFileName = function() {\n\n\t\t\treturn browser.val();\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.setEnableDelete = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\tif ( !val ) {\n\t\t\t\timage.removeAttr( 'enable-delete' );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\timage.attr( 'enable-delete', 1 );\n\t\t\t}\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\tvar form_data;\n\t\t\tif ( browser && browser.val() ) {\n\n\t\t\t\tif ( typeof FormData == 'undefined' ) {\n\t\t\t\t\tform_data = $this.find( '.browser-form' );\n\t\t\t\t} else {\n\t\t\t\t\tform_data = new FormData( $( $this.find( '.browser-form' ) )[0] );\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tform_data = null;\n\t\t\t}\n\n\t\t\treturn form_data;\n\t\t};\n\n\t\tthis.getImageSrc = function() {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\treturn image.attr( 'src' );\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tvar onImageLoad = function( image ) {\n\n\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n\n\t\t\tif ( image_height > default_height ) {\n\t\t\t\t$( image ).css( 'height', default_height );\n\n\t\t\t}\n\n\t\t\tif ( image_width > default_width ) {\n\t\t\t\t$( image ).css( 'width', default_width );\n\t\t\t\t$( image ).css( 'height', 'auto' );\n\t\t\t}\n\n\t\t\t$this.trigger( 'setSize' );\n\n\t\t\tif ( image_height < 5 ) {\n\t\t\t\t$( image ).hide();\n\t\t\t} else {\n\t\t\t\t$( image ).show();\n\t\t\t}\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.each( function() {\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\t// var $this = this;\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( accept_filter ) ) {\n\t\t\t\taccept_filter = o.accept_filter;\n\t\t\t}\n\n\t\t\tbrowser = $( this ).find( '.browser' );\n\t\t\tvar image = $( this ).find( '.image' );\n\t\t\timage.hide();\n\t\t\timage.on( 'load', function() {\n\t\t\t\tonImageLoad( this );\n\n\t\t\t} );\n\n\t\t\tif ( accept_filter ) {\n\t\t\t\tbrowser.attr( 'accept', accept_filter );\n\t\t\t} else {\n\t\t\t\taccept_filter = 'image/*';\n\t\t\t\tbrowser.attr( 'accept', 'image/*' );\n\t\t\t}\n\n\t\t\tbrowser.attr( 'id', id );\n\t\t\tbrowser.attr( 'name', name );\n\n\t\t\tif ( Global.isSet( o.changeHandler ) ) {\n\n\t\t\t\t$this.bind( 'imageChange', o.changeHandler );\n\t\t\t}\n\t\t\tif ( Global.isSet( o.deleteImageHandler ) ) {\n\t\t\t\tthis.find( '.file-browser' ).on( 'deleteClick', function() {\n\t\t\t\t\to.deleteImageHandler();\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tbrowser.bind( 'change', function() {\n\t\t\t\timage.hide();\n\n\t\t\t\tif ( typeof FileReader != 'undefined' ) {\n\n\t\t\t\t\tvar files = !!this.files ? this.files : [];\n\n\t\t\t\t\t// If no files were selected, or no FileReader support, return\n\t\t\t\t\tif ( !files.length || !window.FileReader ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( accept_filter === 'image/*' ) {\n\t\t\t\t\t\t// Create a new instance of the FileReader\n\t\t\t\t\t\tvar reader = new FileReader();\n\n\t\t\t\t\t\t// Read the local file as a DataURL\n\t\t\t\t\t\treader.readAsDataURL( files[0] );\n\n\t\t\t\t\t\t// When loaded, set image data as background of div\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar url = this.result;\n\t\t\t\t\t\t\timage.attr( 'src', url );\n\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t$this.trigger( 'imageChange', [$this] );\n\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageBrowser.defaults = {};\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TImageCutArea = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageCutArea.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar name = 'filedata';\n\n\t\tvar default_width = 400;\n\t\tvar default_height = 300;\n\n\t\tvar default_after_width = 200;\n\t\tvar default_after_height = 150;\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\n\t\t};\n\n\t\tvar setAfterImage = function( val ) {\n\t\t\tvar image = $this.children().eq( 1 ).children().eq( 1 );\n\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar d = new Date();\n\t\t\timage.attr( 'src', val );\n\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tvar image = $this.children().eq( 0 ).children().eq( 1 );\n\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar d = new Date();\n\t\t\timage.attr( 'src', val );\n\n\t\t\tsetAfterImage( val );\n\n\t\t\tsetTimeout( function() {\n\t\t\t\t$( image ).imgAreaSelect( {\n\t\t\t\t\thandles: true,\n\t\t\t\t\tx1: 0,\n\t\t\t\t\ty1: 0,\n\t\t\t\t\tx2: $( image ).width(),\n\t\t\t\t\ty2: $( image ).height(),\n\t\t\t\t\tonSelectEnd: function( img, selection ) {\n\n\t\t\t\t\t\tvar rate = image[0].naturalWidth / image.width();\n\t\t\t\t\t\tvar sx = selection.x1 * rate;\n\t\t\t\t\t\tvar sy = selection.y1 * rate;\n\t\t\t\t\t\tvar tx = selection.x2 * rate;\n\t\t\t\t\t\tvar ty = selection.y2 * rate - 1;\n\t\t\t\t\t\tvar width = selection.width * rate;\n\t\t\t\t\t\tvar height = selection.height * rate;\n\n\t\t\t\t\t\tvar canvas = $( '<canvas></canvas>' );\n\t\t\t\t\t\tcanvas = canvas[0];\n\t\t\t\t\t\tcanvas.width = width;\n\t\t\t\t\t\tcanvas.height = height;\n\t\t\t\t\t\tvar ctx = canvas.getContext( '2d' );\n\n\t\t\t\t\t\tctx.drawImage( image[0], sx, sy, width - 1, height - 1, 0, 0, width, height );\n\t\t\t\t\t\tsetAfterImage( '' );\n\t\t\t\t\t\tsetAfterImage( canvas.toDataURL() );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}, 100 );\n\n\t\t};\n\n\t\tthis.getAfterImageSrc = function() {\n\t\t\tvar image = $this.children().eq( 1 ).children().eq( 1 );\n\n\t\t\treturn image.attr( 'src' );\n\t\t};\n\n\t\tthis.clearSelect = function() {\n\t\t\tvar image = $this.children().eq( 0 ).children().eq( 1 );\n\n\t\t\t$( image ).imgAreaSelect( { remove: true } );\n\n\t\t};\n\n\t\tvar onImageLoad = function( image ) {\n\n//\t\t\tif ( $( image ).height() > default_height ) {\n//\t\t\t\t$( image ).css( 'height', default_height );\n//\n//\t\t\t}\n//\n//\t\t\tif ( $( image ).width() > default_width ) {\n//\t\t\t\t$( image ).css( 'width', default_width );\n//\n//\t\t\t\t$( image ).css( 'height', 'auto' );\n//\t\t\t}\n\n//\t\t\t$( image ).show();\n\n\t\t};\n\n\t\tvar onAfterImageLoad = function( image ) {\n\n//\t\t\tif ( $( image ).height() > default_after_height ) {\n//\t\t\t\t$( image ).css( 'height', default_after_height );\n//\n//\t\t\t}\n//\n//\t\t\tif ( $( image ).width() > default_after_width ) {\n//\t\t\t\t$( image ).css( 'width', default_after_width );\n//\n//\t\t\t\t$( image ).css( 'height', 'auto' );\n//\t\t\t}\n\n//\t\t\t$( image ).show();\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tfor ( var i = 0; i < this.length; i++ ) {\n\t\t\tvar $item = this[i];\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( $item ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tvar image = $( $item ).children().eq( 0 ).children().eq( 1 );\n\t\t\timage.on( 'load', function() {\n\t\t\t\tonImageLoad( this );\n\n\t\t\t} );\n\n\t\t\tvar after_image = $( $item ).children().eq( 1 ).children().eq( 1 );\n\t\t\tafter_image.on( 'load', function() {\n\t\t\t\tonAfterImageLoad( this );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageCutArea.defaults = {};\n\n} )( jQuery );","import '@/global/widgets/filebrowser/TImageBrowser';\nimport '@/global/widgets/filebrowser/CameraBrowser';\nimport '@/global/widgets/filebrowser/TImageAdvBrowser';\nimport '@/global/widgets/filebrowser/TImage';\nimport '@/global/widgets/filebrowser/TImageCutArea';\n\nexport class UserPhotoWizardController extends BaseWizardController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '.wizard-bg',\n\n\t\t\t// _required_files: [\n\t\t\t// \t'TImageBrowser', //only in the upload wizard\n\t\t\t// \t'CameraBrowser', //only in the upload wizard\n\t\t\t// \t'TImageAdvBrowser',//only in the upload wizard\n\t\t\t// \t'TImage',//only in the upload wizard\n\t\t\t// \t'TImageCutArea'//only in the upload wizard\n\t\t\t// ]\n\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\n\t\tthis.title = $.i18n._( 'Image upload Wizard' );\n\t\tthis.steps = 3;\n\t\tthis.current_step = 1;\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tsuper.render();\n\n\t\tthis.initCurrentStep();\n\t}\n\n\t//Create each page UI\n\tbuildCurrentStepUI() {\n\n\t\tvar $this = this;\n\n\t\tthis.content_div.empty();\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\t$this.next_btn.removeClass( 'disable-image' );\n\t\t\t\tvar label = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Please choose the image source' ) );\n\n\t\t\t\tvar combo_box = this.getComboBox( 'image_type' );\n\n\t\t\t\tcombo_box.setSourceData( [\n\t\t\t\t\t{ value: 'file', label: $.i18n._( 'File' ) },\n\t\t\t\t\t{ value: 'camera', label: $.i18n._( 'Camera' ) }\n\t\t\t\t] );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][combo_box.getField()] = combo_box;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( combo_box );\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\n\t\t\t\tvar step_1_Data = this.stepsDataDic[1];\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tvar img;\n\t\t\t\tif ( step_1_Data.image_type === 'file' ) {\n\t\t\t\t\tlabel.text( $.i18n._( 'Choose image file to upload' ) );\n\t\t\t\t\timg = this.getFileBrowser( 'image_data', null, 500, 350 );\n\t\t\t\t} else {\n\t\t\t\t\tlabel.text( $.i18n._( 'Take picture from camera' ) );\n\t\t\t\t\timg = this.getCameraBrowser( 'image_data' );\n\n\t\t\t\t\timg.unbind( 'NoImageChange' ).bind( 'NoImageChange', function() {\n\t\t\t\t\t\t$this.next_btn.addClass( 'disable-image' );\n\t\t\t\t\t\t// Stop the button glow when 'Try Again' is clicked.\n\t\t\t\t\t\tGlobal.glowAnimation.stop( $this.next_btn );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\timg.unbind( 'change' ).bind( 'change', function() {\n\t\t\t\t\t$this.next_btn.removeClass( 'disable-image' );\n\t\t\t\t\t// Start the button glow when 'Take Picture' or 'Try Again' is clicked.\n\t\t\t\t\tGlobal.glowAnimation.start( $this.next_btn, '#00ff00' );\n\t\t\t\t} );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][img.getField()] = img;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( img );\n\t\t\t\t$this.next_btn.addClass( 'disable-image' );\n\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\t$this.next_btn.removeClass( 'disable-image' );\n\n\t\t\t\tlabel = this.getLabel();\n\t\t\t\tlabel.text( $.i18n._( 'Crop and resize image' ) );\n\n\t\t\t\timg = this.getImageCutArea( 'image_cut' );\n\t\t\t\tthis.stepsWidgetDic[this.current_step] = {};\n\t\t\t\tthis.stepsWidgetDic[this.current_step][img.getField()] = img;\n\n\t\t\t\tvar hide_form = $( ' <form enctype=\"multipart/form-data\" class=\"browser-form\"></form>' );\n\n\t\t\t\tthis.stepsWidgetDic[this.current_step]['hide_form'] = hide_form;\n\n\t\t\t\tthis.content_div.append( label );\n\t\t\t\tthis.content_div.append( img );\n\t\t\t\tthis.content_div.append( hide_form );\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tbuildCurrentStepData() {\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tif ( current_step_data ) {\n\t\t\t\t\tcurrent_step_ui.image_type.setValue( current_step_data.image_type );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tif ( this.stepsDataDic[1].image_type === 'camera' ) {\n\t\t\t\t\tcurrent_step_ui.image_data.showCamera();\n\t\t\t\t}\n\n\t\t\t\tGlobal.setWidgetEnabled( this.next_btn, false );\n\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcurrent_step_ui.image_cut.setImage( this.stepsDataDic[2].img_src );\n\t\t}\n\t}\n\n\tonDoneClick() {\n\t\tvar $this = this;\n\t\tsuper.onDoneClick();\n\t\tthis.saveCurrentStep();\n\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\n\t\tvar form_data = new FormData( current_step_ui.hide_form[0] );\n\n\t\tvar image_source_array = current_step_data.after_img_src && current_step_data.after_img_src.split( ',' );\n\n\t\tvar args = {};\n\n\t\t//Error: TypeError: current_step_data.after_img_src is undefined in interface/html5/framework/jquery.min.js?v=9.0.0-20151016-110437 line 2 > eval line 129\n\t\tif ( image_source_array && image_source_array.length > 0 ) {\n\t\t\tform_data.append( 'file_data', image_source_array[1] );\n\t\t\tform_data.append( 'base64_encoded', true );\n\t\t\tform_data.append( 'mime_type', image_source_array[0].split( ';' )[0].split( ':' )[1] );\n\t\t\tform_data.append( 'file_name', this.stepsDataDic[2].file_name );\n\n\t\t\tif ( this.call_back ) {\n\t\t\t\tthis.call_back( form_data );\n\t\t\t}\n\t\t}\n\n\t\t$this.onCloseClick();\n\t}\n\n\tonCloseClick() {\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tif ( this.current_step === 3 ) {\n\t\t\tcurrent_step_ui.image_cut.clearSelect();\n\t\t}\n\n\t\tif ( this.current_step === 2 && this.stepsDataDic[1].image_type === 'camera' ) {\n\t\t\tcurrent_step_ui.image_data.stopCamera();\n\t\t}\n\n\t\t$( this.el ).remove();\n\t\tLocalCacheData.current_open_wizard_controller = null;\n\t}\n\n\tonNextClick() {\n\t\tif ( this.next_btn.hasClass( 'disable-image' ) ) {\n\t\t\treturn;\n\t\t}\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tif ( this.current_step === 3 ) {\n\t\t\tcurrent_step_ui.image_cut.clearSelect();\n\t\t}\n\t\tif ( this.current_step === 2 && this.stepsDataDic[1].image_type === 'camera' ) {\n\t\t\tcurrent_step_ui.image_data.stopCamera();\n\t\t\t// Stop the button glow when 'Next Button' is clicked.\n\t\t\tGlobal.glowAnimation.stop( this.next_btn );\n\t\t}\n\t\tthis.saveCurrentStep();\n\t\tthis.current_step = this.current_step + 1;\n\t\tthis.initCurrentStep();\n\t}\n\n\tonBackClick() {\n\t\tif ( this.back_btn.hasClass( 'disable-image' ) ) {\n\t\t\treturn;\n\t\t}\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tif ( this.current_step === 3 ) {\n\t\t\tcurrent_step_ui.image_cut.clearSelect();\n\t\t}\n\t\tif ( this.current_step === 2 && this.stepsDataDic[1].image_type === 'camera' ) {\n\t\t\tcurrent_step_ui.image_data.stopCamera();\n\t\t\t// Stop the button glow when 'Back Button' is clicked.\n\t\t\tGlobal.glowAnimation.stop( this.next_btn );\n\n\t\t}\n\t\tthis.saveCurrentStep();\n\t\tthis.current_step = this.current_step - 1;\n\t\tthis.initCurrentStep();\n\t}\n\n\tsaveCurrentStep() {\n\t\tthis.stepsDataDic[this.current_step] = {};\n\t\tvar current_step_data = this.stepsDataDic[this.current_step];\n\t\tvar current_step_ui = this.stepsWidgetDic[this.current_step];\n\t\tswitch ( this.current_step ) {\n\t\t\tcase 1:\n\t\t\t\tcurrent_step_data.image_type = current_step_ui.image_type.getValue();\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcurrent_step_data.img_src = current_step_ui.image_data.getImageSrc();\n\t\t\t\tcurrent_step_data.file_name = current_step_ui.image_data.getFileName();\n\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\n\t\t\t\tcurrent_step_data.after_img_src = current_step_ui.image_cut.getAfterImageSrc();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetDefaultDataToSteps() {\n\n\t\tif ( !this.default_data ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.stepsDataDic[2] = {};\n\t\tthis.stepsDataDic[3] = {};\n\n\t\tif ( this.getDefaultData( 'user_id' ) ) {\n\t\t\tthis.stepsDataDic[3].user_id = this.getDefaultData( 'user_id' );\n\t\t}\n\n\t\tif ( this.getDefaultData( 'pay_period_id' ) ) {\n\t\t\tthis.stepsDataDic[2].pay_period_id = this.getDefaultData( 'pay_period_id' );\n\t\t}\n\t}\n\n}"],"sourceRoot":""}