{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImage.js","webpack://timetrex/./interface/html5/global/widgets/filebrowser/TImageAdvBrowser.js","webpack://timetrex/./interface/html5/views/company/legal_entity/LegalEntityViewController.js"],"names":["$","fn","TImage","options","Global","addCss","field","opts","extend","defaults","this","clearErrorStyle","getField","getValue","setValue","val","d","Date","attr","getTime","each","o","meta","data","document","on","e","$this_image_widget","target","parents","height","top","file_browser_overlay","css","append","parent","find","TAlertManager","showConfirmAlert","i18n","_","flag","type","message","time","trigger","off","remove","jQuery","TImageAdvBrowser","image","result_form_data","$this","accept_filter","default_width","default_height","callBack","setEnable","btn","children","eq","show","hide","setImage","getCookie","onImageLoad","image_height","naturalHeight","image_width","width","naturalWidth","setEnableDelete","removeAttr","text","show_browser","isSet","name","deleteImageHandler","bind","IndexViewController","openWizard","form_data","LegalEntityViewController","BaseViewController","el","status_array","type_array","classification_code_array","country_array","province_array","e_province_array","payment_services_status_array","company_api","super","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","navigation_label","api","TTAPI","APILegalEntity","APICompany","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","initDropDownOption","select_value","search_panel","getSelectTabIndex","basic_search_field_ui_dic","setProvince","adv_search_field_ui_dic","url","current_edit_record","id","getBaseURL","Debug","Text","onPaymentServicesStatusChange","setEditViewDataDone","file_browser","getLogoUrl","exclude","ContextMenuIconName","export_excel","include","label","payment_services_statement","group","icon","Icons","payroll_export_report","doNotSetFocus","setDefaultMenu","len","context_menu_array","length","grid_selected_length","getGridSelectIdArray","i","context_btn","setDefaultMenuPaymentServicesStatementIcon","pId","removeClass","addClass","onPaymentServicesStatementClick","doFormIFrameCall","0","1","postData","APIFileDownload","className","change","proxy","selectVal","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","key","c_value","toString","eSetProvince","validate","onCountryChange","initOptions","getLegalEntity","filter_items_per_page","onResult","result","record","getResult","initEditViewUI","initEditView","openEditView","attachElement","detachElement","editFieldResize","buildEditViewUI","form_item_input","tab_model","setTabModel","navigation","AComboBox","api_class","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_legal_entity_column1","edit_view_tab","edit_view_tabs","push","tab_payment_services_column1","loadWidgetByName","FormItemType","COMBO_BOX","TComboBox","setSourceData","addEditFieldToColumn","TEXT_INPUT","TTextInput","set_empty","DATE_PICKER","TDatePicker","FormData","IMAGE_BROWSER","TImageBrowser","ServiceCaller","uploadFile","toLowerCase","showAlert","IMAGE_AVD_BROWSER","is_edit","deleteImage","onDeleteImage","m","getOptions","res","buildRecordArray","refresh","province_widget","edit_view_ui_dic","province","value","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type","AWESOME_BOX","object_type_id","APIUser"],"mappings":"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","file":"company-legal_entity-LegalEntityViewController.bundle.js?v=935c61735d0fe01ae799","sourcesContent":["( function( $ ) {\n\n\t$.fn.TImage = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImage.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn null;\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\tthis.attr( 'src', '' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar d = new Date();\n\t\t\tthis.attr( 'src', val + '&t=' + d.getTime() );\n\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImage.defaults = {};\n\n\t$( document ).on( 'mouseover', '.file-browser img', function( e ) {\n\t\tvar $this_image_widget = $( e.target ).parents( '.file-browser' );\n\n\t\tif ( !$( '.file_browser_overlay' )[0] && $( e.target ).attr( 'enable-delete' ) == 1 ) {\n\t\t\tvar height = $( e.target ).height();\n\t\t\tvar top = ( height - 32 ) / 2;\n\t\t\tvar left = top;\n\n\t\t\tvar file_browser_overlay = $( '<div class=\"file_browser_overlay\"><img src=\"theme/default/images/delete-512.png\" style=\"position:absolute;width:32px;height:32px;top:' + top + 'px;left:' + left + 'px;\"></div>' );\n\t\t\tfile_browser_overlay.css( 'position', 'absolute' );\n\t\t\tfile_browser_overlay.css( 'top', '0px' );\n\t\t\tfile_browser_overlay.css( 'left', '0' );\n\t\t\tfile_browser_overlay.css( 'cursor', 'pointer' );\n\t\t\tfile_browser_overlay.css( 'height', height + 'px' );\n\t\t\tfile_browser_overlay.css( 'width', '100%' );\n\t\t\tfile_browser_overlay.css( 'background', 'rgba(255,255,255,0.85)' );\n\n\t\t\t$( e.target ).parents( '.file-browser' ).append( file_browser_overlay );\n\n\t\t\t$( document ).on( 'click', '.file_browser_overlay', function( e ) {\n\t\t\t\tvar img_src = $( e.target ).parent().find( 'img' ).attr( 'src' );\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'This will permanently delete the image. Are you sure?' ), '', function( flag ) {\n\t\t\t\t\tif ( flag ) {\n\t\t\t\t\t\tvar e = { type: 'deleteClick', message: 'Delete image clicked.', time: new Date() };\n\t\t\t\t\t\t$this_image_widget.trigger( e );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t$( document ).on( 'mouseleave', '.file-browser', function() {\n\t\t\t\t$( document ).off( 'click', '.file_browser_overlay' );\n\t\t\t\tif ( $( '.file_browser_overlay' )[0] ) {\n\t\t\t\t\tvar file_browser_overlay = $( this ).find( '.file_browser_overlay' );\n\t\t\t\t\tfile_browser_overlay.off().remove();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t} );\n\n} )( jQuery );","( function( $ ) {\n\n\t$.fn.TImageAdvBrowser = function( options ) {\n\n\t\tGlobal.addCss( 'global/widgets/filebrowser/TImageBrowser.css' );\n\t\tvar opts = $.extend( {}, $.fn.TImageAdvBrowser.defaults, options );\n\n\t\tvar $this = this;\n\t\tvar field;\n\t\tvar name = 'filedata';\n\n\t\tvar accept_filter = '';\n\n\t\tvar default_width = 177;\n\t\tvar default_height = 42;\n\n\t\tvar callBack = null;\n\n\t\tvar enabled = true;\n\n\t\tvar image;\n\n\t\tvar result_form_data;\n\n\t\tthis.setEnable = function( val ) {\n\t\t\tenabled = val;\n\n\t\t\tvar btn = this.children().eq( 1 );\n\t\t\tif ( !val ) {\n\t\t\t\tbtn.hide();\n\t\t\t} else {\n\t\t\t\tbtn.show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tthis.getValue = function() {\n\t\t\treturn result_form_data;\n\t\t};\n\n\t\tthis.setImage = function( val ) {\n\t\t\tif ( !val ) {\n\t\t\t\timage.attr( 'src', '' );\n\t\t\t\timage.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar d = new Date();\n\t\t\timage.hide();\n\t\t\timage.attr( 'src', val + '&t=' + d.getTime() + '&X-CSRF-Token=' + getCookie( 'CSRF-Token' ) );\n\t\t\timage.css( 'height', 'auto' );\n\t\t\timage.css( 'width', 'auto' );\n\n\t\t};\n\n\t\tthis.onImageLoad = function( image ) {\n\n\t\t\tvar image_height = $( image ).height() > 0 ? $( image ).height() : image.naturalHeight;\n\t\t\tvar image_width = $( image ).width() > 0 ? $( image ).width() : image.naturalWidth;\n\n\t\t\tif ( image_height > default_height ) {\n\t\t\t\t$( image ).css( 'height', default_height );\n\n\t\t\t}\n\n\t\t\tif ( image_width > default_width ) {\n\t\t\t\t$( image ).css( 'width', default_width );\n\t\t\t\t$( image ).css( 'height', 'auto' );\n\t\t\t}\n\n\t\t\t$this.trigger( 'setSize' );\n\n\t\t\tif ( image_height < 5 ) {\n\t\t\t\t$( image ).hide();\n\t\t\t} else {\n\t\t\t\t$( image ).show();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t};\n\n\t\tthis.setEnableDelete = function( val ) {\n\t\t\tvar image = $this.find( '.image' );\n\t\t\tif ( !val ) {\n\t\t\t\timage.removeAttr( 'enable-delete' );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\timage.attr( 'enable-delete', 1 );\n\t\t\t}\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tvar $$this = this;\n\n\t\t\t$( this ).find( '#upload_image' ).text( $.i18n._( 'Upload Image' ) );\n\n\t\t\tif ( o.callBack ) {\n\t\t\t\tcallBack = o.callBack;\n\t\t\t}\n\n\t\t\tif ( o.show_browser === false ) {\n\t\t\t\t$( this ).children().eq( 1 ).hide();\n\t\t\t}\n\n\t\t\tif ( o.default_width > 0 ) {\n\t\t\t\tdefault_width = o.default_width;\n\t\t\t}\n\n\t\t\tif ( o.default_height > 0 ) {\n\t\t\t\tdefault_height = o.default_height;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.name ) ) {\n\t\t\t\tname = o.name;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( accept_filter ) ) {\n\t\t\t\taccept_filter = o.accept_filter;\n\t\t\t}\n\n\t\t\tif ( Global.isSet( o.deleteImageHandler ) ) {\n\t\t\t\t$this.find( '.file-browser' ).on( 'deleteClick', function() {\n\t\t\t\t\to.deleteImageHandler();\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar browser = $( this ).children().eq( 1 );\n\t\t\tbrowser.bind( 'click', function() {\n\t\t\t\tIndexViewController.openWizard( 'UserPhotoWizard', null, function( form_data ) {\n\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack( form_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_form_data = form_data;\n\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\timage = $( this ).children().eq( 0 );\n\t\t\timage.on( 'load', function() {\n\t\t\t\t$this.onImageLoad( this );\n\t\t\t} );\n\n\t\t\timage.hide();\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TImageAdvBrowser.defaults = {};\n\n} )( jQuery );","import '@/global/widgets/filebrowser/TImage';\nimport '@/global/widgets/filebrowser/TImageAdvBrowser';\n\nexport class LegalEntityViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#legal_entity_view_container',\n\n\t\t\t// _required_files: ['TImage', 'TImageAdvBrowser'],\n\n\t\t\tstatus_array: null,\n\t\t\ttype_array: null,\n\t\t\tclassification_code_array: null,\n\t\t\tcountry_array: null,\n\t\t\tprovince_array: null,\n\t\t\te_province_array: null,\n\n\t\t\tpayment_services_status_array: null,\n\n\t\t\tcompany_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit() {\n\t\t//this._super('initialize' );\n\t\tthis.edit_view_tpl = 'LegalEntityEditView.html';\n\t\tthis.permission_id = 'legal_entity';\n\t\tthis.viewId = 'LegalEntity';\n\t\tthis.script_name = 'LegalEntityView';\n\t\tthis.table_name_key = 'legal_entity';\n\t\tthis.context_menu_name = $.i18n._( 'Legal Entities' );\n\t\tthis.navigation_label = $.i18n._( 'Legal Entity' ) + ':';\n\t\tthis.api = TTAPI.APILegalEntity;\n\t\tthis.company_api = TTAPI.APICompany;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'status' );\n\t\tthis.initDropDownOption( 'type' );\n\t\tthis.initDropDownOption( 'classification_code' );\n\t\tthis.initDropDownOption( 'country', 'country', this.company_api );\n\n\t\tthis.initDropDownOption( 'payment_services_status' );\n\t}\n\n\tonSetSearchFilterFinished() {\n\t\tvar combo;\n\t\tvar select_value;\n\t\tif ( this.search_panel.getSelectTabIndex() === 0 ) {\n\t\t\tcombo = this.basic_search_field_ui_dic['country'];\n\t\t\tselect_value = combo.getValue();\n\t\t\tthis.setProvince( select_value );\n\t\t} else if ( this.search_panel.getSelectTabIndex() === 1 ) {\n\t\t\tcombo = this.adv_search_field_ui_dic['country'];\n\t\t\tselect_value = combo.getValue();\n\t\t\tthis.setProvince( select_value );\n\t\t}\n\t}\n\n\tgetLogoUrl() {\n\t\tvar url = false;\n\t\tif ( this.current_edit_record.id ) {\n\t\t\turl = Global.getBaseURL() + '../send_file.php?api=1&object_type=legal_entity_logo&object_id=' + this.current_edit_record.id;\n\t\t}\n\t\tDebug.Text( url, 'LegalEntityViewController.js', 'LegalEntityViewController', 'getLogoUrl', 10 );\n\t\treturn url;\n\t}\n\n\tsetEditViewDataDone() {\n\t\tthis.onPaymentServicesStatusChange();\n\t\tsuper.setEditViewDataDone();\n\t\tthis.file_browser.setImage( this.getLogoUrl() );\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: [ContextMenuIconName.export_excel],\n\t\t\tinclude: [{\n\t\t\t\tlabel: $.i18n._( 'Payment Services<br>Statement' ),\n\t\t\t\tid: ContextMenuIconName.payment_services_statement,\n\t\t\t\tgroup: 'other',\n\t\t\t\ticon: Icons.payroll_export_report,\n\t\t\t\t// sort_order: 8000 // TODO: what is this for? Is it needed? From copy/paste\n\t\t\t}]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tsetDefaultMenu( doNotSetFocus ) {\n\n\t\tsuper.setDefaultMenu( doNotSetFocus );\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.payment_services_statement:\n\t\t\t\t\tthis.setDefaultMenuPaymentServicesStatementIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tsetDefaultMenuPaymentServicesStatementIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.payment_services_statement:\n\t\t\t\tthis.onPaymentServicesStatementClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonPaymentServicesStatementClick() {\n\t\tvar post_data = { 0: null, 1: null }; //Eventually we could pass start/end dates.\n\t\tthis.doFormIFrameCall( post_data );\n\t}\n\n\tdoFormIFrameCall( postData ) {\n\t\tGlobal.APIFileDownload( this.api.className, 'get' + 'PaymentServicesAccountStatementReport', postData );\n\t}\n\n\tonBuildAdvUIFinished() {\n\n\t\tthis.adv_search_field_ui_dic['country'].change( $.proxy( function() {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar selectVal = combo.getValue();\n\n\t\t\tthis.setProvince( selectVal );\n\n\t\t\tthis.adv_search_field_ui_dic['province'].setValue( null );\n\n\t\t}, this ) );\n\t}\n\n\tonBuildBasicUIFinished() {\n\t\tthis.basic_search_field_ui_dic['country'].change( $.proxy( function() {\n\t\t\tvar combo = this.basic_search_field_ui_dic['country'];\n\t\t\tvar selectVal = combo.getValue();\n\n\t\t\tthis.setProvince( selectVal );\n\n\t\t\tthis.basic_search_field_ui_dic['province'].setValue( null );\n\n\t\t}, this ) );\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tswitch ( key ) {\n\t\t\tcase 'country':\n\t\t\t\tif ( c_value.toString() === this.current_edit_record[key].toString() ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.eSetProvince( c_value );\n\t\t\t\tbreak;\n\t\t\tcase 'payment_services_status_id':\n\t\t\t\tthis.current_edit_record[key] = c_value;\n\t\t\t\tthis.onPaymentServicesStatusChange();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tif ( key === 'country' ) {\n\t\t\tthis.onCountryChange();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\topenEditView( id ) {\n\t\tif ( id == false ) {\n\t\t\tvar $this = this;\n\t\t\tthis.initOptions();\n\t\t\tthis.api.getLegalEntity( { filter_items_per_page: 1 }, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tvar record = result.getResult();\n\t\t\t\t\tif ( typeof record == 'object' ) {\n\t\t\t\t\t\t$this.initEditViewUI( $this.viewId, $this.edit_view_tpl );\n\t\t\t\t\t\t$this.current_edit_record = record[0];\n\t\t\t\t\t\t$this.initEditView();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tsuper.openEditView();\n\t\t}\n\t}\n\n\tonPaymentServicesStatusChange() {\n\t\tif ( this.current_edit_record && this.current_edit_record['payment_services_status_id'] == 10 ) {\n\t\t\tthis.attachElement( 'payment_services_user_name' );\n\t\t\tthis.attachElement( 'payment_services_api_key' );\n\t\t} else {\n\t\t\tthis.detachElement( 'payment_services_user_name' );\n\t\t\tthis.detachElement( 'payment_services_api_key' );\n\t\t}\n\n\t\tthis.editFieldResize();\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_legal_entity': { 'label': $.i18n._( 'Legal Entity' ) },\n\t\t\t'tab_payment_services': { 'label': $.i18n._( 'Payment Services' ), 'display_on_mass_edit': false },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tvar form_item_input;\n\n\t\tif ( this.navigation ) {\n\t\t\tthis.navigation.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APILegalEntity,\n\t\t\t\tid: this.script_name + '_navigation',\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_legal_entity',\n\t\t\t\tnavigation_mode: true,\n\t\t\t\tshow_search_inputs: true\n\t\t\t} );\n\n\t\t\tthis.setNavigation();\n\t\t}\n\n\t\t//Tab 0 start\n\t\tvar tab_legal_entity = this.edit_view_tab.find( '#tab_legal_entity' );\n\t\tvar tab_legal_entity_column1 = tab_legal_entity.find( '.first-column' );\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_legal_entity_column1 );\n\n\t\t//Payment Services Tab\n\t\tvar tab_payment_services = this.edit_view_tab.find( '#tab_payment_services' );\n\t\tvar tab_payment_services_column1 = tab_payment_services.find( '.first-column' );\n\t\tthis.edit_view_tabs[1] = [];\n\t\tthis.edit_view_tabs[1].push( tab_payment_services_column1 );\n\n\t\t//Status\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id' } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_legal_entity_column1, '' );\n\n\t\t// Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'type_id' } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_legal_entity_column1, '' );\n\n\t\t// Classification Code\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'classification_code' } );\n\t\tform_item_input.setSourceData( $this.classification_code_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Classification Code' ), form_item_input, tab_legal_entity_column1, '' );\n\n\t\t// Legal Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'legal_name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Legal Name' ), form_item_input, tab_legal_entity_column1 );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Trade Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'trade_name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Trade Name' ), form_item_input, tab_legal_entity_column1 );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Short Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'short_name', width: '150' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Short Name/Abbreviation' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t// Address1\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'address1', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Address (Line 1)' ), form_item_input, tab_legal_entity_column1 );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Address2\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'address2', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Address (Line 2)' ), form_item_input, tab_legal_entity_column1 );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// city\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'city', width: 149 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'City' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t//Country\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'country', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Country' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t//Province / State\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'province' } );\n\t\tform_item_input.setSourceData( [] );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Province/State' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t//Postcode\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'postal_code', width: 149 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Postal/ZIP Code' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t// Phone\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'work_phone', width: 149 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Phone' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t// Fax\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'fax_phone', width: 149 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Fax' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t//Start Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_legal_entity_column1 );\n\n\t\t//End Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_legal_entity_column1 );\n\n\t\tif ( typeof FormData == 'undefined' ) {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.IMAGE_BROWSER );\n\n\t\t\tthis.file_browser = form_item_input.TImageBrowser( { field: '', default_width: 128, default_height: 128 } );\n\n\t\t\tthis.file_browser.bind( 'imageChange', function( e, target ) {\n\t\t\t\tnew ServiceCaller().uploadFile( target.getValue(), 'object_type=legal_entity_logo&object_id=' + $this.current_edit_record.id, {\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tif ( result.toLowerCase() === 'true' ) {\n\t\t\t\t\t\t\t$this.file_browser.setImage( $this.getLogoUrl() );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tTAlertManager.showAlert( result, 'Error' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t} );\n\t\t} else {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.IMAGE_AVD_BROWSER );\n\n\t\t\tthis.file_browser = form_item_input.TImageAdvBrowser( {\n\t\t\t\tfield: '', callBack: function( form_data ) {\n\t\t\t\t\tnew ServiceCaller().uploadFile( form_data, 'object_type=legal_entity_logo&object_id=' + $this.current_edit_record.id, {\n\t\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\t\tif ( result.toLowerCase() === 'true' ) {\n\t\t\t\t\t\t\t\t$this.file_browser.setImage( $this.getLogoUrl() );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tTAlertManager.showAlert( result, 'Error' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tif ( this.is_edit ) {\n\t\t\tthis.file_browser.setEnableDelete( true );\n\t\t\tthis.file_browser.bind( 'deleteClick', function( e, target ) {\n\t\t\t\t$this.api.deleteImage( $this.current_edit_record.id, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.onDeleteImage();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t\t}\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Logo' ), this.file_browser, tab_legal_entity_column1, '', null, false, true );\n\n\t\t//Status\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'payment_services_status_id' } );\n\t\tform_item_input.setSourceData( $this.payment_services_status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_payment_services_column1, '', null, true );\n\n\t\t//User Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'payment_services_user_name', width: 250 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'User Name' ), form_item_input, tab_payment_services_column1, '', null, true );\n\n\t\t//API Key\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'payment_services_api_key', width: 510 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'API Key' ), form_item_input, tab_payment_services_column1, '', null, true );\n\t}\n\n\tsetProvince( val, m ) {\n\t\tvar $this = this;\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.province_array = [];\n\t\t\tthis.adv_search_field_ui_dic['province'].setSourceData( [] );\n\t\t\tthis.basic_search_field_ui_dic['province'].setSourceData( [] );\n\n\t\t} else {\n\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.province_array = Global.buildRecordArray( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['province'].setSourceData( $this.province_array );\n\t\t\t\t\t$this.basic_search_field_ui_dic['province'].setSourceData( $this.province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\t\t\t\t\t$this.e_province_array = Global.buildRecordArray( res );\n\t\t\t\t\tif ( refresh && $this.e_province_array.length > 0 ) {\n\t\t\t\t\t\t$this.current_edit_record.province = $this.e_province_array[0].value;\n\t\t\t\t\t\tprovince_widget.setValue( $this.current_edit_record.province );\n\t\t\t\t\t}\n\t\t\t\t\tprovince_widget.setSourceData( $this.e_province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Legal Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'legal_name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Trade Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'trade_name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Phone' ),\n\t\t\t\tfield: 'work_phone',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 1,\n\t\t\t\tobject_type_id: 110,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Fax' ),\n\t\t\t\tfield: 'fax_phone',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 1,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Address (Line1)' ),\n\t\t\t\tfield: 'address1',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 2,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Address (Line2)' ),\n\t\t\t\tfield: 'address2',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 2,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Postal/ZIP Code' ),\n\t\t\t\tfield: 'postal_code',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 2,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Country' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'country',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.COMBO_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Province/State' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'province',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'City' ),\n\t\t\t\tfield: 'city',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 3,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tscript_name: 'EmployeeView',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 3,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tscript_name: 'EmployeeView',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\n\t\t];\n\t}\n\n}"],"sourceRoot":""}