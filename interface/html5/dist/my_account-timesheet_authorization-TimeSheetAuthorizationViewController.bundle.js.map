{"version":3,"sources":["webpack://timetrex/./interface/html5/views/my_account/timesheet_authorization/TimeSheetAuthorizationViewController.js"],"names":["TimeSheetAuthorizationViewController","BaseViewController","options","_","defaults","el","type_array","hierarchy_level_array","messages","message_control_api","authorization_api","request_api","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIPayPeriodTimeSheetVerify","APIRequest","APIMessageControl","APIAuthorization","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","hierarchy_type_id","$this","data","getHierarchyLevelOptions","async","getResult","Global","buildRecordArray","isSet","basic_search_field_ui_dic","setSourceData","set_default_menu","page_action","page_number","callBack","refresh_id","search","result_data","len","length","i","item","id","TTUUID","not_exist_id","user_id","pay_period_id","index","toString","indexOf","split","groups","action","label","authorization","objects","exclude","include","ContextMenuIconName","view","group","icon","Icons","cancel","pass","decline","authorization_request","permission_result","PermissionManager","checkTopLevelPermission","authorization_timesheet","selected","authorization_expense","timesheet","schedule","edit_employee","employee","export_excel","sort_order","context_btn","grid_selected_length","pId","viewPermissionValidate","edit_only_mode","addClass","removeClass","editPermissionValidate","editOwnerOrChildPermissionValidate","parseToRecordId","getGridSelectIdArray","is_viewing","current_edit_record","display_columns","grid","getGridParam","column_filter","name","getProductEdition","doNotSetFocus","context_menu_array","selectContextMenu","setTotalDisplaySpan","find","attr","edit","setDefaultMenuEditIcon","setDefaultMenuViewIcon","send","setDefaultMenuSaveIcon","setDefaultMenuCancelIcon","setDefaultMenuAuthorizationIcon","setDefaultMenuPassIcon","setDefaultMenuDeclineIcon","setDefaultMenuAuthorizationRequestIcon","setDefaultMenuAuthorizationTimesheetIcon","setDefaultMenuAuthorizationExpenseIcon","setDefaultMenuExportIcon","setContextMenuGroupVisibility","setEditMenuEditIcon","setEditMenuViewIcon","setEditMenuSaveIcon","setEditMenuAuthorizationIcon","setEditMenuPassIcon","setEditMenuDeclineIcon","setEditMenuAuthorizationRequestIcon","setEditMenuAuthorizationTimesheetIcon","setEditMenuNavViewIcon","setEditMenuNavEditIcon","setEditMenuAuthorizationExpenseIcon","onSaveClick","onAuthorizationClick","onPassClick","onDeclineClick","onAuthorizationRequestClick","onAuthorizationExpenseClick","onNavigationClick","IndexViewController","goToView","iconName","grid_selected_id_array","base_date","filter","ids","user_ids","edit_view","push","start_date","each","value","grid_selected_row","getRecordFromGridById","strToDateTime","format","Date","openEditView","addViewTab","window","location","href","filter_data","include_users","include_user_ids","select_date","onExportClick","key_name","ignoreWarning","is_edit","record","is_add","uniformVariable","onResult","result","onSaveResult","current_edit_record_id","isValid","onViewClick","setErrorMenu","setErrorTips","validateResult","object_id","object_type_id","res","onRightArrowClick","TFeedback","source","TAlertManager","showErrorAlert","force_no_confirm","cancel_all","callback","onCancelClick","records","msg","undefined","body","from_user_id","to_user_id","isFalseOrNull","subject","edit_view_ui_dic","getValue","record_id","getCurrentSelectedRecord","processResultData","handleViewAPICallbackResult","doViewClickResult","AuthorizationHistory","init","ProgressBar","showOverlay","buildSearchFields","search_fields","SearchField","in_column","field","layout_name","api_class","APIUser","multiple","basic_search","adv_search","form_item_type","FormItemType","AWESOME_BOX","APIPayPeriod","set_any","editId","noRefreshUI","LocalCacheData","current_doing_context_action","initEditView","hierarchy_level","buildEditViewUI","tab_model","setTabModel","navigation","tab_timesheet_verification","edit_view_tab","tab_timesheet_verification_column1","tab_timesheet_verification_column2","edit_view_tabs","form_item_input","loadWidgetByName","TEXT_INPUT","TTextInput","width","addEditFieldToColumn","TEXT_AREA","TTextArea","height","css","pager_data","getPagerData","source_data","getSourceData","AComboBox","allow_multiple_selection","navigation_mode","show_search_inputs","extendDataProcessWhenSearch","setNavigation","setPagerData","TEXT","TText","selected_able","separate_box","SEPARATED_BOX","SeparatedBox","view_id","edit_view_file_name","setUINotready","TTPromise","add","wait","remove","loadViewSource","ui_id","setTabOVisibility","tabs","activate","e","ui","onTabShow","bind","onTabIndexChange","contentContainer","append","initRightClickMenu","RightClickMenuType","EDITVIEW","buildViewUI","setEditViewTabHeight","key","hasOwnProperty","widget","setValue","collectUIDataToCurrentEditRecord","setEditViewDataDone","initTimeSheetSummary","initExceptionSummary","apiDisplayColumnsArray","all_exception_columns","len1","j","api_exception","APIException","buildExceptionGrid","setExceptionGridSize","getOptions","columns_result","columns_result_data","args","type_id","getException","buildColumnArray","exception_grid","column_info_array","buildExceptionDisplayColumns","view_column_data","column_info","sortable","title","isArray","isUUID","removeExceptionGridNoResultCover","setData","formatGridData","showExceptionGridNoResultCover","text","setGridCellBackGround","jqGrid","TTGrid","onResizeGrid","multiselect","winMultiSelect","gridComplete","setGridColumnsWidth","ondblClickRow","row_id","onExceptionGridDblClickRow","exception_grid_no_result_box","WidgetNamesDic","NO_RESULT_BOX","NoResultBox","related_view_controller","is_new","grid_div","parseInt","setEditViewTabSize","setTimeSheetSummaryGridSize","exception_background_color","severity","exception_color","code","accumulated_total_grid_source_map","api_timesheet","APITimeSheet","buildAccumulatedTotalGrid","getTimeSheetData","full_timesheet_data","pay_period_data","timesheet_verify_data","strToDate","timesheet_dates","start_display_date","end_date","end_display_date","columns","punch_in_out_column","fixed","formatter","onCellFormat","start_date_str","end_date_str","getAccumulatedTotalGridPayperiodHeader","column_2","pay_period_header","buildAccumulatedTotalData","total","key1","accmulated_order_map","order","array","date_string","map","result_array","parent_key","row","marked_regular_row","getTimeUnit","total_time","override","is_override_row","type","TOTAL_ROW","REGULAR_ROW","ACCUMULATED_TIME_ROW","PREMIUM_ROW","punch_info","key_array","no_id","unshift","accumulated_total_grid_source","accumulated_user_date_total_data","pay_period_accumulated_user_date_total_data","accumulated_time","premium_time","absence_time","absence_time_taken","buildAccmulatedOrderMap","buildSubGridsData","total_result","sortAccumulatedTotalData","timesheet_authorization_summary_grid","sort","m_sort_by","pay_period","onTimeSheetGridDblClickRow","date_stamp","cell_value","related_data","decodeCellValue","time_span","col_model","colModel","content_div","rowid","pos","get","outerHTML","note","prepend","setGridWidth","size","data_array","getData","setGridHeight","ABSENCE_ROW"],"mappings":"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","file":"my_account-timesheet_authorization-TimeSheetAuthorizationViewController.bundle.js?v=c6d3050621a5d0fb1932","sourcesContent":["export class TimeSheetAuthorizationViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#timesheet_authorization_view_container',\n\n\t\t\ttype_array: null,\n\t\t\thierarchy_level_array: null,\n\n\t\t\tmessages: null,\n\n\t\t\tmessage_control_api: null,\n\n\t\t\tauthorization_api: null,\n\n\t\t\trequest_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'TimeSheetAuthorizationEditView.html';\n\t\tthis.permission_id = 'punch';\n\t\tthis.viewId = 'TimeSheetAuthorization';\n\t\tthis.script_name = 'TimeSheetAuthorizationView';\n\t\tthis.table_name_key = 'pay_period_time_sheet_verify';\n\t\tthis.context_menu_name = $.i18n._( 'TimeSheet (Authorizations)' );\n\t\tthis.navigation_label = $.i18n._( 'TimeSheet' ) + ':';\n\t\tthis.api = TTAPI.APIPayPeriodTimeSheetVerify;\n\t\tthis.request_api = TTAPI.APIRequest;\n\t\tthis.message_control_api = TTAPI.APIMessageControl;\n\t\tthis.authorization_api = TTAPI.APIAuthorization;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu( true );\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\n\t\tthis.hierarchy_type_id = 90;\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\t\tvar res = this.request_api.getHierarchyLevelOptions( [-1], { async: false } );\n\t\tvar data = res.getResult();\n\t\t$this['hierarchy_level_array'] = Global.buildRecordArray( data );\n\t\tif ( Global.isSet( $this.basic_search_field_ui_dic['hierarchy_level'] ) ) {\n\t\t\t$this.basic_search_field_ui_dic['hierarchy_level'].setSourceData( Global.buildRecordArray( data ) );\n\t\t}\n\t}\n\n\tsearch( set_default_menu, page_action, page_number, callBack ) {\n\t\tthis.refresh_id = null;\n\t\tsuper.search( set_default_menu, page_action, page_number, callBack );\n\t}\n\n\tprocessResultData( result_data ) {\n\t\tvar len = result_data.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar item = result_data[i];\n\t\t\tif ( item.id == TTUUID.not_exist_id ) {\n\t\t\t\titem.id = item.user_id + '_' + item.pay_period_id;\n\t\t\t}\n\t\t}\n\n\t\treturn result_data;\n\t}\n\n\tparseToRecordId( id, index ) {\n\t\tif ( !id ) {\n\t\t\treturn false;\n\t\t}\n\t\tid = id.toString();\n\t\tif ( id.indexOf( '_' ) > 0 ) {\n\t\t\tif ( index >= 0 ) {\n\t\t\t\treturn id.split( '_' )[index];\n\t\t\t}\n\t\t\treturn TTUUID.not_exist_id;\n\t\t} else {\n\t\t\treturn id;\n\t\t}\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {\n\t\t\t\taction: {\n\t\t\t\t\tlabel: $.i18n._( 'Action' ),\n\t\t\t\t\tid: this.script_name + 'action'\n\t\t\t\t},\n\t\t\t\tauthorization: {\n\t\t\t\t\tlabel: $.i18n._( 'Authorization' ),\n\t\t\t\t\tid: this.script_name + 'authorization'\n\t\t\t\t},\n\t\t\t\tobjects: {\n\t\t\t\t\tlabel: $.i18n._( 'Objects' ),\n\t\t\t\t\tid: this.script_name + 'objects'\n\t\t\t\t}\n\t\t\t},\n\t\t\texclude: ['default'],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'View' ),\n\t\t\t\t\tid: ContextMenuIconName.view,\n\t\t\t\t\tgroup: 'action',\n\t\t\t\t\ticon: Icons.view\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Cancel' ),\n\t\t\t\t\tid: ContextMenuIconName.cancel,\n\t\t\t\t\tgroup: 'action',\n\t\t\t\t\ticon: Icons.cancel\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Authorize' ),\n\t\t\t\t\tid: ContextMenuIconName.authorization,\n\t\t\t\t\tgroup: 'authorization',\n\t\t\t\t\ticon: Icons.authorization\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Pass' ),\n\t\t\t\t\tid: ContextMenuIconName.pass,\n\t\t\t\t\tgroup: 'authorization',\n\t\t\t\t\ticon: Icons.pass\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Decline' ),\n\t\t\t\t\tid: ContextMenuIconName.decline,\n\t\t\t\t\tgroup: 'authorization',\n\t\t\t\t\ticon: Icons.decline\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Request<br>Authorizations' ),\n\t\t\t\t\tid: ContextMenuIconName.authorization_request,\n\t\t\t\t\tgroup: 'objects',\n\t\t\t\t\ticon: Icons.authorization_request,\n\t\t\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'RequestAuthorization' )\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'TimeSheet<br>Authorizations' ),\n\t\t\t\t\tid: ContextMenuIconName.authorization_timesheet,\n\t\t\t\t\tgroup: 'objects',\n\t\t\t\t\ticon: Icons.authorization_timesheet,\n\t\t\t\t\tselected: true,\n\t\t\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'TimeSheetAuthorization' )\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Expense<br>Authorizations' ),\n\t\t\t\t\tid: ContextMenuIconName.authorization_expense,\n\t\t\t\t\tgroup: 'objects',\n\t\t\t\t\ticon: Icons.authorization_expense,\n\t\t\t\t\tselected: false,\n\t\t\t\t\tpermission_result: PermissionManager.checkTopLevelPermission( 'ExpenseAuthorization' )\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'TimeSheet' ),\n\t\t\t\t\tid: ContextMenuIconName.timesheet,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.timesheet\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Schedule' ),\n\t\t\t\t\tid: ContextMenuIconName.schedule,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.schedule\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Edit<br>Employee' ),\n\t\t\t\t\tid: ContextMenuIconName.edit_employee,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.employee\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Export' ),\n\t\t\t\t\tid: ContextMenuIconName.export_excel,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.export_excel,\n\t\t\t\t\tsort_order: 9000\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tsetDefaultMenuViewIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.viewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 && this.editOwnerOrChildPermissionValidate( pId ) && this.parseToRecordId( this.getGridSelectIdArray()[0] ) !== TTUUID.not_exist_id ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t\tif ( !this.is_viewing || !this.editOwnerOrChildPermissionValidate( pId ) || this.parseToRecordId( this.current_edit_record.id ) === TTUUID.not_exist_id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tgetFilterColumnsFromDisplayColumns() {\n\t\t// Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tvar display_columns = [];\n\t\tif ( this.grid ) {\n\t\t\tdisplay_columns = this.grid.getGridParam( 'colModel' );\n\t\t}\n\n\t\tvar column_filter = {};\n\t\tcolumn_filter.is_owner = true;\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.user_id = true;\n\t\tcolumn_filter.is_child = true;\n\t\tcolumn_filter.in_use = true;\n\t\tcolumn_filter.first_name = true;\n\t\tcolumn_filter.last_name = true;\n\t\tcolumn_filter.start_date = true;\n\t\tcolumn_filter.end_date = true;\n\t\tcolumn_filter.pay_period_id = true;\n\n\t\tif ( display_columns ) {\n\t\t\tvar len = display_columns.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar column_info = display_columns[i];\n\t\t\t\tcolumn_filter[column_info.name] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tsetDefaultMenuAuthorizationExpenseIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !( Global.getProductEdition() >= 25 ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t\tcontext_btn.removeClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenu( doNotSetFocus ) {\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Employee&a=edit&id=42411&tab=Wage line 282\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !Global.isSet( doNotSetFocus ) || !doNotSetFocus ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t/* jshint ignore:start */\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.send:\n\t\t\t\t\tthis.setDefaultMenuSaveIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization:\n\t\t\t\t\tthis.setDefaultMenuAuthorizationIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.pass:\n\t\t\t\t\tthis.setDefaultMenuPassIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.decline:\n\t\t\t\t\tthis.setDefaultMenuDeclineIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization_request:\n\t\t\t\t\tthis.setDefaultMenuAuthorizationRequestIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization_timesheet:\n\t\t\t\t\tthis.setDefaultMenuAuthorizationTimesheetIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'user' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization_expense:\n\t\t\t\t\tthis.setDefaultMenuAuthorizationExpenseIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\t/* jshint ignore:end */\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetEditMenu() {\n\n\t\tthis.selectContextMenu();\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t/* jshint ignore:start */\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.send:\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization:\n\t\t\t\t\tthis.setEditMenuAuthorizationIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.pass:\n\t\t\t\t\tthis.setEditMenuPassIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.decline:\n\t\t\t\t\tthis.setEditMenuDeclineIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization_request:\n\t\t\t\t\tthis.setEditMenuAuthorizationRequestIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization_timesheet:\n\t\t\t\t\tthis.setEditMenuAuthorizationTimesheetIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setEditMenuNavViewIcon( context_btn, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\t\tthis.setEditMenuNavViewIcon( context_btn, 'schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\t\tthis.setEditMenuNavEditIcon( context_btn, 'user' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.authorization_expense:\n\t\t\t\t\tthis.setEditMenuAuthorizationExpenseIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\t/* jshint ignore:end */\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetEditMenuAuthorizationExpenseIcon( context_btn, pId ) {\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t}\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.send:\n\t\t\t\tthis.onSaveClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.authorization:\n\t\t\t\tthis.onAuthorizationClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.pass:\n\t\t\t\tthis.onPassClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.decline:\n\t\t\t\tthis.onDeclineClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.authorization_request:\n\t\t\t\tthis.onAuthorizationRequestClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.authorization_timesheet:\n\t\t\t\tbreak; //Already here, don't do anything.\n\t\t\tcase ContextMenuIconName.authorization_expense:\n\t\t\t\tthis.onAuthorizationExpenseClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\tcase ContextMenuIconName.schedule:\n\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\tthis.onNavigationClick( id );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonAuthorizationExpenseClick() {\n\t\tIndexViewController.goToView( 'ExpenseAuthorization' );\n\t}\n\n\tonNavigationClick( iconName ) {\n\n\t\tvar $this = this;\n\n\t\tvar grid_selected_id_array;\n\n\t\tvar filter = {};\n\n\t\tvar ids = [];\n\n\t\tvar user_ids = [];\n\n\t\tvar base_date;\n\n\t\tif ( $this.edit_view && $this.current_edit_record.id ) {\n\t\t\tids.push( $this.current_edit_record.id );\n\t\t\tuser_ids.push( $this.current_edit_record.user_id );\n\t\t\tbase_date = $this.current_edit_record.start_date;\n\t\t} else {\n\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t\tvar grid_selected_row = $this.getRecordFromGridById( value );\n\t\t\t\tids.push( grid_selected_row.id );\n\t\t\t\tuser_ids.push( grid_selected_row.user_id );\n\t\t\t\tbase_date = grid_selected_row.start_date;\n\t\t\t} );\n\t\t}\n\n\t\t//Error: TypeError: Global.strToDateTime(...) is null in interface/html5/framework/jquery.min.js?v=9.0.0-20151014-164655 line 2 > eval line 552\n\t\tbase_date = base_date ? Global.strToDateTime( base_date ).format() : new Date().format();\n\n\t\tswitch ( iconName ) {\n\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\tif ( user_ids.length > 0 ) {\n\t\t\t\t\tIndexViewController.openEditView( this, 'Employee', user_ids[0] );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\tif ( user_ids.length > 0 ) {\n\t\t\t\t\tfilter.user_id = user_ids[0];\n\t\t\t\t\tfilter.base_date = base_date;\n\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Authorization - TimeSheet' ), window.location.href );\n\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\tfilter.filter_data = {};\n\t\t\t\tvar include_users = { value: user_ids };\n\t\t\t\tfilter.filter_data.include_user_ids = include_users;\n\t\t\t\tfilter.select_date = base_date;\n\t\t\t\tGlobal.addViewTab( this.viewId, $.i18n._( 'Authorization - TimeSheet' ), window.location.href );\n\t\t\t\tIndexViewController.goToView( 'Schedule', filter );\n\t\t\t\tbreak;\n\n\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\tthis.onExportClick( 'export' + this.api.key_name );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonSaveClick( ignoreWarning ) {\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tif ( this.is_edit ) {\n\n\t\t\tvar $this = this;\n\n\t\t\tvar record = {};\n\n\t\t\tthis.is_add = false;\n\n\t\t\trecord = this.uniformVariable( record );\n\n\t\t\tthis.message_control_api['setMessageControl']( record, false, ignoreWarning, {\n\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t$this.onSaveResult( result );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tvar current_edit_record_id;\n\n\t\tif ( result.isValid() ) {\n\n\t\t\tcurrent_edit_record_id = $this.current_edit_record.id;\n\n\t\t\t$this.onViewClick( current_edit_record_id, true );\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tvalidate() {\n\n\t\tvar $this = this;\n\n\t\tvar record = this.current_edit_record;\n\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.message_control_api['validate' + this.message_control_api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.validateResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonAuthorizationClick() {\n\t\tvar $this = this;\n\t\tvar filter = {};\n\t\tfilter.authorized = true;\n\t\tif ( this.parseToRecordId( $this.current_edit_record.id ) == TTUUID.not_exist_id ) {\n\t\t\tfilter.object_id = TTUUID.not_exist_id;\n\t\t\tfilter.user_id = $this.current_edit_record.user_id;\n\t\t\tfilter.pay_period_id = $this.current_edit_record.pay_period_id;\n\t\t} else {\n\t\t\tfilter.object_id = $this.current_edit_record.id;\n\t\t}\n\t\tfilter.object_type_id = 90;\n\n\t\t$this.authorization_api['setAuthorization']( [filter], {\n\t\t\tonResult: function( res ) {\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.onRightArrowClick( function() {\n\t\t\t\t\t\t$this.search();\n\t\t\t\t\t\t$().TFeedback( {\n\t\t\t\t\t\t\tsource: 'Authorize'\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( res );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonPassClick() {\n\t\tvar $this = this;\n\t\tthis.onRightArrowClick( function() {\n\t\t\t$this.search();\n\t\t\t$().TFeedback( {\n\t\t\t\tsource: 'Pass'\n\t\t\t} );\n\t\t} );\n\t}\n\n\tonAuthorizationRequestClick() {\n\t\tIndexViewController.goToView( 'RequestAuthorization' );\n\t}\n\n\tonCancelClick( force_no_confirm, cancel_all, callback ) {\n\t\t//Refresh grid on cancel as its not done during authorize/decline anymore.\n\t\tvar $this = this;\n\t\tsuper.onCancelClick( force_no_confirm, cancel_all, function() {\n\t\t\t//Since we are overriding the callback function to call this.search(), make sure the original callback is still called.\n\t\t\tif ( callback ) {\n\t\t\t\tcallback();\n\t\t\t}\n\n\t\t\t$this.search();\n\t\t} );\n\t}\n\n\tonDeclineClick() {\n\n\t\tvar $this = this;\n\t\tvar filter = {};\n\n\t\tfilter.authorized = false;\n\t\tif ( this.parseToRecordId( $this.current_edit_record.id ) == TTUUID.not_exist_id ) {\n\t\t\tfilter.object_id = TTUUID.not_exist_id;\n\t\t\tfilter.user_id = $this.current_edit_record.user_id;\n\t\t\tfilter.pay_period_id = $this.current_edit_record.pay_period_id;\n\t\t} else {\n\t\t\tfilter.object_id = $this.current_edit_record.id;\n\t\t}\n\t\tfilter.object_type_id = 90;\n\n\t\t$this.authorization_api['setAuthorization']( [filter], {\n\t\t\tonResult: function( res ) {\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.onRightArrowClick( function() {\n\t\t\t\t\t\t$this.search();\n\t\t\t\t\t\t$().TFeedback( {\n\t\t\t\t\t\t\tsource: 'Decline'\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( res );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonAuthorizationTimesheetClick() {\n\t\tthis.search( false );\n\t}\n\n\tuniformVariable( records ) {\n\n\t\tvar msg = {};\n\n\t\tif ( this.is_edit && this.current_edit_record != undefined ) {\n\t\t\tmsg.body = this.current_edit_record['body'];\n\t\t\tmsg.from_user_id = this.current_edit_record['user_id'];\n\t\t\tmsg.to_user_id = this.current_edit_record['user_id'];\n\t\t\tmsg.object_id = this.current_edit_record['id'];\n\t\t\tmsg.object_type_id = 90;\n\t\t\tif ( Global.isFalseOrNull( this.current_edit_record['subject'] ) ) {\n\t\t\t\tmsg.subject = this.edit_view_ui_dic['subject'].getValue();\n\t\t\t} else {\n\t\t\t\tmsg.subject = this.current_edit_record['subject'];\n\t\t\t}\n\t\t\treturn msg;\n\t\t}\n\t\trecords.id = this.parseToRecordId( records.id );\n\t\treturn records;\n\t}\n\n\tgetAPIFilters() {\n\t\t// override this function if view requires more filters\n\t\tvar record_id = this.getCurrentSelectedRecord();\n\t\tvar filter = {};\n\n\t\tfilter.filter_data = {};\n\t\tif ( this.parseToRecordId( record_id ) != TTUUID.not_exist_id ) {\n\t\t\tfilter.filter_data.id = [record_id];\n\t\t} else {\n\t\t\tfilter.filter_data.user_id = this.parseToRecordId( record_id, 0 );\n\t\t\tfilter.filter_data.pay_period_id = this.parseToRecordId( record_id, 1 );\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\thandleViewAPICallbackResult( result ) {\n\t\tvar result_data = result.getResult();\n\t\tvar record_id = this.getCurrentSelectedRecord();\n\n\t\tresult_data = this.processResultData( result_data );\n\t\tif ( !result_data ) {\n\t\t\tresult_data = [];\n\t\t}\n\n\t\tresult_data = result_data[0];\n\t\treturn super.handleViewAPICallbackResult( result_data );\n\t}\n\n\tdoViewClickResult( result_data ) {\n\t\tsuper.doViewClickResult( result_data );\n\t\tAuthorizationHistory.init( this );\n\t}\n\n\tonGridDblClickRow() {\n\n\t\tProgressBar.showOverlay();\n\t\tthis.onViewClick();\n\t}\n\n\tsetEditMenuViewIcon( context_btn, pId ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetEditMenuAuthorizationIcon( context_btn, pId ) {\n\t\tif ( this.is_edit ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuPassIcon( context_btn, pId ) {\n\t\tif ( this.is_edit ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuDeclineIcon( context_btn, pId ) {\n\t\tif ( this.is_edit ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuAuthorizationRequestIcon( context_btn, pId ) {\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuAuthorizationTimesheetIcon( context_btn, pId ) {\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuSaveIcon( context_btn, grid_selected_length, pId ) {\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuAuthorizationIcon( context_btn, grid_selected_length, pId ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuPassIcon( context_btn, grid_selected_length, pId ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuDeclineIcon( context_btn, grid_selected_length, pId ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuAuthorizationRequestIcon( context_btn, grid_selected_length, pId ) {\n\t\tcontext_btn.removeClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuAuthorizationTimesheetIcon( context_btn, grid_selected_length, pId ) {\n\t\tcontext_btn.removeClass( 'disable-image' );\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Pay Period' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'pay_period_id',\n\t\t\t\tlayout_name: 'global_Pay_period',\n\t\t\t\tapi_class: TTAPI.APIPayPeriod,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Hierarchy Level' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tmultiple: false,\n\t\t\t\tset_any: false,\n\t\t\t\tfield: 'hierarchy_level',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tonEditClick( editId, noRefreshUI ) {\n\n\t\tvar $this = this;\n\t\tthis.is_viewing = false;\n\t\tthis.is_edit = true;\n\t\tthis.is_add = false;\n\t\tLocalCacheData.current_doing_context_action = 'edit';\n\t\t$this.openEditView();\n\n\t\t$this.initEditView();\n\t}\n\n\tgetSubViewFilter( filter ) {\n\n\t\tif ( filter.length === 0 ) {\n\t\t\tfilter = {};\n\t\t}\n\n\t\tif ( !Global.isSet( filter.hierarchy_level ) ) {\n\t\t\tfilter['hierarchy_level'] = 1;\n\t\t\tthis.filter_data['hierarchy_level'] = {\n\t\t\t\tfield: 'hierarchy_level',\n\t\t\t\tid: '',\n\t\t\t\tvalue: this.basic_search_field_ui_dic['hierarchy_level'].getValue( true )\n\t\t\t};\n\t\t}\n\n\t\treturn filter;\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar tab_model = {\n\t\t\t'tab_timesheet_verification': { 'label': $.i18n._( 'Message' ) },\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation = null;\n\n\t\t//Tab 0 start\n\n\t\tvar tab_timesheet_verification = this.edit_view_tab.find( '#tab_timesheet_verification' );\n\t\tvar tab_timesheet_verification_column1 = tab_timesheet_verification.find( '.first-column' );\n\t\tvar tab_timesheet_verification_column2 = tab_timesheet_verification.find( '.second-column' );\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_timesheet_verification_column1 );\n\n\t\t// Subject\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'subject', width: 359 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Subject' ), form_item_input, tab_timesheet_verification_column1, '' );\n\n\t\t// Body\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'body', width: 600, height: 400 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Body' ), form_item_input, tab_timesheet_verification_column1, '', null, null, true );\n\t\ttab_timesheet_verification_column2.css( 'display', 'none' );\n\t}\n\n\tneedShowNavigation() {\n\t\tif ( this.is_viewing && this.current_edit_record && Global.isSet( this.current_edit_record.id ) && this.current_edit_record.id ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tbuildViewUI() {\n\t\tvar pager_data = this.navigation && this.navigation.getPagerData && this.navigation.getPagerData();\n\t\tvar source_data = this.navigation && this.navigation.getSourceData && this.navigation.getSourceData();\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_timesheet_verification': { 'label': $.i18n._( 'TimeSheet Verification' ) },\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIPayPeriodTimeSheetVerify,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_Pay_period',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true,\n\t\t\textendDataProcessWhenSearch: this.processResultData\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\tif ( pager_data && source_data ) {\n\t\t\tthis.navigation.setSourceData( source_data );\n\t\t\tthis.navigation.setPagerData( pager_data );\n\t\t}\n\n\t\t//Tab 0 first column start\n\n\t\tvar tab_timesheet_verification = this.edit_view_tab.find( '#tab_timesheet_verification' );\n\t\tvar tab_timesheet_verification_column1 = tab_timesheet_verification.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_timesheet_verification_column1 );\n\n\t\t// Employee\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'full_name', selected_able: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_timesheet_verification_column1, '' );\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'status', selected_able: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_timesheet_verification_column1, '' );\n\n\t\t// Pay Period\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'pay_period', selected_able: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Pay Period' ), form_item_input, tab_timesheet_verification_column1 );\n\n\t\t// tab_timesheet_verification first column end\n\n\t\tvar separate_box = tab_timesheet_verification.find( '.separate' );\n\n\t\t// Messages\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.SEPARATED_BOX );\n\t\tform_item_input.SeparatedBox( { label: $.i18n._( 'Messages' ) } );\n\t\tthis.addEditFieldToColumn( null, form_item_input, separate_box );\n\n\t\tseparate_box.css( 'display', 'none' );\n\n\t\t// Tab 0 second column start\n\n\t\tvar tab_timesheet_verification_column2 = tab_timesheet_verification.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0].push( tab_timesheet_verification_column2 );\n\n\t\t// From\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'from', selected_able: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'From' ), form_item_input, tab_timesheet_verification_column2, '' );\n\n\t\t// Subject\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'subject', selected_able: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Subject' ), form_item_input, tab_timesheet_verification_column2 );\n\n\t\t// Body\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'body', width: 600, height: 400, selected_able: true } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Body' ), form_item_input, tab_timesheet_verification_column2, '', null, true, true );\n\n\t\t// Tab 0 second column end\n\n\t\ttab_timesheet_verification_column2.css( 'display', 'none' );\n\t}\n\n\tinitEditViewUI( view_id, edit_view_file_name ) {\n\t\tGlobal.setUINotready();\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\t\tvar $this = this;\n\n\t\tif ( this.edit_view ) {\n\t\t\tthis.edit_view.remove();\n\t\t}\n\n\t\tthis.edit_view = $( Global.loadViewSource( view_id, edit_view_file_name, null, true ) );\n\n\t\tthis.edit_view_tab = $( this.edit_view.find( '.edit-view-tab-bar' ) );\n\n\t\t//Give edt view tab a id, so we can load it when put right click menu on it\n\t\tthis.edit_view_tab.attr( 'id', this.ui_id + '_edit_view_tab' );\n\n\t\tthis.setTabOVisibility( false );\n\n\t\tthis.edit_view_tab = this.edit_view_tab.tabs( {\n\t\t\tactivate: function( e, ui ) {\n\t\t\t\t$this.onTabShow( e, ui );\n\t\t\t}\n\t\t} );\n\n\t\tthis.edit_view_tab.bind( 'tabsselect', function( e, ui ) {\n\t\t\t$this.onTabIndexChange( e, ui );\n\t\t} );\n\n\t\tGlobal.contentContainer().append( this.edit_view );\n\t\tthis.initRightClickMenu( RightClickMenuType.EDITVIEW );\n\n\t\tif ( this.is_viewing ) {\n\t\t\tLocalCacheData.current_doing_context_action = 'view';\n\t\t\tthis.buildViewUI();\n\t\t} else if ( this.is_edit ) {\n\t\t\tLocalCacheData.current_doing_context_action = 'edit';\n\t\t\tthis.buildEditViewUI();\n\t\t}\n\n\t\t$this.setEditViewTabHeight();\n\t}\n\n\tsetCurrentEditRecordData() {\n\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tif ( !this.current_edit_record.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'full_name':\n\t\t\t\t\t\tif ( this.is_viewing ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record['first_name'] + ' ' + this.current_edit_record['last_name'] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'pay_period':\n\t\t\t\t\t\twidget.setValue( this.current_edit_record['start_date'] + ' ' + this.current_edit_record['end_date'] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'subject':\n\t\t\t\t\t\tif ( this.is_edit ) {\n\t\t\t\t\t\t\tif ( Global.isSet( this.messages ) ) {\n\t\t\t\t\t\t\t\twidget.setValue( 'Re: ' + this.messages[0].subject );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if ( this.is_viewing ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tvar $this = this;\n\t\tsuper.setEditViewDataDone();\n\n\t\tif ( this.is_viewing ) {\n\t\t\tthis.initTimeSheetSummary();\n\t\t\tthis.initExceptionSummary();\n\t\t\t//this.initEmbeddedMessageData();\n\t\t} else {\n\t\t\tif ( Global.isSet( $this.messages ) ) {\n\t\t\t\t$this.messages = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildExceptionDisplayColumns( apiDisplayColumnsArray ) {\n\t\tvar len = this.all_exception_columns.length;\n\t\tvar len1 = apiDisplayColumnsArray ? apiDisplayColumnsArray.length : 0;\n\t\tvar display_columns = [];\n\t\tfor ( var j = 0; j < len1; j++ ) {\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tif ( apiDisplayColumnsArray[j] === this.all_exception_columns[i].value ) {\n\t\t\t\t\tdisplay_columns.push( this.all_exception_columns[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn display_columns;\n\t}\n\n\tinitExceptionSummary() {\n\n\t\tvar $this = this;\n\t\tif ( !this.api_exception ) {\n\t\t\tthis.api_exception = TTAPI.APIException;\n\t\t}\n\n\t\t$this.buildExceptionGrid();\n\t\t$this.setExceptionGridSize();\n\t\tthis.api_exception.getOptions( 'columns', {\n\t\t\tonResult: function( columns_result ) {\n\t\t\t\tvar columns_result_data = columns_result.getResult();\n\t\t\t\tif ( Global.isSet( $this.current_edit_record ) == false ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar args = {\n\t\t\t\t\tfilter_data: {\n\t\t\t\t\t\tuser_id: $this.current_edit_record.user_id,\n\t\t\t\t\t\tpay_period_id: $this.current_edit_record.pay_period_id,\n\t\t\t\t\t\ttype_id: [30, 40, 50, 55, 60]\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t$this.api_exception.getException( args, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.all_exception_columns = Global.buildColumnArray( columns_result_data );\n\t\t\t\t\t\tvar grid;\n\t\t\t\t\t\tif ( !Global.isSet( $this.exception_grid ) ) {\n\t\t\t\t\t\t\tgrid = $( '#exception_grid' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar display_columns = [\n\t\t\t\t\t\t\t'date_stamp',\n\t\t\t\t\t\t\t'severity',\n\t\t\t\t\t\t\t'exception_policy_type',\n\t\t\t\t\t\t\t'exception_policy_type_id',\n\t\t\t\t\t\t\t'exception_color',\n\t\t\t\t\t\t\t'exception_background_color'\n\t\t\t\t\t\t];\n\t\t\t\t\t\tdisplay_columns = $this.buildExceptionDisplayColumns( display_columns );\n\t\t\t\t\t\t//Set Data Grid on List view\n\t\t\t\t\t\tvar column_info_array = [];\n\t\t\t\t\t\tvar len = display_columns.length;\n\t\t\t\t\t\tvar start_from = 0;\n\t\t\t\t\t\tfor ( var i = start_from; i < len; i++ ) {\n\t\t\t\t\t\t\tvar view_column_data = display_columns[i];\n\t\t\t\t\t\t\tvar column_info = {\n\t\t\t\t\t\t\t\tname: view_column_data.value,\n\t\t\t\t\t\t\t\tindex: view_column_data.value,\n\t\t\t\t\t\t\t\tlabel: view_column_data.label,\n\t\t\t\t\t\t\t\twidth: 100,\n\t\t\t\t\t\t\t\tsortable: false,\n\t\t\t\t\t\t\t\ttitle: false\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcolumn_info_array.push( column_info );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$this.buildExceptionGrid( column_info_array );\n\n\t\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\t\tif ( !Global.isArray( result_data ) && TTUUID.isUUID( $this.refresh_id ) == false ) {\n\t\t\t\t\t\t\t$this.showExceptionGridNoResultCover();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.removeExceptionGridNoResultCover();\n\t\t\t\t\t\t\t$this.exception_grid.setData( Global.formatGridData( result.getResult() ) );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.setExceptionGridSize();\n\n\t\t\t\t\t\t$( '.exception-title' ).text( $.i18n._( 'Exceptions' ) );\n\t\t\t\t\t\t$( '.exception-title' ).css( 'width', ( $this.exception_grid.grid.width() - 1 ) + 'px !important' );\n\t\t\t\t\t\t$this.setGridCellBackGround();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildExceptionGrid( column_info_array ) {\n\t\tvar $this = this;\n\n\t\tif ( typeof column_info_array == 'undefined' ) {\n\t\t\tcolumn_info_array = [];\n\t\t}\n\n\t\tif ( this.exception_grid ) {\n\t\t\tthis.exception_grid.grid.jqGrid( 'GridUnload' );\n\t\t\tthis.exception_grid = null;\n\t\t}\n\t\tthis.exception_grid = new TTGrid( 'exception_grid', {\n\t\t\tonResizeGrid: false,\n\t\t\tmultiselect: false,\n\t\t\twinMultiSelect: false,\n\t\t\tgridComplete: function() {\n\t\t\t\tif ( $( this ).jqGrid( 'getGridParam', 'data' ).length > 0 ) {\n\t\t\t\t\t$this.exception_grid.setGridColumnsWidth();\n\t\t\t\t}\n\t\t\t},\n\t\t\tondblClickRow: function( row_id ) {\n\t\t\t\t$this.onExceptionGridDblClickRow( row_id );\n\t\t\t},\n\t\t\tsortable: false,\n\t\t\theight: 160\n\t\t}, column_info_array );\n\t}\n\n\tshowExceptionGridNoResultCover() {\n\t\tthis.removeExceptionGridNoResultCover();\n\t\tthis.exception_grid_no_result_box = Global.loadWidgetByName( WidgetNamesDic.NO_RESULT_BOX );\n\t\tthis.exception_grid_no_result_box.NoResultBox( { related_view_controller: this, is_new: false } );\n\t\tvar grid_div = $( '.exception-grid-div' );\n\t\tgrid_div.css( 'position', 'relative' );\n\t\tthis.exception_grid_no_result_box.attr( 'id', '#exception_grid_no_result_box' );\n\t\tthis.exception_grid_no_result_box.css( 'width', parseInt( grid_div.width() ) + 'px' );\n\t\tthis.exception_grid_no_result_box.css( 'height', parseInt( grid_div.height() ) + 'px' );\n\n\t\tgrid_div.append( this.exception_grid_no_result_box );\n\t}\n\n\tremoveExceptionGridNoResultCover() {\n\t\tif ( this.exception_grid_no_result_box && this.exception_grid_no_result_box.length > 0 ) {\n\t\t\tthis.exception_grid_no_result_box.remove();\n\t\t}\n\t\tthis.exception_grid_no_result_box = null;\n\t}\n\n\tsetEditViewTabSize() {\n\t\tsuper.setEditViewTabSize();\n\t\tthis.setExceptionGridSize();\n\t\tthis.setTimeSheetSummaryGridSize();\n\t}\n\n\tsetGridCellBackGround() {\n\t\tvar data;\n\t\tvar len;\n\t\tvar i;\n\t\tvar item;\n\t\tif ( !this.exception_grid || !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\t\tdata = this.exception_grid.getGridParam( 'data' );\n\t\t//Error: TypeError: data is undefined in /interface/html5/framework/jquery.min.js?v=7.4.6-20141027-074127 line 2 > eval line 70\n\t\tif ( !data ) {\n\t\t\treturn;\n\t\t}\n\t\tlen = data.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\titem = data[i];\n\t\t\tif ( item.exception_background_color ) {\n\t\t\t\tvar severity = this.edit_view.find( 'tr[id=\\'' + item.id + '\\']' ).find( 'td[aria-describedby=\"exception_grid_severity\"]' );\n\t\t\t\tseverity.css( 'background-color', item.exception_background_color );\n\t\t\t\tseverity.css( 'font-weight', 'bold' );\n\t\t\t}\n\t\t\tif ( item.exception_color ) {\n\t\t\t\tvar code = this.edit_view.find( 'tr[id=\\'' + item.id + '\\']' ).find( 'td[aria-describedby=\"exception_grid_exception_policy_type_id\"]' );\n\t\t\t\tcode.css( 'color', item.exception_color );\n\t\t\t\tcode.css( 'font-weight', 'bold' );\n\t\t\t}\n\t\t}\n\t}\n\n\tinitTimeSheetSummary() {\n\t\tvar $this = this;\n\n\t\tif ( Global.isSet( this.current_edit_record ) == false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.accumulated_total_grid_source_map = {};\n\t\tif ( !this.api_timesheet ) {\n\t\t\tthis.api_timesheet = TTAPI.APITimeSheet;\n\t\t}\n\n\t\t$this.buildAccumulatedTotalGrid();\n\t\tthis.api_timesheet.getTimeSheetData( this.current_edit_record.user_id, this.current_edit_record.start_date, {\n\t\t\tonResult: function( result ) {\n\n\t\t\t\tif ( Global.isSet( $this.current_edit_record ) == false ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t$this.full_timesheet_data = result.getResult();\n\t\t\t\t$this.pay_period_data = $this.full_timesheet_data.pay_period_data;\n\t\t\t\t$this.timesheet_verify_data = $this.full_timesheet_data.timesheet_verify_data;\n\t\t\t\t$this.start_date = Global.strToDate( $this.full_timesheet_data.timesheet_dates.start_display_date );\n\t\t\t\t$this.end_date = Global.strToDate( $this.full_timesheet_data.timesheet_dates.end_display_date );\n\t\t\t\tvar columns = [];\n\t\t\t\tvar punch_in_out_column = {\n\t\t\t\t\tname: 'punch_info',\n\t\t\t\t\tindex: 'punch_info',\n\t\t\t\t\tlabel: ' ',\n\t\t\t\t\twidth: 200,\n\t\t\t\t\tfixed: true,\n\t\t\t\t\tsortable: false,\n\t\t\t\t\ttitle: false,\n\t\t\t\t\tformatter: $this.onCellFormat\n\t\t\t\t};\n\t\t\t\tcolumns.push( punch_in_out_column );\n\t\t\t\tvar start_date_str = $this.current_edit_record.start_date;\n\t\t\t\tvar end_date_str = $this.current_edit_record.end_date;\n\t\t\t\t$this.getAccumulatedTotalGridPayperiodHeader();\n\t\t\t\tvar column_1 = {\n\t\t\t\t\tname: 'week',\n\t\t\t\t\tindex: 'week',\n\t\t\t\t\tlabel: $.i18n._( 'Week' ) + '<br>' + start_date_str + ' to ' + end_date_str,\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tsortable: false,\n\t\t\t\t\ttitle: false,\n\t\t\t\t\tformatter: $this.onCellFormat\n\t\t\t\t};\n\t\t\t\tvar column_2 = {\n\t\t\t\t\tname: 'pay_period',\n\t\t\t\t\tindex: 'pay_period',\n\t\t\t\t\tlabel: $.i18n._( 'Pay Period' ) + '<br>' + $this.pay_period_header,\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tsortable: false,\n\t\t\t\t\ttitle: false,\n\t\t\t\t\tformatter: $this.onCellFormat\n\t\t\t\t};\n\t\t\t\tcolumns.push( column_2 );\n\t\t\t\t$this.buildAccumulatedTotalGrid( columns );\n\t\t\t\t$this.buildAccumulatedTotalData();\n\t\t\t\t$( '.button-rotate' ).removeClass( 'button-rotate' );\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildAccmulatedOrderMap( total ) {\n\t\tif ( !total ) {\n\t\t\treturn;\n\t\t}\n\t\tfor ( var key in total ) {\n\t\t\tfor ( var key1 in total[key] ) {\n\t\t\t\tthis.accmulated_order_map[key1] = total[key][key1].order;\n\t\t\t}\n\t\t}\n\t}\n\n\t//This function is copied from TimeSheetViewController.js\n\tbuildSubGridsData( array, date_string, map, result_array, parent_key ) {\n\t\tvar row;\n\t\tvar marked_regular_row = false; //Only mark the first regular time row, as thats where the bold top-line is going to go.\n\t\tfor ( var key in array ) {\n\t\t\tif ( !map[key] ) {\n\t\t\t\trow = {};\n\t\t\t\trow.parent_key = parent_key;\n\t\t\t\trow.key = key;\n\n\t\t\t\tif ( parent_key === 'accumulated_time' ) {\n\t\t\t\t\tif ( key === 'total' || key === 'worked_time' ) {\n\t\t\t\t\t\trow.type = TimeSheetAuthorizationViewController.TOTAL_ROW;\n\t\t\t\t\t} else if ( marked_regular_row == false && key.indexOf( 'regular_time' ) === 0 ) {\n\t\t\t\t\t\trow.type = TimeSheetAuthorizationViewController.REGULAR_ROW;\n\t\t\t\t\t\tmarked_regular_row = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.type = TimeSheetAuthorizationViewController.ACCUMULATED_TIME_ROW;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( array[key].override ) {\n\t\t\t\t\t\trow.is_override_row = true;\n\t\t\t\t\t}\n\t\t\t\t} else if ( parent_key === 'premium_time' ) {\n\t\t\t\t\trow.type = TimeSheetAuthorizationViewController.PREMIUM_ROW;\n\t\t\t\t}\n\n\t\t\t\tif ( this.accmulated_order_map[key] ) {\n\t\t\t\t\trow.order = this.accmulated_order_map[key];\n\t\t\t\t}\n\n\t\t\t\trow.punch_info = array[key].label;\n\n\t\t\t\tvar key_array = key.split( '_' );\n\t\t\t\tvar no_id = false;\n\t\t\t\tif ( key_array.length > 1 && key_array[1] == '0' ) {\n\t\t\t\t\tno_id = true;\n\t\t\t\t}\n\n\t\t\t\tarray[key].key = key;\n\t\t\t\trow[date_string] = Global.getTimeUnit( array[key].total_time );\n\t\t\t\trow[date_string + '_data'] = array[key];\n\n\t\t\t\t//if id == 0, put the row as first row.\n\t\t\t\tif ( no_id ) {\n\t\t\t\t\tresult_array.unshift( row );\n\t\t\t\t} else {\n\t\t\t\t\tresult_array.push( row );\n\t\t\t\t}\n\t\t\t\tmap[key] = row;\n\t\t\t} else {\n\t\t\t\trow = map[key];\n\t\t\t\tif ( row[date_string] && key === 'total' ) { //Override total cell data since we set all to 00:00 at beginning\n\t\t\t\t\tarray[key].key = key;\n\t\t\t\t\trow[date_string] = Global.getTimeUnit( array[key].total_time );\n\t\t\t\t\trow[date_string + '_data'] = array[key];\n\t\t\t\t\tif ( row.parent_key === 'accumulated_time' ) {\n\t\t\t\t\t\tif ( array[key].override ) {\n\t\t\t\t\t\t\trow.is_override_row = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tarray[key].key = key;\n\t\t\t\t\trow[date_string] = Global.getTimeUnit( array[key].total_time );\n\t\t\t\t\trow[date_string + '_data'] = array[key];\n\n\t\t\t\t\tif ( row.parent_key === 'accumulated_time' ) {\n\t\t\t\t\t\tif ( array[key].override ) {\n\t\t\t\t\t\t\trow.is_override_row = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildAccumulatedTotalData() {\n\t\tthis.accmulated_order_map = {};\n\t\tthis.accumulated_total_grid_source = [];\n\t\tvar accumulated_user_date_total_data = this.full_timesheet_data.accumulated_user_date_total_data;\n\t\tvar pay_period_accumulated_user_date_total_data = this.full_timesheet_data.pay_period_accumulated_user_date_total_data;\n\t\tvar accumulated_time = pay_period_accumulated_user_date_total_data.accumulated_time;\n\t\tvar premium_time = pay_period_accumulated_user_date_total_data.premium_time;\n\t\tvar absence_time = pay_period_accumulated_user_date_total_data.absence_time_taken;\n\t\t// Save the order, will do sort after all data prepared.\n\t\tif ( accumulated_user_date_total_data.total ) {\n\t\t\tthis.buildAccmulatedOrderMap( accumulated_user_date_total_data.total );\n\t\t}\n\t\tif ( pay_period_accumulated_user_date_total_data ) {\n\t\t\tthis.buildAccmulatedOrderMap( pay_period_accumulated_user_date_total_data );\n\t\t}\n\t\tif ( Global.isSet( accumulated_time ) ) {\n\t\t\tthis.buildSubGridsData( accumulated_time, 'pay_period', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'accumulated_time' );\n\t\t} else {\n\t\t\taccumulated_time = { total: { label: 'Total Time', total_time: '0' } };\n\t\t\tthis.buildSubGridsData( accumulated_time, 'pay_period', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'accumulated_time' );\n\t\t}\n\t\tif ( Global.isSet( premium_time ) ) {\n\t\t\tthis.buildSubGridsData( premium_time, 'pay_period', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'premium_time' );\n\t\t}\n\t\tif ( Global.isSet( absence_time ) ) {\n\t\t\tthis.buildSubGridsData( absence_time, 'pay_period', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'absence_time' );\n\t\t}\n\t\taccumulated_time = { total: { label: 'Total Time', total_time: '0' } };\n\t\tthis.buildSubGridsData( accumulated_time, 'week', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'accumulated_time' );\n\t\tfor ( var key in accumulated_user_date_total_data ) {\n\t\t\t//Build Accumulated Total Grid week column data\n\t\t\tif ( key === 'total' ) {\n\t\t\t\tvar total_result = accumulated_user_date_total_data.total;\n\t\t\t\taccumulated_time = total_result.accumulated_time;\n\t\t\t\tpremium_time = total_result.premium_time;\n\t\t\t\tabsence_time = total_result.absence_time_taken;\n\t\t\t\tif ( Global.isSet( accumulated_time ) ) {\n\t\t\t\t\tthis.buildSubGridsData( accumulated_time, 'week', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'accumulated_time' );\n\t\t\t\t}\n\t\t\t\tif ( Global.isSet( premium_time ) ) {\n\t\t\t\t\tthis.buildSubGridsData( premium_time, 'week', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'premium_time' );\n\t\t\t\t}\n\t\t\t\tif ( Global.isSet( absence_time ) ) {\n\t\t\t\t\tthis.buildSubGridsData( absence_time, 'week', this.accumulated_total_grid_source_map, this.accumulated_total_grid_source, 'absence_time' );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tthis.sortAccumulatedTotalData();\n\t\tthis.timesheet_authorization_summary_grid.setData( this.accumulated_total_grid_source );\n\n\t\t$( '.timesheet-authorization-summary-title' ).text( $.i18n._( 'TimeSheet Summary' ) );\n\t}\n\n\tsortAccumulatedTotalData() {\n\t\tvar sort_fields = ['order', 'punch_info'];\n\t\tthis.accumulated_total_grid_source.sort( Global.m_sort_by( sort_fields ) );\n\t}\n\n\tgetAccumulatedTotalGridPayperiodHeader() {\n\t\tthis.pay_period_header = $.i18n._( 'No Pay Period' );\n\t\tvar pay_period_id = this.timesheet_verify_data.pay_period_id;\n\t\tif ( pay_period_id && this.pay_period_data ) {\n\t\t\tfor ( var key in this.pay_period_data ) {\n\t\t\t\tvar pay_period = this.pay_period_data[key];\n\t\t\t\tif ( pay_period.id === pay_period_id ) {\n\t\t\t\t\tvar start_date = Global.strToDate( pay_period.start_date ).format();\n\t\t\t\t\tvar end_date = Global.strToDate( pay_period.end_date ).format();\n\t\t\t\t\tthis.pay_period_header = start_date + ' to ' + end_date;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildAccumulatedTotalGrid( columns ) {\n\t\tvar $this = this;\n\t\tvar grid;\n\t\tif ( typeof columns == 'undefined' ) {\n\t\t\tcolumns = [];\n\t\t}\n\t\tif ( this.timesheet_authorization_summary_grid ) {\n\t\t\tthis.timesheet_authorization_summary_grid.grid.jqGrid( 'GridUnload' );\n\t\t\tthis.timesheet_authorization_summary_grid = null;\n\t\t}\n\t\tvar $this = this;\n\t\tthis.timesheet_authorization_summary_grid = new TTGrid( 'timesheet_authorization_summary_grid', {\n\t\t\tmultiselect: false,\n\t\t\twinMultiSelect: false,\n\t\t\tsortable: false,\n\t\t\tonResizeGrid: false,\n\t\t\tgridComplete: function() {\n\t\t\t\t$this.setTimeSheetSummaryGridSize();\n\t\t\t},\n\t\t\tondblClickRow: function() {\n\t\t\t\t$this.onTimeSheetGridDblClickRow();\n\t\t\t}\n\t\t}, columns );\n\t\tthis.setTimeSheetSummaryGridSize();\n\t}\n\n\tonTimeSheetGridDblClickRow() {\n\t\tvar filter = { filter_data: {} };\n\t\tfilter.user_id = this.current_edit_record.user_id;\n\t\tfilter.base_date = Global.strToDateTime( this.current_edit_record.start_date ).format();\n\t\tGlobal.addViewTab( this.viewId, $.i18n._( 'TimeSheet (Authorizations)' ), window.location.href );\n\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\t}\n\n\tonExceptionGridDblClickRow( row_id ) {\n\t\tvar date_stamp = this.exception_grid.grid.jqGrid( 'getCell', row_id, 'date_stamp' );\n\n\t\tif ( !date_stamp ) {\n\t\t\tdate_stamp = Global.strToDateTime( this.current_edit_record.start_date ).format();\n\t\t}\n\n\t\tvar filter = { filter_data: {} };\n\t\tfilter.user_id = this.current_edit_record.user_id;\n\t\tfilter.base_date = date_stamp;\n\t\tGlobal.addViewTab( this.viewId, $.i18n._( 'TimeSheet (Authorizations)' ), window.location.href );\n\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\t}\n\n\tonCellFormat( cell_value, related_data, row ) {\n\t\tcell_value = Global.decodeCellValue( cell_value );\n\t\tvar col_model = related_data.colModel;\n\t\tvar row_id = related_data.rowid;\n\t\tvar content_div = $( '<div class=\\'punch-content-div\\'></div>' );\n\t\tvar punch_info;\n\t\tif ( related_data.pos === 0 ) {\n\t\t\tif ( row.type === TimeSheetAuthorizationViewController.TOTAL_ROW ) {\n\t\t\t\tpunch_info = $( '<span class=\\'total\\' style=\\'font-size: 11px\\'></span>' );\n\t\t\t\tif ( Global.isSet( cell_value ) ) {\n\t\t\t\t\tpunch_info.text( cell_value );\n\t\t\t\t} else {\n\t\t\t\t\tpunch_info.text( '' );\n\t\t\t\t}\n\t\t\t\treturn punch_info.get( 0 ).outerHTML;\n\t\t\t} else if ( row.type === TimeSheetAuthorizationViewController.REGULAR_ROW ) {\n\t\t\t\tpunch_info = $( '<span class=\\'top-line-span\\' style=\\'font-size: 11px\\'></span>' );\n\t\t\t\tif ( Global.isSet( cell_value ) ) {\n\t\t\t\t\tpunch_info.text( cell_value );\n\t\t\t\t} else {\n\t\t\t\t\tpunch_info.text( '' );\n\t\t\t\t}\n\t\t\t\treturn punch_info.get( 0 ).outerHTML;\n\t\t\t}\n\t\t\treturn cell_value;\n\t\t}\n\t\tvar ex_span;\n\t\tvar i;\n\t\tvar time_span;\n\t\tvar punch;\n\t\tvar break_span;\n\t\tvar related_punch;\n\t\tvar exception;\n\t\tvar len;\n\t\tvar text;\n\t\tvar ex;\n\t\tvar data;\n\t\tif ( row.type === TimeSheetAuthorizationViewController.TOTAL_ROW ) {\n\t\t\tdata = row[col_model.name + '_data'];\n\t\t\ttime_span = $( '<span class=\\'total\\'></span>' );\n\t\t\tif ( Global.isSet( cell_value ) ) {\n\t\t\t\tif ( data ) {\n\t\t\t\t\tif ( data.hasOwnProperty( 'override' ) && data.override === true ) {\n\t\t\t\t\t\ttime_span.addClass( 'absence-override' );\n\t\t\t\t\t}\n\t\t\t\t\tif ( data.hasOwnProperty( 'note' ) && data.note ) {\n\t\t\t\t\t\tcell_value = '*' + cell_value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime_span.text( cell_value );\n\n\t\t\t} else {\n\t\t\t\ttime_span.text( '' );\n\t\t\t}\n\t\t\tcontent_div.prepend( time_span );\n\t\t} else if ( row.type === TimeSheetAuthorizationViewController.REGULAR_ROW ) {\n\t\t\tcontent_div.addClass( 'top-line' );\n\t\t\tdata = row[col_model.name + '_data'];\n\t\t\ttime_span = $( '<span ></span>' );\n\t\t\tif ( Global.isSet( cell_value ) ) {\n\t\t\t\tif ( data ) {\n\t\t\t\t\tif ( data.hasOwnProperty( 'override' ) && data.override === true ) {\n\t\t\t\t\t\ttime_span.addClass( 'absence-override' );\n\t\t\t\t\t}\n\t\t\t\t\tif ( data.hasOwnProperty( 'note' ) && data.note ) {\n\t\t\t\t\t\tcell_value = '*' + cell_value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime_span.text( cell_value );\n\t\t\t} else {\n\t\t\t\ttime_span.text( '' );\n\t\t\t}\n\t\t\tcontent_div.prepend( time_span );\n\t\t} else if ( row.type === TimeSheetAuthorizationViewController.ACCUMULATED_TIME_ROW ) {\n\t\t\tdata = row[col_model.name + '_data'];\n\t\t\ttime_span = $( '<span></span>' );\n\t\t\tif ( Global.isSet( cell_value ) ) {\n\t\t\t\tif ( data ) {\n\t\t\t\t\tif ( data.hasOwnProperty( 'override' ) && data.override === true ) {\n\t\t\t\t\t\ttime_span.addClass( 'absence-override' );\n\t\t\t\t\t}\n\t\t\t\t\tif ( data.hasOwnProperty( 'note' ) && data.note ) {\n\t\t\t\t\t\tcell_value = '*' + cell_value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttime_span.text( cell_value );\n\t\t\t} else {\n\t\t\t\ttime_span.text( '' );\n\t\t\t}\n\t\t\tcontent_div.prepend( time_span );\n\t\t} else {\n\t\t\ttime_span = $( '<span class=\\'punch-time\\'></span>' );\n\t\t\tif ( Global.isSet( cell_value ) ) {\n\t\t\t\ttime_span.text( cell_value );\n\t\t\t} else {\n\t\t\t\ttime_span.text( '' );\n\t\t\t}\n\t\t\tcontent_div.prepend( time_span );\n\t\t}\n\t\treturn content_div.get( 0 ).outerHTML;\n\t}\n\n\tsetExceptionGridSize() {\n\t\tif ( this.exception_grid ) {\n\t\t\tthis.exception_grid.grid.setGridWidth( $( '.exception-grid-div' ).width() + 1 );\n\n\t\t\tvar size = 2;\n\n\t\t\tvar data_array = this.exception_grid.getData();\n\t\t\tif ( Global.isArray( data_array ) ) {\n\t\t\t\tsize += ( 22 * data_array.length );\n\t\t\t}\n\n\t\t\tthis.exception_grid.setGridHeight( size );\n\t\t}\n\t}\n\n\tsetTimeSheetSummaryGridSize() {\n\t\tif ( this.timesheet_authorization_summary_grid ) {\n\t\t\tthis.timesheet_authorization_summary_grid.grid.setGridWidth( $( '.timesheet-authorization-grid-div' ).width() );\n\n\t\t\tvar size = 2;\n\n\t\t\tvar data_array = this.timesheet_authorization_summary_grid.getData();\n\t\t\tif ( Global.isArray( data_array ) ) {\n\t\t\t\tsize += ( 22 * data_array.length );\n\t\t\t}\n\n\t\t\tthis.timesheet_authorization_summary_grid.setGridHeight( size );\n\t\t}\n\t}\n\n}\n\nTimeSheetAuthorizationViewController.TOTAL_ROW = 4;\nTimeSheetAuthorizationViewController.REGULAR_ROW = 5;\nTimeSheetAuthorizationViewController.ABSENCE_ROW = 6;\nTimeSheetAuthorizationViewController.ACCUMULATED_TIME_ROW = 7;\nTimeSheetAuthorizationViewController.PREMIUM_ROW = 8;\n"],"sourceRoot":""}