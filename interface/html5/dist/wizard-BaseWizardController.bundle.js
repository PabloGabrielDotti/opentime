(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["wizard-BaseWizardController"],{9312:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"BaseWizardController":()=>r});var a=i(6739);class r extends a.TTBackboneView{constructor(e={}){_.defaults(e,{steps:0,title:"Wizard",current_step:1,content_div:null,next_btn:null,back_btn:null,done_btn:null,cancel_btn:null,progress:null,progress_label:null,stepsWidgetDic:null,stepsDataDic:null,default_data:null,call_back:null,saved_user_generic_data:null,script_name:null,user_generic_data_api:null,wizard_id:null,edit_view_ui_dic:{},edit_view_form_item_dic:{},events:{"click .close-btn":"onCloseClick","click .close-icon":"onCloseClick","click .wizard-overlay.onclick-close":"onCloseClick","click .forward-btn":"onNextClick","click .back-btn":"onBackClick","click .done-btn":"onDoneClick"}}),super(e)}initialize(e){super.initialize(e),this.content_div=$(this.el).find(".content"),this.stepsWidgetDic={},this.stepsDataDic={},this.default_data=r.default_data,this.call_back=r.call_back,r.default_data=null,r.call_back=null,this.user_generic_data_api=TTAPI.APIUserGenericData,LocalCacheData.current_open_wizard_controller=this,"function"==typeof this.init&&("function"==typeof this.setDefaultDataToSteps&&this.setDefaultDataToSteps(),this.init(e),TTPromise.resolve("BaseViewController","initialize"))}setDefaultDataToSteps(){}getDefaultData(e){return this.default_data?this.default_data[e]:null}render(){var e=$(this.el).find(".title"),t=$(this.el).find(".title-1");this.progress=$(this.el).find(".progress"),this.progress_label=$(this.el).find(".steps"),this.progress.attr("max",10),this.progress.val(0),this.next_btn=$(this.el).find(".forward-btn"),this.back_btn=$(this.el).find(".back-btn"),this.done_btn=$(this.el).find(".done-btn"),this.close_btn=$(this.el).find(".close-btn"),Global.setWidgetEnabled(this.back_btn,!1),Global.setWidgetEnabled(this.next_btn,!1),Global.setWidgetEnabled(this.close_btn,!1),Global.setWidgetEnabled(this.done_btn,!1),e.text(this.title),t.text(this.title),TTPromise.resolve("init","init")}setButtonsStatus(){Global.setWidgetEnabled(this.done_btn,!1),Global.setWidgetEnabled(this.close_btn,!0),1===this.current_step?Global.setWidgetEnabled(this.back_btn,!1):Global.setWidgetEnabled(this.back_btn,!0),this.current_step!==this.steps?(Global.setWidgetEnabled(this.done_btn,!1),Global.setWidgetEnabled(this.next_btn,!0)):(Global.setWidgetEnabled(this.done_btn,!0),Global.setWidgetEnabled(this.next_btn,!1))}onNextClick(){this.saveCurrentStep(),this.current_step=this.current_step+1,this.initCurrentStep()}onBackClick(){this.saveCurrentStep(),this.current_step=this.current_step-1,this.initCurrentStep()}onDoneClick(){}cleanStepsData(){this.stepsDataDic={},this.current_step=1}onCloseClick(){this.script_name&&(this.saveCurrentStep(),this.saveAllStepsToUserGenericData((function(){}))),LocalCacheData.current_open_wizard_controller=null,$(this.el).remove()}saveCurrentStep(e,t){}saveAllStepsToUserGenericData(e){this.script_name&&this.saved_user_generic_data?(this.saved_user_generic_data.data=this.stepsDataDic,this.saved_user_generic_data.data.current_step=this.current_step,this.user_generic_data_api.setUserGenericData(this.saved_user_generic_data,{onResult:function(t){e(t.getResult())}})):e(!0)}addEditFieldToColumn(e,t,i,a,r,n,s,l,o,d){var c=this,u=$(Global.loadWidgetByName(WidgetNamesDic.EDIT_VIEW_FORM_ITEM)),_=u.find(".edit-view-form-item-label-div"),p=u.find(".edit-view-form-item-label"),m=u.find(".edit-view-form-item-input-div"),b=t;if(Global.isArray(t))for(var h=0;h<t.length;h++)b=t[h];if(d?(p.parent().append(d),p.remove()):p.html(e+": "),Global.isSet(r)?m.append(r):m.append(b),i.append(u),!e)return m.remove(),_.remove(),u.append(b),void(n&&l&&(this.edit_view_form_item_dic[l]=u));if(n&&(Global.isArray(t)?this.edit_view_form_item_dic[t[0].getField()]=u:this.edit_view_form_item_dic[b.getField()]=u),Global.isArray(t))for(h=0;h<t.length;h++)b=t[h],this.stepsWidgetDic[this.current_step][b.getField()]=b,b.unbind("formItemChange").bind("formItemChange",(function(e,t,i){c.onFormItemChange(t,i)})),o&&(b.unbind("formItemKeyUp").bind("formItemKeyUp",(function(e,t){c.onFormItemKeyUp(t)})),b.unbind("formItemKeyDown").bind("formItemKeyDown",(function(e,t){c.onFormItemKeyDown(t)})));else this.stepsWidgetDic[this.current_step][b.getField()]=b,b.bind("formItemChange",(function(e,t,i){c.onFormItemChange(t,i)})),o&&(b.bind("formItemKeyUp",(function(e,t){c.onFormItemKeyUp(t)})),b.bind("formItemKeyDown",(function(e,t){c.onFormItemKeyDown(t)})));return u}initUserGenericData(){var e=this,t={};this.script_name?(t.filter_data={script:this.script_name,deleted:!1},this.user_generic_data_api.getUserGenericData(t,{onResult:function(t){var i=t.getResult();"array"===$.type(i)?(e.saved_user_generic_data=i[0],e.stepsDataDic=e.saved_user_generic_data.data):(e.saved_user_generic_data={},e.saved_user_generic_data.script=e.script_name,e.saved_user_generic_data.name=e.script_name,e.saved_user_generic_data.is_default=!1,e.saved_user_generic_data.data={current_step:1}),e.current_step=e.saved_user_generic_data.data.current_step,(e.current_step>e.steps||e.current_step<1)&&(e.current_step=1),e.initCurrentStep()}})):e.initCurrentStep()}initCurrentStep(){var e=this;e.progress_label.text("Step "+e.current_step+" of "+e.steps),e.progress.attr("max",e.steps),e.progress.val(e.current_step),e.buildCurrentStepUI(),e.buildCurrentStepData(),e.setCurrentStepValues(),e.setButtonsStatus()}buildCurrentStepUI(){}buildCurrentStepData(){}setCurrentStepValues(){}getLabel(){return $("<span class='wizard-label clear-both-div'></span>")}getCheckBox(e){var t=Global.loadWidgetByName(FormItemType.CHECKBOX);return t.TCheckbox({field:e}),t}getDatePicker(e){var t=Global.loadWidgetByName(FormItemType.DATE_PICKER);return t.TDatePicker({field:e}),t}getPasswordInput(e){var t=Global.loadWidgetByName(FormItemType.PASSWORD_INPUT);return t=t.TPasswordInput({field:e})}getTextInput(e,t){var i=Global.loadWidgetByName(FormItemType.TEXT_INPUT);return i=t?i.TPasswordInput({field:e,width:t}):i.TPasswordInput({field:e})}getText(){var e=Global.loadWidgetByName(FormItemType.TEXT);return e=e.TText({})}getTextArea(e,t,i){t||(t=300),i||(i=200);var a=Global.loadWidgetByName(FormItemType.TEXT_AREA);return a=a.TTextArea({field:e,width:t,height:i})}getComboBox(e,t){var i=Global.loadWidgetByName(FormItemType.COMBO_BOX);return i=i.TComboBox({field:e,set_empty:t})}getImageCutArea(e){var t=Global.loadWidgetByName(FormItemType.IMAGE_CUT);return t=t.TImageCutArea({field:e})}getCameraBrowser(e){var t=Global.loadWidgetByName(FormItemType.CAMERA_BROWSER);return t=t.CameraBrowser({field:e})}getFileBrowser(e,t,i,a){var r=Global.loadWidgetByName(FormItemType.IMAGE_BROWSER);return r=r.TImageBrowser({field:e,accept_filter:t,default_width:i,default_height:a})}getAComboBox(e,t,i,a,r,n){var s=Global.loadWidgetByName(FormItemType.AWESOME_BOX);return n||(n="id"),s.AComboBox({key:n,api_class:e,allow_multiple_selection:t,layout_name:i,show_search_inputs:!0,set_empty:!0,set_all:r,field:a}),s}getSimpleTComboBox(e,t){Global.isSet(t)||(t=!0);var i=Global.loadWidgetByName(FormItemType.AWESOME_BOX);return i=i.AComboBox({field:e,set_empty:!0,allow_multiple_selection:t,layout_name:"global_option_column",key:"value"})}onGridSelectRow(e){}onGridDblClickRow(e){}setGrid(e,t,i){i||(i=!1);var a=this;this.content_div.append(t);var r=t.find("#"+e);return this.getGridColumns(e,(function(t){a.stepsWidgetDic[a.current_step][e]=new TTGrid(e,{container_selector:".wizard",altRows:!0,onSelectRow:function(e){a.onGridSelectRow(e)},onSelectAll:function(e){for(var t in e)a.onGridSelectRow(e[t])},ondblClickRow:function(){a.onGridDblClickRow()},sortable:!1,height:75,multiselect:i,multiboxonly:i},t),a.setGridSize(a.stepsWidgetDic[a.current_step][e]),a.setGridGroupColumns(e)})),r}setGridGroupColumns(e){}setGridSize(e){e.grid.setGridWidth($(this.content_div.find(".grid-div")).width()-11),e.grid.setGridHeight(this.content_div.height()-150)}getGridColumns(e,t){}getRibbonButtonBox(){var e=$('<div class="menu ribbon-button-bar"></div>'),t=$("<ul></ul>");return e.append(t),e}getRibbonButton(e,t,i){return $('<li><div class="ribbon-sub-menu-icon" id="'+e+'"><img src="'+t+'" >'+i+"</div></li>")}showNoResultCover(e){if(e&&e instanceof jQuery){this.removeNoResultCover(e);var t=Global.loadWidgetByName(WidgetNamesDic.NO_RESULT_BOX);t.NoResultBox({related_view_controller:this,is_new:!1}),t.attr("class","no-result-div"),e.append(t)}}removeNoResultCover(e){e&&e instanceof jQuery&&e.find(".no-result-div").remove()}}r.default_data=null,r.callBack=null,r.openWizard=function(e,t){"ReportViewWizard"!=e&&LocalCacheData.current_open_wizard_controller&&LocalCacheData.current_open_wizard_controller.onCloseClick(),Global.loadViewSource(e,t,(function(e){var t=_.template(e);$("body").append(t({})),Global.setUIInitComplete()}))}}}]);
//# sourceMappingURL=wizard-BaseWizardController.bundle.js.map?v=5791f9c93396f2ea5734