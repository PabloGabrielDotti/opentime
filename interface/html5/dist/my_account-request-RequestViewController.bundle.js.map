{"version":3,"sources":["webpack://timetrex/./interface/html5/views/my_account/request/RequestViewController.js"],"names":["RequestViewController","RequestViewCommonController","options","_","defaults","el","type_array","status_array","api_request_schedule","authorization_api","hierarchy_type_id","messages","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIRequest","api_absence_policy","APIAbsencePolicy","api_schedule","APISchedule","message_control_api","APIMessageControl","Global","getProductEdition","APIRequestSchedule","job_api","APIJob","job_item_api","APIJobItem","APIAuthorization","initPermission","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","callBack","initDropDownOptions","option_name","result","buildEditViewUI","tab_model","setTabModel","edit_view","find","css","tab_request","edit_view_tab","tab_request_column1","tab_request_column2","edit_view_tabs","push","form_item_input","loadWidgetByName","FormItemType","TEXT_INPUT","TTextInput","field","width","addEditFieldToColumn","TEXT_AREA","TTextArea","height","widgetContainer","label","TEXT","TText","COMBO_BOX","TComboBox","set_empty","setSourceData","DATE_PICKER","TDatePicker","append","PermissionManager","validate","10","20","form_item_sun_checkbox","CHECKBOX","TCheckbox","form_item_mon_checkbox","form_item_tue_checkbox","form_item_wed_checkbox","form_item_thu_checkbox","form_item_fri_checkbox","form_item_sat_checkbox","sun","mon","tue","wed","thu","fri","sat","addClass","TIME_PICKER","TTimePicker","AWESOME_BOX","AComboBox","api_class","APISchedulePolicy","allow_multiple_selection","layout_name","show_search_inputs","customSearchFilter","filter_data","user_id","LocalCacheData","getLoginUser","id","available_balance_info","getRealImagePath","APIBranch","show_branch_ui","APIDepartment","show_department_ui","setRealValueCallBack","val","job_coder","setValue","manual_id","added_items","value","default_item","selected_item","disable_keyup_event","show_job_ui","detachElement","job_item_coder","show_job_item_ui","edit_view_ui_dic","available_balance","parents","hide","hideAdvancedFields","onTypeChanged","onWorkingStatusChanged","buildSearchFields","search_fields","SearchField","in_column","APIUser","multiple","basic_search","adv_search","form_item_type","exclude","include","ContextMenuIconName","add","group","icon","Icons","new_add","view","edit","delete_icon","delete_and_next","send","cancel","sort_order","timesheet","schedule","edit_employee","employee","export_excel","current_edit_record","key","hasOwnProperty","widget","isSet","is_add","loginUser","first_name","last_name","is_viewing","is_edit","subject","collectUIDataToCurrentEditRecord","setEditViewDataDone","initViewingView","message","type_id","dow","one_selected","indexOf","i","show","current_doing_context_action","setURL","doNotSetFocus","context_menu_array","selectContextMenu","setTotalDisplaySpan","len","length","grid_selected_length","getGridSelectIdArray","context_btn","attr","removeClass","setDefaultMenuAddIcon","setDefaultMenuViewIcon","setDefaultMenuEditIcon","setDefaultMenuDeleteIcon","setDefaultMenuDeleteAndNextIcon","setDefaultMenuSendIcon","setDefaultMenuCancelIcon","setDefaultMenuEditEmployeeIcon","setDefaultMenuExportIcon","setContextMenuGroupVisibility","setEditMenuAddIcon","setEditMenuViewIcon","setEditMenuEditIcon","setEditMenuDeleteIcon","setEditMenuDeleteAndNextIcon","setEditMenuSaveIcon","setEditMenuNavViewIcon","setEditMenuNavEditIcon","pId","sub_view_mode","edit_only_mode","undefined","grid","arg","date_stamp","start_date","end_date","showAdvancedFields","getValue","request_schedule_status_id","$this","setRequestFormDefaultData","getAvailableBalance","setCurrentEditRecordData","getScheduleTotalTime","data","callback_function","enable_validation","setUIWidgetFieldsToCurrentEditRecord","filter","uniformVariable","buildDataForAPI","getRequestScheduleDefaultData","onResult","res","getResult","status_id","setDefaultData","buildDataFromAPI","absence_policy_id","TTUUID","zero_id","retval","onViewClick","TFeedback","source","records","msg","uniformMessageVariable","request_schedule","ignoreWarning","record","key_name","onSaveResult","EmbeddedMessage","reply","isValid","removeEditView","setErrorTips","setErrorMenu","set_default_menu","page_action","page_number","refresh_id","search","editPermissionValidate","checkTopLevelPermission","addPermissionValidate","editChildPermissionValidate","onNavigationClick","onSaveClick","did_clean","parent","hasClass","setEnabled","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","getField","c_value","needs_callback","setJobItemValueWhenJobChanged","setCheckBox","onJobQuickSearch","onDateStampChanged","onStartDateChanged","onAvailableBalanceChange","finishFormItemChange","selected_absence_policy_record","setEditMenu","validateResult","TTPromise","wait","setCurrentEditViewState","openEditView","buildAddViewUI","extend","onAddResult","resolve","data_array","initOptions","onAddClick"],"mappings":"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","file":"my_account-request-RequestViewController.bundle.js?v=3c79973f8d63830073ed","sourcesContent":["export class RequestViewController extends RequestViewCommonController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#request_view_container',\n\n\t\t\ttype_array: null,\n\t\t\tstatus_array: null,\n\n\t\t\tapi_request_schedule: null,\n\t\t\tauthorization_api: null,\n\t\t\thierarchy_type_id: false,\n\t\t\tmessages: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options);\n\t\tthis.edit_view_tpl = 'RequestEditView.html';\n\t\tthis.permission_id = 'request';\n\t\tthis.viewId = 'Request';\n\t\tthis.script_name = 'RequestView';\n\t\tthis.table_name_key = 'request';\n\t\tthis.context_menu_name = $.i18n._( 'Requests' );\n\t\tthis.navigation_label = $.i18n._( 'Request' ) + ':';\n\t\tthis.api = TTAPI.APIRequest;\n\t\tthis.api_absence_policy = TTAPI.APIAbsencePolicy;\n\t\tthis.api_schedule = TTAPI.APISchedule;\n\t\tthis.message_control_api = TTAPI.APIMessageControl;\n\n\t\tif ( ( Global.getProductEdition() >= 15 ) ) {\n\t\t\tthis.api_request_schedule = TTAPI.APIRequestSchedule;\n\t\t}\n\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\tthis.job_api = TTAPI.APIJob;\n\t\t\tthis.job_item_api = TTAPI.APIJobItem;\n\t\t}\n\n\t\tthis.authorization_api = TTAPI.APIAuthorization;\n\n\t\tthis.initPermission();\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\t// override allows a callback after initOptions when run as sub view (from EmployeeViewController)\n\tinitOptions( callBack ) {\n\n\t\tvar options = [\n\t\t\t{ option_name: 'status' },\n\t\t\t{ option_name: 'type' }\n\t\t];\n\n\t\tthis.initDropDownOptions( options, function( result ) {\n\n\t\t\tif ( callBack ) {\n\t\t\t\tcallBack( result ); // First to initialize drop down options, and then to initialize edit view UI.\n\t\t\t}\n\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar tab_model = {\n\t\t\t'tab_request': { 'label': $.i18n._( 'Message' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\t//This hides the audit tab as this view is always used for creating/replying to an existing request.\n\t\t//For some reason removing 'tab_audit' from the model above results in a blank tab appearing.\n\t\tvar tab_audit_label = this.edit_view.find( 'a[ref=tab_audit]' );\n\t\ttab_audit_label.css( 'display', 'none' );\n\n\t\t//Tab 0 start\n\n\t\tvar tab_request = this.edit_view_tab.find( '#tab_request' );\n\t\tvar tab_request_column1 = tab_request.find( '.first-column' );\n\t\tvar tab_request_column2 = tab_request.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_request_column1 );\n\n\t\t// Subject\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'subject', width: 359 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Subject' ), form_item_input, tab_request_column1, '' );\n\n\t\t// Body\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\n\t\tform_item_input.TTextArea( { field: 'body', width: 600, height: 400 } );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Body' ), form_item_input, tab_request_column1, '', null, null, true );\n\n\t\ttab_request_column2.css( 'display', 'none' );\n\t}\n\n\tbuildAddViewUI() {\n\t\tsuper.buildEditViewUI();\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_request': { 'label': $.i18n._( 'Request' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\t//This hides the audit tab as this view is always used for creating/replying to an existing request.\n\t\t//For some reason removing 'tab_audit' from the model above results in a blank tab appearing.\n\t\tvar tab_audit_label = this.edit_view.find( 'a[ref=tab_audit]' );\n\t\ttab_audit_label.css( 'display', 'none' );\n\n\t\t//Tab 0 start\n\t\tvar tab_request = this.edit_view_tab.find( '#tab_request' );\n\t\tvar tab_request_column1 = tab_request.find( '.first-column' );\n\t\tvar tab_request_column2 = tab_request.find( '.second-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\t\tthis.edit_view_tabs[0].push( tab_request_column1 );\n\t\tthis.edit_view_tabs[0].push( tab_request_column2 );\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\tform_item_input.TText( { field: 'full_name' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_request_column1, '' );\n\n\t\t// Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'type_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_request_column1 );\n\n\t\t// Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\tform_item_input.TDatePicker( { field: 'date_stamp' } );\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'> ' + $.i18n._( '(Use the first or only date affected by this request)' ) + '</span>' );\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Date' ), form_item_input, tab_request_column1, '', widgetContainer );\n\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\t//Working Status\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\tform_item_input.TComboBox( { field: 'request_schedule_status_id', set_empty: false } );\n\t\t\tform_item_input.setSourceData( { 10: 'Working', 20: 'Absent' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Start Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Start Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t//End  Date\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'End Date' ), form_item_input, tab_request_column1, '' );\n\n\t\t\t// Effective Days\n\t\t\tvar form_item_sun_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sun_checkbox.TCheckbox( { field: 'sun' } );\n\n\t\t\tvar form_item_mon_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_mon_checkbox.TCheckbox( { field: 'mon' } );\n\n\t\t\tvar form_item_tue_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_tue_checkbox.TCheckbox( { field: 'tue' } );\n\n\t\t\tvar form_item_wed_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_wed_checkbox.TCheckbox( { field: 'wed' } );\n\n\t\t\tvar form_item_thu_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_thu_checkbox.TCheckbox( { field: 'thu' } );\n\n\t\t\tvar form_item_fri_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_fri_checkbox.TCheckbox( { field: 'fri' } );\n\n\t\t\tvar form_item_sat_checkbox = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\t\tform_item_sat_checkbox.TCheckbox( { field: 'sat' } );\n\n\t\t\twidgetContainer = $( '<div></div>' );\n\n\t\t\tvar sun = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sun' ) + ' <br> ' + ' </span>' );\n\t\t\tvar mon = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Mon' ) + ' <br> ' + ' </span>' );\n\t\t\tvar tue = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Tue' ) + ' <br> ' + ' </span>' );\n\t\t\tvar wed = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Wed' ) + ' <br> ' + ' </span>' );\n\t\t\tvar thu = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Thu' ) + ' <br> ' + ' </span>' );\n\t\t\tvar fri = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Fri' ) + ' <br> ' + ' </span>' );\n\t\t\tvar sat = $( '<span class=\\'widget-top-label\\'> ' + $.i18n._( 'Sat' ) + ' <br> ' + ' </span>' );\n\n\t\t\tsun.append( form_item_sun_checkbox );\n\t\t\tmon.append( form_item_mon_checkbox );\n\t\t\ttue.append( form_item_tue_checkbox );\n\t\t\twed.append( form_item_wed_checkbox );\n\t\t\tthu.append( form_item_thu_checkbox );\n\t\t\tfri.append( form_item_fri_checkbox );\n\t\t\tsat.append( form_item_sat_checkbox );\n\n\t\t\twidgetContainer.append( sun );\n\t\t\twidgetContainer.append( mon );\n\t\t\twidgetContainer.append( tue );\n\t\t\twidgetContainer.append( wed );\n\t\t\twidgetContainer.append( thu );\n\t\t\twidgetContainer.append( fri );\n\t\t\twidgetContainer.append( sat );\n\n\t\t\twidgetContainer.addClass( 'request_edit_view_effective_days' );\n\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Effective Days' ), [form_item_sun_checkbox, form_item_mon_checkbox, form_item_tue_checkbox, form_item_wed_checkbox, form_item_thu_checkbox, form_item_fri_checkbox, form_item_sat_checkbox], tab_request_column1, '', widgetContainer, false, true );\n\n\t\t\t//Start time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'start_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'In' ), form_item_input, tab_request_column1 );\n\n\t\t\t//End  time\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TIME_PICKER );\n\t\t\tform_item_input.TTimePicker( { field: 'end_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Out' ), form_item_input, tab_request_column1 );\n\n\t\t\t// Total\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'total_time' } );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Total' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Schedule Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APISchedulePolicy,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_schedule',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'schedule_policy_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Schedule Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Absence Policy\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIAbsencePolicy,\n\t\t\t\tcustomSearchFilter: function() {\n\t\t\t\t\treturn { filter_data: { user_id: LocalCacheData.getLoginUser().id } };\n\t\t\t\t},\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_absences',\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'absence_policy_id'\n\t\t\t} );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Absence Policy' ), form_item_input, tab_request_column1 );\n\n\t\t\t//Available Balance\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\tform_item_input.TText( { field: 'available_balance' } );\n\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\tthis.available_balance_info = $( '<img class=\"available-balance-info\" src=\"' + Global.getRealImagePath( 'images/infox16x16.png' ) + '\">' );\n\t\t\twidgetContainer.append( form_item_input );\n\t\t\twidgetContainer.append( this.available_balance_info );\n\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Available Balance' ), form_item_input, tab_request_column1, '', widgetContainer, true );\n\n\t\t\t//branch\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'branch_id'\n\t\t\t} );\n\t\t\tif ( this.show_branch_ui ) {\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Branch' ), form_item_input, tab_request_column1 );\n\t\t\t}\n\n\t\t\t//Dept\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tform_item_input.AComboBox( {\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tallow_multiple_selection: false,\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tshow_search_inputs: true,\n\t\t\t\tset_empty: true,\n\t\t\t\tfield: 'department_id'\n\t\t\t} );\n\n\t\t\tif ( this.show_department_ui ) {\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Department' ), form_item_input, tab_request_column1 );\n\t\t\t}\n\n\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t//Job\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJob,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_coder.TTextInput( { field: 'job_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Job' ), [form_item_input, job_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_ui ) {\n\t\t\t\t\t//invalid permissions\n\t\t\t\t\tthis.detachElement( 'job_id' );\n\t\t\t\t}\n\t\t\t\t//Job Item\n\t\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\t\t\tform_item_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIJobItem,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_job_item',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tsetRealValueCallBack: ( function( val ) {\n\n\t\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\t\tjob_item_coder.setValue( val.manual_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ),\n\t\t\t\t\tfield: 'job_item_id',\n\t\t\t\t\tadded_items: [\n\t\t\t\t\t\t{ value: '-1', label: Global.default_item },\n\t\t\t\t\t\t{ value: '-2', label: Global.selected_item }\n\t\t\t\t\t]\n\t\t\t\t} );\n\n\t\t\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\t\t\tvar job_item_coder = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tjob_item_coder.TTextInput( { field: 'job_item_quick_search', disable_keyup_event: true } );\n\t\t\t\tjob_item_coder.addClass( 'job-coder' );\n\n\t\t\t\twidgetContainer.append( job_item_coder );\n\t\t\t\twidgetContainer.append( form_item_input );\n\t\t\t\tthis.addEditFieldToColumn( $.i18n._( 'Task' ), [form_item_input, job_item_coder], tab_request_column1, '', widgetContainer, true );\n\n\t\t\t\tif ( !this.show_job_item_ui ) {\n\t\t\t\t\t//invalid permissions\n\t\t\t\t\tthis.detachElement( 'job_item_id' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Message\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_AREA );\n\t\tform_item_input.TTextArea( { field: 'message', width: 400, height: 300 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Reason / Message' ), form_item_input, tab_request_column1, '', null, null, true );\n\n\t\t//hide initially hidden fields.\n\t\t//tab_request_column2.css( 'display', 'none' );\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\tthis.hideAdvancedFields();\n\t\t}\n\n\t\tthis.onTypeChanged();\n\t\tthis.onWorkingStatusChanged();\n\t}\n\n\tbuildSearchFields() {\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Start Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'start_date',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'End Date' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'end_date',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.DATE_PICKER\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\texclude: ['default'],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'New' ),\n\t\t\t\t\tid: ContextMenuIconName.add,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.new_add\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'View' ),\n\t\t\t\t\tid: ContextMenuIconName.view,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.view\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Reply' ),\n\t\t\t\t\tid: ContextMenuIconName.edit,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.edit\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Delete' ),\n\t\t\t\t\tid: ContextMenuIconName.delete_icon,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.delete_icon\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Delete<br>& Next' ),\n\t\t\t\t\tid: ContextMenuIconName.delete_and_next,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.delete_and_next\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Send' ),\n\t\t\t\t\tid: ContextMenuIconName.send,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.send\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Cancel' ),\n\t\t\t\t\tid: ContextMenuIconName.cancel,\n\t\t\t\t\tgroup: 'editor',\n\t\t\t\t\ticon: Icons.cancel,\n\t\t\t\t\tsort_order: 1990\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'TimeSheet' ),\n\t\t\t\t\tid: ContextMenuIconName.timesheet,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.timesheet\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Schedule' ),\n\t\t\t\t\tid: ContextMenuIconName.schedule,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.schedule\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Edit<br>Employee' ),\n\t\t\t\t\tid: ContextMenuIconName.edit_employee,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.employee\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Export' ),\n\t\t\t\t\tid: ContextMenuIconName.export_excel,\n\t\t\t\t\tgroup: 'other',\n\t\t\t\t\ticon: Icons.export_excel,\n\t\t\t\t\tsort_order: 9000\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tsetCurrentEditRecordData( current_edit_record ) {\n\t\tif ( current_edit_record ) {\n\t\t\tthis.current_edit_record = current_edit_record;\n\t\t}\n\n\t\tif ( !this.current_edit_record ) {\n\t\t\tthis.current_edit_record = {};\n\t\t}\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tif ( !this.current_edit_record.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'full_name':\n\t\t\t\t\t\tif ( this.is_add ) {\n\t\t\t\t\t\t\twidget.setValue( LocalCacheData.loginUser.first_name + ' ' + LocalCacheData.loginUser.last_name );\n\t\t\t\t\t\t} else if ( this.is_viewing ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record['first_name'] + ' ' + this.current_edit_record['last_name'] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'subject':\n\t\t\t\t\t\t// Error: Uncaught TypeError: Cannot read property '0' of null in /interface/html5/#!m=Request&a=view&id=13185&tab=Request line 505\n\t\t\t\t\t\tif ( this.is_edit && this.messages ) {\n\t\t\t\t\t\t\twidget.setValue( 'Re: ' + this.messages[0].subject );\n\t\t\t\t\t\t} else if ( this.is_viewing ) {\n\t\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\n\t\t//a new request comes from the current user.\n\t\tif ( this.is_add ) {\n\t\t\tthis.current_edit_record.user_id = LocalCacheData.loginUser.id;\n\t\t}\n\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tvar $this = this;\n\t\tsuper.setEditViewDataDone();\n\t\tif ( this.is_viewing ) {\n\n\t\t} else {\n\t\t\tif ( Global.isSet( $this.messages ) ) {\n\t\t\t\t$this.messages = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tinitViewingView() {\n\t\tsuper.initViewingView();\n\t\tif ( this.edit_view_ui_dic.message ) {\n\t\t\tthis.edit_view_ui_dic.message.parents( '.edit-view-form-item-div' ).hide();\n\t\t}\n\t\tif ( Global.getProductEdition() >= 15 && ( this.edit_view_ui_dic.type_id == 30 || this.edit_view_ui_dic.type_id == 40 ) ) {\n\t\t\tvar dow = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n\t\t\tvar one_selected = false;\n\t\t\tfor ( var key in this.current_edit_record ) {\n\t\t\t\tif ( dow.indexOf( key ) > -1 ) {\n\t\t\t\t\tfor ( var i = 0; i < 7; i++ ) {\n\t\t\t\t\t\tif ( this.current_edit_record[key] !== 0 && this.current_edit_record[key] !== false ) {\n\t\t\t\t\t\t\tone_selected = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( one_selected ) {\n\t\t\t\t\t\tthis.edit_view_ui_dic['sun'].parents( '.edit-view-form-item-div' ).show();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.edit_view_ui_dic['sun'].parents( '.edit-view-form-item-div' ).hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetURL() {\n\n\t\tif ( LocalCacheData.current_doing_context_action === 'edit' ) {\n\t\t\tLocalCacheData.current_doing_context_action = '';\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.setURL();\n\t}\n\n\tsetDefaultMenu( doNotSetFocus ) {\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Employee&a=edit&id=42411&tab=Wage line 282\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !Global.isSet( doNotSetFocus ) || !doNotSetFocus ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setDefaultMenuAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length, 'request' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setDefaultMenuDeleteIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.send:\n\t\t\t\t\tthis.setDefaultMenuSendIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\t\tthis.setDefaultMenuEditEmployeeIcon( context_btn, grid_selected_length, 'user' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetEditMenu() {\n\t\tthis.selectContextMenu();\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setEditMenuAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn, 'request' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setEditMenuDeleteIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setEditMenuDeleteAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.send:\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setEditMenuNavViewIcon( context_btn, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\t\tthis.setEditMenuNavViewIcon( context_btn, 'schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\t\tthis.setEditMenuNavEditIcon( context_btn, 'user' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetDefaultMenuCancelIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.sub_view_mode && !this.is_viewing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuExportIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( this.edit_only_mode || this.grid == undefined ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t} else {\n\t\t\tif ( this.is_viewing || this.is_edit || this.is_add ) {\n\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetEditMenuAddIcon( context_btn, pId ) {\n\t\tsuper.setEditMenuAddIcon( context_btn, pId );\n\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteAndNextIcon( context_btn, pId ) {\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuNavViewIcon( context_btn, pId ) {\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuViewIcon( context_btn, pId ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetEditMenuDeleteIcon( context_btn, pId ) {\n\t\tif ( this.is_edit || this.is_add ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tonTypeChanged( arg ) {\n\t\tif ( this.current_edit_record && Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) && ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) ) { //schedule adjustment || absence selected\n\n\t\t\tif ( this.edit_view_ui_dic.date_stamp ) {\n\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t\tif ( this.current_edit_record.date_stamp != undefined && this.current_edit_record.start_date == '' ) {\n\t\t\t\tthis.edit_view_ui_dic.start_date.setValue( this.current_edit_record.date_stamp );\n\t\t\t\tthis.current_edit_record.start_date = this.current_edit_record.date_stamp;\n\t\t\t}\n\t\t\tif ( this.current_edit_record.date_stamp != undefined && this.current_edit_record.end_date == '' ) {\n\t\t\t\tthis.edit_view_ui_dic.end_date.setValue( this.current_edit_record.date_stamp );\n\t\t\t\tthis.current_edit_record.end_date = this.current_edit_record.date_stamp;\n\t\t\t}\n\t\t\tthis.showAdvancedFields( false ); //Don't update schedule total time as it will be done lower down in setRequestFormDefaultData();\n\n\t\t\tif ( this.edit_view_ui_dic.type_id.getValue() == 30 ) {\n\t\t\t\tthis.edit_view_ui_dic.request_schedule_status_id.setValue( 20 );\n\t\t\t} else if ( this.edit_view_ui_dic.type_id.getValue() == 40 ) {\n\t\t\t\tthis.edit_view_ui_dic.request_schedule_status_id.setValue( 10 );\n\t\t\t}\n\n\t\t\tif ( arg ) {\n\t\t\t\targ.request_schedule_status_id = this.edit_view_ui_dic.request_schedule_status_id.getValue(); //arg is passed on setRequestFormDefaultData() below, so make sure it matches the UI here.\n\t\t\t}\n\n\t\t\tthis.onWorkingStatusChanged();\n\n\t\t\tvar $this = this;\n\t\t\tthis.setRequestFormDefaultData( arg, function() {\n\t\t\t\t$this.getAvailableBalance();\n\t\t\t\t$this.setCurrentEditRecordData( $this.current_edit_record );\n\t\t\t\t$this.getScheduleTotalTime();\n\t\t\t} );\n\t\t} else {\n\n\t\t\tthis.hideAdvancedFields();\n\t\t\tif ( this.edit_view_ui_dic.date_stamp ) {\n\t\t\t\tthis.edit_view_ui_dic.date_stamp.parents( '.edit-view-form-item-div' ).show();\n\t\t\t}\n\t\t\tthis.onWorkingStatusChanged();\n\t\t}\n\t}\n\n\tsetRequestFormDefaultData( data, callback_function ) {\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) && ( this.current_edit_record.type_id == 30 || this.current_edit_record.type_id == 40 ) ) {\n\t\t\tif ( data == undefined ) {\n\t\t\t\tvar $this = this;\n\t\t\t\tthis.enable_validation = false;\n\t\t\t\tthis.setUIWidgetFieldsToCurrentEditRecord();\n\t\t\t\tvar filter = this.uniformVariable( this.buildDataForAPI( this.current_edit_record ) );\n\n\t\t\t\tthis.api_request_schedule.getRequestScheduleDefaultData( filter, {\n\t\t\t\t\tonResult: function( res ) {\n\n\t\t\t\t\t\tdata = res.getResult();\n\t\t\t\t\t\tdata.request_schedule_status_id = data.status_id;\n\t\t\t\t\t\tdata.date_stamp = data.start_date;\n\n\t\t\t\t\t\t//force = true is required to set the current_edit_record and populate edit_view_ui_dic\n\t\t\t\t\t\t$this.setDefaultData( data, true );\n\t\t\t\t\t\tif ( callback_function ) {\n\t\t\t\t\t\t\tcallback_function();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tdata.date_stamp = data.start_date;\n\t\t\t\tdata = this.buildDataFromAPI( data );\n\t\t\t\t//force = true is required to set the current_edit_record and populate edit_view_ui_dic\n\t\t\t\tthis.setDefaultData( data, true );\n\t\t\t\tif ( callback_function ) {\n\t\t\t\t\tcallback_function();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonAvailableBalanceChange() {\n\t\tif ( Global.getProductEdition() >= 15 && PermissionManager.validate( 'request', 'add_advanced' ) ) {\n\t\t\tif ( this.edit_view_ui_dic && this.edit_view_ui_dic.absence_policy_id && this.edit_view_ui_dic.request_schedule_status_id.getValue() == 20 && this.edit_view_ui_dic.absence_policy_id.getValue() != TTUUID.zero_id ) {\n\t\t\t\tthis.getAvailableBalance();\n\t\t\t} else if ( this.edit_view_ui_dic && this.edit_view_ui_dic.available_balance ) {\n\t\t\t\tthis.edit_view_ui_dic.available_balance.parents( '.edit-view-form-item-div' ).hide();\n\t\t\t}\n\t\t}\n\t}\n\n\t//post hook for onSaveResult\n\tonSaveDone( result ) {\n\t\tvar retval;\n\t\tif ( this.is_edit ) {\n\t\t\tthis.onViewClick( this.current_edit_record.id );\n\t\t\tretval = false;\n\t\t} else {\n\t\t\tretval = true;\n\t\t}\n\t\t$().TFeedback( {\n\t\t\tsource: 'Send'\n\t\t} );\n\t\treturn retval;\n\t}\n\n\tuniformVariable( records ) {\n\t\tif ( typeof records === 'object' ) {\n\t\t\trecords.user_id = LocalCacheData.loginUser.id;\n\t\t\trecords.first_name = LocalCacheData.loginUser.first_name;\n\t\t\trecords.last_name = LocalCacheData.loginUser.last_name;\n\t\t}\n\n\t\tif ( this.is_add ) {\n\t\t\trecords = this.buildDataForAPI( records );\n\t\t} else if ( this.is_edit ) {\n\t\t\tvar msg = this.uniformMessageVariable( records );\n\n\t\t\tif ( records && records.request_schedule ) {\n\t\t\t\tmsg.request_schedule = records.request_schedule;\n\t\t\t}\n\n\t\t\treturn msg;\n\t\t}\n\n\t\treturn records;\n\t}\n\n\tonSaveClick( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tLocalCacheData.current_doing_context_action = 'save';\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\n\t\tfor ( var key in $this.current_edit_record ) {\n\t\t\tif ( $this.edit_view_ui_dic[key] != undefined ) {\n\t\t\t\t$this.current_edit_record[key] = $this.edit_view_ui_dic[key].getValue();\n\t\t\t}\n\t\t}\n\n\t\tif ( this.is_add ) {\n\t\t\t// //format data as expected by API\n\t\t\trecord = this.uniformVariable( $this.current_edit_record );\n\n\t\t\tthis.api['set' + this.api.key_name]( record, false, ignoreWarning, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onSaveResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else if ( this.is_edit ) {\n\t\t\tvar record = {};\n\t\t\tthis.is_add = false;\n\t\t\tthis.setCurrentEditRecordData();\n\t\t\trecord = this.uniformVariable( this.current_edit_record );\n\t\t\tEmbeddedMessage.reply( [record], ignoreWarning, function( result ) {\n\t\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\t\tvar id = $this.current_edit_record.id;\n\t\t\t\t\t\t//see #2224 - Unable to get property 'find' of undefined\n\t\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t\t$this.onViewClick( id );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.setErrorTips( result );\n\t\t\t\t\t\t$this.setErrorMenu();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tsearch( set_default_menu, page_action, page_number, callBack ) {\n\t\tthis.refresh_id = null;\n\t\tsuper.search( set_default_menu, page_action, page_number, callBack );\n\t}\n\n\tsetDefaultMenuEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuScheduleIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !PermissionManager.checkTopLevelPermission( 'Schedule' ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuSendIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuEditEmployeeIcon( context_btn, grid_selected_length ) {\n\t\tif ( !this.editChildPermissionValidate( 'user' ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\tcase ContextMenuIconName.schedule:\n\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\tthis.onNavigationClick( id );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.send:\n\t\t\t\tthis.onSaveClick();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tsetEditViewWidgetsMode() {\n\t\tvar did_clean = false;\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\twidget.css( 'opacity', 1 );\n\t\t\tvar column = widget.parent().parent().parent();\n\t\t\tif ( !column.hasClass( 'v-box' ) ) {\n\t\t\t\tif ( !did_clean ) {\n\t\t\t\t\tdid_clean = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.is_viewing ) {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( false );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tthis.current_edit_record[key] = c_value;\n\t\tvar needs_callback = false;\n\n\t\tswitch ( key ) {\n\t\t\tcase 'job_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\t\tthis.setJobItemValueWhenJobChanged( target.getValue( true ), 'job_item_id' );\n\t\t\t\t\tthis.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_item_id':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setValue( target.getValue( true ) ? ( target.getValue( true ).manual_id ? target.getValue( true ).manual_id : '' ) : '' );\n\t\t\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'job_quick_search':\n\t\t\tcase 'job_item_quick_search':\n\t\t\t\tif ( ( Global.getProductEdition() >= 20 ) ) {\n\t\t\t\t\tthis.onJobQuickSearch( key, c_value, 'job_id', 'job_item_id' );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'type_id':\n\t\t\t\tdoNotValidate = true;\n\t\t\t\tthis.onTypeChanged();\n\t\t\t\tbreak;\n\t\t\tcase 'date_stamp':\n\t\t\t\tthis.onDateStampChanged();\n\t\t\t\tbreak;\n\t\t\tcase 'request_schedule_status_id':\n\t\t\t\tthis.onWorkingStatusChanged();\n\t\t\t\tbreak;\n\t\t\tcase 'start_date':\n\t\t\t\tthis.current_edit_record.start_date = this.edit_view_ui_dic.start_date.getValue();\n\t\t\t\tthis.current_edit_record.date_stamp = this.edit_view_ui_dic.start_date.getValue();\n\t\t\t\tthis.onStartDateChanged();\n\n\t\t\t\tthis.onAvailableBalanceChange();\n\t\t\t\tthis.setRequestFormDefaultData( null, function() {\n\t\t\t\t\tfinishFormItemChange();\n\t\t\t\t} );\n\t\t\t\tneeds_callback = true;\n\n\t\t\t\tbreak;\n\t\t\tcase 'end_date':\n\t\t\t\tthis.current_edit_record.end_date = this.edit_view_ui_dic.end_date.getValue();\n\n\t\t\t\tthis.onAvailableBalanceChange();\n\t\t\t\tthis.setRequestFormDefaultData( null, function() {\n\t\t\t\t\tfinishFormItemChange();\n\t\t\t\t} );\n\t\t\t\tneeds_callback = true;\n\n\t\t\t\tbreak;\n\t\t\tcase 'start_time':\n\t\t\tcase 'end_time':\n\t\t\tcase 'sun':\n\t\t\tcase 'tue':\n\t\t\tcase 'wed':\n\t\t\tcase 'thu':\n\t\t\tcase 'fri':\n\t\t\tcase 'sat':\n\t\t\t\tthis.getScheduleTotalTime();\n\t\t\t\tbreak;\n\t\t\tcase'absence_policy_id':\n\t\t\t\tthis.selected_absence_policy_record = this.edit_view_ui_dic.absence_policy_id.getValue();\n\t\t\t\tthis.onAvailableBalanceChange();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ( !needs_callback ) {\n\t\t\tfinishFormItemChange();\n\t\t}\n\n\t\tfunction finishFormItemChange() {\n\t\t\tif ( key === 'date_stamp' ||\n\t\t\t\tkey === 'start_date_stamps' ||\n\t\t\t\tkey === 'start_date' ||\n\t\t\t\tkey === 'end_date' ||\n\t\t\t\tkey === 'start_date_stamp' ||\n\t\t\t\tkey === 'start_time' ||\n\t\t\t\tkey === 'end_time' ||\n\t\t\t\tkey === 'schedule_policy_id' ||\n\t\t\t\tkey === 'absence_policy_id' ) {\n\n\t\t\t\tif ( $this.current_edit_record['date_stamp'] !== '' &&\n\t\t\t\t\t$this.current_edit_record['start_time'] !== '' &&\n\t\t\t\t\t$this.current_edit_record['end_time'] !== '' ) {\n\n\t\t\t\t\t$this.getScheduleTotalTime();\n\t\t\t\t} else {\n\t\t\t\t\t$this.onAvailableBalanceChange();\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( !doNotValidate ) {\n\t\t\t\t$this.validate();\n\t\t\t}\n\t\t\t$this.setEditMenu();\n\t\t}\n\t}\n\n\tvalidate() {\n\t\tvar $this = this;\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\t\tvar api = this.message_control_api;\n\t\tif ( this.is_add ) {\n\t\t\trecord = this.buildDataForAPI( record );\n\t\t\tapi = this.api;\n\t\t}\n\n\t\tapi['validate' + api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.validateResult( result );\n\t\t\t}\n\t\t} );\n\t}\n\n\tonAddClick( data ) {\n\t\tTTPromise.add( 'Request', 'add' );\n\t\tTTPromise.wait();\n\t\tvar $this = this;\n\t\tif ( this.edit_view ) {\n\t\t\tthis.removeEditView();\n\t\t}\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tthis.openEditView();\n\t\tthis.buildAddViewUI();\n\t\t//Error: Uncaught TypeError: undefined is not a function in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-111140 line 897\n\t\tif ( $this.api && typeof $this.api['get' + $this.api.key_name + 'DefaultData'] === 'function' ) {\n\t\t\t$this.api['get' + $this.api.key_name + 'DefaultData']( {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tif ( data ) {\n\t\t\t\t\t\t//data passed should overwrite the default data from the API.\n\t\t\t\t\t\tresult = $.extend( {}, result.getResult(), data );\n\t\t\t\t\t}\n\t\t\t\t\t$this.onAddResult( result );\n\t\t\t\t\t$this.onDateStampChanged();\n\t\t\t\t\tif ( result.type_id ) {\n\t\t\t\t\t\t$this.onTypeChanged( result );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.getScheduleTotalTime(); //This is called as part of onTypeChanged(), so it doesn't need to be done twice.\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'Request', 'add' );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\t//To be called only by external scripts creating requests (timesheet and schedule at this time)\n\topenAddView( data_array ) {\n\t\tthis.sub_view_mode = true;\n\t\tthis.edit_only_mode = true;\n\t\tvar $this = this;\n\t\tthis.initOptions( function() {\n\t\t\t$this.onAddClick( data_array );\n\t\t} );\n\t}\n\n}"],"sourceRoot":""}