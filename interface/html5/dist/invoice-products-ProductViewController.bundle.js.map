{"version":3,"sources":["webpack://timetrex/./interface/html5/views/invoice/products/ProductViewController.js"],"names":["ProductViewController","BaseViewController","options","_","defaults","el","type_array","apply_frequency_array","month_of_year_array","day_of_month_array","day_of_week_array","length_of_service_unit_array","date_api","group_api","product_price_api","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIProduct","APITTDate","APIProductGroup","APIProductPrice","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","callBack","$this","option_name","field_name","APICompany","initDropDownOptions","result","getProductGroup","onResult","res","getResult","Global","buildTreeRecord","edit_only_mode","sub_view_mode","basic_search_field_ui_dic","setSourceData","group_array","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_product_column1","edit_view_tab","find","edit_view_tabs","push","form_item_input","loadWidgetByName","FormItemType","COMBO_BOX","TComboBox","field","set_empty","addEditFieldToColumn","status_array","AWESOME_BOX","tree_mode","TEXT_INPUT","TTextInput","width","parent","CHECKBOX","TCheckbox","APITaxPolicy","TAG_INPUT","TTagInput","object_type_id","tab_pricing","tab_pricing_column1","APICurrency","unit_price_type_array","inside_editor_div","args","quantity","unit_price","editor","INSIDE_EDITOR","InsideEditor","addRow","insideEditorAddRow","removeRow","insideEditorRemoveRow","getValue","insideEditorGetValue","setValue","insideEditorSetValue","render_args","row_render","parent_controller","append","tab_shipping_column1","weight_unit_array","dimension_unit_array","country_array","current_edit_record","type_id","hide","getEditViewTabIndex","tabs","show","unit_price_type_id","is_mass_editing","attachElement","css","detachElement","editFieldResize","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","key","getField","c_value","onTypeChange","validate","val","length","removeAllRows","i","isSet","row","getTimeUnit","parent_id","data","index","widgetContainer","label","getRowRender","getRender","widgets","children","eq","setWidgetEnableBaseOnParentController","current_edit_item","insertAfter","rows_widgets_array","splice","is_viewing","addIconsEvent","removeLastRowLine","rowIndex","remove_id","TTUUID","isUUID","zero_id","not_exist_id","delete_ids","remove","current_edit_item_id","len","product_id","setEditViewDataDone","initInsideEditorData","copied_record_id","filter_data","getProductPrice","edit_view","refresh_id","remove_ids","deleteProductPrice","isValid","setProductPrice","result_data","saveInsideEditorData","search","onSaveDone","removeEditView","setErrorTips","setErrorMenu","onCopyAsNewClick","setCurrentEditViewState","LocalCacheData","current_doing_context_action","_continueDoCopyAsNew","TAlertManager","showAlert","onCancelClick","openEditView","parent_key","parent_value","initEditView","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type","APIUser"],"mappings":"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","file":"invoice-products-ProductViewController.bundle.js?v=630fdd7d62b46f7db27b","sourcesContent":["export class ProductViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#product_view_container',\n\n\t\t\ttype_array: null,\n\t\t\tapply_frequency_array: null,\n\t\t\tmonth_of_year_array: null,\n\t\t\tday_of_month_array: null,\n\t\t\tday_of_week_array: null,\n\t\t\tlength_of_service_unit_array: null,\n\t\t\tdate_api: null,\n\t\t\tgroup_api: null,\n\n\t\t\tproduct_price_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'ProductEditView.html';\n\t\tthis.permission_id = 'product';\n\t\tthis.viewId = 'Product';\n\t\tthis.script_name = 'ProductView';\n\t\tthis.table_name_key = 'product';\n\t\tthis.context_menu_name = $.i18n._( 'Products' );\n\t\tthis.navigation_label = $.i18n._( 'Product' ) + ':';\n\t\tthis.api = TTAPI.APIProduct;\n\t\tthis.date_api = TTAPI.APITTDate;\n\t\tthis.group_api = TTAPI.APIProductGroup;\n\t\tthis.product_price_api = TTAPI.APIProductPrice;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\tinitOptions( callBack ) {\n\t\tvar $this = this;\n\t\tvar options = [\n\t\t\t{ option_name: 'type', field_name: null, api: null },\n\t\t\t{ option_name: 'status', field_name: null, api: null },\n\t\t\t{ option_name: 'unit_price_type', field_name: null, api: null },\n\t\t\t{ option_name: 'weight_unit', field_name: null, api: null },\n\t\t\t{ option_name: 'dimension_unit', field_name: null, api: null },\n\t\t\t{ option_name: 'country', field_name: null, api: TTAPI.APICompany }\n\n\t\t];\n\n\t\tthis.initDropDownOptions( options, function( result ) {\n\n\t\t\t$this.group_api.getProductGroup( '', false, false, {\n\t\t\t\tonResult: function( res ) {\n\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tres = Global.buildTreeRecord( res );\n\n\t\t\t\t\tif ( !$this.edit_only_mode ) {\n\t\t\t\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['group_id'] ) {\n\t\t\t\t\t\t\t$this.basic_search_field_ui_dic['group_id'].setSourceData( res );\n//\t\t\t\t\t\t$this.adv_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t$this.group_array = res;\n\n\t\t\t\t\tif ( callBack ) {\n\t\t\t\t\t\tcallBack( result ); // First to initialize drop down options, and then to initialize edit view UI.\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_product': { 'label': $.i18n._( 'Product' ) },\n\t\t\t'tab_pricing': { 'label': $.i18n._( 'Pricing' ) },\n\t\t\t'tab_shipping': { 'label': $.i18n._( 'Shipping' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIProduct,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_product',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_product = this.edit_view_tab.find( '#tab_product' );\n\n\t\tvar tab_product_column1 = tab_product.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_product_column1 );\n\n\t\t//Type\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'type_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Status\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'status_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Group\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\ttree_mode: true,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_tree_column',\n\t\t\tset_empty: true,\n\t\t\tfield: 'group_id'\n\t\t} );\n\t\tform_item_input.setSourceData( $this.group_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Group' ), form_item_input, tab_product_column1 );\n\n\t\t//Part Number\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'part_number' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Part Number' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Name\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_product_column1, '' );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t//Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'description', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Description' ), form_item_input, tab_product_column1, '' );\n\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Lock Description\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'description_locked' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Lock Description' ), form_item_input, tab_product_column1 );\n\n\t\t//UPC\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'upc' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'UPC' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Current Stock\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'quantity' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Current Stock' ), form_item_input, tab_product_column1, '' );\n\n\t\t// Include Tax Policy\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APITaxPolicy,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_tax_policy',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'include_tax_policy'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Include Tax Policy' ), form_item_input, tab_product_column1, '' );\n\n\t\t// Exclude Tax Policy\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APITaxPolicy,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_tax_policy',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'exclude_tax_policy'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Exclude Tax Policy' ), form_item_input, tab_product_column1, '' );\n\n\t\t//Tags\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TAG_INPUT );\n\n\t\tform_item_input.TTagInput( { field: 'tag', object_type_id: 900 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tags' ), form_item_input, tab_product_column1, '', null, null, true );\n\n\t\t//Tab 1 start\n\n\t\tvar tab_pricing = this.edit_view_tab.find( '#tab_pricing' );\n\n\t\tvar tab_pricing_column1 = tab_pricing.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[1] = [];\n\n\t\tthis.edit_view_tabs[1].push( tab_pricing_column1 );\n\n\t\t//Unit Cost\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'unit_cost', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Unit Cost' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t//Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tshow_search_inputs: true,\n\t\t\tfield: 'currency_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Currency' ), form_item_input, tab_pricing_column1 );\n\n\t\t//Minimum Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'minimum_purchase_quantity', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Minimum Quantity' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t//Maximum Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'maximum_purchase_quantity', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Maximum Quantity' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t// Lock Price\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.CHECKBOX );\n\t\tform_item_input.TCheckbox( { field: 'price_locked' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Lock Price' ), form_item_input, tab_pricing_column1 );\n\n\t\t// Price Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'unit_price_type_id' } );\n\t\tform_item_input.setSourceData( $this.unit_price_type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Price Type' ), form_item_input, tab_pricing_column1, '' );\n\n\t\t//Unit Price\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'unit_price', width: 80 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Unit Price' ), form_item_input, tab_pricing_column1, '', null, true );\n\n\t\t//Inside editor\n\t\tvar inside_editor_div = tab_pricing.find( '.inside-editor-div' );\n\t\tvar args = {\n\t\t\tquantity: $.i18n._( 'Quantity' ),\n\t\t\tunit_price: $.i18n._( 'Unit Price' )\n\n\t\t};\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\tthis.editor.InsideEditor( {\n\t\t\taddRow: this.insideEditorAddRow,\n\t\t\tremoveRow: this.insideEditorRemoveRow,\n\t\t\tgetValue: this.insideEditorGetValue,\n\t\t\tsetValue: this.insideEditorSetValue,\n\t\t\trender: 'views/invoice/products/ProductInsideEditorRender.html',\n\t\t\trender_args: args,\n\t\t\trow_render: 'views/invoice/products/ProductInsideEditorRow.html',\n\t\t\tparent_controller: this\n\t\t} );\n\n\t\tinside_editor_div.append( this.editor );\n\n\t\t//Tab 2 start\n\n\t\tvar tab_shipping = this.edit_view_tab.find( '#tab_shipping' );\n\n\t\tvar tab_shipping_column1 = tab_shipping.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[2] = [];\n\n\t\tthis.edit_view_tabs[2].push( tab_shipping_column1 );\n\n\t\t// Weight Unit\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'weight_unit_id' } );\n\t\tform_item_input.setSourceData( $this.weight_unit_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Weight Unit' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Weight\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'weight' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Weight' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t// Dimension Unit\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'dimension_unit_id' } );\n\t\tform_item_input.setSourceData( $this.dimension_unit_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Dimension Unit' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Length\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'dimension_length' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Length' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Width\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'dimension_width' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Width' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Height\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'dimension_height' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Height' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t// Country\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\n\t\tform_item_input.TComboBox( { field: 'origin_country', set_empty: true } );\n\t\tform_item_input.setSourceData( $this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Origin Country' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Tariff Code\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'tariff_code' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Tariff Code' ), form_item_input, tab_shipping_column1, '' );\n\n\t\t//Custom Unit Value\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'customs_unit_value' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Custom Unit Value' ), form_item_input, tab_shipping_column1, '' );\n\t}\n\n\tonTypeChange() {\n\n\t\tif ( this.current_edit_record['type_id'] != 10 && this.current_edit_record.type_id != 62 ) {\n\t\t\t$( this.edit_view_tab.find( 'ul li' )[2] ).hide();\n\n\t\t\tif ( this.getEditViewTabIndex() == 2 ) {\n\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', 0 );\n\t\t\t}\n\n\t\t} else {\n\t\t\t$( this.edit_view_tab.find( 'ul li' )[2] ).show();\n\t\t}\n\n\t\tif ( ( this.current_edit_record['unit_price_type_id'] == 20 ||\n\t\t\tthis.current_edit_record.unit_price_type_id == 30 ) && !this.is_mass_editing ) {\n\n\t\t\tthis.detachElement( 'unit_price' );\n\t\t\tthis.editor.css( 'display', 'block' );\n\n\t\t} else {\n\n\t\t\tthis.attachElement( 'unit_price' );\n\t\t\tthis.editor.css( 'display', 'none' );\n\t\t}\n\n\t\tthis.editFieldResize();\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\t\tthis.current_edit_record[key] = c_value;\n\t\tif ( key === 'type_id' || key === 'unit_price_type_id' ) {\n\n\t\t\tthis.onTypeChange();\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tinsideEditorSetValue( val ) {\n\t\tvar len = val.length;\n\n\t\tthis.removeAllRows();\n\t\tfor ( var i = 0; i < val.length; i++ ) {\n\t\t\tif ( Global.isSet( val[i] ) ) {\n\t\t\t\tvar row = val[i];\n\t\t\t\trow['accrual_rate'] = Global.getTimeUnit( row['accrual_rate'] );\n\t\t\t\trow['maximum_time'] = Global.getTimeUnit( row['maximum_time'] );\n\t\t\t\trow['rollover_time'] = Global.getTimeUnit( row['rollover_time'] );\n\t\t\t\tif ( Global.isSet( this.parent_id ) ) {\n\t\t\t\t\trow['id'] = '';\n\t\t\t\t}\n\t\t\t\tthis.addRow( row );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinsideEditorAddRow( data, index ) {\n\n\t\tif ( !data ) {\n\t\t\tdata = {};\n\t\t}\n\n\t\tvar $this = this;\n\t\tvar row = this.getRowRender(); //Get Row render\n\t\tvar render = this.getRender(); //get render, should be a table\n\t\tvar widgets = {}; //Save each row's widgets\n\n\t\tvar form_item_input;\n\t\tvar widgetContainer;\n\t\tvar label;\n\n\t\t//Build row widgets\n\n\t\t// Quantity\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'quantity', width: 60 } );\n\t\tform_item_input.setValue( data.quantity ? data.quantity : 0 );\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\tlabel = $( '<span class=\\'widget-right-label\\'> ' + $.i18n._( 'or more' ) + '</span>' );\n\n\t\twidgetContainer.append( form_item_input );\n\t\twidgetContainer.append( label );\n\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 0 ).append( widgetContainer );\n\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\t// Unit Price\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'unit_price', width: 60 } );\n\t\tform_item_input.setValue( data.unit_price ? data.unit_price : '0.00' );\n\t\twidgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\n\t\twidgetContainer.append( form_item_input );\n\n\t\twidgets[form_item_input.getField()] = form_item_input;\n\t\trow.children().eq( 1 ).append( widgetContainer );\n\n\t\tthis.setWidgetEnableBaseOnParentController( form_item_input );\n\n\t\twidgets.current_edit_item = data;\n\n\t\tif ( !this.parent_controller.current_edit_record.id ) {\n\t\t\twidgets.current_edit_item.id = '';\n\t\t}\n\n\t\tif ( typeof index != 'undefined' ) {\n\n\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\tthis.rows_widgets_array.splice( ( index ), 0, widgets );\n\n\t\t} else {\n\t\t\t$( render ).append( row );\n\t\t\tthis.rows_widgets_array.push( widgets );\n\t\t}\n\t\tif ( this.parent_controller.is_viewing ) {\n\t\t\trow.find( '.control-icon' ).hide();\n\t\t}\n\n\t\tthis.addIconsEvent( row ); //Bind event to add and minus icon\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorRemoveRow( row ) {\n\t\tvar index = row[0].rowIndex - 1;\n\t\tvar remove_id = this.rows_widgets_array[index].current_edit_item.id;\n\t\tif ( TTUUID.isUUID( remove_id ) && remove_id != TTUUID.zero_id && remove_id != TTUUID.not_exist_id ) {\n\t\t\tthis.delete_ids.push( remove_id );\n\t\t}\n\t\trow.remove();\n\t\tthis.rows_widgets_array.splice( index, 1 );\n\t\tthis.removeLastRowLine();\n\t}\n\n\tinsideEditorGetValue( current_edit_item_id ) {\n\t\tvar len = this.rows_widgets_array.length;\n\t\tvar result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tvar data = row.current_edit_item;\n\t\t\tdata.quantity = row.quantity.getValue();\n\t\t\tdata.unit_price = row.unit_price.getValue();\n\t\t\tdata.product_id = current_edit_item_id;\n\t\t\tresult.push( data );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\t\tthis.onTypeChange();\n\t\tthis.initInsideEditorData();\n\t}\n\n\tinitInsideEditorData() {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.copied_record_id ) {\n\t\t\t$this.editor.removeAllRows();\n\t\t\t$this.editor.addRow();\n\n\t\t} else {\n\t\t\targs.filter_data.product_id = this.current_edit_record.id ? this.current_edit_record.id : this.copied_record_id;\n\t\t\tthis.copied_record_id = '';\n\t\t\tthis.product_price_api.getProductPrice( args, true, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar data = res.getResult();\n\t\t\t\t\tif ( data === true ) { // result is null\n\t\t\t\t\t\t$this.editor.addRow();\n\t\t\t\t\t} else if ( data.length > 0 ) {\n\t\t\t\t\t\t$this.editor.setValue( data );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsaveInsideEditorData( callBack ) {\n\t\tif ( ( this.current_edit_record['unit_price_type_id'] != 20 &&\n\t\t\tthis.current_edit_record.unit_price_type_id != 30 ) || this.is_mass_editing ) {\n\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar $this = this;\n\t\tvar data = this.editor.getValue( this.refresh_id );\n\t\tvar remove_ids = $this.editor.delete_ids;\n\t\tif ( remove_ids.length > 0 ) {\n\t\t\t$this.product_price_api.deleteProductPrice( remove_ids, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t\t$this.editor.delete_ids = [];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t$this.product_price_api.setProductPrice( data, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tvar res_data = res.getResult();\n\t\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id; // as add\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onSaveDone( result );\n\n\t\t\t\t$this.removeEditView();\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndContinueResult( result ) {\n\t//\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onEditClick( $this.refresh_id, true );\n\t//\n\t// \t\t\t$this.onSaveAndContinueDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t// onSaveAndNewResult: function( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onAddClick( true );\n\t//\n\t// \t\t} );\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onCopyAsNewClick();\n\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndNextResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t//\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t//\n\t// \t\t$this.saveInsideEditorData( function() {\n\t// \t\t\t$this.onRightArrowClick();\n\t// \t\t\t$this.search( false );\n\t// \t\t\t$this.onSaveAndNextDone( result );\n\t//\n\t// \t\t} );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\t_continueDoCopyAsNew() {\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\t\t\tfor ( var i = 0; i < this.editor.rows_widgets_array.length; i++ ) {\n\t\t\t\tthis.editor.rows_widgets_array[i].current_edit_item.id = '';\n\t\t\t}\n\t\t}\n\t\tsuper._continueDoCopyAsNew();\n\t}\n\n\tonCopyAsNewResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist' ) );\n\t\t\t$this.onCancelClick();\n\t\t\treturn;\n\t\t}\n\n\t\t$this.openEditView(); // Put it here is to avoid if the selected one is not existed in data or have deleted by other pragram. in this case, the edit view should not be opend.\n\n\t\tresult_data = result_data[0];\n\t\tthis.copied_record_id = result_data.id;\n\t\tresult_data.id = '';\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.initEditView();\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Group' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tmultiple: true,\n\t\t\t\tfield: 'group_id',\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\ttree_mode: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Tags' ),\n\t\t\t\tfield: 'tag',\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tin_column: 1,\n\t\t\t\tobject_type_id: 900,\n\t\t\t\tform_item_type: FormItemType.TAG_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Part Number' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'part_number',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Description' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'description',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n}\n"],"sourceRoot":""}