(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["employees-remittance_destination_account-RemittanceDestinationAccountViewController"],{4333:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"RemittanceDestinationAccountViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#remittance_destination_account_view_container",status_array:null,type_array:null,priority_array:[],amount_type_array:null,ach_transaction_type_array:null,ach_transaction_type_data:null,remittance_source_account_array:null,company_api:null,user_default_api:null,user_api:null,legal_entity_id:!1,remittance_source_account_api:null,sub_document_view_controller:null,document_object_type_id:null,is_first_load:!0,is_subview:!1}),super(e)}init(e){this.type_array=[],this.edit_view_tpl="RemittanceDestinationAccountEditView.html",this.permission_id="remittance_destination_account",this.viewId="RemittanceDestinationAccount",this.script_name="RemittanceDestinationAccountView",this.table_name_key="remittance_destination_account",this.context_menu_name=$.i18n._("Pay Methods"),this.navigation_label=$.i18n._("Pay Methods")+":",this.document_object_type_id=320,this.api=TTAPI.APIRemittanceDestinationAccount,this.company_api=TTAPI.APICompany,this.user_api=TTAPI.APIUser,this.user_default_api=TTAPI.APIUserDefault,this.remittance_source_account_api=TTAPI.APIRemittanceSourceAccount,this.render(),this.sub_view_mode?this.buildContextMenu(!0):this.buildContextMenu(),this.sub_view_mode||this.initData(),this.setSelectRibbonMenuIfNecessary()}initOptions(){var e=this;this.initDropDownOption("status"),this.initDropDownOption("amount_type"),this.api.getOptions("priority",{onResult:function(t){e.priority_array=t.getResult()}}),this.api.getOptions("ach_transaction_type",{onResult:function(t){var i=t.getResult();e.ach_transaction_type_data=i,e.ach_transaction_type_array=Global.buildRecordArray(i)}}),this.remittance_source_account_api.getOptions("type",{onResult:function(t){t=t.getResult(),e.basic_search_field_ui_dic&&e.basic_search_field_ui_dic.type_id&&e.basic_search_field_ui_dic.type_id.setSourceData(Global.buildRecordArray(t)),e.adv_search_field_ui_dic&&e.adv_search_field_ui_dic.type_id&&e.adv_search_field_ui_dic.type_id.setSourceData(Global.buildRecordArray(t))}})}getDefaultDisplayColumns(e){var t=this;this.api.getOptions("default_display_columns",{onResult:function(i){var a=i.getResult();for(var _ in t.default_display_columns=[],a)(1!=t.is_subview||"user_first_name"!=a[_]&&"user_last_name"!=a[_])&&t.default_display_columns.push(a[_]);e&&e()}})}attachElement(e){if(this.edit_view_form_item_dic&&this.edit_view_form_item_dic[e]){var t=$(".place_holder_"+e);return this.edit_view_form_item_dic[e].insertBefore(t),t.remove(),$(this.edit_view_form_item_dic[e].find(".edit-view-form-item-label"))}}setCurrentEditRecordData(){for(var e in this.current_edit_record)if(this.current_edit_record.hasOwnProperty(e)){var t=this.edit_view_ui_dic[e];if("value1"===e&&this.current_edit_record[e]&&!this.is_mass_editing&&(Global.isSet(this.ach_transaction_type_data[this.current_edit_record[e]])?this.edit_view_ui_dic.value1_2.setValue(this.current_edit_record[e]):this.edit_view_ui_dic.value1_1.setValue(this.current_edit_record[e])),Global.isSet(t))switch(e){case"amount_type_id":this.onAmountTypeChange(this.current_edit_record[e]),t.setValue(this.current_edit_record[e]);break;case"value1_1":case"value1_2":case"type_id":break;case"currency_id":case"remittance_source_account_id":t.setValue(this.current_edit_record[e]),this.detachElement(e);break;default:t.setValue(this.current_edit_record[e])}}PermissionManager.validate(this.permission_id,"edit")||PermissionManager.validate(this.permission_id,"edit_child")||(this.current_edit_record.user_id=LocalCacheData.getLoginUser().id,this.edit_view_ui_dic.user_id.setValue(LocalCacheData.getLoginUser().id),this.edit_view_ui_dic.user_id.setEnabled(!1)),this.getLegalEntity(),this.setEditViewDataDone()}setEditViewDataDone(){super.setEditViewDataDone(),this.getTypeOptions(),this.getRemittanceSourceAccount(),this.onTypeChange(),this.getRemittanceSourceAccount(),this.edit_view_ui_dic.legal_entity_id.setEnabled(!1)}getTypeOptions(){var e=this,t={};this.is_mass_editing?t.company_id=LocalCacheData.getLoginUser().company_id:t.legal_entity_id=this.current_edit_record.legal_entity_id,this.api.getOptions("type",t,{async:!1,onResult:function(t){var i=t.getResult();i||(i=[]),e.type_array=Global.buildRecordArray(i),e.edit_view_ui_dic.type_id.setSourceData(e.type_array),e.current_edit_record.type_id&&i[e.current_edit_record.type_id]?e.edit_view_ui_dic.type_id.setValue(e.current_edit_record.type_id):e.current_edit_record.type_id=e.edit_view_ui_dic.type_id.getValue(),e.onTypeChange(e.current_edit_record.type_id)}})}getLegalEntity(){var e=this;if(this.edit_view_ui_dic&&this.edit_view_ui_dic.user_id&&this.edit_view_ui_dic.user_id.getValue()!=TTUUID.zero_id){var t=this.edit_view_ui_dic.user_id.getValue();Global.isSet(t)&&!Global.isFalseOrNull(t)||(t=this.current_edit_record.user_id);var i={filter_data:{},filter_columns:{id:!0,legal_entity_id:!0,currency_id:!0}};i.filter_data.id=t,this.user_api.getUser(i,{async:!1,onResult:function(t){if(t.isValid()){var i=t.getResult()[0];Global.isSet(i.legal_entity_id)&&0!==i.legal_entity_id&&(e.current_edit_record.legal_entity_id=i.legal_entity_id,e.edit_view_ui_dic.legal_entity_id.setValue(i.legal_entity_id)),Global.isSet(i.currency_id)&&!Global.isSet(e.current_edit_record.currency_id)&&(e.current_edit_record.currency_id=i.currency_id,e.edit_view_ui_dic.currency_id.setValue(i.currency_id))}}}),Global.isSet(this.current_edit_record.legal_entity_id)&&!Global.isFalseOrNull(this.current_edit_record.legal_entity_id)||this.user_default_api["get"+this.user_default_api.key_name]({async:!1,onResult:function(t){var i=t.getResult();e.current_edit_record.legal_entity_id=i[0].legal_entity_id,e.edit_view_ui_dic.legal_entity_id.setValue(i[0].legal_entity_id)}})}else e.current_edit_record.legal_entity_id=TTUUID.zero_id,e.edit_view_ui_dic.legal_entity_id.setValue(TTUUID.zero_id)}getRemittanceSourceAccount(){var e=this,t=this.edit_view_ui_dic.type_id.getValue(),i=this.edit_view_ui_dic.legal_entity_id.getValue();Global.isSet(t)&&!Global.isFalseOrNull(t)||(t=this.current_edit_record.type_id);var a={filter_data:{}};a.filter_data.type_id=t,this.is_mass_editing?a.filter_data.company_id=[LocalCacheData.getLoginUser().company_id,TTUUID.not_exist_id]:a.filter_data.legal_entity_id=[i,TTUUID.not_exist_id],e.edit_view_ui_dic.remittance_source_account_id.setValue(0),e.edit_view_ui_dic.remittance_source_account_id.setSourceData(null),e.edit_view_ui_dic.remittance_source_account_id.setDefaultArgs(a),this.remittance_source_account_api.getRemittanceSourceAccount(a,{async:!1,onResult:function(t){var i=t.getResult();i||(i=[]),e.remittance_source_account_array=i,e.edit_view_ui_dic.remittance_source_account_id.setSourceData(e.remittance_source_account_array);var a=!1;for(var _ in i)i.hasOwnProperty(_)&&(i[_].id==TTUUID.zero_id||i[_].id==TTUUID.not_exist_id||a||(a=_),e.current_edit_record.remittance_source_account_id&&e.current_edit_record.remittance_source_account_id==i[_].id&&e.edit_view_ui_dic.remittance_source_account_id.setValue(e.current_edit_record.remittance_source_account_id));"object"!=typeof i||e.current_edit_record.id||(e.is_first_load||0==e.current_edit_record.type_id?(e.is_first_load=!1,0!==e.edit_view_ui_dic.remittance_source_account_id.getValue()&&Global.isFalseOrNull(e.edit_view_ui_dic.remittance_source_account_id.getValue())&&e.edit_view_ui_dic.remittance_source_account_id.setValue(i[a].id)):Global.isFalseOrNull(e.edit_view_ui_dic.remittance_source_account_id.getValue())&&e.edit_view_ui_dic.remittance_source_account_id.setValue(i[a].id)),e.onTypeChange()}}),e.current_edit_record.remittance_source_account_id=e.edit_view_ui_dic.remittance_source_account_id.getValue()}uniformVariable(e){if(this.edit_view_ui_dic&&this.current_edit_record.remittance_source_account_id!=TTUUID.zero_id)for(var t=1;t<=10;t++)1==t?this.edit_view_ui_dic.value1_1&&this.edit_view_ui_dic.value1_1.is(":visible")?e.value1=e.value1_1?e.value1_1:this.edit_view_ui_dic.value1_1.getValue():this.edit_view_ui_dic.value1_2&&this.edit_view_ui_dic.value1_2.is(":visible")?e.value1=e.value1_2?e.value1_2:this.edit_view_ui_dic.value1_2.getValue():this.is_mass_editing||(e.value1=!1):!this.is_mass_editing&&e["value"+t]&&(void 0===this.edit_view_ui_dic["value"+t]||this.edit_view_ui_dic["value"+t]&&0==this.edit_view_ui_dic["value"+t].is(":visible"))&&(e["value"+t]=!1);return this.is_mass_editing||(e.legal_entity_id=this.current_edit_record.legal_entity_id),e}getCustomContextMenuModel(){return{exclude:[],include:[{label:$.i18n._("Import"),id:ContextMenuIconName.import_icon,group:"other",icon:Icons.import_icon,permission_result:PermissionManager.checkTopLevelPermission("ImportCSVEmployeeBankAccount"),permission:null,sort_order:8e3}]}}onCustomContextClick(e){switch(e){case ContextMenuIconName.import_icon:this.onImportClick()}}onImportClick(){var e=this;IndexViewController.openWizard("ImportCSVWizard","RemittanceDestinationAccount",(function(){e.search()}))}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),a=e.getValue();switch(i){case"value1_1":case"value1_2":this.current_edit_record.value1=a;break;case"remittance_source_account_id":case"country":case"type_id":this.onTypeChange(a);break;case"user_id":this.getLegalEntity(),this.getTypeOptions(),this.edit_view_ui_dic.currency_id.setValue(this.current_edit_record.currency_id);break;case"amount_type_id":this.onAmountTypeChange(a)}"type_id"!==i&&"user_id"!==i||this.getRemittanceSourceAccount(),this.current_edit_record[i]=a,t||this.validate()}onTypeChange(e){Global.isSet(e)&&!Global.isFalseOrNull(e)||(Global.isSet(this.current_edit_record.type_id)&&!Global.isFalseOrNull(this.current_edit_record.type_id)||(this.current_edit_record.type_id=2e3),e=this.current_edit_record.type_id),this.detachElement("value1_1"),this.detachElement("value1_2"),this.detachElement("value2"),this.detachElement("value3"),this.detachElement("value4"),this.detachElement("value5"),this.detachElement("value6"),this.detachElement("value7"),this.detachElement("value8"),this.detachElement("value9"),this.detachElement("value10");var t=null;if(3e3==this.edit_view_ui_dic.type_id.getValue()&&this.edit_view_ui_dic.remittance_source_account_id.getValue()!=TTUUID.zero_id){if(this.edit_view_ui_dic.remittance_source_account_id.getValue())t=this.remittance_source_account_api.getRemittanceSourceAccount({filter_data:{id:this.edit_view_ui_dic.remittance_source_account_id.getValue()}},{async:!1}).getResult()[0].country;this.is_mass_editing||null==t||("US"==t?(this.attachElement("value1_2").text($.i18n._("Account Type")+":"),this.attachElement("value2").text($.i18n._("Routing")+":"),this.attachElement("value3").text($.i18n._("Account")+":"),Global.isFalseOrNull(this.current_edit_record.value1)&&(this.current_edit_record.value1=this.edit_view_ui_dic.value1_2.getValue(),this.current_edit_record.value1_2=this.edit_view_ui_dic.value1_2.getValue())):"CA"==t||-1!=$.inArray(t,["AG","BS","BB","BZ","DO","GY","HT","JM","DM","GD","KN","LC","VC","SR","TT"])?(this.attachElement("value1_1").text($.i18n._("Institution")+":"),this.attachElement("value2").text($.i18n._("Bank Transit")+":"),this.attachElement("value3").text($.i18n._("Account")+":"),this.current_edit_record.value1=this.edit_view_ui_dic.value1_1.getValue(),this.current_edit_record.value1_1=this.edit_view_ui_dic.value1_1.getValue()):(this.attachElement("value1_2").text($.i18n._("Account Type")+":"),this.attachElement("value2").text($.i18n._("Routing")+":"),this.attachElement("value3").text($.i18n._("Account")+":"),Global.isFalseOrNull(this.current_edit_record.value1)&&(this.current_edit_record.value1=this.edit_view_ui_dic.value1_2.getValue(),this.current_edit_record.value1_2=this.edit_view_ui_dic.value1_2.getValue())))}this.editFieldResize()}onAmountTypeChange(e){Global.isSet(e)&&!Global.isFalseOrNull(e)||(Global.isSet(this.current_edit_record.amount_type_id)&&!Global.isFalseOrNull(this.current_edit_record.amount_type_id)||(this.current_edit_record.amount_type_id=10),e=this.current_edit_record.amount_type_id),this.detachElement("amount"),this.detachElement("percent_amount"),10==e?this.attachElement("percent_amount"):20==e&&this.attachElement("amount"),this.editFieldResize()}buildEditViewUI(){super.buildEditViewUI();var e=this,t={"tab_remittance_destination_account":{"label":$.i18n._("Pay Methods")},"tab_attachment":!0,"tab_audit":!0};this.setTabModel(t),this.navigation.AComboBox({api_class:TTAPI.APIRemittanceDestinationAccount,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_remittance_destination_account",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var i=this.edit_view_tab.find("#tab_remittance_destination_account").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(i),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APILegalEntity,allow_multiple_selection:!1,layout_name:"global_legal_entity",field:"legal_entity_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn($.i18n._("Legal Entity"),_,i,""),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIUser,allow_multiple_selection:!1,layout_name:"global_user",field:"user_id",set_empty:!0,show_search_inputs:!0});var a={permission_section:"remittance_destination_account"};_.setDefaultArgs(a),this.addEditFieldToColumn($.i18n._("Employee"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"status_id"}),_.setSourceData(e.status_array),this.addEditFieldToColumn($.i18n._("Status"),_,i,""),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),_,i),_.parent().width("45%"),(_=Global.loadWidgetByName(FormItemType.TEXT_AREA)).TTextArea({field:"description",width:"100%"}),this.addEditFieldToColumn($.i18n._("Description"),_,i),_.parent().width("45%"),(_=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"type_id"}),_.setSourceData(e.type_array),this.addEditFieldToColumn($.i18n._("Type"),_,i,"");var _=Global.loadWidgetByName(FormItemType.AWESOME_BOX);_.AComboBox({api_class:TTAPI.APIRemittanceSourceAccount,allow_multiple_selection:!1,layout_name:"global_remittance_source_account",field:"remittance_source_account_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn($.i18n._("Remittance Source Account"),_,i,""),(_=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APICurrency,allow_multiple_selection:!1,layout_name:"global_currency",field:"currency_id",set_empty:!0,show_search_inputs:!0}),this.addEditFieldToColumn($.i18n._("Currency"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"priority"}),_.setSourceData(e.priority_array),this.addEditFieldToColumn($.i18n._("Priority"),_,i,""),(_=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"amount_type_id"}),_.setSourceData(e.amount_type_array),this.addEditFieldToColumn($.i18n._("Amount Type"),_,i,""),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"amount",width:50}),this.addEditFieldToColumn($.i18n._("Amount"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"percent_amount",width:79}),this.addEditFieldToColumn($.i18n._("Percent"),_,i,"",null,!0),this.is_mass_editing||((_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value1_1",validation_field:"value1",width:149}),this.addEditFieldToColumn($.i18n._("Value1"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"value1_2",validation_field:"value1"}),_.setSourceData(e.ach_transaction_type_array),this.addEditFieldToColumn($.i18n._("Account Type"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value2",width:149}),this.addEditFieldToColumn($.i18n._("Value2"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value3",width:149}),this.addEditFieldToColumn($.i18n._("Value3"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value4",width:149}),this.addEditFieldToColumn($.i18n._("Value4"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value5",width:149}),this.addEditFieldToColumn($.i18n._("Value5"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value6",width:149}),this.addEditFieldToColumn($.i18n._("Value6"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value7",width:149}),this.addEditFieldToColumn($.i18n._("Value7"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value8",width:149}),this.addEditFieldToColumn($.i18n._("Value8"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value9",width:149}),this.addEditFieldToColumn($.i18n._("Value9"),_,i,"",null,!0),(_=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"value10",width:149}),this.addEditFieldToColumn($.i18n._("Value10"),_,i,"",null,!0))}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Legal Entity"),in_column:1,field:"legal_entity_id",api_class:TTAPI.APILegalEntity,multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_legal_entity",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Employee"),in_column:1,field:"user_id",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_user",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Source Account"),in_column:1,field:"remittance_source_account_id",api_class:TTAPI.APIRemittanceSourceAccount,multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_remittance_source_account",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Status"),in_column:2,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Type"),in_column:2,field:"type_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Currency"),in_column:2,field:"currency_id",api_class:TTAPI.APICurrency,multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_currency",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Created By"),in_column:3,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:3,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}searchDone(){super.searchDone(),TTPromise.resolve("PaymentMethodsView","init")}}a.loadSubView=function(e,t,i){Global.loadViewSource("RemittanceDestinationAccount","SubRemittanceDestinationAccountView.html",(function(a){var l=_.template(a,{});Global.isSet(t)&&t(),Global.isSet(e)&&(e.html(l),Global.isSet(i)&&i(sub_remittance_destination_account_view_controller))}))}}}]);
//# sourceMappingURL=employees-remittance_destination_account-RemittanceDestinationAccountViewController.bundle.js.map?v=e5cedfb60b47795e4262