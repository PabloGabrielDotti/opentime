{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/wizard/Wizard.js"],"names":["Wizard","TTBackboneView","options","_","defaults","current_step","wizard_id","wizard_name","$","i18n","step_history","step_objects","el","previous_wizard","_step_map","do_not_initialize_onload","external_data","events","super","initialize","this","setExternalData","$this","initStepObject","getCurrentStepName","obj","init","render","enableButtons","LocalCacheData","current_open_wizard_controller","data","e","button_click_procesing","target","hasClass","disableButtons","name","getStepObject","getNextStepName","step_obj","setPreviousStepName","setCurrentStepName","getPreviousStepName","TAlertManager","showConfirmAlert","flag","cleanUp","isRequiredButtonsClicked","onDoneComplete","val","n","remove","reload","TFeedback","source","callback","hasOwnProperty","Global","loadScript","script_path","find","html","eval","object_name","addStepObject","clicked_buttons","step","addClass","removeClass","_enableButtons","PayrollRemittanceAgencyEventWizard","addViewTab","window","location","href","delegateEvents","i","getProductEdition","showAlert","getUpgradeMessage"],"mappings":"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","file":"wizard-Wizard.bundle.js?v=7c74d3e5df40990f42a7","sourcesContent":["/**\n * For an example of implementation see: interface/html5/views/payroll/remittance_wizard/PayrollRemittanceAgencyEventWizard.js\n *\n * CRITICAL: ALL WIZARDS MUST HAVE A HOME STEP SO THAT THEY HAVE SOMEWHERE TO START.\n **/\n\nimport { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class Wizard extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tcurrent_step: false,\n\t\t\twizard_id: 'generic_wizard',\n\t\t\twizard_name: $.i18n._( 'Wizard' ),\n\t\t\tstep_history: {},\n\t\t\tstep_objects: {},\n\t\t\tel: $( '.wizard' ),\n\t\t\tprevious_wizard: null,\n\t\t\t_step_map: null,\n\t\t\tdo_not_initialize_onload: false, //when this flag is set, initialize will not be run automagically.\n\t\t\texternal_data: null,\n\t\t\tevents: {\n\t\t\t\t'click .close-btn': 'onCloseClick',\n\t\t\t\t'click .close-icon': 'onCloseClick',\n\t\t\t\t'click .wizard-overlay.onclick-close': 'onCloseClick',\n\t\t\t\t'click .forward-btn': 'onNextClick',\n\t\t\t\t'click .back-btn': 'onPrevClick',\n\t\t\t\t'click .done-btn': 'onDone'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\n\t\tif ( options && options.external_data ) {\n\t\t\tthis.setExternalData( options.external_data );\n\t\t}\n\n\t\tif ( !this.do_not_initialize_onload ) {\n\t\t\tthis.step_history = {};\n\t\t\tthis.step_objects = {};\n\t\t\tvar $this = this;\n\n\t\t\tthis.initStepObject( ( this.getCurrentStepName() ? this.getCurrentStepName() : 'home' ), function( obj ) {\n\t\t\t\t$this.init();\n\t\t\t\t$this.render();\n\t\t\t\t$this.enableButtons();\n\n\t\t\t\tif ( LocalCacheData.current_open_wizard_controller ) {\n\t\t\t\t\t$this.previous_wizard = LocalCacheData.current_open_wizard_controller;\n\t\t\t\t} else {\n\t\t\t\t\t$this.previous_wizard = false;\n\t\t\t\t}\n\t\t\t\tLocalCacheData.current_open_wizard_controller = $this;\n\t\t\t} );\n\t\t}\n\t}\n\n\t//always override\n\tinit() {\n\t\treturn;\n\t}\n\n\tsetExternalData( data ) {\n\t\tthis.external_data = data;\n\t}\n\n\tgetExternalData() {\n\t\treturn this.external_data;\n\t}\n\n\tonNextClick( e ) {\n\t\tif ( this.button_click_procesing == true ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tthis.disableButtons();\n\n\t\t\tvar name = this.getStepObject().getNextStepName();\n\t\t\tvar $this = this;\n\t\t\tthis.initStepObject( name, function( step_obj ) {\n\t\t\t\tstep_obj.setPreviousStepName( $this.getCurrentStepName() );\n\t\t\t\t$this.setCurrentStepName( name );\n\t\t\t\t//$this.enableButtons(); //This should be done at the end of each _render() function to avoid race conditions and hammer clicking right arrow causing JS exceptions.\n\t\t\t} );\n\t\t}\n\t}\n\n\tonPrevClick( e ) {\n\t\tif ( this.button_click_procesing == true ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( e === true || $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tthis.disableButtons();\n\n\t\t\tvar name = this.getStepObject().getPreviousStepName();\n\t\t\tvar $this = this;\n\n\t\t\t//Needs to be initialized in the event that we came back from the min_tab.\n\t\t\tthis.initStepObject( name, function( step_obj ) {\n\t\t\t\t//step_obj.setPreviousStepName($this.getCurrentStepName());\n\t\t\t\t$this.setCurrentStepName( name );\n\t\t\t\t//$this.enableButtons(); //This should be done at the end of each _render() function to avoid race conditions and hammer clicking right arrow causing JS exceptions.\n\t\t\t} );\n\t\t}\n\t}\n\n\tonCloseClick( e ) {\n\t\tif ( !e || $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tvar $this = this;\n\n\t\t\tif ( this.getStepObject().getPreviousStepName() !== false && this.getStepObject().getNextStepName() !== false ) { //Not on first step, and not last step\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'Are you sure you wish to cancel without completing all steps for this event?' ), null, function( flag ) {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else if ( this.getStepObject().getNextStepName() == false ) { //On last step.\n\t\t\t\tif ( this.getStepObject().isRequiredButtonsClicked() == false ) { //Required actions are not performed.\n\t\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( '<strong>WARNING</strong>: You are about to cancel without performing all required actions on this step! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>' ), null, function( flag ) {\n\t\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} else { //Required actions ARE performed.\n\t\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( 'Are you sure you wish to cancel without marking this event as completed?' ), null, function( flag ) {\n\t\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t\t$this.cleanUp();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$this.cleanUp();\n\t\t\t}\n\t\t}\n\t}\n\n\tonDone( e ) {\n\t\tif ( !e || $( e.target ).hasClass( 'disable-image' ) == false ) {\n\t\t\tvar $this = this;\n\n\t\t\tif ( this.getStepObject().getNextStepName() == false && this.getStepObject().isRequiredButtonsClicked() == false ) { //On last step.\n\t\t\t\tTAlertManager.showConfirmAlert( $.i18n._( '<strong>WARNING</strong>: You are about to mark this event as completed without performing all required actions on this step! <br><br><strong>This may result in payments or reports not being submitted to this agency.</strong> <br><br>Are you sure you wish to continue?<br><br>' ), null, function( flag ) {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t$this.onDoneComplete();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.onDoneComplete();\n\t\t\t}\n\t\t}\n\t}\n\n\t//Override this function to perform other actions when the user clicks the green checkmark to complete the wizard.\n\tonDoneComplete( e ) {\n\t\t$this.cleanUp();\n\t}\n\n\taddStepObject( name, obj ) {\n\t\t//always override.\n\t\tthis.step_objects[name] = obj;\n\t\treturn this.step_objects[name]; //returned for chaining.\n\t}\n\n\tgetStepObject( name ) {\n\t\tif ( typeof name == 'undefined' ) {\n\t\t\tname = this.getCurrentStepName();\n\t\t}\n\n\t\tif ( typeof this.step_objects[name] == 'object' ) {\n\t\t\treturn this.step_objects[name];\n\t\t}\n\t\treturn this.step_objects['home'];\n\t}\n\n\tgetCurrentStepName() {\n\t\treturn this.current_step;\n\t}\n\n\tsetCurrentStepName( val ) {\n\t\tthis.current_step = val;\n\t}\n\n\t//Stub to stop backbone from complaining that it's missing, Wizard really doesn't render itself as such, it just displays its template.\n\trender() {\n\t}\n\n\t/*\n\t * Clean up the markup.\n\t */\n\tcleanUp() {\n\t\t$( this.el ).remove();\n\t\tfor ( var n in this.step_objects ) {\n\t\t\tif ( this.step_objects[n] ) {\n\t\t\t\tthis.step_objects[n].reload = true;\n\t\t\t}\n\t\t}\n\n\t\tLocalCacheData.current_open_wizard_controller = null;\n\n\t\t$().TFeedback( {\n\t\t\tsource: this.wizard_id\n\t\t} );\n\t}\n\n\t/**\n\t * setup a step object\n\t *\n\t * @param name\n\t * @param callback\n\t */\n\tinitStepObject( name, callback ) {\n\t\tif ( this._step_map.hasOwnProperty( name ) ) {\n\t\t\tif ( this.step_objects[name] == null || typeof this.step_objects[name] != 'object' ) {\n\t\t\t\tvar $this = this;\n\t\t\t\tGlobal.loadScript( this._step_map[name].script_path, function() {\n\t\t\t\t\t$this.setCurrentStepName( name );\n\t\t\t\t\t$( $this.el ).find( '.content' ).html( '' );\n\n\t\t\t\t\t//var obj = new window[$this._step_map[name].object_name]( $this );\n\t\t\t\t\tvar obj = eval( 'new ' + $this._step_map[name].object_name + '( $this );' );\n\t\t\t\t\tobj.reload = false;\n\t\t\t\t\t$this.addStepObject( name, obj );\n\n\t\t\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\t\t\tcallback( obj );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\t//reopening a step\n\t\t\t\tthis.setCurrentStepName( name );\n\t\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\t\tvar obj = this.step_objects[name];\n\n\t\t\t\t\t$( this.el ).find( '.content' ).html( '' );\n\t\t\t\t\t//obj = new window[this._step_map[name].object_name]( this );\n\t\t\t\t\tvar obj = eval( 'new ' + this._step_map[name].object_name + '( this );' );\n\n\t\t\t\t\t//reopening a step that has been opened in a previously closed wizard.\n\t\t\t\t\tif ( this.step_objects[name].reload == true ) {\n\t\t\t\t\t\tobj.clicked_buttons = {};\n\t\t\t\t\t\tobj.reload = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.addStepObject( name, obj );\n\n\t\t\t\t\tcallback( obj );\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableButtons() {\n\t\tthis.button_click_procesing = true;\n\n\t\t//Changing the button images causes flashing and isn't required for just disabling the buttons while the view loads.\n\t\t// $( this.el ).find( '.forward-btn' ).addClass( 'disable-image' );\n\t\t// $( this.el ).find( '.back-btn' ).addClass( 'disable-image' );\n\t}\n\n\t/**\n\t * Enables the next/prev buttons\n\t * the step object for the first step should return false instead fo a previous step name to disable the previous button\n\t * the step object for the last step should return false instead of a next step name to disable the next button and enable the done button.\n\t */\n\tenableButtons() {\n\t\tvar step = this.getStepObject();\n\n\t\tif ( typeof step.getNextStepName() != 'string' ) {\n\t\t\t$( this.el ).find( '.forward-btn' ).addClass( 'disable-image' );\n\t\t\t$( this.el ).find( '.done-btn' ).removeClass( 'disable-image' ); //When right arrow is disabled, assume last step and enable done button.\n\t\t} else {\n\t\t\t$( this.el ).find( '.forward-btn' ).removeClass( 'disable-image' );\n\t\t\t$( this.el ).find( '.done-btn' ).addClass( 'disable-image' ); //When right arrow is enabled, assume *not* last step, disable done button.\n\t\t}\n\n\t\tif ( typeof step.getPreviousStepName() != 'string' ) {\n\t\t\t$( this.el ).find( '.back-btn' ).addClass( 'disable-image' );\n\t\t} else {\n\t\t\t$( this.el ).find( '.back-btn' ).removeClass( 'disable-image' );\n\t\t}\n\n\t\tthis._enableButtons();\n\n\t\tthis.button_click_procesing = false;\n\t}\n\n\t//override me.\n\t_enableButtons() {\n\t}\n\n\t/**\n\t * minimize the wiazrd to a min_tab\n\t */\n\tminimize() {\n\t\tLocalCacheData.PayrollRemittanceAgencyEventWizard = this;\n\t\tGlobal.addViewTab( this.wizard_id, this.wizard_name, window.location.href );\n\t\tthis.delegateEvents();\n\t\t$( this.el ).remove();\n\t}\n\n\treload() {\n\t\tfor ( var i in this.step_objects ) {\n\t\t\tthis.step_objects[i].reload = true;\n\t\t}\n\t}\n\n\tdisableForCommunity( callback ) {\n\t\tif ( Global.getProductEdition() <= 10 ) {\n\t\t\tTAlertManager.showAlert( Global.getUpgradeMessage(), $.i18n._( 'Denied' ) );\n\t\t} else {\n\t\t\tif ( typeof callback == 'function' ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\n\t}\n\n}"],"sourceRoot":""}