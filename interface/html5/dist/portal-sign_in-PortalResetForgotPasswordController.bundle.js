(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["portal-sign_in-PortalResetForgotPasswordController"],{5866:(e,r,s)=>{"use strict";s.r(r),s.d(r,{"PortalResetForgotPasswordController":()=>a});var t=s(6739),o=s(7526);class a extends t.TTBackboneView{constructor(e={}){_.defaults(e,{events:{"click .portal-reset-forgot-password":"resetForgotPassword"}}),super(e)}initialize(e){super.initialize(e),e.callback&&(this.callback=e.callback),this.api=o.y.APIRecruitmentAuthentication;var r=Global.loadWidget("views/portal/sign_in/PortalResetForgotPassword.html");this.setElement(_.template(r)()),this.render()}render(){var e=this;this.$("#new_password").focus(),this.$("#confirm_password").unbind("keydown").bind("keydown",(function(r){13===r.keyCode&&e.resetForgotPassword()})),$("body").append(this.$el),this.$el.modal({"show":!0,"backdrop":"static"}),this.$el.on("hidden.bs.modal",(function(){e.removeView()}))}removeView(){this.$el.remove(),LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"sm")),LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"key")),IndexViewController.instance.router.navigate("#!m=PortalJobVacancy&company_id="+LocalCacheData.getAllURLArgs().company_id,{trigger:!1,replace:!0})}resetForgotPassword(){var e=this;if(this.getPassword()){var r=this.getPassword();this.api.passwordReset(LocalCacheData.getAllURLArgs().key,r.new_password,r.confirm_password,{onResult:function(r){if(r.isValid())e.$el.modal("hide"),e.callback&&e.callback();else{var s=r.getDetails();s||(s=r.getDescription());var t="";Global.isArray(s)||"object"==typeof s?$.each(s,(function(e,r){r.hasOwnProperty("error")&&(r=r.error);var s=0;for(var o in r)t+=r[o],s>0&&(t+="<br>"),s++})):t=s,e.setError(e.$("#new_password"),t)}}})}}getPassword(){var e=this.$("#new_password"),r=this.$("#confirm_password");return e.val()?(this.clearError(e),e.val()!==r.val()?(this.setError(r,$.i18n._("New password does not match")),!1):(this.clearError(r),{new_password:e.val(),confirm_password:r.val()})):(this.setError(e,$.i18n._("New password can't be empty")),!1)}setError(e,r){e.css("border","1px solid red"),e.tooltip({title:r}),e.tooltip("show")}clearError(e){e.css("border","1px solid #ccc"),e.tooltip("dispose")}}}}]);
//# sourceMappingURL=portal-sign_in-PortalResetForgotPasswordController.bundle.js.map?v=dcb492d3031477bc1c44