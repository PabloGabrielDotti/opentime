{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/tag_input/TTagInput.js"],"names":["$","jQuery","fn","TTagInput","options","field","error_tip_box","api_tag","opts","extend","defaults","$this","this","add_tag_input","tag_span_dic","check_box","enabled","error_string","object_type_id","showErrorTip","sec","Global","isSet","loadWidgetByName","WidgetNamesDic","ERROR_TOOLTIP","ErrorTipBox","hasClass","show","hideErrorTip","remove","getEnabled","setEnabled","val","addClass","attr","removeClass","removeAttr","setCheckBox","children","eq","checked","isChecked","setMassEditMode","insertBefore","change","trigger","clearErrorStyle","getField","addCss","getValue","value","key","find","text","substring","length","setValue","buildTagSpan","tagArray","split","each","index","content","delete_mode","indexOf","tagSpanDiv","close_btn","tagSpan","doing_dblclick","dblclick","e","setTimeout","click","$$this","current_div","new_value","substr","doNext","append","prepend","createTag","o","meta","data","TTAPI","APICompanyGenericTag","autocomplete","source","select","ui","item","isSelectedItem","close","event","focus","LocalCacheData","current_open_sub_controller","edit_view","is_viewing","current_open_primary_controller","view_mode_message","contextmenu","preventDefault","stopImmediatePropagation","mouseout","bind","relatedTarget","which","args","filter_data","name","getCompanyGenericTag","onResult","result","result_data","getResult","final_result","i","push"],"mappings":"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","file":"tag_input-TTagInput.bundle.js?v=995d3cb812017a069407","sourcesContent":["( function( $ ) {\n\n\t$.fn.TTagInput = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.TTagInput.defaults, options );\n\t\tvar $this = this;\n\t\tvar field;\n\n\t\tvar add_tag_input = null;\n\n\t\tvar tag_span_dic = [];\n\n\t\tvar close_btn = null;\n\n\t\tvar mass_edit_mode = false;\n\n\t\tvar check_box = null;\n\n\t\tvar enabled = true;\n\n\t\tvar error_string = '';\n\n\t\tvar error_tip_box;\n\n\t\tvar api_tag;\n\n\t\tvar object_type_id = -1;\n\n\t\tthis.showErrorTip = function( sec ) {\n\n\t\t\tif ( !Global.isSet( sec ) ) {\n\t\t\t\tsec = 2;\n\t\t\t}\n\n\t\t\tif ( !error_tip_box ) {\n\t\t\t\terror_tip_box = Global.loadWidgetByName( WidgetNamesDic.ERROR_TOOLTIP );\n\t\t\t\terror_tip_box = error_tip_box.ErrorTipBox();\n\t\t\t}\n\t\t\tif ( $( this ).hasClass( 'warning-tip' ) ) {\n\t\t\t\terror_tip_box.show( this, error_string, sec, true );\n\t\t\t} else {\n\t\t\t\terror_tip_box.show( this, error_string, sec );\n\t\t\t}\n\t\t};\n\n\t\tthis.hideErrorTip = function() {\n\n\t\t\tif ( Global.isSet( error_tip_box ) ) {\n\t\t\t\terror_tip_box.remove();\n\t\t\t}\n\n\t\t};\n\n\t\tthis.getEnabled = function() {\n\t\t\treturn enabled;\n\t\t};\n\n\t\tthis.setEnabled = function( val ) {\n\t\t\tenabled = val;\n\t\t\tif ( val === false || val === '' ) {\n\t\t\t\t$this.addClass( 't-tag-input-readonly' );\n\t\t\t\tadd_tag_input.addClass( 'add-tag-input-readonly' );\n\t\t\t\tadd_tag_input.attr( 'disabled', true );\n\t\t\t} else {\n\t\t\t\t$this.removeClass( 't-tag-input-readonly' );\n\t\t\t\tadd_tag_input.removeClass( 'add-tag-input-readonly' );\n\t\t\t\tadd_tag_input.removeAttr( 'disabled' );\n\t\t\t}\n//\t\t\t  $this.children().attr( 'disabled', 'true' );\n\n\t\t};\n\n\t\tthis.setCheckBox = function( val ) {\n\t\t\tif ( check_box ) {\n\t\t\t\tcheck_box.children().eq( 0 )[0].checked = val;\n\t\t\t}\n\t\t};\n\n\t\tthis.isChecked = function() {\n\t\t\tif ( check_box ) {\n\t\t\t\tif ( check_box.children().eq( 0 )[0].checked === true ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\n\t\tthis.setMassEditMode = function( val ) {\n\t\t\tmass_edit_mode = val;\n\n\t\t\tif ( mass_edit_mode ) {\n\t\t\t\tcheck_box = $( ' <div class=\"mass-edit-checkbox-wrapper tag-mass-edit-checkbox-wrapper\"><input type=\"checkbox\" class=\"mass-edit-checkbox\"></input>' +\n\t\t\t\t\t'<label for=\"checkbox-input-1\" class=\"input-helper input-helper--checkbox\"></label></div>' );\n\t\t\t\tcheck_box.insertBefore( $( this ) );\n\n\t\t\t\tcheck_box.change( function() {\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t} );\n\n\t\t\t} else {\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\tcheck_box.remove();\n\t\t\t\t\tcheck_box = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t\tthis.clearErrorStyle = function() {\n\n\t\t};\n\n\t\tthis.getField = function() {\n\t\t\treturn field;\n\t\t};\n\n\t\tGlobal.addCss( 'global/widgets/tag_input/TTagInput.css' );\n\n\t\tthis.getValue = function() {\n\n\t\t\tvar value = '';\n\n\t\t\tfor ( var key in tag_span_dic ) {\n\t\t\t\t// Error: Unable to get property 'find' of undefined or null reference in /interface/html5/global/widgets/tag_input/TTagInput.js?v=8.0.6-20150417-143734 line 116\n\t\t\t\tif ( tag_span_dic[key] ) {\n\t\t\t\t\tvalue = value + tag_span_dic[key].find( '.tag-span' ).text() + ',';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvalue = value.substring( 0, value.length - 1 );\n\n\t\t\treturn value;\n\t\t};\n\n\t\tthis.setValue = function( val ) {\n\n\t\t\t$this.buildTagSpan( val );\n\t\t};\n\n\t\tthis.buildTagSpan = function( val ) {\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = '';\n\t\t\t}\n\n\t\t\tfor ( var key in tag_span_dic ) {\n\t\t\t\t// Error: Unable to get property 'remove' of undefined or null reference in /interface/html5/global/widgets/tag_input/TTagInput.js?v=8.0.6-20150417-143734 line 136\n\t\t\t\tif ( tag_span_dic[key] ) {\n\t\t\t\t\ttag_span_dic[key].remove();\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttag_span_dic = {};\n\n\t\t\tvar tagArray = val.split( ',' );\n\n\t\t\tif ( tagArray && tagArray.length === 1 && tagArray[0] === '' ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.each( tagArray, function( index, content ) {\n\n\t\t\t\tvar delete_mode = false;\n\t\t\t\tif ( content.indexOf( '[search-deleted]' ) > 0 || content.indexOf( '-' ) === 0 ) {\n\t\t\t\t\tcontent = content.split( '[search-deleted]' )[0];\n\t\t\t\t\tdelete_mode = true;\n\t\t\t\t}\n\n\t\t\t\tvar tagSpanDiv = $( '<div class=\\'tag-span-div\\'></div>' );\n\t\t\t\tvar close_btn = $( '<span  class=\\'close-btn\\'>X</span>' );\n\t\t\t\tvar tagSpan = $( '<span class=\\'tag-span\\'></span>' );\n\n\t\t\t\tif ( delete_mode ) {\n\t\t\t\t\ttagSpanDiv.addClass( 'removed' );\n\t\t\t\t}\n\n\t\t\t\tclose_btn.attr( 'data-value', content );\n\t\t\t\ttagSpan.text( content );\n\n\t\t\t\tvar doing_dblclick = false;\n\t\t\t\tclose_btn.dblclick( function( e ) {\n\t\t\t\t\tdoing_dblclick = true;\n\t\t\t\t\tif ( !enabled ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar value = $( this ).attr( 'data-value' );\n\n\t\t\t\t\tif ( Global.isSet( tag_span_dic[value] ) ) {\n\t\t\t\t\t\ttag_span_dic[value].remove();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete tag_span_dic[value];\n\n\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\tdoing_dblclick = false;\n\t\t\t\t\t}, 200 );\n\n\t\t\t\t} );\n\n\t\t\t\tclose_btn.click( function( e ) {\n\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\tif ( !doing_dblclick ) {\n\t\t\t\t\t\t\tdoNext();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 200 );\n\n\t\t\t\t\tvar $$this = this;\n\n\t\t\t\t\tfunction doNext() {\n\t\t\t\t\t\tif ( !enabled ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar value = $( $$this ).attr( 'data-value' );\n\t\t\t\t\t\tvar current_div = tag_span_dic[value];\n\t\t\t\t\t\tvar new_value = '';\n\n\t\t\t\t\t\t//Error: Unable to get property 'removeClass' of undefined or null reference in /interface/html5/global/widgets/tag_input/TTagInput.js?v=8.0.0-20150126-192326 line 214\n\t\t\t\t\t\tif ( !current_div ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( value.indexOf( '-' ) === 0 ) {\n\t\t\t\t\t\t\tnew_value = value.substr( 1 );\n\t\t\t\t\t\t\tcurrent_div.removeClass( 'removed' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnew_value = '-' + value;\n\t\t\t\t\t\t\tcurrent_div.addClass( 'removed' );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttag_span_dic[value].find( '.tag-span' ).text( new_value );\n\n\t\t\t\t\t\tdelete tag_span_dic[value];\n\t\t\t\t\t\t$( $$this ).attr( 'data-value', new_value );\n\n\t\t\t\t\t\ttag_span_dic[new_value] = current_div;\n\n\t\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\ttagSpanDiv.append( tagSpan );\n\t\t\t\ttagSpanDiv.append( close_btn );\n\t\t\t\t$( $this ).prepend( tagSpanDiv );\n\n\t\t\t\ttag_span_dic[content] = tagSpanDiv;\n\n\t\t\t} );\n\t\t};\n\n\t\tthis.createTag = function( val ) {\n\n\t\t\tvar tagSpanDiv = $( '<div class=\\'tag-span-div new\\'></div>' );\n\t\t\tvar close_btn = $( '<span class=\\'close-btn\\'>X</span>' );\n\t\t\tvar tagSpan = $( '<span class=\\'tag-span\\'></span>' );\n\n\t\t\tclose_btn.attr( 'data-value', val );\n\t\t\ttagSpan.text( val );\n\n\t\t\tvar doing_dblclick = false;\n\n\t\t\tclose_btn.dblclick( function( e ) {\n\t\t\t\tdoing_dblclick = true;\n\t\t\t\tif ( !enabled ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar value = $( this ).attr( 'data-value' );\n\n\t\t\t\tif ( Global.isSet( tag_span_dic[value] ) ) {\n\t\t\t\t\ttag_span_dic[value].remove();\n\n\t\t\t\t}\n\n\t\t\t\tdelete tag_span_dic[value];\n\n\t\t\t\tif ( check_box ) {\n\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t}\n\n\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\n\t\t\t\tsetTimeout( function() {\n\t\t\t\t\tdoing_dblclick = false;\n\t\t\t\t}, 200 );\n\n\t\t\t} );\n\n\t\t\tclose_btn.click( function( e ) {\n\n\t\t\t\tsetTimeout( function() {\n\t\t\t\t\tif ( !doing_dblclick ) {\n\t\t\t\t\t\tdoNext();\n\t\t\t\t\t}\n\t\t\t\t}, 200 );\n\n\t\t\t\tvar $$this = this;\n\n\t\t\t\tfunction doNext() {\n\t\t\t\t\tif ( !enabled ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar value = $( $$this ).attr( 'data-value' );\n\t\t\t\t\tvar current_div = tag_span_dic[value];\n\t\t\t\t\tvar new_value = '';\n\n\t\t\t\t\tif ( value.indexOf( '-' ) === 0 ) {\n\t\t\t\t\t\tnew_value = value.substr( 1 );\n\t\t\t\t\t\tcurrent_div.removeClass( 'removed' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnew_value = '-' + value;\n\t\t\t\t\t\tcurrent_div.addClass( 'removed' );\n\t\t\t\t\t}\n\n\t\t\t\t\ttag_span_dic[value].find( '.tag-span' ).text( new_value );\n\n\t\t\t\t\tdelete tag_span_dic[value];\n\t\t\t\t\t$( $$this ).attr( 'data-value', new_value );\n\n\t\t\t\t\ttag_span_dic[new_value] = current_div;\n\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tif ( Global.isSet( tag_span_dic[close_btn.attr( 'data-value' )] ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttagSpanDiv.append( tagSpan );\n\t\t\ttagSpanDiv.append( close_btn );\n\t\t\ttagSpanDiv.insertBefore( add_tag_input );\n\t\t\ttag_span_dic[val] = tagSpanDiv;\n\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tfield = o.field;\n\n\t\t\tif ( o.object_type_id ) {\n\t\t\t\tobject_type_id = o.object_type_id;\n\t\t\t}\n\n\t\t\tadd_tag_input = $( '<input class=\\'add-tag-input\\' autocomplete=\\'On\\'></input>' );\n\n\t\t\tapi_tag = TTAPI.APICompanyGenericTag;\n\n\t\t\tadd_tag_input.autocomplete( {\n\t\t\t\tsource: [],\n\t\t\t\tselect: function( e, ui ) {\n\t\t\t\t\t$this.createTag( ui.item.value );\n\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t}\n\t\t\t\t\tadd_tag_input.autocomplete( 'option', { source: [] } );\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\t\t\t\t\t$this.isSelectedItem = true;\n\t\t\t\t},\n\t\t\t\tclose: function( event, ui ) {\n\t\t\t\t\tif ( $this.isSelectedItem ) {\n\t\t\t\t\t\tadd_tag_input.val( '' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( this ).append( add_tag_input );\n\n\t\t\t$( this ).click( function() {\n\t\t\t\tadd_tag_input.focus();\n\t\t\t\tif ( !enabled ) {\n\t\t\t\t\tif ( !check_box ) {\n\t\t\t\t\t\tif ( LocalCacheData.current_open_sub_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_sub_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = Global.view_mode_message;\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t} else if ( LocalCacheData.current_open_primary_controller &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.is_viewing ) {\n\t\t\t\t\t\t\terror_string = Global.view_mode_message;\n\t\t\t\t\t\t\t$this.showErrorTip( 10 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( this ).contextmenu( function( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t} );\n\n\t\t\t$( this ).mouseout( function() {\n\t\t\t\t$this.hideErrorTip();\n\t\t\t} );\n\n\t\t\tadd_tag_input.bind( 'focusout', function( e ) {\n\t\t\t\tif ( $( e.relatedTarget ).attr( 'id' ) === 'ui-active-menuitem' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( add_tag_input.val().length > 0 ) {\n\n\t\t\t\t\tif ( !enabled ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.createTag( add_tag_input.val() );\n\t\t\t\t\tadd_tag_input.val( '' );\n\n\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tadd_tag_input.bind( 'keyup', function( e ) {\n\t\t\t\tif ( e.which === 40 || e.which === 38 ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\t\t\t\tvar args = {};\n\t\t\t\targs.filter_data = {};\n\t\t\t\targs.filter_data.object_type_id = [object_type_id];\n\t\t\t\targs.filter_data.name = add_tag_input.val();\n\t\t\t\tapi_tag.getCompanyGenericTag( args, {\n\t\t\t\t\tonResult: function( result ) {\n\n\t\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\t\tvar final_result = [];\n\n\t\t\t\t\t\tfor ( var i = 0; i < result_data.length; i++ ) {\n\t\t\t\t\t\t\t//https://stackoverflow.com/questions/13144025/jquery-autocomplete-update-source-with-object-formatting-the-array\n\t\t\t\t\t\t\t//final_result.push({title: result_data[i].name, label: result_data[i].name,});\n\t\t\t\t\t\t\t//http://api.jqueryui.com/autocomplete/#option-source\n\t\t\t\t\t\t\tfinal_result.push( result_data[i].name );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//add_tag_input.autocomplete( \"option\", \"source\", final_result )\n\n\t\t\t\t\t\tadd_tag_input.autocomplete( 'option', { source: final_result } );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\treturn false;\n\n\t\t\t} );\n\n\t\t\tadd_tag_input.bind( 'keydown', function( e ) {\n\n\t\t\t\tif ( e.which === 40 || e.which === 38 ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ( ( e.which === 13 || e.which === 44 || e.which === 32 || e.which === 9 || e.which === 188 ) &&\n\t\t\t\t\tadd_tag_input.val().length > 0 ) {\n\n\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\tif ( !enabled ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.createTag( add_tag_input.val() );\n\t\t\t\t\tadd_tag_input.val( '' );\n\n\t\t\t\t\tif ( check_box ) {\n\t\t\t\t\t\t$this.setCheckBox( true );\n\t\t\t\t\t}\n\t\t\t\t\t//add_tag_input.autocomplete( \"option\", { source: [] } );\n\t\t\t\t\t$this.trigger( 'formItemChange', [$this] );\n\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\t//add_tag_input.autocomplete( \"option\", { source: [] } );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.TTagInput.defaults = {};\n\n} )( jQuery );"],"sourceRoot":""}