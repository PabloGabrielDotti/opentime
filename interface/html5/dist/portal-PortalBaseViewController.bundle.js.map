{"version":3,"sources":["webpack://timetrex/./interface/html5/portal/recruitment/IndexController.js","webpack://timetrex/./interface/html5/views/portal/PortalBaseViewController.js","webpack://timetrex/./interface/html5/views/portal/header/HeaderUploadResumeWidget.js","webpack://timetrex/./interface/html5/views/portal/header/HeaderViewController.js","webpack://timetrex/./interface/html5/views/portal/hr/recruitment/PortalJobVacancyRowController.js","webpack://timetrex/./interface/html5/views/portal/sign_in/PortalForgotPasswordController.js","webpack://timetrex/./interface/html5/views/portal/sign_in/PortalResetForgotPasswordController.js","webpack://timetrex/./interface/html5/views/portal/sign_in/SignInController.js"],"names":["ApplicationRouter","Backbone","Router","options","_","defaults","controller","headerView","routes","super","view_id","eval","TopMenuManager","selected_sub_menu_id","PortalBaseViewController","url","new_url","Global","getBaseURL","split","setURLToBrowser","viewName","edit_id","action","$this","this","args","needReloadBrowser","window","location","reload","buildArgDic","indexOf","sanitizeViewId","m","LocalCacheData","fullUrlParameterStr","setAllURLArgs","getAllURLArgs","hasOwnProperty","TTPromise","add","wait","IndexViewController","instance","router","showTipModal","$","i18n","setTimeout","resolve","id","a","current_open_view_id","edit_id_for_next_open_view","current_doing_context_action","date","current_select_date","timeout_count","loadViewRequiredJSReady","showRibbonMenuAndLoadView","auto_login_timer","setInterval","clearInterval","current_open_primary_controller","edit_view","current_edit_record","openEditView","t","isArray","i","length","item","checkIds","current_select_message_control_data","viewId","is_mass_editing","buildContextMenu","removeEditView","cleanAnySubViewUI","autoLogin","removeClass","loadStyleSheet","APIGlobal","pre_login_data","application_build","profileView","is_changed","showConfirmModal","title","actions","label","isClose","callBack","e","navigate","company_id","trigger","replace","hideConfirmModal","headerRender","loadViewController","HeaderViewController","html","el","jobVacancyViewController","render","topContainer","css","bottomContainer","loadViewSource","view_mode","type","object_id","object_type_id","onViewClick","onEditClick","onAddClick","children","contentContainer","attr","ui_id","remove","addClass","loadScript","TopMenuController","loadView","element","doNext","modal","backdrop","show","text","empty","each","button","class","find","unbind","bind","self","append","is","hideFormModal","style","autoHideTipModal","hideTipModal","hideSignInModal","clean","viewController","clearErrorTips","sub_log_view_controller","edit_view_ui_dic","edit_view_ui_validation_field_dic","edit_view_form_item_dic","edit_view_error_ui_dic","current_open_edit_only_controller","cleanWhenUnloadView","isSet","View","History","started","history","start","callback","session_cookie","getCookie","getSessionIDKey","login_data","getLoginData","is_logged_in","setPortalLoginUserData","session_id","getPortalLoginUser","setSessionID","setCookie","doing_login","jobapplicant_api","getJobApplicant","onResult","result","isValid","setPortalLoginUser","getResult","goToView","view_name","filter","default_filter_for_next_open_view","goToViewByViewLabel","view_label","openWizard","wizardName","defaultData","BaseWizardController","default_data","call_back","trackView","openReport","parent_view_controller","view_controller","current_open_report_controller","ProgressBar","showOverlay","current_url","href","substring","default_edit_id_for_next_open_edit_view","PermissionManager","checkTopLevelPermission","setNotificationBar","target","api","getNotification","getNotifications","result_data","notification_bar","notification_box_tpl","loadWidgetByName","WidgetNamesDic","NOTIFICATION_BAR","TopNotification","TTBackboneView","can_cache_controller","pager_data","events","initialize","preInit","company_api","init","postInit","initOptions","search","keyCode","onSearchClick","initCountryOptions","getOptions","prop","value","selectpicker","eSetProvince","val","page_action","addSearchResultPanel","vacancy_list_panel","more_btn","loadMore","filter_data","filter_sort","filter_items_per_page","filter_page","next_page","key_name","getPagerData","is_first_page","row","vacancy_model","Model","vacancy_row","PortalJobVacancyRowController","model","no_result_span","is_last_page","hide","elem","currentTarget","parent","document","createEvent","initMouseEvent","dispatchEvent","fireEvent","template","HeaderUploadResumeWidget","tpl","loadWidget","setElement","document_id","uploader","TImageBrowser","field","name","accept_filter","changeHandler","file_name","files","showFormModal","$el","uploadResume","file","getValue","document_api","document_name","first_name","last_name","addAttachment","async","uploadFile","file_data","document_revision_id","className","message_id","showProgressBar","changeProgressBarMessage","ajax","headers","data","success","res","removeProgressBar","uploaded","error","showUploadedMessage","refreshSubDocument","cache","contentType","processData","addDocumentRow","message","company_logo","uploadResumeWidget","jobVacancyDetailController","my_profile_container","dropdown_menus","sign_in_container","SignInController","_delegate","Logout","deleteCookie","tips","tooltip","goPortalLogin","key","attributes","get","set","toJSON","on","PortalForgotPasswordController","emailInput","focus","sendResetEmail","email","resetPassword","showErrorAlert","details","getDetails","getDescription","error_string","index","PortalResetForgotPasswordController","resetForgotPassword","removeView","omit","getPassword","password","passwordReset","new_password","confirm_password","setError","clearError","widget","recruitment_api","authentication_api","user_name","sm","setLoginTips","onLoginBtnClick","showSignInModal","Login","onLoginSuccess","setLocalCacheCompany","delegate","getCurrentCompany","current_company_result","com_result","setCurrentCompany","setLoginUserPreference","api_class","getDetailsAsString","setErrorTips","before","error_list","field_obj"],"mappings":"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","file":"portal-PortalBaseViewController.bundle.js?v=37b367c369fb05483c57","sourcesContent":["import { HeaderViewController } from '@/views/portal/header/HeaderViewController';\nimport { PortalBaseViewController } from '@/views/portal/PortalBaseViewController';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { TAlertManager } from '@/global/TAlertManager';\n\nexport class ApplicationRouter extends Backbone.Router {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tcontroller: null,\n\t\t\theaderView: null,\n\t\t\troutes: {\n\t\t\t\t'': 'onViewChange',\n\t\t\t\t'!:viewName': 'onViewChange',\n\t\t\t\t'*notFound': 'notFound'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\treloadView( view_id ) {\n\t\t//error: Uncaught ReferenceError: XXXXViewController is not defined ininterface/html5/#!m=TimeSheet line 3\n\t\t// Happens when quickly click on context menu and network is slow.\n\t\tif ( eval( 'typeof '+ view_id + 'ViewController' ) === 'function' ) { //Was ES5: window[view_id + 'ViewController'] &&\n\t\t\tTopMenuManager.selected_sub_menu_id = ''; // clear select ribbon menu, set in view init;\n\t\t\tPortalBaseViewController.loadView( view_id );\n\t\t}\n\t}\n\n\tnotFound( url ) {\n\t\tvar new_url = Global.getBaseURL().split( '#' )[0];\n\n\t\tGlobal.setURLToBrowser( new_url + '#!m=PortalJobVacancy' );\n\t}\n\n\t/* jshint ignore:start */\n\tonViewChange( viewName ) {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\tvar view_id;\n\t\tvar edit_id;\n\t\tvar action;\n\n\t\tif ( Global.needReloadBrowser ) {\n\t\t\tGlobal.needReloadBrowser = false;\n\t\t\twindow.location.reload();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( viewName ) {\n\t\t\targs = Global.buildArgDic( viewName.split( '&' ) );\n\t\t}\n\t\tif ( viewName && viewName.indexOf( 'm=' ) >= 0 ) {\n\t\t\tview_id = Global.sanitizeViewId( args.m );\n\t\t} else {\n\t\t\tview_id = 'PortalJobVacancy';\n\t\t}\n\n\t\tLocalCacheData.fullUrlParameterStr = viewName;\n\n\t\tLocalCacheData.setAllURLArgs( args );\n\n\t\tif ( LocalCacheData.getAllURLArgs() ) {\n\t\t\tif ( !LocalCacheData.getAllURLArgs().hasOwnProperty( 'company_id' ) ) {\n\t\t\t\tTTPromise.add( 'IndexController', 'onViewChange' );\n\t\t\t\tTTPromise.wait( null, null, function() {\n\t\t\t\t\tif ( IndexViewController && IndexViewController.instance && IndexViewController.instance.router ) {\n\t\t\t\t\t\tIndexViewController.instance.router.showTipModal( $.i18n._( 'Invalid Company' ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'Invalid Company' ) );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t//Ensure that the error is shown in a relatively timely fashion AFTER the framework needed to render properly is loaded.\n\t\t\t\t\tTTPromise.resolve( 'IndexController', 'onViewChange' );\n\t\t\t\t}, 4000 );\n\t\t\t}\n\t\t}\n\n\t\tedit_id = args.id;\n\n\t\taction = args.a;\n\n\t\tif ( LocalCacheData.current_open_view_id === view_id ) {\n\n\t\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\n\t\t\t\tif ( action ) {\n\t\t\t\t\tswitch ( action ) {\n\t\t\t\t\t\tcase 'edit':\n\n\t\t\t\t\t\t\t//Error: Unable to get property 'id' of undefined or null reference in /interface/html5/IndexController.js?v=8.0.0-20141230-125406 line 87\n\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ||\n\t\t\t\t\t\t\t\t( LocalCacheData.current_open_primary_controller.current_edit_record &&\n\t\t\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.current_edit_record.id != edit_id ) ) {\n\n\t\t\t\t\t\t\t\t//Makes ure when doing copy_as_new, don't open this\n\t\t\t\t\t\t\t\tif ( LocalCacheData.current_doing_context_action === 'edit' ) {\n\t\t\t\t\t\t\t\t\topenEditView( edit_id );\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'new':\n\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\t\t\t\t\t\topenEditView();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'view':\n\n\t\t\t\t\t\t\tswitch ( view_id ) {\n\t\t\t\t\t\t\t\tcase 'MessageControl':\n\t\t\t\t\t\t\t\t\tif ( args.t === 'message' ) {\n\t\t\t\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ||\n\t\t\t\t\t\t\t\t\t\t\t( !checkIds() ) ) {\n\t\t\t\t\t\t\t\t\t\t\topenEditView( edit_id, true );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if ( args.t === 'request' ) {\n\t\t\t\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ||\n\t\t\t\t\t\t\t\t\t\t\t( LocalCacheData.current_open_primary_controller.current_select_message_control_data.id != edit_id ) ) {\n\t\t\t\t\t\t\t\t\t\t\topenEditView( edit_id, true );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tif ( !LocalCacheData.current_open_primary_controller.edit_view ||\n\t\t\t\t\t\t\t\t\t\t( LocalCacheData.current_open_primary_controller.current_edit_record.id != edit_id ) ) {\n\t\t\t\t\t\t\t\t\t\topenEditView( edit_id, true );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller.edit_view &&\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.current_edit_record ) {\n\n\t\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller.viewId === 'TimeSheet' ) {\n\t\t\t\t\t\t\tif ( LocalCacheData.current_open_primary_controller.is_mass_editing ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.buildContextMenu( true );\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.removeEditView();\n\t\t\t\t\t\tthis.cleanAnySubViewUI();\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\treturn;\n\n\t\t} else {\n\t\t\tLocalCacheData.edit_id_for_next_open_view = edit_id;\n\n\t\t\tif ( action ) {\n\t\t\t\tLocalCacheData.current_doing_context_action = action;\n\t\t\t}\n\n\t\t\tswitch ( view_id ) {\n\t\t\t\tcase 'TimeSheet':\n\t\t\t\tcase 'Schedule':\n\t\t\t\t\tif ( args.date ) {\n\t\t\t\t\t\tLocalCacheData.current_select_date = args.date;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar timeout_count;\n\t\ttimeout_count = 0;\n\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\tshowRibbonMenuAndLoadView();\n\t\t} else {\n\t\t\tvar auto_login_timer = setInterval( function() {\n\t\t\t\tif ( timeout_count == 100 ) {\n\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t}\n\t\t\t\ttimeout_count = timeout_count + 1;\n\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\tshowRibbonMenuAndLoadView();\n\t\t\t\t\tclearInterval( auto_login_timer );\n\t\t\t\t}\n\t\t\t}, 600 );\n\t\t}\n\n\t\tfunction showRibbonMenuAndLoadView() {\n\n\t\t\tIndexViewController.autoLogin( function() {\n\t\t\t\t$( 'body' ).removeClass( 'login-bg' );\n\t\t\t\t// Global.loadStyleSheet( '../../theme/default/portal/css/portal.css' + '?v=' + APIGlobal.pre_login_data.application_build ); // Trialling the loading of this stylesheet earlier, in portal-styles.js to aid with loading screen styling.\n\t\t\t\tGlobal.loadStyleSheet( '../../framework/bootstrap-select/css/bootstrap-select.min.css' + '?v=' + APIGlobal.pre_login_data.application_build );\n\t\t\t\t// $( 'link[title=\"application css\"]' ).prop( 'disabled', true ); // no longer needed as application.css not loaded now. See the lines above on portal.css. Or for context see #2833 and 65ae7d9c1bf7f9e6102e1faf43a989060416fa99\n\t\t\t\tif ( !$this.headerView ) {\n\t\t\t\t\t$this.headerView = new HeaderViewController();\n\t\t\t\t\t$( '#topContainer' ).html( $this.headerView.el );\n\t\t\t\t\tloadViewController();\n\t\t\t\t} else {\n\t\t\t\t\tif ( $this.headerView.profileView && $this.headerView.profileView.is_changed ) {\n\t\t\t\t\t\t$this.showConfirmModal( $.i18n._( 'You have modified data without saving, are you sure you want to continue and lose your changes' ), {\n\t\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: \"No\", isClose: true, callBack: function( e ) {\n\t\t\t\t\t\t\t\t\t\t$this.navigate( '#!m=MyProfile&company_id=' + LocalCacheData.getAllURLArgs().company_id, {\n\t\t\t\t\t\t\t\t\t\t\ttrigger: false,\n\t\t\t\t\t\t\t\t\t\t\treplace: true\n\t\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: 'Yes', callBack: function( e ) {\n\t\t\t\t\t\t\t\t\t\t$this.hideConfirmModal();\n\t\t\t\t\t\t\t\t\t\theaderRender();\n\t\t\t\t\t\t\t\t\t\tloadViewController();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\theaderRender();\n\t\t\t\t\t\tloadViewController();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction headerRender() {\n\t\t\t$this.headerView.jobVacancyViewController = null;\n\t\t\t$this.headerView.profileView = null;\n\t\t\t$this.headerView.render();\n\t\t}\n\n\t\tfunction loadViewController() {\n\t\t\tsetTimeout( function() {\n\t\t\t\tGlobal.topContainer().css( 'display', 'block' );\n\t\t\t\tGlobal.bottomContainer().css( 'display', 'block' );\n\t\t\t}, 50 );\n\n\t\t\tGlobal.loadViewSource( view_id, view_id + 'ViewController.js', function() {\n\t\t\t\tPortalBaseViewController.loadView( view_id );\n\t\t\t} );\n\t\t}\n\n\t\tfunction checkIds() {\n\n\t\t\tif ( Global.isArray( LocalCacheData.current_open_primary_controller.current_edit_record ) ) {\n\t\t\t\tfor ( var i = 0; i < LocalCacheData.current_open_primary_controller.current_edit_record.length; i++ ) {\n\t\t\t\t\tvar item = LocalCacheData.current_open_primary_controller.current_edit_record[i];\n\n\t\t\t\t\tif ( item.id === edit_id ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titem = LocalCacheData.current_open_primary_controller.current_edit_record;\n\t\t\t\tif ( item.id === edit_id ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction openEditView( edit_id, view_mode ) {\n\t\t\tvar type;\n\t\t\tswitch ( view_id ) {\n\t\t\t\tcase 'MessageControl':\n\t\t\t\t\ttype = args.t;\n\t\t\t\t\tvar item = {};\n\t\t\t\t\tif ( type === 'message' ) {\n\t\t\t\t\t\titem.id = edit_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.object_id = edit_id;\n\t\t\t\t\t\titem.object_type_id = 50;\n\t\t\t\t\t}\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( item );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TimeSheet':\n\t\t\t\t\ttype = args.t;\n\n\t\t\t\t\tif ( !view_mode ) {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onEditClick( edit_id, type );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onAddClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( edit_id, type );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( !view_mode ) {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onEditClick( edit_id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onAddClick();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( edit_id ) {\n\t\t\t\t\t\t\tLocalCacheData.current_open_primary_controller.onViewClick( edit_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/* jshint ignore:end */\n\n\tcleanAnySubViewUI() {\n\t\tvar children = Global.contentContainer().children();\n\n\t\tif ( children.length > 1 ) {\n\t\t\tfor ( var i = 1; i < children.length; i++ ) {\n\t\t\t\t// Object doesn't support property or method 'remove', Not sure why, add try catch to ingore this error since this should no harm\n\t\t\t\ttry {\n\n\t\t\t\t\tif ( $( children[i] ).attr( 'id' ) === LocalCacheData.current_open_primary_controller.ui_id ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchildren[i].remove();\n\t\t\t\t\t}\n\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\t//Do nothing\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t}\n\n\tsetContentDivHeight() {\n\t\tGlobal.contentContainer().removeClass( 'content-container' );\n\t\tGlobal.contentContainer().addClass( 'content-container-after-login' );\n\t\tGlobal.topContainer().addClass( 'top-container-after-login' );\n\n\t}\n\n\taddTopMenu() {\n\t\tGlobal.loadScript( 'global/widgets/top_menu/TopMenuController.js' );\n\t\tif ( TopMenuController ) {\n\t\t\tTopMenuController.loadView();\n\t\t}\n\n\t}\n\n\tshowFormModal( element, options ) {\n\t\tvar $this = this;\n\t\tif ( $( '#formModal' ).is( ':visible' ) ) {\n\t\t\tthis.hideFormModal();\n\t\t\tsetTimeout( function() {\n\t\t\t\tdoNext();\n\t\t\t}, 500 );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\t!options && ( options = { title: '...', actions: [] } );\n\t\t\tif ( $( '#formModal' ).length > 0 ) {\n\t\t\t\t$( '#formModal' ).modal( {\n\t\t\t\t\tbackdrop: 'static',\n\t\t\t\t\tshow: true\n\t\t\t\t} );\n\t\t\t}\n\t\t\t$( '#formModalLabel' ).text( options.title );\n\t\t\t$( '#formModalBody' ).html( element );\n\t\t\tif ( options.actions.length > 0 ) {\n\t\t\t\t$( '#formModalFooter' ).empty();\n\t\t\t\t_.each( options.actions, function( item ) {\n\t\t\t\t\tvar button = $( '<button type=\"button\" class=\"btn\"></button>' );\n\t\t\t\t\titem.isClose && button.attr( 'data-dismiss', 'modal' );\n\t\t\t\t\tbutton.text( item.label );\n\t\t\t\t\titem.class && ( button.addClass( item.class ) );\n\t\t\t\t\t!item.class && button.addClass( 'btn-primary' );\n\t\t\t\t\tif ( item.callBack ) {\n\t\t\t\t\t\tif ( item.isClose ) {\n\t\t\t\t\t\t\t$( '#formModal' ).find( 'button.close' ).unbind( 'click' ).bind( 'click', item.callBack.bind( self ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbutton.unbind( 'click' ).bind( 'click', item.callBack.bind( self ) );\n\t\t\t\t\t}\n\t\t\t\t\t$( '#formModalFooter' ).append( button );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t}\n\n\tshowTipModal( element, options ) {\n\t\tvar $this = this;\n\t\tif ( $( '#tipModal' ).is( ':visible' ) ) {\n\t\t\tthis.hideTipModal();\n\t\t\tsetTimeout( function() {\n\t\t\t\tdoNext();\n\t\t\t}, 500 );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\t!options && ( options = { title: '...', actions: [], style: {} } );\n\t\t\t$( '#tipModal' ).find( '.modal-content' ).css( options.style );\n\t\t\tif ( $( '#tipModal' ).length > 0 ) {\n\t\t\t\t$( '#tipModal' ).modal( 'show' );\n\t\t\t}\n\t\t\t$( '#tipModalBody' ).html( element );\n\t\t\t$this.autoHideTipModal();\n\t\t}\n\t}\n\n\tshowConfirmModal( element, options ) {\n\t\tvar $this = this;\n\t\tif ( $( '#confirmModal' ).is( ':visible' ) ) {\n\t\t\tthis.hideConfirmModal();\n\t\t\tsetTimeout( function() {\n\t\t\t\tdoNext();\n\t\t\t}, 500 );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\t!options && ( options = { title: '...', actions: [] } );\n\t\t\tif ( $( '#confirmModal' ).length > 0 ) {\n\t\t\t\t$( '#confirmModal' ).modal( {\n\t\t\t\t\tbackdrop: 'static',\n\t\t\t\t\tshow: true\n\t\t\t\t} );\n\t\t\t}\n\t\t\t$( '#confirmModalLabel' ).text( options.title );\n\t\t\t$( '#confirmModalBody' ).html( element );\n\t\t\tif ( options.actions.length > 0 ) {\n\t\t\t\t$( '#confirmModalFooter' ).empty();\n\t\t\t\t_.each( options.actions, function( item ) {\n\t\t\t\t\tvar button = $( '<button type=\"button\" class=\"btn\"></button>' );\n\t\t\t\t\titem.isClose && button.attr( 'data-dismiss', 'modal' );\n\t\t\t\t\tbutton.text( item.label );\n\t\t\t\t\titem.class && ( button.addClass( item.class ) );\n\t\t\t\t\t!item.class && button.addClass( 'btn-primary' );\n\t\t\t\t\tif ( item.callBack ) {\n\t\t\t\t\t\tbutton.unbind( 'click' ).bind( 'click', item.callBack.bind( self ) );\n\t\t\t\t\t}\n\t\t\t\t\t$( '#confirmModalFooter' ).append( button );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t}\n\n\tshowSignInModal( element, options ) {\n\t\tvar $this = this;\n\t\tif ( $( '#signinModal' ).is( ':visible' ) ) {\n\t\t\tthis.hideSignInModal();\n\t\t\tsetTimeout( function() {\n\t\t\t\tdoNext();\n\t\t\t}, 500 );\n\t\t} else {\n\t\t\tdoNext();\n\t\t}\n\n\t\tfunction doNext() {\n\t\t\t!options && ( options = { title: '...', actions: [] } );\n\t\t\tif ( $( '#signinModal' ).length > 0 ) {\n\t\t\t\t$( '#signinModal' ).modal( {\n\t\t\t\t\tbackdrop: 'static',\n\t\t\t\t\tshow: true\n\t\t\t\t} );\n\t\t\t}\n\t\t\t$( '#signinModalLabel' ).text( options.title );\n\t\t\t$( '#signinModalBody' ).html( element );\n\t\t\tif ( options.actions.length > 0 ) {\n\t\t\t\t$( '#signinModalFooter' ).empty();\n\t\t\t\t_.each( options.actions, function( item ) {\n\t\t\t\t\tvar button = $( '<button type=\"button\" class=\"btn\"></button>' );\n\t\t\t\t\titem.isClose && button.attr( 'data-dismiss', 'modal' );\n\t\t\t\t\tbutton.text( item.label );\n\t\t\t\t\titem.class && ( button.addClass( item.class ) );\n\t\t\t\t\t!item.class && button.addClass( 'btn-primary' );\n\t\t\t\t\tif ( item.callBack ) {\n\t\t\t\t\t\tif ( item.isClose ) {\n\t\t\t\t\t\t\t$( '#signinModal' ).find( 'button.close' ).unbind( 'click' ).bind( 'click', item.callBack.bind( self ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbutton.unbind( 'click' ).bind( 'click', item.callBack.bind( self ) );\n\t\t\t\t\t}\n\t\t\t\t\t$( '#signinModalFooter' ).append( button );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t}\n\n\tautoHideTipModal() {\n\t\tvar $this = this;\n\t\tsetTimeout( function() {\n\t\t\t$this.hideTipModal();\n\t\t}, 5000 );\n\t}\n\n\thideTipModal() {\n\t\t$( '#tipModal' ).modal( 'hide' );\n\t}\n\n\thideFormModal() {\n\t\t$( '#formModal' ).modal( 'hide' );\n\t}\n\n\thideSignInModal() {\n\t\t$( '#signinModal' ).modal( 'hide' );\n\t}\n\n\thideConfirmModal() {\n\t\t$( '#confirmModal' ).modal( 'hide' );\n\t}\n\n\tremoveCurrentView( callBack ) {\n\t\tif ( LocalCacheData.current_open_edit_only_controller ) {\n\t\t\tclean( LocalCacheData.current_open_edit_only_controller );\n\t\t\tLocalCacheData.current_open_edit_only_controller = null;\n\t\t}\n\n\t\tif ( LocalCacheData.current_open_primary_controller ) {\n\t\t\tif ( LocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\t\tclean( LocalCacheData.current_open_primary_controller );\n\t\t\t}\n\t\t\tGlobal.contentContainer().empty();\n\t\t\tLocalCacheData.current_open_primary_controller.cleanWhenUnloadView( callBack );\n\t\t} else {\n\n\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\t\t}\n\n\t\tfunction clean( viewController ) {\n\t\t\tviewController.clearErrorTips();\n\t\t\t// Cannot read property 'remove' of null in interface/html5/IndexController.js?v=9.0.0-20151016-153057 line 439\n\t\t\tif ( viewController.edit_view ) {\n\t\t\t\tviewController.edit_view.remove();\n\t\t\t}\n\t\t\tviewController.sub_log_view_controller = null;\n\t\t\tviewController.edit_view_ui_dic = {};\n\t\t\tviewController.edit_view_ui_validation_field_dic = {};\n\t\t\tviewController.edit_view_form_item_dic = {};\n\t\t\tviewController.edit_view_error_ui_dic = {};\n\t\t\tLocalCacheData.current_doing_context_action = '';\n\t\t}\n\t}\n\n}\n\nexport class IndexViewController extends Backbone.View {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: 'body', //So we can add event listener for all elements\n\t\t\trouter: null,\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tthis.router = new ApplicationRouter();\n\n\t\t//Set title in index.php instead.\n\t\t//$( 'title' ).html( '' );\n\n\t\tthis.router.controller = this;\n\t\t//Error: Backbone.history has already been started in interface/html5/framework/backbone/backbone-min.js?v=9.0.1-20151022-162110 line 28\n\t\tif ( !Backbone.History.started ) {\n\t\t\tBackbone.history.start();\n\t\t}\n\n\t\tIndexViewController.instance = this;\n\n\t}\n\n}\n\nIndexViewController.autoLogin = function( callback ) {\n\tvar session_cookie = getCookie( Global.getSessionIDKey() );\n\tvar login_data = LocalCacheData.getLoginData();\n\tif ( session_cookie && session_cookie.length >= 40 && login_data && login_data.is_logged_in == true ) {\n\t\t//Setup user data when browser is refreshed and they are already logged in.\n\t\tIndexViewController.setPortalLoginUserData( session_cookie, callback );\n\t} else {\n\t\tcallback();\n\t}\n};\n\nIndexViewController.setPortalLoginUserData = function( session_id, callback ) {\n\t//Setup Job Appicant data upon login.\n\tif ( LocalCacheData.getPortalLoginUser() === null ) {\n\t\tvar $this = this;\n\n\t\tLocalCacheData.setSessionID( session_id );\n\t\tsetCookie( Global.getSessionIDKey(), session_id );\n\n\t\tthis.doing_login = true;\n\n\t\tthis.jobapplicant_api = TTAPI.APIJobApplicantPortal;\n\t\tthis.jobapplicant_api.getJobApplicant( {\n\t\t\tonResult: function( result ) {\n\t\t\t\tif ( result.isValid() ) {\n\t\t\t\t\tLocalCacheData.setPortalLoginUser( result.getResult()[0] );\n\t\t\t\t}\n\n\t\t\t\t$this.doing_login = false;\n\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t} else {\n\t\tcallback();\n\t}\n};\n\nIndexViewController.goToView = function( view_name, filter ) {\n\tif ( TopMenuManager.selected_sub_menu_id ) {\n\t\t$( '#' + TopMenuManager.selected_sub_menu_id ).removeClass( 'selected-menu' );\n\t}\n\n\t$( '#' + view_name ).addClass( 'selected-menu' );\n\tLocalCacheData.default_filter_for_next_open_view = filter;\n\n\tTopMenuManager.goToView( view_name, true );\n\n};\n\nIndexViewController.goToViewByViewLabel = function( view_label ) {\n\tvar view_name;\n\tswitch ( view_label ) {\n\t\tcase 'Exceptions':\n\t\t\tview_name = 'Exception';\n\t\t\tbreak;\n\t\tcase 'Messages':\n\t\t\tview_name = 'MessageControl';\n\t\t\tbreak;\n\t\tcase 'Requests':\n\t\t\tview_name = 'Request';\n\t\t\tbreak;\n\t\tcase 'Contact Information':\n\t\t\tIndexViewController.openEditView( LocalCacheData.current_open_primary_controller, 'LoginUserContact' );\n\t\t\treturn;\n\t\tdefault:\n\t\t\tvar reg = /\\s/g;\n\t\t\tview_name = view_label.replace( reg, '' );\n\t\t\tbreak;\n\t}\n\n\tif ( TopMenuManager.selected_sub_menu_id ) {\n\t\t$( '#' + TopMenuManager.selected_sub_menu_id ).removeClass( 'selected-menu' );\n\t}\n\n\t$( '#' + view_name ).addClass( 'selected-menu' );\n\n\tTopMenuManager.goToView( view_name, true );\n\n};\n\nIndexViewController.openWizard = function( wizardName, defaultData, callBack ) {\n\tBaseWizardController.default_data = defaultData;\n\tBaseWizardController.call_back = callBack;\n\tswitch ( wizardName ) {\n\t\tdefault:\n\t\t\t// track edit view only view\n\t\t\tGlobal.trackView( wizardName );\n\t\t\tGlobal.loadViewSource( wizardName, wizardName + 'Controller.js', function() {\n\t\t\t\tBaseWizardController.openWizard( wizardName, wizardName + '.html' );\n\t\t\t} );\n\t\t\tbreak;\n\t}\n\n};\n\nIndexViewController.openReport = function( parent_view_controller, view_name, id ) {\n\tvar view_controller = null;\n\n\tif ( LocalCacheData.current_open_report_controller ) {\n\t\tLocalCacheData.current_open_report_controller.removeEditView();\n\t}\n\n\tProgressBar.showOverlay();\n\n\tswitch ( view_name ) {\n\t\tdefault:\n\t\t\tGlobal.loadViewSource( view_name, view_name + 'ViewController.js', function() {\n\t\t\t\t/* jshint ignore:start */\n\t\t\t\tview_controller = eval( 'new ' + view_name + 'ViewController( {edit_only_mode: true} ); ' );\n\t\t\t\t/* jshint ignore:end */\n\t\t\t\tview_controller.parent_view_controller = parent_view_controller;\n\t\t\t\tview_controller.openEditView();\n\n\t\t\t\tvar current_url = window.location.href;\n\t\t\t\tif ( current_url.indexOf( '&sm' ) > 0 ) {\n\t\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&sm' ) );\n\t\t\t\t}\n\t\t\t\tcurrent_url = current_url + '&sm=' + view_name;\n\n\t\t\t\tif ( LocalCacheData.default_edit_id_for_next_open_edit_view ) {\n\t\t\t\t\tcurrent_url = current_url + '&sid=' + LocalCacheData.default_edit_id_for_next_open_edit_view;\n\t\t\t\t}\n\t\t\t\tGlobal.setURLToBrowser( current_url );\n\n\t\t\t} );\n\t\t\tbreak;\n\t}\n\n};\n\n//Open edit view\nIndexViewController.openEditView = function( parent_view_controller, view_name, id ) {\n\tvar view_controller = null;\n\n\tif ( !PermissionManager.checkTopLevelPermission( view_name ) && view_name !== 'map' ) {\n\t\tTAlertManager.showAlert( 'Permission denied' );\n\t\treturn;\n\t}\n\n\t//Merge conflict from RecruitmentPortal. This seemed to have removed the permission check, but that would break the application UI?\n\t//if ( LocalCacheData.current_open_edit_only_controller ) {\n\t//\tLocalCacheData.current_open_edit_only_controller.onCancelClick();\n\t//}\n\n\t// track edit view only view\n\tGlobal.trackView( view_name );\n\n\tswitch ( view_name ) {\n\n\t\tdefault:\n\t\t\tGlobal.loadViewSource( view_name, view_name + 'ViewController.js', function() {\n\t\t\t\t/* jshint ignore:start */\n\t\t\t\tview_controller = eval( 'new ' + view_name + 'ViewController( {edit_only_mode: true} ); ' );\n\t\t\t\t/* jshint ignore:end */\n\t\t\t\tview_controller.parent_view_controller = parent_view_controller;\n\t\t\t\tview_controller.openEditView( id );\n\n\t\t\t\tvar current_url = window.location.href;\n\t\t\t\tif ( current_url.indexOf( '&sm' ) > 0 ) {\n\t\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&sm' ) );\n\t\t\t\t}\n\t\t\t\tif ( id ) {\n\t\t\t\t\tcurrent_url = current_url + '&sm=' + view_name + '&sid=' + id;\n\t\t\t\t} else {\n\t\t\t\t\tcurrent_url = current_url + '&sm=' + view_name;\n\t\t\t\t}\n\n\t\t\t\tGlobal.setURLToBrowser( current_url );\n\n\t\t\t\tLocalCacheData.current_open_edit_only_controller = view_controller;\n\n\t\t\t} );\n\t\t\tbreak;\n\n\t}\n\n};\n\nIndexViewController.setNotificationBar = function( target ) {\n\n\tvar api = TTAPI.APINotification;\n\n\t//Error: TypeError: api.getNotification is not a function in /interface/html5/IndexController.js?v=8.0.0-20141117-095711 line 529\n\tif ( !api || !api.getNotification || typeof ( api.getNotification ) !== 'function' ) {\n\t\treturn;\n\t}\n\n\tapi.getNotifications( target, {\n\t\tonResult: function( result ) {\n\t\t\tvar result_data = result.getResult();\n\n\t\t\tif ( !LocalCacheData.notification_bar ) {\n\t\t\t\tvar notification_box_tpl = $( Global.loadWidgetByName( WidgetNamesDic.NOTIFICATION_BAR ) );\n\t\t\t\tLocalCacheData.notification_bar = notification_box_tpl.TopNotification();\n\t\t\t}\n\n\t\t\tLocalCacheData.notification_bar.show( result_data );\n\n\t\t}\n\t} );\n\n};\n\nIndexViewController.instance = null;","import 'bootstrap-select';\nimport { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { IndexViewController} from '@/portal/recruitment/IndexController'; // For the reference in the html file PortalJobVacancyView.html loaded from this file.\nimport { PortalJobVacancyRowController } from '@/views/portal/hr/recruitment/PortalJobVacancyRowController';\n\nexport class PortalBaseViewController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tcan_cache_controller: true, //if allow to cache current controller\n\t\t\tpager_data: null,\n\t\t\t// required_files: [],\n\n\t\t\tevents: {\n\t\t\t\t'click .search-btn': 'onSearchClick',\n\t\t\t\t'change select[id=\"country\"]': 'onCountryChange',\n\t\t\t\t// 'click .more': 'loadMore'\n\t\t\t\t// 'click .styled-select .glyphicon': 'onSelectClick',\n\t\t\t\t'keydown input[id=\"name\"]': 'autoSearch',\n\t\t\t\t// 'change select[id=\"province\"]': 'onSearchClick',\n\t\t\t\t'keydown input[id=\"city\"]': 'autoSearch'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\n\t\tthis.preInit( options );\n\n\t\t// __non_webpack_require__( this.getRequiredFiles(), function() {\n\t\tthis.company_api = TTAPI.APICompanyPortal;\n\t\tLocalCacheData.current_open_primary_controller = this;\n\t\tthis.init();\n\t\tthis.postInit( options );\n\t\t// } );\n\t}\n\n\t// getRequiredFiles() {\n\t// \t//override in child class\n\t// \treturn this.required_files.concat( this._required_files );\n\t// }\n\n\tpreInit() {\n\t\t//Override in child class.\n\t\treturn;\n\t}\n\n\tinit() {\n\t\t//Override in child class.\n\t\treturn;\n\t}\n\n\tpostInit() {\n\t\t//Override in child class.\n\t\treturn;\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tProgressBar.showOverlay();\n\t\tthis.initOptions( function() {\n\t\t\t$this.search();\n\t\t} );\n\t}\n\n\tautoSearch( e ) {\n\t\tif ( e.keyCode === 13 ) {\n\t\t\tthis.onSearchClick();\n\t\t}\n\t}\n\n\tinitOptions( callback ) {\n\t\tthis.initCountryOptions( callback );\n\t}\n\n\tinitCountryOptions( callback ) {\n\t\tvar $this = this;\n\t\tthis.company_api.getOptions( 'country', {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result = result.getResult();\n\t\t\t\t$this.$( '#country' ).append( $( '<option></option>' ).prop( 'value', '' ).attr( 'selected', 'selected' ).text( $.i18n._( 'All Countries' ) ) );\n\t\t\t\t$.each( result, function( value, label ) {\n\t\t\t\t\t$this.$( '#country' ).append( $( '<option></option>' ).prop( 'value', value ).text( $.i18n._( label ) ) );\n\t\t\t\t} );\n\t\t\t\t$this.$( '#country' ).selectpicker();\n\t\t\t\t$this.$( '#province' ).selectpicker();\n\t\t\t\tcallback();\n\t\t\t}\n\t\t} );\n\t}\n\n\tonCountryChange() {\n\t\tthis.eSetProvince( this.$( 'select[id=\"country\"]' ).val() );\n\t}\n\n\teSetProvince( val ) {\n\t\tvar $this = this;\n\t\t$this.$( '#province' ).selectpicker( 'destroy' );\n\t\tif ( !val ) {\n\t\t\t$this.$( '#province' ).html( $( '<option></option>' ).prop( 'value', '' ).attr( 'selected', 'selected' ).text( $.i18n._( 'All Province/States' ) ) );\n\t\t\t$this.$( '#province' ).selectpicker();\n\t\t\treturn;\n\t\t}\n\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tresult = result.getResult();\n\t\t\t\tif ( !result ) {\n\t\t\t\t\tresult = [];\n\t\t\t\t}\n\t\t\t\t$this.$( '#province' ).html( $( '<option></option>' ).prop( 'value', '' ).attr( 'selected', 'selected' ).text( $.i18n._( 'All Province/States' ) ) );\n\t\t\t\t$.each( result, function( value, label ) {\n\t\t\t\t\t$this.$( '#province' ).append( $( '<option></option>' ).prop( 'value', value ).text( $.i18n._( label ) ) );\n\t\t\t\t} );\n\t\t\t\t$this.$( '#province' ).selectpicker();\n\t\t\t}\n\t\t} );\n\t}\n\n\tloadMore() {\n\t\tthis.onSearchClick( {\n\t\t\tpage_action: 'next'\n\t\t} );\n\t}\n\n\taddSearchResultPanel() {\n\t}\n\n\tonSearchClick( options ) {\n\t\tvar $this = this;\n\t\tvar filter = {};\n\t\tthis.addSearchResultPanel();\n\t\t// first load\n\t\tif ( typeof options == 'undefined' ) {\n\t\t\toptions = {};\n\t\t}\n\t\tif ( typeof options.page_action == 'undefined' ) {\n\t\t\tthis.$( '.search-result .content' ).empty();\n\t\t}\n\t\tthis.vacancy_list_panel = this.$( '.search-result .content' );\n\t\tthis.more_btn = this.$( '.search-result .more' );\n\t\tthis.more_btn.unbind( 'click' ).bind( 'click', function() {\n\t\t\t$this.loadMore();\n\t\t} );\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_sort = {};\n\t\tfilter.filter_items_per_page = 0; // Default to 0 to load user preference defined\n\t\t// if ( this.$('#job_title_id').val() && parseInt( this.$('#job_title_id').val() ) > 0  ) {\n\t\t// \tfilter.filter_data['title_id'] = this.$('#job_title_id').val();\n\t\t// }\n\t\tif ( this.$( '#name' ).val() && this.$( '#name' ).val() != '' ) {\n\t\t\tfilter.filter_data['name'] = this.$( '#name' ).val();\n\t\t}\n\t\tif ( this.$( '#country' ).val() && this.$( '#country' ).val() != '' ) {\n\t\t\tfilter.filter_data['country'] = this.$( '#country' ).val();\n\t\t}\n\t\tif ( this.$( '#province' ).val() && this.$( '#province' ).val() != '' ) {\n\t\t\tfilter.filter_data['province'] = this.$( '#province' ).val();\n\t\t}\n\t\tif ( this.$( '#city' ).val() && this.$( '#city' ).val() != '' ) {\n\t\t\tfilter.filter_data['city'] = this.$( '#city' ).val();\n\t\t}\n\t\tif ( this.pager_data ) {\n\t\t\tif ( options.page_action === 'next' ) {\n\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t} else {\n\t\t\t\tfilter.filter_page = 1;\n\t\t\t}\n\t\t} else {\n\t\t\tfilter.filter_page = 1;\n\t\t}\n\t\tthis.api['get' + this.api.key_name]( filter, false, { // paging or none\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.pager_data = result.getPagerData();\n\t\t\t\tvar result_data = result.getResult();\n\t\t\t\tvar no_result_panel = $this.vacancy_list_panel.find( '.vacancy-list-no-result' );\n\t\t\t\tif ( no_result_panel[0] || ( $this.pager_data && $this.pager_data.is_first_page ) ) {\n\t\t\t\t\t$this.vacancy_list_panel.empty();\n\t\t\t\t}\n\t\t\t\tif ( !Global.isArray( result_data ) ) {\n\t\t\t\t\tvar no_result_span = $( '<div class=\"vacancy-list-no-result\">' + $.i18n._( 'No Results Found' ) + '</div>' );\n\t\t\t\t\t$this.vacancy_list_panel.html( no_result_span );\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var i = 0; i < result_data.length; i++ ) {\n\t\t\t\t\t\tvar row = result_data[i];\n\t\t\t\t\t\tvar vacancy_model = new Backbone.Model( row );\n\t\t\t\t\t\tvar vacancy_row = new PortalJobVacancyRowController( { model: vacancy_model } );\n\t\t\t\t\t\t$this.vacancy_list_panel.append( vacancy_row.el );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( !$this.pager_data || $this.pager_data.is_last_page || result_data === true ) {\n\t\t\t\t\t$this.more_btn.hide();\n\t\t\t\t} else {\n\t\t\t\t\t$this.more_btn.show();\n\t\t\t\t}\n\t\t\t\tif ( typeof options.callback != 'undefined' ) {\n\t\t\t\t\toptions.callback();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSelectClick( e ) {\n\t\tvar elem = $( e.currentTarget ).parent().find( 'select' );\n\t\tif ( document.createEvent ) {\n\t\t\tvar e = document.createEvent( 'MouseEvents' );\n\t\t\te.initMouseEvent( 'mousedown', true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null );\n\t\t\telem[0].dispatchEvent( e );\n\t\t} else if ( element.fireEvent ) {\n\t\t\telem[0].fireEvent( 'onmousedown' );\n\t\t}\n\t}\n}\n\nPortalBaseViewController.loadView = function( view_id ) {\n\tGlobal.loadViewSource( view_id, view_id + 'View.html', function( result ) {\n\t\tvar template = _.template( result )();\n\t\twindow.IndexViewController = IndexViewController; // // For the reference in the html file PortalJobVacancyView.html loaded from this file.\n\t\tGlobal.contentContainer().html( template );\n\n\t\tLocalCacheData.current_open_view_id = view_id;\n\n\t\tGlobal.trackView( view_id, LocalCacheData.current_doing_context_action );\n\t} );\n\n};\n","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { TTUUID } from '@/global/TTUUID';\nimport { ServiceCaller } from '@/services/ServiceCaller';\n\nexport class HeaderUploadResumeWidget extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tvar tpl = Global.loadWidget( 'views/portal/header/HeaderUploadResumeWidget.html' );\n\t\tthis.setElement( _.template( tpl )() );\n\t\tthis.document_id = null;\n\t\tthis.profileView = null;\n\t\tif ( options.profileView ) {\n\t\t\tthis.profileView = options.profileView;\n\t\t}\n\t\t// this.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tif ( !this.uploader ) {\n\t\t\tthis.uploader = this.$( '.register-resume' ).TImageBrowser( {\n\t\t\t\tfield: 'file',\n\t\t\t\tname: 'filedata',\n\t\t\t\taccept_filter: '*',\n\t\t\t\tchangeHandler: function( a ) {\n\t\t\t\t\tvar file_name = $( this ).find( '.browser' )[0].files[0].name;\n\t\t\t\t\t$this.$( '#fileName' ).val( file_name );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tIndexViewController.instance.router.showFormModal( this.$el, {\n\t\t\ttitle: $.i18n._( 'Upload Resume' ),\n\t\t\tactions: [\n\t\t\t\t{ label: 'Close', isClose: true },\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Upload Resume' ), callBack: function( e ) {\n\t\t\t\t\t\t$this.uploadResume();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\t}\n\n\tuploadResume() {\n\t\tvar $this = this;\n\t\tif ( !this.uploader ) {\n\t\t\treturn false;\n\t\t}\n\t\tvar uploader = this.uploader;\n\t\tvar name = uploader.attr( 'file_name' );\n\t\tvar file = uploader.getValue();\n\t\tif ( file ) {\n\t\t\tthis.document_api = TTAPI.APIDocumentPortal;\n\t\t\tvar document_name = 'Resume' + ' - ' + LocalCacheData.getPortalLoginUser().first_name + ' ' + LocalCacheData.getPortalLoginUser().last_name;\n\t\t\tvar result = this.document_api.addAttachment( document_name, '', { async: false } ).getResult();\n\t\t\tthis.document_id = result['document_id'];\n\t\t\tthis.uploadFile( file, result['document_revision_id'] );\n\t\t}\n\t}\n\n\tuploadFile( file_data, document_revision_id ) {\n\t\tvar $this = this;\n\t\tvar url = ServiceCaller.getAPIURL( 'Class=' + this.document_api.className + '&Method=uploadAttachment' + '&v=2' );\n\t\tif ( LocalCacheData.getAllURLArgs() ) {\n\t\t\tif ( LocalCacheData.getAllURLArgs().hasOwnProperty( 'company_id' ) ) {\n\t\t\t\turl = url + '&company_id=' + LocalCacheData.getAllURLArgs().company_id;\n\t\t\t}\n\t\t}\n\t\turl = url + '&object_id=' + document_revision_id;\n\t\tvar message_id = TTUUID.generateUUID();\n\t\tProgressBar.showProgressBar( message_id );\n\t\tProgressBar.changeProgressBarMessage( $.i18n._( 'File Uploading' ) + '...' );\n\t\t$.ajax( {\n\t\t\turl: url, //Server script to process data\n\t\t\theaders: {\n\t\t\t\t//Handle CSRF tokens and related headers here.\n\t\t\t\t'X-Client-ID': 'Browser-TimeTrex',\n\t\t\t\t'X-CSRF-Token': getCookie( 'CSRF-Token' ),\n\t\t\t},\n\t\t\ttype: 'POST',\n\t\t\tdata: file_data,\n\t\t\tsuccess: function( res ) {\n\t\t\t\tProgressBar.removeProgressBar();\n\t\t\t\t$this.uploaded();\n\t\t\t\tif ( res.error ) {\n\t\t\t\t\t$this.showUploadedMessage( res.error );\n\t\t\t\t} else {\n\t\t\t\t\t$this.showUploadedMessage( $.i18n._( 'Upload Successful!' ) );\n\t\t\t\t\t$this.refreshSubDocument();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcache: false,\n\t\t\tcontentType: false,\n\t\t\tprocessData: false\n\t\t} );\n\t}\n\n\trefreshSubDocument() {\n\t\tif ( this.profileView ) {\n\t\t\tthis.profileView.addDocumentRow( this.document_id );\n\t\t}\n\t}\n\n\tuploaded() {\n\t\tthis.uploader = null;\n\t\tIndexViewController.instance.router.hideFormModal();\n\t}\n\n\tshowUploadedMessage( message ) {\n\t\tIndexViewController.instance.router.showTipModal( message );\n\t}\n}","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { SignInController } from '@/views/portal/sign_in/SignInController';\nimport { HeaderUploadResumeWidget } from '@/views/portal/header/HeaderUploadResumeWidget';\nimport { ServiceCaller } from '@/services/ServiceCaller';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\n\nexport class HeaderViewController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tevents: {\n\t\t\t\t'click .navbar-signin .login': 'goPortalLogin',\n\t\t\t\t'click .navbar-signin .logout': 'doLogout',\n\t\t\t\t'click .navbar-signin .profile': 'goProfile'\n\t\t\t\t// 'click .navbar-upload-resume > a': 'uploadResume'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tvar url;\n\t\tvar options = {};\n\t\tif ( LocalCacheData.getAllURLArgs().company_id ) {\n\t\t\turl = ServiceCaller.getAPIURL( 'Class=APIDocumentPortal&Method=getCompanyLogo' + '&v=2' ) + '&company_id=' + LocalCacheData.getAllURLArgs().company_id;\n\t\t} else {\n\t\t\turl = '../../theme/default/portal/images/t_icon_logo.png';\n\t\t}\n\t\tvar tpl = Global.loadWidget( 'views/portal/header/HeaderView.html' );\n\t\tthis.setElement( _.template( tpl )( { company_logo: url } ) );\n\t\tthis.uploadResumeWidget = null;\n\t\tthis.profileView = null;\n\t\tthis.jobVacancyDetailController = null;\n\t\tthis.jobVacancyViewController = null;\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tif ( !LocalCacheData.getPortalLoginUser() ) {\n\t\t\tvar sign_in_container = $( '<a class=\"login\"></a>' );\n\t\t\tsign_in_container.attr( 'href', 'javascript:;' );\n\t\t\tsign_in_container.append( $( '<img>' ).attr( 'src', '../../theme/default/portal/images/t_icon_head.png' ) );\n\t\t\tsign_in_container.append( $( '<span>' ).text( $.i18n._( 'Login' ) ) );\n\t\t\tthis.$( '.navbar-signin' ).html( sign_in_container );\n\t\t} else {\n\t\t\tvar my_profile_container = $( '<div class=\"dropdown\">' );\n\t\t\tmy_profile_container.append( '<a href=\"javascript:;\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">' + LocalCacheData.getPortalLoginUser().first_name + ' ' + LocalCacheData.getPortalLoginUser().last_name + ' <span class=\"caret\"></span></a>' );\n\t\t\tvar dropdown_menus = $( '<ul class=\"dropdown-menu\">' );\n\t\t\tdropdown_menus.append( '<li><a class=\"profile\" href=\"javascript:;\">My Profile</a></li>' );\n\t\t\tdropdown_menus.append( '<li><a class=\"logout\" href=\"javascript:;\">Logout</a></li>' );\n\t\t\tmy_profile_container.append( dropdown_menus );\n\t\t\tthis.$( '.navbar-signin' ).html( my_profile_container );\n\t\t}\n\t}\n\n\tgoPortalLogin() {\n\t\tvar sign_controller = new SignInController( {\n\t\t\t_delegate: this.jobVacancyDetailController\n\t\t} );\n\t\t// $('#signinModal').modal({\n\t\t// \tbackdrop: 'static',\n\t\t// \tshow: true\n\t\t// });\n\t}\n\n\tdoLogout() {\n\t\tthis.clearErrorTips();\n\t\tvar $this = this;\n\t\tvar current_user_api = TTAPI.APIRecruitmentAuthentication;\n\t\tcurrent_user_api.Logout( {\n\t\t\tonResult: function( result ) {\n\t\t\t\tdeleteCookie( Global.getSessionIDKey() );\n\t\t\t\tLocalCacheData.setPortalLoginUser( false );\n\t\t\t\tLocalCacheData.current_open_view_id = ''; //#1528  -  Logout icon not working.\n\t\t\t\t// $this.goPortalLogin();\n\t\t\t\t// $this.render();\n\t\t\t\t// if ( $this.jobVacancyDetailController ) {\n\t\t\t\t// \t$this.jobVacancyDetailController.render();\n\t\t\t\t// }\n\n\t\t\t\tif ( $this.jobVacancyViewController ) {\n\t\t\t\t\t$this.render();\n\t\t\t\t} else {\n\t\t\t\t\tIndexViewController.instance.router.navigate( '#!m=PortalJobVacancy&company_id=' + LocalCacheData.getAllURLArgs().company_id, {\n\t\t\t\t\t\ttrigger: true,\n\t\t\t\t\t\treplace: true\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\t//needed for logout.\n\tclearErrorTips() {\n\t\t//harder here because we can't access the active controller's data from here.\n\t\tvar tips = $( '.error-tip' );\n\t\tfor ( var i = 0; i < tips.length; i++ ) {\n\t\t\t$( tips[i] ).removeClass( 'error-tip' );\n\t\t\t$( tips[i] ).tooltip().tooltip( 'dispose' );\n\t\t}\n\t}\n\n\tgoProfile() {\n\t\tvar location = Global.getBaseURL() + '#!m=MyProfile&company_id=' + LocalCacheData.getAllURLArgs()['company_id'];\n\t\twindow.location = location;\n\t}\n\n\tuploadResume() {\n\t\tvar $this = this;\n\t\tif ( !LocalCacheData.getPortalLoginUser() ) {\n\t\t\t// IndexViewController.instance.router.showTipModal('Please login first!')\n\t\t\t// setTimeout(function(  ) {\n\t\t\t// \t$this.goPortalLogin();\n\t\t\t// }, 100)\n\t\t\tthis.goPortalLogin();\n\t\t} else {\n\t\t\tif ( !this.uploadResumeWidget ) {\n\t\t\t\tthis.uploadResumeWidget = new HeaderUploadResumeWidget( {\n\t\t\t\t\tprofileView: $this.profileView\n\t\t\t\t} );\n\t\t\t}\n\t\t\tthis.uploadResumeWidget.render();\n\t\t}\n\t}\n}\n","import { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class PortalJobVacancyRowController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tvar $this = this;\n\t\tvar row = Global.loadWidget( 'views/portal/hr/recruitment/PortalJobVacancyRow.html' );\n\t\tfor ( var key in this.model.attributes ) {\n\t\t\tif ( this.model.get( key ) == false ) {\n\t\t\t\tthis.model.set( key, '' );\n\t\t\t}\n\t\t}\n\t\tthis.setElement( _.template( row )( this.model.toJSON() ) );\n\t\tthis.$el.on( 'click', function( e ) {\n\t\t\tvar url = Global.getBaseURL() + '#!m=PortalJobVacancyDetail&id=' + $this.model.id + '&company_id=' + LocalCacheData.getAllURLArgs().company_id;\n\t\t\twindow.location = url;\n\t\t} );\n\t}\n}\n","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\n\nexport class PortalForgotPasswordController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tevents: {\n\t\t\t\t'click .send-reset-email': 'sendResetEmail'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tthis.api = TTAPI.APIRecruitmentAuthentication;\n\t\tvar el = Global.loadWidget( 'views/portal/sign_in/PortalForgotPassword.html' );\n\t\tthis.setElement( _.template( el )() );\n\t\tthis.emailInput = this.$( '#email' );\n\t\tthis.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tthis.emailInput.focus();\n\t\tthis.emailInput.unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t$this.sendResetEmail();\n\t\t\t}\n\t\t} );\n\t\t$( 'body' ).append( this.$el );\n\t\tthis.$el.modal( {\n\t\t\t'show': true,\n\t\t\t'backdrop': 'static'\n\t\t} );\n\t\tthis.$el.on( 'hidden.bs.modal', function() {\n\t\t\t$this.$el.remove();\n\t\t} );\n\t}\n\n\tsendResetEmail() {\n\t\tvar $this = this;\n\t\tvar email = this.emailInput.val();\n\t\tthis.api.resetPassword( email, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t$this.showErrorAlert( result );\n\t\t\t\t} else {\n\t\t\t\t\tvar response = result.getResult();\n\t\t\t\t\tif ( response.hasOwnProperty( 'email_sent' ) ) { // make sure email if is sent successfully\n\t\t\t\t\t\t$this.$el.modal( 'hide' );\n\t\t\t\t\t\tIndexViewController.instance.router.showTipModal( $.i18n._( 'An email has been sent to you with instructions on how to change your password.' ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tshowErrorAlert( result ) {\n\t\tvar details = result.getDetails();\n\t\t// if ( details.hasOwnProperty( 'error' ) ) {\n\t\t//\n\t\t// }\n\t\tif ( !details ) {\n\t\t\tdetails = result.getDescription(); // If the details is empty, try to get description to show.\n\t\t}\n\t\tvar error_string = '';\n\n\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\n\t\t\t$.each( details, function( index, val ) {\n\n\t\t\t\tif ( val.hasOwnProperty( 'error' ) ) {\n\t\t\t\t\tval = val.error;\n\t\t\t\t}\n\t\t\t\tvar i = 0;\n\t\t\t\tfor ( var key in val ) {\n\t\t\t\t\terror_string = error_string + val[key];\n\t\t\t\t\tif ( i > 0 ) {\n\t\t\t\t\t\terror_string += '<br>';\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\terror_string = details;\n\t\t}\n\t\tthis.emailInput.css( 'border', '1px solid red' );\n\t\tthis.emailInput.tooltip( {\n\t\t\ttitle: error_string\n\t\t} );\n\t\tthis.emailInput.tooltip( 'show' );\n\t}\n\n}","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\n\nexport class PortalResetForgotPasswordController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tevents: {\n\t\t\t\t'click .portal-reset-forgot-password': 'resetForgotPassword'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( options ) {\n\t\tsuper.initialize( options );\n\t\tif ( options.callback ) {\n\t\t\tthis.callback = options.callback;\n\t\t}\n\t\t// var $this = this;\n\t\t// __non_webpack_require__( this._required_files, function() {\n\t\tthis.api = TTAPI.APIRecruitmentAuthentication;\n\t\tvar el = Global.loadWidget( 'views/portal/sign_in/PortalResetForgotPassword.html' );\n\t\tthis.setElement( _.template( el )() );\n\t\tthis.render();\n\t\t// } );\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tthis.$( '#new_password' ).focus();\n\t\tthis.$( '#confirm_password' ).unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t$this.resetForgotPassword();\n\t\t\t}\n\t\t} );\n\t\t$( 'body' ).append( this.$el );\n\t\tthis.$el.modal( {\n\t\t\t'show': true,\n\t\t\t'backdrop': 'static'\n\t\t} );\n\t\tthis.$el.on( 'hidden.bs.modal', function() {\n\t\t\t$this.removeView();\n\t\t} );\n\t}\n\n\tremoveView() {\n\t\tthis.$el.remove();\n\t\tLocalCacheData.setAllURLArgs( _.omit( LocalCacheData.getAllURLArgs(), 'sm' ) );\n\t\tLocalCacheData.setAllURLArgs( _.omit( LocalCacheData.getAllURLArgs(), 'key' ) );\n\t\tIndexViewController.instance.router.navigate( '#!m=PortalJobVacancy&company_id=' + LocalCacheData.getAllURLArgs().company_id, {\n\t\t\ttrigger: false,\n\t\t\treplace: true\n\t\t} );\n\t}\n\n\tresetForgotPassword() {\n\t\tvar $this = this;\n\t\tif ( this.getPassword() ) {\n\t\t\tvar password = this.getPassword();\n\t\t\tthis.api.passwordReset( LocalCacheData.getAllURLArgs().key,\n\t\t\t\tpassword.new_password,\n\t\t\t\tpassword.confirm_password\n\t\t\t\t, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\tif ( !result.isValid() ) {\n\t\t\t\t\t\t\tvar details = result.getDetails();\n\t\t\t\t\t\t\tif ( !details ) {\n\t\t\t\t\t\t\t\tdetails = result.getDescription(); // If the details is empty, try to get description to show.\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar error_string = '';\n\t\t\t\t\t\t\tif ( Global.isArray( details ) || typeof details === 'object' ) {\n\t\t\t\t\t\t\t\t$.each( details, function( index, val ) {\n\t\t\t\t\t\t\t\t\tif ( val.hasOwnProperty( 'error' ) ) {\n\t\t\t\t\t\t\t\t\t\tval = val.error;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar i = 0;\n\t\t\t\t\t\t\t\t\tfor ( var key in val ) {\n\t\t\t\t\t\t\t\t\t\terror_string = error_string + val[key];\n\t\t\t\t\t\t\t\t\t\tif ( i > 0 ) {\n\t\t\t\t\t\t\t\t\t\t\terror_string += '<br>';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\terror_string = details;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$this.setError( $this.$( '#new_password' ), error_string );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$this.$el.modal( 'hide' );\n\t\t\t\t\t\t\tif ( $this.callback ) {\n\t\t\t\t\t\t\t\t$this.callback();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}\n\t}\n\n\tgetPassword() {\n\t\tvar new_password = this.$( '#new_password' );\n\t\tvar confirm_password = this.$( '#confirm_password' );\n\t\tif ( !new_password.val() ) {\n\t\t\tthis.setError( new_password, $.i18n._( 'New password can\\'t be empty' ) );\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis.clearError( new_password );\n\t\t}\n\t\tif ( new_password.val() !== confirm_password.val() ) {\n\t\t\tthis.setError( confirm_password, $.i18n._( 'New password does not match' ) );\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis.clearError( confirm_password );\n\t\t}\n\n\t\treturn {\n\t\t\tnew_password: new_password.val(),\n\t\t\tconfirm_password: confirm_password.val()\n\t\t};\n\t}\n\n\tsetError( widget, message ) {\n\t\twidget.css( 'border', '1px solid red' );\n\t\twidget.tooltip( {\n\t\t\ttitle: message\n\t\t} );\n\t\twidget.tooltip( 'show' );\n\t}\n\n\tclearError( widget ) {\n\t\twidget.css( 'border', '1px solid #ccc' );\n\t\twidget.tooltip( 'dispose' );\n\t}\n\n}","import { PortalBaseViewController } from '@/views/portal/PortalBaseViewController';\nimport { PortalResetForgotPasswordController } from '@/views/portal/sign_in/PortalResetForgotPasswordController';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { IndexViewController } from '@/portal/recruitment/IndexController';\nimport { ServiceCaller } from '@/services/ServiceCaller';\nimport { PortalForgotPasswordController } from '@/views/portal/sign_in/PortalForgotPasswordController';\n\nexport class SignInController extends PortalBaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tdoing_login: false,\n\t\t\tedit_view_error_ui_dic: {},\n\n\t\t\t_delegate: null,\n\t\t\tevents: {\n\t\t\t\t'click #forgot_password': 'forgotPasswordClick'\n\t\t\t}\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\tvar $this = this;\n\t\t$this.recruitment_api = TTAPI.APIRecruitmentAuthentication;\n\t\t$this.jobapplicant_api = TTAPI.APIJobApplicantPortal;\n\t\t$this.authentication_api = TTAPI.APIAuthentication;\n\t\t// var login_data = LocalCacheData.getLoginData();\n\t\tvar el = Global.loadWidget( 'views/portal/sign_in/SignIn.html' );\n\t\t$this.setElement( _.template( el )() );\n\t\t$this.user_name = $this.$( '#user_name' );\n\t\t$this.password = $this.$( '#password' );\n\t\tif ( Global.isSet( options ) && Global.isSet( options._delegate ) ) {\n\t\t\t$this._delegate = options._delegate;\n\t\t}\n\t\tif ( LocalCacheData.getAllURLArgs().sm === 'ResetPassword' && LocalCacheData.getAllURLArgs().key && LocalCacheData.getAllURLArgs().company_id ) {\n\t\t\tvar forgotResetPasswordIntance = new PortalResetForgotPasswordController( {\n\t\t\t\tcallback: function() {\n\t\t\t\t\tLocalCacheData.setAllURLArgs( _.omit( LocalCacheData.getAllURLArgs(), 'sm' ) );\n\t\t\t\t\tLocalCacheData.setAllURLArgs( _.omit( LocalCacheData.getAllURLArgs(), 'key' ) );\n\t\t\t\t\tIndexViewController.instance.router.navigate( '#!m=PortalJobVacancy&company_id=' + LocalCacheData.getAllURLArgs().company_id, {\n\t\t\t\t\t\ttrigger: false,\n\t\t\t\t\t\treplace: true\n\t\t\t\t\t} );\n\t\t\t\t\t$this.setLoginTips( $.i18n._( 'Password has been changed successfully, you may now login' ) );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\t// $( this.el ).visible();\n\t\t\t$this.render();\n\t\t}\n\t\t// this.render();\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\t\tLocalCacheData.setSessionID( '' );\n\t\tthis.user_name.focus();\n\t\tthis.password.unbind( 'keydown' ).bind( 'keydown', function( e ) {\n\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\t$this.onLoginBtnClick();\n\t\t\t}\n\t\t} );\n\t\tif ( LocalCacheData.getAllURLArgs().user_name ) {\n\t\t\tthis.user_name.val( LocalCacheData.getAllURLArgs().user_name );\n\t\t}\n\t\tif ( LocalCacheData.getAllURLArgs().password ) {\n\t\t\tthis.password.val( LocalCacheData.getAllURLArgs().password );\n\t\t}\n\t\tthis.showSignInModal();\n\t}\n\n\tshowSignInModal() {\n\t\tvar $this = this;\n\t\tIndexViewController.instance.router.showSignInModal( this.$el, {\n\t\t\ttitle: $.i18n._( 'Login' ),\n\t\t\tactions: [\n\t\t\t\t{ label: $.i18n._( 'Cancel' ), isClose: true },\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Login' ), callBack: function( e ) {\n\t\t\t\t\t\t$this.onLoginBtnClick();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\t}\n\n\thideSignInModal( callback ) {\n\t\tif ( callback ) {\n\t\t\t$( '#signinModal' ).unbind( 'hidden.bs.modal' ).bind( 'hidden.bs.modal', function( e ) {\n\t\t\t\tcallback();\n\t\t\t} );\n\t\t}\n\t\tIndexViewController.instance.router.hideSignInModal();\n\t}\n\n\tforgotPasswordClick() {\n\t\tvar $this = this;\n\t\tthis.hideSignInModal( function() {\n\t\t\tvar forgotPasswordIntance = new PortalForgotPasswordController();\n\t\t\t$( '#signinModal' ).unbind( 'hidden.bs.modal' );\n\t\t} );\n\t}\n\n\tonLoginBtnClick() {\n\t\tvar user_name = this.user_name.val();\n\t\tvar password = this.password.val();\n\t\tvar $this = this;\n\t\tif ( !this.doing_login ) {\n\t\t\tthis.doing_login = true;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t\t//Async call\n\t\tthis.recruitment_api.Login( user_name, password, {\n\t\t\tonResult: function( e ) {\n\t\t\t\t$this.onLoginSuccess( e );\n\t\t\t\t$this.setLocalCacheCompany();\n\t\t\t}, delegate: this\n\t\t} );\n\t}\n\n\tsetLocalCacheCompany() {\n\t\t// set local cache company information this will be used when sending an error report.\n\t\tthis.authentication_api.getCurrentCompany( {\n\t\t\tonResult: function( current_company_result ) {\n\t\t\t\tvar com_result = current_company_result.getResult();\n\t\t\t\tLocalCacheData.setCurrentCompany( com_result );\n\t\t\t}\n\t\t} );\n\t}\n\n\tonLoginSuccess( e, session_id ) {\n\t\tvar result;\n\t\tvar $this = this;\n\t\tif ( !session_id ) {\n\t\t\tresult = e.getResult();\n\t\t} else {\n\t\t\tresult = session_id;\n\t\t}\n\t\t//Clean user preference, since if login to normal UI and than to portal, it's not null.\n\t\tLocalCacheData.setLoginUserPreference( null );\n\n\t\tif ( e && !e.isValid() ) {\n\t\t\tLocalCacheData.setSessionID( '' );\n\t\t\tdeleteCookie( Global.getSessionIDKey() );\n\n\t\t\tif ( e.getDetails()[0].hasOwnProperty( 'password' ) ) {\n\t\t\t\t$this.hideSignInModal();\n\t\t\t\t$this.password.val( '' );\n\t\t\t\tIndexViewController.openWizard( 'ResetPasswordWizard', {\n\t\t\t\t\tuser_name: $this.user_name.val(),\n\t\t\t\t\tapi_class: TTAPI.APIRecruitmentAuthentication,\n\t\t\t\t\tmessage: e.getDetailsAsString()\n\t\t\t\t}, function() {\n\t\t\t\t\t$this.setLoginTips( $.i18n._( 'Password has been changed successfully, you may now login' ) );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t// TAlertManager.showAlert( e.getDetailsAsString(), 'Error', function() {\n\t\t\t\t//     password.focus();\n\t\t\t\t// } );\n\t\t\t\tthis.setErrorTips( e );\n\t\t\t}\n\n\t\t\t$this.doing_login = false;\n\t\t} else {\n\t\t\tthis.clearErrorTips();\n\t\t\tServiceCaller.cancel_all_error = false;\n\n\t\t\tIndexViewController.setPortalLoginUserData( result, function() {\n\t\t\t\tIndexViewController.instance.router.headerView.render();\n\t\t\t\tif ( $this._delegate ) {\n\t\t\t\t\t$this._delegate.render();\n\t\t\t\t}\n\t\t\t\t$this.hideSignInModal();\n\n\t\t\t\t$this.doing_login = false;\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetLoginTips( message ) {\n\t\tif ( typeof this.$( '.alert' )[0] !== 'undefined' ) {\n\t\t\tthis.$( '.alert' ).remove();\n\t\t}\n\t\tvar row = Global.loadWidget( 'views/portal/alert/alert.html' );\n\t\tthis.$( '.signIn-form' ).before( row );\n\t\tthis.$( '.alert' ).append( '<p>' + message + '</p>' );\n\t\tthis.showSignInModal();\n\t}\n\n\tsetErrorTips( e ) {\n\t\tvar error_list = e.getDetails() ? e.getDetails()[0] : {};\n\t\tif ( error_list && error_list.hasOwnProperty( 'error' ) ) {\n\t\t\terror_list = error_list.error;\n\t\t}\n\t\tfor ( var key in error_list ) {\n\t\t\tif ( !error_list.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar field_obj;\n\t\t\tif ( this.$( 'input[id=\"' + key + '\"]' )[0] ) {\n\t\t\t\tfield_obj = this.$( 'input[id=\"' + key + '\"]' );\n\t\t\t}\n\t\t\tif ( field_obj ) {\n\t\t\t\tfield_obj.addClass( 'error-tip' );\n\t\t\t\tvar error_string;\n\t\t\t\tif ( _.isArray( error_list[key] ) ) {\n\t\t\t\t\terror_string = error_list[key][0];\n\t\t\t\t} else {\n\t\t\t\t\terror_string = error_list[key];\n\t\t\t\t}\n\t\t\t\tfield_obj.tooltip( {\n\t\t\t\t\t'title': error_string\n\t\t\t\t} );\n\t\t\t\tfield_obj.tooltip( 'show' );\n\t\t\t\tthis.edit_view_error_ui_dic[key] = field_obj;\n\t\t\t\t// sort_array.push( field_obj.attr('data-sort') );\n\t\t\t}\n\t\t}\n\t}\n\n\tclearErrorTips() {\n\t\tfor ( var key in this.edit_view_error_ui_dic ) {\n\t\t\tthis.edit_view_error_ui_dic[key].removeClass( 'error-tip' );\n\t\t\tthis.edit_view_error_ui_dic[key].tooltip( 'dispose' );\n\t\t}\n\t\tthis.edit_view_error_ui_dic = {};\n\t}\n}"],"sourceRoot":""}