(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["portal-PortalBaseViewController","portal-header-HeaderUploadResumeWidget","portal-hr-recruitment-PortalJobVacancyRowController","portal-sign_in-PortalForgotPasswordController","portal-sign_in-PortalResetForgotPasswordController"],{1748:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{"g":()=>IndexViewController});var _views_portal_header_HeaderViewController__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3246),_views_portal_PortalBaseViewController__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(97),_services_TimeTrexClientAPI__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7526),_global_TAlertManager__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9239);class ApplicationRouter extends Backbone.Router{constructor(e={}){_.defaults(e,{controller:null,headerView:null,routes:{"":"onViewChange","!:viewName":"onViewChange","*notFound":"notFound"}}),super(e)}reloadView(view_id){"function"===eval("typeof "+view_id+"ViewController")&&(TopMenuManager.selected_sub_menu_id="",_views_portal_PortalBaseViewController__WEBPACK_IMPORTED_MODULE_1__.PortalBaseViewController.loadView(view_id))}notFound(e){var t=Global.getBaseURL().split("#")[0];Global.setURLToBrowser(t+"#!m=PortalJobVacancy")}onViewChange(e){var t,a,o,r=this,i={};if(Global.needReloadBrowser)return Global.needReloadBrowser=!1,void window.location.reload();if(e&&(i=Global.buildArgDic(e.split("&"))),t=e&&e.indexOf("m=")>=0?Global.sanitizeViewId(i.m):"PortalJobVacancy",LocalCacheData.fullUrlParameterStr=e,LocalCacheData.setAllURLArgs(i),LocalCacheData.getAllURLArgs()&&(LocalCacheData.getAllURLArgs().hasOwnProperty("company_id")||(TTPromise.add("IndexController","onViewChange"),TTPromise.wait(null,null,(function(){IndexViewController&&IndexViewController.instance&&IndexViewController.instance.router?IndexViewController.instance.router.showTipModal($.i18n._("Invalid Company")):_global_TAlertManager__WEBPACK_IMPORTED_MODULE_3__.K.showAlert($.i18n._("Invalid Company"))})),setTimeout((function(){TTPromise.resolve("IndexController","onViewChange")}),4e3))),a=i.id,o=i.a,LocalCacheData.current_open_view_id!==t){switch(LocalCacheData.edit_id_for_next_open_view=a,o&&(LocalCacheData.current_doing_context_action=o),t){case"TimeSheet":case"Schedule":i.date&&(LocalCacheData.current_select_date=i.date)}var n;if(n=0,LocalCacheData.loadViewRequiredJSReady)s();else var l=setInterval((function(){100==n&&clearInterval(l),n+=1,LocalCacheData.loadViewRequiredJSReady&&(s(),clearInterval(l))}),600)}else if(LocalCacheData.current_open_primary_controller){if(o){switch(o){case"edit":(!LocalCacheData.current_open_primary_controller.edit_view||LocalCacheData.current_open_primary_controller.current_edit_record&&LocalCacheData.current_open_primary_controller.current_edit_record.id!=a)&&"edit"===LocalCacheData.current_doing_context_action&&_(a);break;case"new":LocalCacheData.current_open_primary_controller.edit_view||_();break;case"view":switch(t){case"MessageControl":"message"===i.t?LocalCacheData.current_open_primary_controller.edit_view&&function(){if(Global.isArray(LocalCacheData.current_open_primary_controller.current_edit_record))for(var e=0;e<LocalCacheData.current_open_primary_controller.current_edit_record.length;e++){var t=LocalCacheData.current_open_primary_controller.current_edit_record[e];if(t.id===a)return!0}else if((t=LocalCacheData.current_open_primary_controller.current_edit_record).id===a)return!0;return!1}()||_(a,!0):"request"===i.t&&(LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.current_select_message_control_data.id==a||_(a,!0));break;default:LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.current_edit_record.id==a||_(a,!0)}}return}if(LocalCacheData.current_open_primary_controller.edit_view&&LocalCacheData.current_open_primary_controller.current_edit_record){if("TimeSheet"===LocalCacheData.current_open_primary_controller.viewId&&LocalCacheData.current_open_primary_controller.is_mass_editing)return;LocalCacheData.current_open_primary_controller.buildContextMenu(!0),LocalCacheData.current_open_primary_controller.removeEditView(),this.cleanAnySubViewUI()}}function s(){IndexViewController.autoLogin((function(){if($("body").removeClass("login-bg"),Global.loadStyleSheet("../../framework/bootstrap-select/css/bootstrap-select.min.css?v="+APIGlobal.pre_login_data.application_build),r.headerView){if(r.headerView.profileView&&r.headerView.profileView.is_changed)return void r.showConfirmModal($.i18n._("You have modified data without saving, are you sure you want to continue and lose your changes"),{title:"",actions:[{label:"No",isClose:!0,callBack:function(e){r.navigate("#!m=MyProfile&company_id="+LocalCacheData.getAllURLArgs().company_id,{trigger:!1,replace:!0})}},{label:"Yes",callBack:function(e){r.hideConfirmModal(),c(),d()}}]});c(),d()}else r.headerView=new _views_portal_header_HeaderViewController__WEBPACK_IMPORTED_MODULE_0__.HeaderViewController,$("#topContainer").html(r.headerView.el),d()}))}function c(){r.headerView.jobVacancyViewController=null,r.headerView.profileView=null,r.headerView.render()}function d(){setTimeout((function(){Global.topContainer().css("display","block"),Global.bottomContainer().css("display","block")}),50),Global.loadViewSource(t,t+"ViewController.js",(function(){_views_portal_PortalBaseViewController__WEBPACK_IMPORTED_MODULE_1__.PortalBaseViewController.loadView(t)}))}function _(e,a){var o;switch(t){case"MessageControl":var r={};"message"===(o=i.t)?r.id=e:(r.object_id=e,r.object_type_id=50),LocalCacheData.current_open_primary_controller.onViewClick(r);break;case"TimeSheet":o=i.t,a?e&&LocalCacheData.current_open_primary_controller.onViewClick(e,o):e?LocalCacheData.current_open_primary_controller.onEditClick(e,o):LocalCacheData.current_open_primary_controller.onAddClick();break;default:a?e&&LocalCacheData.current_open_primary_controller.onViewClick(e):e?LocalCacheData.current_open_primary_controller.onEditClick(e):LocalCacheData.current_open_primary_controller.onAddClick()}}}cleanAnySubViewUI(){var e=Global.contentContainer().children();if(e.length>1)for(var t=1;t<e.length;t++)try{if($(e[t]).attr("id")===LocalCacheData.current_open_primary_controller.ui_id)continue;e[t].remove()}catch(a){}}setContentDivHeight(){Global.contentContainer().removeClass("content-container"),Global.contentContainer().addClass("content-container-after-login"),Global.topContainer().addClass("top-container-after-login")}addTopMenu(){Global.loadScript("global/widgets/top_menu/TopMenuController.js"),TopMenuController&&TopMenuController.loadView()}showFormModal(e,t){function a(){!t&&(t={title:"...",actions:[]}),$("#formModal").length>0&&$("#formModal").modal({backdrop:"static",show:!0}),$("#formModalLabel").text(t.title),$("#formModalBody").html(e),t.actions.length>0&&($("#formModalFooter").empty(),_.each(t.actions,(function(e){var t=$('<button type="button" class="btn"></button>');e.isClose&&t.attr("data-dismiss","modal"),t.text(e.label),e.class&&t.addClass(e.class),!e.class&&t.addClass("btn-primary"),e.callBack&&(e.isClose&&$("#formModal").find("button.close").unbind("click").bind("click",e.callBack.bind(self)),t.unbind("click").bind("click",e.callBack.bind(self))),$("#formModalFooter").append(t)})))}$("#formModal").is(":visible")?(this.hideFormModal(),setTimeout((function(){a()}),500)):a()}showTipModal(e,t){var a=this;function o(){!t&&(t={title:"...",actions:[],style:{}}),$("#tipModal").find(".modal-content").css(t.style),$("#tipModal").length>0&&$("#tipModal").modal("show"),$("#tipModalBody").html(e),a.autoHideTipModal()}$("#tipModal").is(":visible")?(this.hideTipModal(),setTimeout((function(){o()}),500)):o()}showConfirmModal(e,t){function a(){!t&&(t={title:"...",actions:[]}),$("#confirmModal").length>0&&$("#confirmModal").modal({backdrop:"static",show:!0}),$("#confirmModalLabel").text(t.title),$("#confirmModalBody").html(e),t.actions.length>0&&($("#confirmModalFooter").empty(),_.each(t.actions,(function(e){var t=$('<button type="button" class="btn"></button>');e.isClose&&t.attr("data-dismiss","modal"),t.text(e.label),e.class&&t.addClass(e.class),!e.class&&t.addClass("btn-primary"),e.callBack&&t.unbind("click").bind("click",e.callBack.bind(self)),$("#confirmModalFooter").append(t)})))}$("#confirmModal").is(":visible")?(this.hideConfirmModal(),setTimeout((function(){a()}),500)):a()}showSignInModal(e,t){function a(){!t&&(t={title:"...",actions:[]}),$("#signinModal").length>0&&$("#signinModal").modal({backdrop:"static",show:!0}),$("#signinModalLabel").text(t.title),$("#signinModalBody").html(e),t.actions.length>0&&($("#signinModalFooter").empty(),_.each(t.actions,(function(e){var t=$('<button type="button" class="btn"></button>');e.isClose&&t.attr("data-dismiss","modal"),t.text(e.label),e.class&&t.addClass(e.class),!e.class&&t.addClass("btn-primary"),e.callBack&&(e.isClose&&$("#signinModal").find("button.close").unbind("click").bind("click",e.callBack.bind(self)),t.unbind("click").bind("click",e.callBack.bind(self))),$("#signinModalFooter").append(t)})))}$("#signinModal").is(":visible")?(this.hideSignInModal(),setTimeout((function(){a()}),500)):a()}autoHideTipModal(){var e=this;setTimeout((function(){e.hideTipModal()}),5e3)}hideTipModal(){$("#tipModal").modal("hide")}hideFormModal(){$("#formModal").modal("hide")}hideSignInModal(){$("#signinModal").modal("hide")}hideConfirmModal(){$("#confirmModal").modal("hide")}removeCurrentView(e){function t(e){e.clearErrorTips(),e.edit_view&&e.edit_view.remove(),e.sub_log_view_controller=null,e.edit_view_ui_dic={},e.edit_view_ui_validation_field_dic={},e.edit_view_form_item_dic={},e.edit_view_error_ui_dic={},LocalCacheData.current_doing_context_action=""}LocalCacheData.current_open_edit_only_controller&&(t(LocalCacheData.current_open_edit_only_controller),LocalCacheData.current_open_edit_only_controller=null),LocalCacheData.current_open_primary_controller?(LocalCacheData.current_open_primary_controller.edit_view&&t(LocalCacheData.current_open_primary_controller),Global.contentContainer().empty(),LocalCacheData.current_open_primary_controller.cleanWhenUnloadView(e)):Global.isSet(e)&&e()}}class IndexViewController extends Backbone.View{constructor(e={}){_.defaults(e,{el:"body",router:null}),super(e)}initialize(e){this.router=new ApplicationRouter,this.router.controller=this,Backbone.History.started||Backbone.history.start(),IndexViewController.instance=this}}IndexViewController.autoLogin=function(e){var t=getCookie(Global.getSessionIDKey()),a=LocalCacheData.getLoginData();t&&t.length>=40&&a&&1==a.is_logged_in?IndexViewController.setPortalLoginUserData(t,e):e()},IndexViewController.setPortalLoginUserData=function(e,t){if(null===LocalCacheData.getPortalLoginUser()){var a=this;LocalCacheData.setSessionID(e),setCookie(Global.getSessionIDKey(),e),this.doing_login=!0,this.jobapplicant_api=_services_TimeTrexClientAPI__WEBPACK_IMPORTED_MODULE_2__.y.APIJobApplicantPortal,this.jobapplicant_api.getJobApplicant({onResult:function(e){e.isValid()&&LocalCacheData.setPortalLoginUser(e.getResult()[0]),a.doing_login=!1,t&&t()}})}else t()},IndexViewController.goToView=function(e,t){TopMenuManager.selected_sub_menu_id&&$("#"+TopMenuManager.selected_sub_menu_id).removeClass("selected-menu"),$("#"+e).addClass("selected-menu"),LocalCacheData.default_filter_for_next_open_view=t,TopMenuManager.goToView(e,!0)},IndexViewController.goToViewByViewLabel=function(e){var t;switch(e){case"Exceptions":t="Exception";break;case"Messages":t="MessageControl";break;case"Requests":t="Request";break;case"Contact Information":return void IndexViewController.openEditView(LocalCacheData.current_open_primary_controller,"LoginUserContact");default:t=e.replace(/\s/g,"")}TopMenuManager.selected_sub_menu_id&&$("#"+TopMenuManager.selected_sub_menu_id).removeClass("selected-menu"),$("#"+t).addClass("selected-menu"),TopMenuManager.goToView(t,!0)},IndexViewController.openWizard=function(e,t,a){BaseWizardController.default_data=t,BaseWizardController.call_back=a,Global.trackView(e),Global.loadViewSource(e,e+"Controller.js",(function(){BaseWizardController.openWizard(e,e+".html")}))},IndexViewController.openReport=function(parent_view_controller,view_name,id){var view_controller=null;LocalCacheData.current_open_report_controller&&LocalCacheData.current_open_report_controller.removeEditView(),ProgressBar.showOverlay(),Global.loadViewSource(view_name,view_name+"ViewController.js",(function(){view_controller=eval("new "+view_name+"ViewController( {edit_only_mode: true} ); "),view_controller.parent_view_controller=parent_view_controller,view_controller.openEditView();var current_url=window.location.href;current_url.indexOf("&sm")>0&&(current_url=current_url.substring(0,current_url.indexOf("&sm"))),current_url=current_url+"&sm="+view_name,LocalCacheData.default_edit_id_for_next_open_edit_view&&(current_url=current_url+"&sid="+LocalCacheData.default_edit_id_for_next_open_edit_view),Global.setURLToBrowser(current_url)}))},IndexViewController.openEditView=function(parent_view_controller,view_name,id){var view_controller=null;PermissionManager.checkTopLevelPermission(view_name)||"map"===view_name?(Global.trackView(view_name),Global.loadViewSource(view_name,view_name+"ViewController.js",(function(){view_controller=eval("new "+view_name+"ViewController( {edit_only_mode: true} ); "),view_controller.parent_view_controller=parent_view_controller,view_controller.openEditView(id);var current_url=window.location.href;current_url.indexOf("&sm")>0&&(current_url=current_url.substring(0,current_url.indexOf("&sm"))),current_url=id?current_url+"&sm="+view_name+"&sid="+id:current_url+"&sm="+view_name,Global.setURLToBrowser(current_url),LocalCacheData.current_open_edit_only_controller=view_controller}))):_global_TAlertManager__WEBPACK_IMPORTED_MODULE_3__.K.showAlert("Permission denied")},IndexViewController.setNotificationBar=function(e){var t=_services_TimeTrexClientAPI__WEBPACK_IMPORTED_MODULE_2__.y.APINotification;t&&t.getNotification&&"function"==typeof t.getNotification&&t.getNotifications(e,{onResult:function(e){var t=e.getResult();if(!LocalCacheData.notification_bar){var a=$(Global.loadWidgetByName(WidgetNamesDic.NOTIFICATION_BAR));LocalCacheData.notification_bar=a.TopNotification()}LocalCacheData.notification_bar.show(t)}})},IndexViewController.instance=null},97:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"PortalBaseViewController":()=>l});a(300);var o=a(6739),r=a(7526),i=a(1748),n=a(1730);class l extends o.TTBackboneView{constructor(e={}){_.defaults(e,{can_cache_controller:!0,pager_data:null,events:{"click .search-btn":"onSearchClick",'change select[id="country"]':"onCountryChange",'keydown input[id="name"]':"autoSearch",'keydown input[id="city"]':"autoSearch"}}),super(e)}initialize(e){super.initialize(e),this.preInit(e),this.company_api=r.y.APICompanyPortal,LocalCacheData.current_open_primary_controller=this,this.init(),this.postInit(e)}preInit(){}init(){}postInit(){}render(){var e=this;ProgressBar.showOverlay(),this.initOptions((function(){e.search()}))}autoSearch(e){13===e.keyCode&&this.onSearchClick()}initOptions(e){this.initCountryOptions(e)}initCountryOptions(e){var t=this;this.company_api.getOptions("country",{onResult:function(a){a=a.getResult();t.$("#country").append($("<option></option>").prop("value","").attr("selected","selected").text($.i18n._("All Countries"))),$.each(a,(function(e,a){t.$("#country").append($("<option></option>").prop("value",e).text($.i18n._(a)))})),t.$("#country").selectpicker(),t.$("#province").selectpicker(),e()}})}onCountryChange(){this.eSetProvince(this.$('select[id="country"]').val())}eSetProvince(e){var t=this;if(t.$("#province").selectpicker("destroy"),!e)return t.$("#province").html($("<option></option>").prop("value","").attr("selected","selected").text($.i18n._("All Province/States"))),void t.$("#province").selectpicker();this.company_api.getOptions("province",e,{onResult:function(e){(e=e.getResult())||(e=[]),t.$("#province").html($("<option></option>").prop("value","").attr("selected","selected").text($.i18n._("All Province/States"))),$.each(e,(function(e,a){t.$("#province").append($("<option></option>").prop("value",e).text($.i18n._(a)))})),t.$("#province").selectpicker()}})}loadMore(){this.onSearchClick({page_action:"next"})}addSearchResultPanel(){}onSearchClick(e){var t=this,a={};this.addSearchResultPanel(),void 0===e&&(e={}),void 0===e.page_action&&this.$(".search-result .content").empty(),this.vacancy_list_panel=this.$(".search-result .content"),this.more_btn=this.$(".search-result .more"),this.more_btn.unbind("click").bind("click",(function(){t.loadMore()})),a.filter_data={},a.filter_sort={},a.filter_items_per_page=0,this.$("#name").val()&&""!=this.$("#name").val()&&(a.filter_data.name=this.$("#name").val()),this.$("#country").val()&&""!=this.$("#country").val()&&(a.filter_data.country=this.$("#country").val()),this.$("#province").val()&&""!=this.$("#province").val()&&(a.filter_data.province=this.$("#province").val()),this.$("#city").val()&&""!=this.$("#city").val()&&(a.filter_data.city=this.$("#city").val()),this.pager_data&&"next"===e.page_action?a.filter_page=this.pager_data.next_page:a.filter_page=1,this.api["get"+this.api.key_name](a,!1,{onResult:function(a){t.pager_data=a.getPagerData();var o=a.getResult();if((t.vacancy_list_panel.find(".vacancy-list-no-result")[0]||t.pager_data&&t.pager_data.is_first_page)&&t.vacancy_list_panel.empty(),Global.isArray(o))for(var r=0;r<o.length;r++){var i=o[r],l=new Backbone.Model(i),s=new n.PortalJobVacancyRowController({model:l});t.vacancy_list_panel.append(s.el)}else{var c=$('<div class="vacancy-list-no-result">'+$.i18n._("No Results Found")+"</div>");t.vacancy_list_panel.html(c)}!t.pager_data||t.pager_data.is_last_page||!0===o?t.more_btn.hide():t.more_btn.show(),void 0!==e.callback&&e.callback()}})}onSelectClick(e){var t=$(e.currentTarget).parent().find("select");document.createEvent?((e=document.createEvent("MouseEvents")).initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t[0].dispatchEvent(e)):element.fireEvent&&t[0].fireEvent("onmousedown")}}l.loadView=function(e){Global.loadViewSource(e,e+"View.html",(function(t){var a=_.template(t)();window.IndexViewController=i.g,Global.contentContainer().html(a),LocalCacheData.current_open_view_id=e,Global.trackView(e,LocalCacheData.current_doing_context_action)}))}},3295:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"HeaderUploadResumeWidget":()=>l});var o=a(6739),r=a(7526),i=a(4936),n=a(12);class l extends o.TTBackboneView{constructor(e={}){_.defaults(e,{}),super(e)}initialize(e){super.initialize(e);var t=Global.loadWidget("views/portal/header/HeaderUploadResumeWidget.html");this.setElement(_.template(t)()),this.document_id=null,this.profileView=null,e.profileView&&(this.profileView=e.profileView)}render(){var e=this;this.uploader||(this.uploader=this.$(".register-resume").TImageBrowser({field:"file",name:"filedata",accept_filter:"*",changeHandler:function(t){var a=$(this).find(".browser")[0].files[0].name;e.$("#fileName").val(a)}})),IndexViewController.instance.router.showFormModal(this.$el,{title:$.i18n._("Upload Resume"),actions:[{label:"Close",isClose:!0},{label:$.i18n._("Upload Resume"),callBack:function(t){e.uploadResume()}}]})}uploadResume(){if(!this.uploader)return!1;var e=this.uploader,t=(e.attr("file_name"),e.getValue());if(t){this.document_api=r.y.APIDocumentPortal;var a="Resume - "+LocalCacheData.getPortalLoginUser().first_name+" "+LocalCacheData.getPortalLoginUser().last_name,o=this.document_api.addAttachment(a,"",{async:!1}).getResult();this.document_id=o.document_id,this.uploadFile(t,o.document_revision_id)}}uploadFile(e,t){var a=this,o=n.n.getAPIURL("Class="+this.document_api.className+"&Method=uploadAttachment&v=2");LocalCacheData.getAllURLArgs()&&LocalCacheData.getAllURLArgs().hasOwnProperty("company_id")&&(o=o+"&company_id="+LocalCacheData.getAllURLArgs().company_id),o=o+"&object_id="+t;var r=i.d.generateUUID();ProgressBar.showProgressBar(r),ProgressBar.changeProgressBarMessage($.i18n._("File Uploading")+"..."),$.ajax({url:o,headers:{"X-Client-ID":"Browser-TimeTrex","X-CSRF-Token":getCookie("CSRF-Token")},type:"POST",data:e,success:function(e){ProgressBar.removeProgressBar(),a.uploaded(),e.error?a.showUploadedMessage(e.error):(a.showUploadedMessage($.i18n._("Upload Successful!")),a.refreshSubDocument())},cache:!1,contentType:!1,processData:!1})}refreshSubDocument(){this.profileView&&this.profileView.addDocumentRow(this.document_id)}uploaded(){this.uploader=null,IndexViewController.instance.router.hideFormModal()}showUploadedMessage(e){IndexViewController.instance.router.showTipModal(e)}}},3246:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"HeaderViewController":()=>s});var o=a(6739),r=a(9903),i=a(3295),n=a(12),l=a(7526);class s extends o.TTBackboneView{constructor(e={}){_.defaults(e,{events:{"click .navbar-signin .login":"goPortalLogin","click .navbar-signin .logout":"doLogout","click .navbar-signin .profile":"goProfile"}}),super(e)}initialize(e){var t;super.initialize(e);e={};t=LocalCacheData.getAllURLArgs().company_id?n.n.getAPIURL("Class=APIDocumentPortal&Method=getCompanyLogo&v=2")+"&company_id="+LocalCacheData.getAllURLArgs().company_id:"../../theme/default/portal/images/t_icon_logo.png";var a=Global.loadWidget("views/portal/header/HeaderView.html");this.setElement(_.template(a)({company_logo:t})),this.uploadResumeWidget=null,this.profileView=null,this.jobVacancyDetailController=null,this.jobVacancyViewController=null,this.render()}render(){if(LocalCacheData.getPortalLoginUser()){var e=$('<div class="dropdown">');e.append('<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">'+LocalCacheData.getPortalLoginUser().first_name+" "+LocalCacheData.getPortalLoginUser().last_name+' <span class="caret"></span></a>');var t=$('<ul class="dropdown-menu">');t.append('<li><a class="profile" href="javascript:;">My Profile</a></li>'),t.append('<li><a class="logout" href="javascript:;">Logout</a></li>'),e.append(t),this.$(".navbar-signin").html(e)}else{var a=$('<a class="login"></a>');a.attr("href","javascript:;"),a.append($("<img>").attr("src","../../theme/default/portal/images/t_icon_head.png")),a.append($("<span>").text($.i18n._("Login"))),this.$(".navbar-signin").html(a)}}goPortalLogin(){new r.SignInController({_delegate:this.jobVacancyDetailController})}doLogout(){this.clearErrorTips();var e=this;l.y.APIRecruitmentAuthentication.Logout({onResult:function(t){deleteCookie(Global.getSessionIDKey()),LocalCacheData.setPortalLoginUser(!1),LocalCacheData.current_open_view_id="",e.jobVacancyViewController?e.render():IndexViewController.instance.router.navigate("#!m=PortalJobVacancy&company_id="+LocalCacheData.getAllURLArgs().company_id,{trigger:!0,replace:!0})}})}clearErrorTips(){for(var e=$(".error-tip"),t=0;t<e.length;t++)$(e[t]).removeClass("error-tip"),$(e[t]).tooltip().tooltip("dispose")}goProfile(){var e=Global.getBaseURL()+"#!m=MyProfile&company_id="+LocalCacheData.getAllURLArgs().company_id;window.location=e}uploadResume(){LocalCacheData.getPortalLoginUser()?(this.uploadResumeWidget||(this.uploadResumeWidget=new i.HeaderUploadResumeWidget({profileView:this.profileView})),this.uploadResumeWidget.render()):this.goPortalLogin()}}},1730:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"PortalJobVacancyRowController":()=>r});var o=a(6739);class r extends o.TTBackboneView{constructor(e={}){_.defaults(e,{}),super(e)}initialize(e){super.initialize(e);var t=this,a=Global.loadWidget("views/portal/hr/recruitment/PortalJobVacancyRow.html");for(var o in this.model.attributes)0==this.model.get(o)&&this.model.set(o,"");this.setElement(_.template(a)(this.model.toJSON())),this.$el.on("click",(function(e){var a=Global.getBaseURL()+"#!m=PortalJobVacancyDetail&id="+t.model.id+"&company_id="+LocalCacheData.getAllURLArgs().company_id;window.location=a}))}}},76:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"PortalForgotPasswordController":()=>i});var o=a(6739),r=a(7526);class i extends o.TTBackboneView{constructor(e={}){_.defaults(e,{events:{"click .send-reset-email":"sendResetEmail"}}),super(e)}initialize(e){super.initialize(e),this.api=r.y.APIRecruitmentAuthentication;var t=Global.loadWidget("views/portal/sign_in/PortalForgotPassword.html");this.setElement(_.template(t)()),this.emailInput=this.$("#email"),this.render()}render(){var e=this;this.emailInput.focus(),this.emailInput.unbind("keydown").bind("keydown",(function(t){13===t.keyCode&&e.sendResetEmail()})),$("body").append(this.$el),this.$el.modal({"show":!0,"backdrop":"static"}),this.$el.on("hidden.bs.modal",(function(){e.$el.remove()}))}sendResetEmail(){var e=this,t=this.emailInput.val();this.api.resetPassword(t,{onResult:function(t){t.isValid()?t.getResult().hasOwnProperty("email_sent")&&(e.$el.modal("hide"),IndexViewController.instance.router.showTipModal($.i18n._("An email has been sent to you with instructions on how to change your password."))):e.showErrorAlert(t)}})}showErrorAlert(e){var t=e.getDetails();t||(t=e.getDescription());var a="";Global.isArray(t)||"object"==typeof t?$.each(t,(function(e,t){t.hasOwnProperty("error")&&(t=t.error);var o=0;for(var r in t)a+=t[r],o>0&&(a+="<br>"),o++})):a=t,this.emailInput.css("border","1px solid red"),this.emailInput.tooltip({title:a}),this.emailInput.tooltip("show")}}},5866:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"PortalResetForgotPasswordController":()=>i});var o=a(6739),r=a(7526);class i extends o.TTBackboneView{constructor(e={}){_.defaults(e,{events:{"click .portal-reset-forgot-password":"resetForgotPassword"}}),super(e)}initialize(e){super.initialize(e),e.callback&&(this.callback=e.callback),this.api=r.y.APIRecruitmentAuthentication;var t=Global.loadWidget("views/portal/sign_in/PortalResetForgotPassword.html");this.setElement(_.template(t)()),this.render()}render(){var e=this;this.$("#new_password").focus(),this.$("#confirm_password").unbind("keydown").bind("keydown",(function(t){13===t.keyCode&&e.resetForgotPassword()})),$("body").append(this.$el),this.$el.modal({"show":!0,"backdrop":"static"}),this.$el.on("hidden.bs.modal",(function(){e.removeView()}))}removeView(){this.$el.remove(),LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"sm")),LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"key")),IndexViewController.instance.router.navigate("#!m=PortalJobVacancy&company_id="+LocalCacheData.getAllURLArgs().company_id,{trigger:!1,replace:!0})}resetForgotPassword(){var e=this;if(this.getPassword()){var t=this.getPassword();this.api.passwordReset(LocalCacheData.getAllURLArgs().key,t.new_password,t.confirm_password,{onResult:function(t){if(t.isValid())e.$el.modal("hide"),e.callback&&e.callback();else{var a=t.getDetails();a||(a=t.getDescription());var o="";Global.isArray(a)||"object"==typeof a?$.each(a,(function(e,t){t.hasOwnProperty("error")&&(t=t.error);var a=0;for(var r in t)o+=t[r],a>0&&(o+="<br>"),a++})):o=a,e.setError(e.$("#new_password"),o)}}})}}getPassword(){var e=this.$("#new_password"),t=this.$("#confirm_password");return e.val()?(this.clearError(e),e.val()!==t.val()?(this.setError(t,$.i18n._("New password does not match")),!1):(this.clearError(t),{new_password:e.val(),confirm_password:t.val()})):(this.setError(e,$.i18n._("New password can't be empty")),!1)}setError(e,t){e.css("border","1px solid red"),e.tooltip({title:t}),e.tooltip("show")}clearError(e){e.css("border","1px solid #ccc"),e.tooltip("dispose")}}},9903:(e,t,a)=>{"use strict";a.r(t),a.d(t,{"SignInController":()=>c});var o=a(97),r=a(5866),i=a(7526),n=a(1748),l=a(12),s=a(76);class c extends o.PortalBaseViewController{constructor(e={}){_.defaults(e,{doing_login:!1,edit_view_error_ui_dic:{},_delegate:null,events:{"click #forgot_password":"forgotPasswordClick"}}),super(e)}init(e){var t=this;t.recruitment_api=i.y.APIRecruitmentAuthentication,t.jobapplicant_api=i.y.APIJobApplicantPortal,t.authentication_api=i.y.APIAuthentication;var a=Global.loadWidget("views/portal/sign_in/SignIn.html");if(t.setElement(_.template(a)()),t.user_name=t.$("#user_name"),t.password=t.$("#password"),Global.isSet(e)&&Global.isSet(e._delegate)&&(t._delegate=e._delegate),"ResetPassword"===LocalCacheData.getAllURLArgs().sm&&LocalCacheData.getAllURLArgs().key&&LocalCacheData.getAllURLArgs().company_id)new r.PortalResetForgotPasswordController({callback:function(){LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"sm")),LocalCacheData.setAllURLArgs(_.omit(LocalCacheData.getAllURLArgs(),"key")),n.g.instance.router.navigate("#!m=PortalJobVacancy&company_id="+LocalCacheData.getAllURLArgs().company_id,{trigger:!1,replace:!0}),t.setLoginTips($.i18n._("Password has been changed successfully, you may now login"))}});else t.render()}render(){var e=this;LocalCacheData.setSessionID(""),this.user_name.focus(),this.password.unbind("keydown").bind("keydown",(function(t){13===t.keyCode&&e.onLoginBtnClick()})),LocalCacheData.getAllURLArgs().user_name&&this.user_name.val(LocalCacheData.getAllURLArgs().user_name),LocalCacheData.getAllURLArgs().password&&this.password.val(LocalCacheData.getAllURLArgs().password),this.showSignInModal()}showSignInModal(){var e=this;n.g.instance.router.showSignInModal(this.$el,{title:$.i18n._("Login"),actions:[{label:$.i18n._("Cancel"),isClose:!0},{label:$.i18n._("Login"),callBack:function(t){e.onLoginBtnClick()}}]})}hideSignInModal(e){e&&$("#signinModal").unbind("hidden.bs.modal").bind("hidden.bs.modal",(function(t){e()})),n.g.instance.router.hideSignInModal()}forgotPasswordClick(){this.hideSignInModal((function(){new s.PortalForgotPasswordController;$("#signinModal").unbind("hidden.bs.modal")}))}onLoginBtnClick(){var e=this.user_name.val(),t=this.password.val(),a=this;this.doing_login||(this.doing_login=!0,this.recruitment_api.Login(e,t,{onResult:function(e){a.onLoginSuccess(e),a.setLocalCacheCompany()},delegate:this}))}setLocalCacheCompany(){this.authentication_api.getCurrentCompany({onResult:function(e){var t=e.getResult();LocalCacheData.setCurrentCompany(t)}})}onLoginSuccess(e,t){var a,o=this;a=t||e.getResult(),LocalCacheData.setLoginUserPreference(null),e&&!e.isValid()?(LocalCacheData.setSessionID(""),deleteCookie(Global.getSessionIDKey()),e.getDetails()[0].hasOwnProperty("password")?(o.hideSignInModal(),o.password.val(""),n.g.openWizard("ResetPasswordWizard",{user_name:o.user_name.val(),api_class:i.y.APIRecruitmentAuthentication,message:e.getDetailsAsString()},(function(){o.setLoginTips($.i18n._("Password has been changed successfully, you may now login"))}))):this.setErrorTips(e),o.doing_login=!1):(this.clearErrorTips(),l.n.cancel_all_error=!1,n.g.setPortalLoginUserData(a,(function(){n.g.instance.router.headerView.render(),o._delegate&&o._delegate.render(),o.hideSignInModal(),o.doing_login=!1})))}setLoginTips(e){void 0!==this.$(".alert")[0]&&this.$(".alert").remove();var t=Global.loadWidget("views/portal/alert/alert.html");this.$(".signIn-form").before(t),this.$(".alert").append("<p>"+e+"</p>"),this.showSignInModal()}setErrorTips(e){var t=e.getDetails()?e.getDetails()[0]:{};for(var a in t&&t.hasOwnProperty("error")&&(t=t.error),t){var o,r;if(t.hasOwnProperty(a))if(this.$('input[id="'+a+'"]')[0]&&(o=this.$('input[id="'+a+'"]')),o)o.addClass("error-tip"),r=_.isArray(t[a])?t[a][0]:t[a],o.tooltip({"title":r}),o.tooltip("show"),this.edit_view_error_ui_dic[a]=o}}clearErrorTips(){for(var e in this.edit_view_error_ui_dic)this.edit_view_error_ui_dic[e].removeClass("error-tip"),this.edit_view_error_ui_dic[e].tooltip("dispose");this.edit_view_error_ui_dic={}}}}}]);
//# sourceMappingURL=portal-PortalBaseViewController.bundle.js.map?v=37b367c369fb05483c57