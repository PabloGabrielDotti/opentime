{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/wizard/WizardStep.js","webpack://timetrex/./interface/html5/views/payroll/process_transactions_wizard/ProcessTransactionsWizardStepHome.js"],"names":["WizardStep","TTBackboneView","options","_","defaults","previous_step_name","next_step_name","buttons","wizard_obj","clicked_buttons","reload","api","name","title","$","i18n","instructions","super","initialize","this","setWizardObject","init","render","el","find","html","callback","length","append","val","initCardsBlock","_render","content","button","gridId","grid_div","allMultipleSelection","remove","grid","grid_columns","getGridColumns","$this","TTGrid","onSelectRow","e","onGridSelectRow","onSelectAll","n","ondblClickRow","onGridDblClickRow","multiselect","winMultiSelect","setGridSize","setGridGroupColumns","callBack","setGridHeight","setGridWidth","width","height","div","ul","id","icon","label","desc","src","container","img","right_container","description","selected_id","addButtonClick","ProgressBar","showOverlay","window","clickProcessing","clickProcessingHandle","setTimeout","closeOverlay","_onNavigationClick","element","target","hasClass","parents","addClass","hasOwnProperty","context_name","icon_name","button_name","getRibbonButton","Global","getRibbonIconRealPath","unbind","bind","onNavigationClick","isButtonClicked","appendButton","action_id","getMakePaymentData","getWizardObject","selected_remittance_agency_event_id","onResult","result","url","getResult","open","getFileAndPayWithPaymentServicesData","retval","TAlertManager","showAlert","ProcessTransactionsWizardStepHome","source_accounts","pay_periods","types","filter_data","external_data","getExternalData","transaction_source_data","normalizeSourceAccounts","TTAPI","APIPayStubTransaction","temp_filter_data","ignore_fields","indexOf","getPayPeriodTransactionSummary","transactions","data","m","pay_period_id","item","new_record","remittance_source_account_id","remittance_source_account","type","remittance_source_account_type","last_transaction_number","remittance_source_account_last_transaction_number","total_amount","total_transactions","push","TTUUID","zero_id","setExternalData","setTitle","wizard_name","setCurrentStepName","TTPromise","add","wait","show","focus","buildForm","tab_index","instruction_text","form","appendTo","table","header_row","column_header_row","row","chk","on","preventDefault","onCheck","last_transaction_input","onCheckNoKeyDown","parseInt","next_transaction_input","removeClass","filter","resolve","isNaN","key","keyCode","checkboxes","each","setTransactionIds"],"mappings":"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","file":"payroll-process_transactions_wizard-ProcessTransactionsWizardStepHome.bundle.js?v=ccde891642e85f1db5c3","sourcesContent":["import { TTBackboneView } from '@/views/TTBackboneView';\n\nexport class WizardStep extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tprevious_step_name: null,\n\t\t\tnext_step_name: null,\n\t\t\tbuttons: null,\n\t\t\twizard_obj: null, //rename to wizard_obj\n\n\t\t\tclicked_buttons: {},\n\t\t\treload: false,\n\n\t\t\tapi: null,\n\n\t\t\t//override in children\n\t\t\tname: 'undefined',\n\t\t\ttitle: $.i18n._( 'Undefined Step' ),\n\t\t\tinstructions: $.i18n._( 'Undefined step data' )\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinitialize( wizard_obj ) {\n\t\tsuper.initialize( wizard_obj );\n\n\t\tthis.buttons = {};\n\t\tthis.reload = false;\n\t\tthis.setWizardObject( wizard_obj );\n\t\tvar $this = this;\n\t\tthis.init();\n\t}\n\n\t//Children must always call render()\n\tinit() {\n\t\tthis.render();\n\t}\n\n\tinitCardsBlock() {\n\t\t$( this.wizard_obj.el ).find( '#cards' ).html( '' );\n\t}\n\n\tsetTitle( title ) {\n\t\t$( this.wizard_obj.el ).find( '.title-1' ).html( title );\n\t}\n\n\tsetInstructions( instructions, callback ) {\n\n\t\tif ( $( this.el ).find( '.instructions' ).length == 0 ) {\n\t\t\t$( this.el ).find( '.progress-bar' ).append( '<p class=\"instructions\"></p>' );\n\t\t}\n\n\t\t$( this.el ).find( '.progress-bar .instructions' ).html( instructions );\n\n\t\tif ( typeof callback == 'function' ) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tsetWizardObject( val ) {\n\t\tthis.wizard_obj = val;\n\t\tthis.el = this.wizard_obj.el;\n\t}\n\n\tgetWizardObject() {\n\t\treturn this.wizard_obj;\n\t}\n\n\tsetNextStepName( val ) {\n\t\tthis.next_step_name = val;\n\t}\n\n\tgetNextStepName() {\n\t\treturn false;\n\t}\n\n\tsetPreviousStepName( val ) {\n\t\tthis.previous_step_name = val;\n\t}\n\n\tgetPreviousStepName() {\n\t\treturn false;\n\t}\n\n\trender() {\n\t\tthis.initCardsBlock();\n\t\treturn this._render();\n\t}\n\n\t_render() {\n\t\treturn;\n\t\t//always overrirde\n\t}\n\n\tappend( content ) {\n\t\t$( this.wizard_obj.el ).find( '.content' ).append( content );\n\t}\n\n\tappendButton( button ) {\n\t\t$( this.wizard_obj.el ).find( '#cards' ).append( button );\n\t}\n\n\tsetGrid( gridId, grid_div, allMultipleSelection ) {\n\n\t\tif ( !allMultipleSelection ) {\n\t\t\tallMultipleSelection = false;\n\t\t}\n\n\t\t$( '#' + gridId ).remove(); //Remove the grid to prevent JS Exception: Uncaught TypeError: Failed to execute 'replaceChild' on 'Node': parameter 2 is not of type 'Node'.\n\n\t\tthis.append( grid_div );\n\n\t\tvar grid = $( '#' + gridId );\n\n\t\tvar grid_columns = this.getGridColumns( gridId );\n\n\t\tvar $this = this;\n\n\t\tgrid = new TTGrid( gridId, {\n\t\t\tonSelectRow: function( e ) {\n\t\t\t\t$this.onGridSelectRow( e );\n\t\t\t},\n\t\t\tonSelectAll: function( e ) {\n\t\t\t\tfor ( var n in e ) {\n\t\t\t\t\t$this.onGridSelectRow( e[n] );\n\t\t\t\t}\n\t\t\t},\n\t\t\tondblClickRow: function() {\n\t\t\t\t$this.onGridDblClickRow();\n\t\t\t},\n\t\t\tmultiselect: false,\n\t\t\twinMultiSelect: false\n\t\t}, grid_columns );\n\n\t\tthis.setGridSize( grid );\n\t\tthis.setGridGroupColumns( gridId );\n\n\t\treturn grid; //allowing chaining off this method.\n\t}\n\n\tgetGridColumns( gridId, callBack ) {\n\t\t//override if step object needs a grid.\n\t}\n\n\tsetGridAutoHeight( grid, length ) {\n\t\tif ( length > 0 && length < 10 ) {\n\t\t\tgrid.grid.setGridHeight( length * 23 );\n\t\t} else if ( length > 10 ) {\n\t\t\tgrid.grid.setGridHeight( 400 );\n\t\t}\n\t}\n\n\tsetGridSize( grid ) {\n\t\tgrid.grid.setGridWidth( $( this.wizard_obj.el ).find( '.content .grid-div' ).width() - 11 );\n\t\tgrid.grid.setGridHeight( $( this.wizard_obj.el ).find( '.content' ).height() - 150 ); //During merge, this wasn't in MASTER branch.\n\t}\n\n\tgetRibbonButtonBox() {\n\t\tvar div = $( '<div class=\"menu ribbon-button-bar\"></div>' );\n\t\tvar ul = $( '<ul></ul>' );\n\n\t\tdiv.append( ul );\n\n\t\treturn div;\n\t}\n\n\t/**\n\t * to get old-style icons, don't provide desc\n\t * to get card-style icons, provide desc\n\t * to get card-style icons without a description, send a blank string ('') as desc\n\t *\n\t * @param id\n\t * @param icon\n\t * @param label\n\t * @param desc\n\t * @returns {*|jQuery|HTMLElement}\n\t */\n\tgetRibbonButton( id, icon, label, desc ) {\n\t\t//prelaod imgages to reduce the appearance of phantom flashing\n\t\t$( '<img></img>' )[0].src = icon;\n\n\t\tif ( typeof desc == 'undefined' ) {\n\t\t\tvar button = $( '<li><div class=\"ribbon-sub-menu-icon\" id=\"' + id + '\"><img src=\"' + icon + '\" >' + label + '</div></li>' );\n\t\t\treturn button;\n\t\t}\n\n\t\tvar container = $( '<div class=\"wizard_icon_card\" id=\"' + id + '\"></div>' );\n\n\t\tvar img = $( '<img src=\"' + icon + '\"></img>' );\n\n\t\tvar right_container = $( '<div class=\"right_container\"></div>' );\n\n\t\tvar title = $( '<h3 class=\"button_title\"></h3>' );\n\t\ttitle.html( label ? label : '' );\n\n\t\tvar description = $( '<div class=\"description\"></div>' );\n\t\tdescription.html( desc ? desc : '' );\n\n\t\tcontainer.append( img );\n\t\tright_container.append( title );\n\t\tright_container.append( description );\n\t\tcontainer.append( right_container );\n\n\t\treturn container;\n\t}\n\n\t//\n\t//stubs that should be overrideen\n\t//\n\n\tonGridSelectRow( selected_id ) {\n\t\t//\n\t}\n\n\tonGridDblClickRow( selected_id ) {\n\t\t//\n\t}\n\n\tonNavigationClick( e, icon ) {\n\t\tif ( e ) {\n\t\t\tthis.addButtonClick( e, icon );\n\t\t}\n\n\t\t//Prevent double clicking on tax wizard buttons.\n\t\tProgressBar.showOverlay();\n\n\t\t//this flag is turned off in ProgressBarManager::closeOverlay, or 2s whichever happens first\n\t\tif ( window.clickProcessing == true ) {\n\t\t\treturn;\n\t\t} else {\n\t\t\twindow.clickProcessing = true;\n\t\t\twindow.clickProcessingHandle = window.setTimeout( function() {\n\t\t\t\tif ( window.clickProcessing == true ) {\n\t\t\t\t\twindow.clickProcessing = false;\n\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t}\n\t\t\t}, 1000 );\n\t\t}\n\n\t\tthis._onNavigationClick( icon );\n\t}\n\n\t//Overridden in each Wizard step.\n\t_onNavigationClick( icon ) {\n\t}\n\n\t//Overridden in each Wizard step that needs to determine if required buttons are clicked or not.\n\tisRequiredButtonsClicked() {\n\t\treturn true;\n\t}\n\n\taddButtonClick( e, icon ) {\n\t\t// $(e.target).addClass('clicked_wizard_icon');\n\t\t// $(e.target).find('img').addClass('disable-image');\n\t\tvar element = $( e.target );\n\t\tif ( !element.hasClass( 'wizard_icon_card' ) ) {\n\t\t\telement = $( e.target ).parents( '.wizard_icon_card' );\n\t\t}\n\t\telement.addClass( 'clicked_wizard_icon' );\n\t\telement.addClass( 'disable-image' );\n\n\t\tthis.clicked_buttons[icon] = true;\n\t}\n\n\tisButtonClicked( icon ) {\n\t\tif ( this.clicked_buttons.hasOwnProperty( icon ) && typeof this.clicked_buttons[icon] != 'undefined' ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\taddButton( context_name, icon_name, title, description, button_name ) {\n\t\tif ( typeof button_name == 'undefined' ) {\n\t\t\tbutton_name = context_name;\n\t\t}\n\n\t\tvar button = this.getRibbonButton( context_name, Global.getRibbonIconRealPath( icon_name ), title, description );\n\n\t\tvar $this = this;\n\t\tbutton.unbind( 'click' ).bind( 'click', function( e ) {\n\t\t\t$this.onNavigationClick( e, button_name );\n\t\t} );\n\t\t//ribbon_button_box.find('ul').append(button);\n\n\t\tif ( this.isButtonClicked( button_name ) ) {\n\t\t\tbutton.addClass( 'clicked_wizard_icon' );\n\t\t\tbutton.addClass( 'disable-image' );\n\t\t}\n\n\t\tthis.buttons[icon_name] = button;\n\t\tthis.appendButton( button );\n\n\t\treturn button;\n\t}\n\n\tsetGridGroupColumns( gridId ) {\n\n\t}\n\n\turlClick( action_id ) {\n\t\tthis.api.getMakePaymentData( this.getWizardObject().selected_remittance_agency_event_id, action_id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar url = result.getResult();\n\t\t\t\twindow.open( url );\n\t\t\t}\n\t\t} );\n\t}\n\n\tpaymentServicesClick( action_id ) {\n\t\tthis.api.getFileAndPayWithPaymentServicesData( this.getWizardObject().selected_remittance_agency_event_id, action_id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar retval = result.getResult();\n\n\t\t\t\tif ( retval['user_message'] && retval['user_message'] != '' ) {\n\t\t\t\t\tTAlertManager.showAlert( retval['user_message'] );\n\t\t\t\t} else {\n\t\t\t\t\tif ( retval == false ) {\n\t\t\t\t\t\tTAlertManager.showAlert( $.i18n._( 'ERROR! Something went wrong, please contact customer service immediately!' ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n}","import { WizardStep } from '@/global/widgets/wizard/WizardStep';\n\nexport class ProcessTransactionsWizardStepHome extends WizardStep {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tname: 'home',\n\n\t\t\tsource_accounts: [],\n\t\t\tpay_periods: [],\n\t\t\ttypes: [],\n\n\t\t\tfilter_data: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit() {\n\t\tvar $this = this;\n\t\tvar external_data = $this.getWizardObject().getExternalData();\n\t\tif ( external_data.transaction_source_data ) {\n\t\t\t$this.source_accounts = [];\n\t\t\t$this.normalizeSourceAccounts( external_data.transaction_source_data );\n\t\t\tdelete external_data.transaction_source_data;\n\t\t\t$this.render();\n\t\t\treturn;\n\t\t}\n\n\t\tvar api = TTAPI.APIPayStubTransaction;\n\t\tvar filter_data = {};\n\t\tif ( external_data ) {\n\t\t\tvar temp_filter_data = external_data.filter_data;\n\n\t\t\t// Ignore ugliness from report setup data ( We only want to send the filter forward )\n\t\t\tvar ignore_fields = ['chart', 'columns', 'sort', 'sort_', 'order', 'other', 'template', 'sub_total'];\n\t\t\tfor ( var n in temp_filter_data ) {\n\t\t\t\tif ( ignore_fields.indexOf( n ) == -1 ) {\n\t\t\t\t\tfilter_data[n] = temp_filter_data[n];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tapi.getPayPeriodTransactionSummary( filter_data, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar transactions = result.getResult();\n\t\t\t\t$this.normalizeSourceAccounts( transactions );\n\t\t\t\t$this.render();\n\t\t\t}\n\t\t} );\n\t}\n\n\tnormalizeSourceAccounts( data ) {\n\t\tthis.source_accounts = [];\n\n\t\tvar external_data = this.getWizardObject().getExternalData();\n\t\tif ( !external_data.filter_data.pay_period_id ) {\n\t\t\texternal_data.filter_data.pay_period_id = [];\n\t\t}\n\n\t\tfor ( var m in data ) {\n\t\t\tvar item = data[m];\n\t\t\tvar new_record = {\n\t\t\t\tid: item.remittance_source_account_id,\n\t\t\t\tname: item.remittance_source_account,\n\t\t\t\ttype: item.remittance_source_account_type,\n\t\t\t\tlast_transaction_number: item.remittance_source_account_last_transaction_number,\n\t\t\t\ttotal_amount: item.total_amount,\n\t\t\t\ttotal_transactions: item.total_transactions\n\t\t\t};\n\t\t\tthis.source_accounts.push( new_record );\n\n\t\t\tif ( item.pay_period_id && external_data.filter_data.pay_period_id.indexOf( item.pay_period_id ) == -1 && item.pay_period_id != TTUUID.zero_id ) {\n\t\t\t\texternal_data.filter_data.pay_period_id.push( item.pay_period_id );\n\t\t\t}\n\t\t}\n\t\tthis.getWizardObject().setExternalData( external_data );\n\t}\n\n\tinitCardsBlock() {\n\t\t$( this.wizard_obj.el ).find( '.download_warning' ).html( 'Click the <button class=\"done-btn\"></button> icon to download the transaction file. Be sure to save it to your computer rather than open it' );\n\t}\n\n\tgetNextStepName() {\n\t\t//This is a single-step wizard. Always return false;\n\t\treturn false;\n\t}\n\n\t_render() {\n\t\tthis.setTitle( this.getWizardObject().wizard_name );\n\n\t\t//If the wizard is closed, it reopens to the home step and must be told what the current step is.\n\t\tthis.getWizardObject().setCurrentStepName( 'home' );\n\n\t\tTTPromise.add( 'processTransactionsWizard', 'render' );\n\t\tvar $this = this;\n\t\tTTPromise.wait( 'processTransactionsWizard', 'render', function() {\n\t\t\t$( $this.el ).show();\n\t\t\t( $( '.process_transactions_wizard input' )[1] ).focus(); //Select first input field by default.\n\t\t} );\n\t\tthis.buildForm();\n\t}\n\n\tbuildForm() {\n\t\tif ( this.source_accounts.length > 0 ) {\n\t\t\tvar tab_index = 1050;\n\t\t\tvar instruction_text = $.i18n._( 'Select source accounts to processs transactions for' );\n\t\t\tvar $this = this;\n\t\t\tvar container = $( '<div></div>' );\n\t\t\tvar form = $( '<form id=\"process_transactions_wizard_select_accounts_form\"></form>' ).appendTo( container );\n\n\t\t\tvar table = $( '<table id=\"process_transactions_wizard_source_account_table\"></table>' );\n\t\t\tvar header_row = $( '<tr></tr>' );\n\t\t\theader_row.html( '<th colspan=\"7\">' + instruction_text + '<br><br></th>' );\n\t\t\tvar column_header_row = $( '<tr></tr>' );\n\t\t\tvar th_chk = $( '<th></th>' ).appendTo( column_header_row );\n\t\t\tvar th_name = $( '<th></th>' ).html( $.i18n._( 'Source Account' ) ).appendTo( column_header_row );\n\t\t\tvar th_format = $( '<th></th>' ).html( $.i18n._( 'Type' ) ).appendTo( column_header_row );\n\t\t\tvar th_last_check = $( '<th></th>' ).html( $.i18n._( 'Last #' ) ).appendTo( column_header_row );\n\t\t\tvar th_next_check = $( '<th></th>' ).html( $.i18n._( 'Next #' ) ).appendTo( column_header_row );\n\t\t\tvar th_amount = $( '<th></th>' ).html( $.i18n._( 'Amount' ) ).appendTo( column_header_row );\n\t\t\tvar th_transactions = $( '<th></th>' ).html( $.i18n._( 'Transactions' ) ).appendTo( column_header_row );\n\t\t\ttable.append( header_row );\n\t\t\ttable.append( column_header_row );\n\t\t\tfor ( var n in this.source_accounts ) {\n\t\t\t\tvar item = this.source_accounts[n];\n\t\t\t\tvar row = $( '<tr></tr>' );\n\t\t\t\tvar chk = $( '<input type=\"checkbox\" value=\"' + item.id + '\" tabIndex=\"' + tab_index + '\" checked></input>' );\n\t\t\t\ttab_index++;\n\n\t\t\t\tchk.on( 'change', function( e ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$this.onCheck();\n\t\t\t\t} );\n\n\t\t\t\tvar td_chk = $( '<td></td>' ).append( chk ).appendTo( row );\n\t\t\t\tvar td_name = $( '<td></td>' ).html( item.name ).appendTo( row );\n\t\t\t\tvar td_format = $( '<td></td>' ).html( $.i18n._( item.type ) ).appendTo( row );\n\t\t\t\tvar last_transaction_input = $( '<input value=\"' + item.last_transaction_number + '\" class=\"last_transaction_number\" type=\"text\" style=\"width:50px\" tabIndex=\"' + tab_index + '\">' );\n\t\t\t\ttab_index++;\n\n\t\t\t\tlast_transaction_input.on( 'keydown', function( e ) {\n\t\t\t\t\t$this.onCheckNoKeyDown( e );\n\t\t\t\t} );\n\n\t\t\t\tlast_transaction_input.on( 'keyup', function( e ) {\n\t\t\t\t\tvar result_element = $( e.target ).parents( 'tr' ).find( '.next_transaction_number' );\n\t\t\t\t\tresult_element.val( parseInt( $( e.target ).val() ) + 1 );\n\t\t\t\t} );\n\n\t\t\t\tvar next_transaction_input = $( '<input value=\"' + ( parseInt( item.last_transaction_number ) + 1 ) + '\" class=\"next_transaction_number\" type=\"text\" style=\"width:50px\" tabIndex=\"' + tab_index + '\">' );\n\t\t\t\ttab_index++;\n\n\t\t\t\tnext_transaction_input.on( 'keydown', function( e ) {\n\t\t\t\t\t$this.onCheckNoKeyDown( e );\n\t\t\t\t} );\n\n\t\t\t\tnext_transaction_input.on( 'keyup', function( e ) {\n\t\t\t\t\tvar result_element = $( e.target ).parents( 'tr' ).find( '.last_transaction_number' );\n\t\t\t\t\tresult_element.val( parseInt( $( e.target ).val() ) - 1 );\n\t\t\t\t} );\n\n\t\t\t\tvar td_last_check = $( '<td></td>' ).append( last_transaction_input ).appendTo( row );\n\t\t\t\tvar td_last_check = $( '<td></td>' ).append( next_transaction_input ).appendTo( row );\n\t\t\t\tvar td_last_check = $( '<td></td>' ).html( item.total_amount ).appendTo( row );\n\t\t\t\tvar td_last_check = $( '<td></td>' ).html( item.total_transactions ).appendTo( row );\n\n\t\t\t\trow.appendTo( table );\n\t\t\t}\n\n\t\t\tform.append( table );\n\t\t\t$( this.getWizardObject().el ).find( '.content' ).html( container );\n\t\t\t$( this.getWizardObject().el ).find( '.done-btn' ).removeClass( 'disable-image' );\n\t\t\t//reset preload data\n\t\t\tthis.source_accounts = null;\n\t\t\tthis.filter = null;\n\t\t} else {\n\t\t\t$( this.getWizardObject().el ).find( '.content' ).html( 'No transactions to process.' );\n\t\t\t$( this.getWizardObject().el ).find( '.done-btn' ).addClass( 'disable-image' );\n\t\t}\n\n\t\tthis.onCheck(); //ensure that the done button is enabled by default\n\t\tTTPromise.resolve( 'processTransactionsWizard', 'render' );\n\t}\n\n\tonCheckNoKeyDown( e ) {\n\t\t//only allow digits, delete, backspace and arrows\n\t\tif ( isNaN( e.key ) && [9, 8, 46, 37, 39].indexOf( e.keyCode ) == -1 ) {\n\t\t\te.preventDefault();\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tonCheck() {\n\t\tvar checkboxes = $( this.getWizardObject().el ).find( '.content input[type=\"checkbox\"]' ).filter( ':checked' );\n\t\tif ( checkboxes.length > 0 ) {\n\t\t\tvar data = [];\n\t\t\tcheckboxes.each( function() {\n\t\t\t\tdata.push( $( this ).val() );\n\t\t\t} );\n\t\t\tthis.getWizardObject().setTransactionIds( data );\n\n\t\t\t$( this.getWizardObject().el ).find( '.done-btn' ).removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tthis.getWizardObject().setTransactionIds( [] );\n\t\t\t$( this.getWizardObject().el ).find( '.done-btn' ).addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetFilterData( data ) {\n\t\tthis.filter_data = data;\n\t\tTTPromise.resolve( 'ProcessTransactionsWizardStepHome', 'init_filter' );\n\t}\n\n\tgetFilterData() {\n\t\treturn this.filter_data;\n\t}\n\n}"],"sourceRoot":""}