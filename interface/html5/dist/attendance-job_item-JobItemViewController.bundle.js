(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["attendance-job_item-JobItemViewController"],{878:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"JobItemViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#job_item_view_container",status_array:null,job_item_group_array:null,job_item_group_api:null,sub_document_view_controller:null,document_object_type_id:null,date_api:null}),super(e)}init(e){this.edit_view_tpl="JobItemEditView.html",this.permission_id="job_item",this.viewId="JobItem",this.script_name="JobItemView",this.table_name_key="job_item",this.context_menu_name=$.i18n._("Tasks"),this.navigation_label=$.i18n._("Tasks")+":",this.document_object_type_id=70,this.api=TTAPI.APIJobItem,this.date_api=TTAPI.APITTDate,this.job_item_group_api=TTAPI.APIJobItemGroup,this.render(),this.buildContextMenu(),this.initData(),this.setSelectRibbonMenuIfNecessary("JobItem")}initOptions(){var e=this;this.initDropDownOption("status"),this.job_item_group_api.getJobItemGroup("",!1,!1,{onResult:function(t){t=t.getResult(),t=Global.buildTreeRecord(t),!e.sub_view_mode&&e.basic_search_field_ui_dic.group_id&&(e.basic_search_field_ui_dic.group_id.setSourceData(t),e.adv_search_field_ui_dic.group_id.setSourceData(t)),e.job_item_group_array=t}})}getCustomContextMenuModel(){return{exclude:[],include:[{label:$.i18n._("Import"),id:ContextMenuIconName.import_icon,group:"other",icon:Icons.import_icon,permission_result:PermissionManager.checkTopLevelPermission("ImportCSVJobItem"),permission:null,sort_order:8e3}]}}onCustomContextClick(e){switch(e){case ContextMenuIconName.import_icon:this.onImportClick()}}onImportClick(){var e=this;IndexViewController.openWizard("ImportCSVWizard","JobItem",(function(){e.search()}))}buildEditViewUI(){super.buildEditViewUI();var e,t={"tab_task":{"label":$.i18n._("Task")},"tab_attachment":!0,"tab_audit":!0};this.setTabModel(t),this.navigation.AComboBox({api_class:TTAPI.APIJobItem,id:this.script_name+"_navigation",allow_multiple_selection:!1,layout_name:"global_job_item",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation();var i=this.edit_view_tab.find("#tab_task"),a=i.find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(a),(e=Global.loadWidgetByName(FormItemType.COMBO_BOX)).TComboBox({field:"status_id"}),e.setSourceData(this.status_array),this.addEditFieldToColumn($.i18n._("Status"),e,a,""),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"name",width:"100%"}),this.addEditFieldToColumn($.i18n._("Name"),e,a),e.parent().width("45%"),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"description",width:"100%"}),this.addEditFieldToColumn($.i18n._("Description"),e,a),e.parent().width("45%"),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"manual_id",width:65}),this.addEditFieldToColumn($.i18n._("Code"),e,a),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({tree_mode:!0,allow_multiple_selection:!1,layout_name:"global_tree_column",set_empty:!0,field:"group_id"}),e.setSourceData(this.job_item_group_array),this.addEditFieldToColumn($.i18n._("Group"),e,a),(e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIProduct,allow_multiple_selection:!1,layout_name:"global_product",show_search_inputs:!0,set_empty:!0,field:"product_id"}),this.addEditFieldToColumn($.i18n._("Product"),e,a),Global.getProductEdition()>=20&&((e=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIGEOFence,allow_multiple_selection:!0,layout_name:"global_geo_fence",show_search_inputs:!0,set_empty:!0,field:"geo_fence_ids"}),this.addEditFieldToColumn($.i18n._("Allowed GEO Fences"),e,a)),(e=Global.loadWidgetByName(FormItemType.TAG_INPUT)).TTagInput({field:"tag",object_type_id:610}),this.addEditFieldToColumn($.i18n._("Tags"),e,a,"",null,null,!0);var o=i.find(".second-column");this.edit_view_tabs[0].push(o),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"estimate_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn($.i18n._("Estimated Time"),e,o,"",null,!0,!0),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"estimate_quantity",width:150}),this.addEditFieldToColumn($.i18n._("Estimated Quantity"),e,o),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"estimate_bad_quantity",width:150}),this.addEditFieldToColumn($.i18n._("Estimated Bad Quantity"),e,o),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"bad_quantity_rate",width:150}),this.addEditFieldToColumn($.i18n._("Bad Quantity Billable Rate"),e,o),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"billable_rate",width:86}),this.addEditFieldToColumn($.i18n._("Billable Rate"),e,o),(e=Global.loadWidgetByName(FormItemType.TEXT_INPUT)).TTextInput({field:"minimum_time",mode:"time_unit",need_parser_sec:!0}),this.addEditFieldToColumn($.i18n._("Minimum Billable Time"),e,o,"",null)}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,adv_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Code"),in_column:1,field:"manual_id",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Name"),in_column:2,field:"name",multiple:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Description"),in_column:1,field:"description",multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.TEXT_INPUT}),new SearchField({label:$.i18n._("Tags"),field:"tag",basic_search:!0,adv_search:!0,in_column:1,object_type_id:610,form_item_type:FormItemType.TAG_INPUT}),new SearchField({label:$.i18n._("Group"),in_column:2,multiple:!0,field:"group_id",layout_name:"global_tree_column",tree_mode:!0,basic_search:!0,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Product"),in_column:2,field:"product_id",layout_name:"global_product",api_class:TTAPI.APIProduct,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!1,adv_search:!0,form_item_type:FormItemType.AWESOME_BOX})]}setCurrentEditRecordData(){for(var e in this.current_edit_record){var t=this.edit_view_ui_dic[e];Global.isSet(t)&&t.setValue(this.current_edit_record[e])}this.collectUIDataToCurrentEditRecord(),this.setEditViewDataDone()}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),a=e.getValue();this.current_edit_record[i]=a,t||this.validate()}}}}]);
//# sourceMappingURL=attendance-job_item-JobItemViewController.bundle.js.map?v=4b66a2b9e4e4f5f1f464