(self.webpackChunktimetrex=self.webpackChunktimetrex||[]).push([["payroll-pay_periods-PayPeriodsViewController"],{505:(e,t,i)=>{"use strict";i.r(t),i.d(t,{"PayPeriodsViewController":()=>a});class a extends BaseViewController{constructor(e={}){_.defaults(e,{el:"#pay_periods_view_container",status_array:null,type_array:null,pay_period_schedule_api:null}),super(e)}init(e){this.edit_view_tpl="PayPeriodsEditView.html",this.permission_id="pay_period_schedule",this.script_name="PayPeriodsView",this.viewId="PayPeriods",this.table_name_key="pay_period",this.context_menu_name=$.i18n._("Pay Period"),this.navigation_label=$.i18n._("Pay Period")+":",this.api=TTAPI.APIPayPeriod,this.pay_period_schedule_api=TTAPI.APIPayPeriodSchedule,this.render(),this.sub_view_mode?this.buildContextMenu(!0):this.buildContextMenu(),this.sub_view_mode||this.initData(),this.setSelectRibbonMenuIfNecessary(),IndexViewController.setNotificationBar("pay_period")}removeEditView(e){super.removeEditView(),!this.parent_view_controller||"TimeSheet"!==this.parent_view_controller.viewId&&"PayStub"!==this.parent_view_controller.viewId||this.parent_view_controller.onSubViewRemoved(e)}initOptions(e){var t=[{option_name:"status",field_name:null,api:null},{option_name:"type",field_name:"type_id",api:this.pay_period_schedule_api}];this.initDropDownOptions(t,(function(t){e&&e(t)}))}getCustomContextMenuModel(){var e={exclude:[ContextMenuIconName.copy],include:[{label:$.i18n._("Delete<br>Data"),id:ContextMenuIconName.delete_data,group:"other",icon:Icons.delete_icon},{label:$.i18n._("Import<br>Data"),id:ContextMenuIconName.import_icon,group:"other",icon:Icons.import_icon,sort_order:8e3}]};return this.edit_only_mode&&e.exclude.push(ContextMenuIconName.import_icon,ContextMenuIconName.delete_data),e}openEditView(e){var t=this;t.edit_only_mode?t.initOptions((function(i){t.edit_view||t.initEditViewUI(t.viewId,t.edit_view_tpl),t.getPayPeriodData(e,(function(e){t.current_edit_record=e,t.initEditView()}))})):this.edit_view||this.initEditViewUI(t.viewId,t.edit_view_tpl)}setDefaultMenu(e){if(this.context_menu_array){Global.isSet(e)&&e||this.selectContextMenu(),this.setTotalDisplaySpan();for(var t=this.context_menu_array.length,i=this.getGridSelectIdArray().length,a=0;a<t;a++){var n=$(this.context_menu_array[a]),s=$(n.find(".ribbon-sub-menu-icon")).attr("id");switch(n.removeClass("invisible-image"),n.removeClass("disable-image"),s){case ContextMenuIconName.add:this.setDefaultMenuAddIcon(n,i);break;case ContextMenuIconName.edit:this.setDefaultMenuEditIcon(n,i);break;case ContextMenuIconName.view:this.setDefaultMenuViewIcon(n,i);break;case ContextMenuIconName.mass_edit:this.setDefaultMenuMassEditIcon(n,i);break;case ContextMenuIconName.delete_icon:this.setDefaultMenuDeleteIcon(n,i);break;case ContextMenuIconName.delete_and_next:this.setDefaultMenuDeleteAndNextIcon(n,i);break;case ContextMenuIconName.save:this.setDefaultMenuSaveIcon(n,i);break;case ContextMenuIconName.save_and_next:this.setDefaultMenuSaveAndNextIcon(n,i);break;case ContextMenuIconName.save_and_continue:this.setDefaultMenuSaveAndContinueIcon(n,i);break;case ContextMenuIconName.save_and_new:this.setDefaultMenuSaveAndAddIcon(n,i);break;case ContextMenuIconName.save_and_copy:this.setDefaultMenuSaveAndCopyIcon(n,i);break;case ContextMenuIconName.copy_as_new:this.setDefaultMenuCopyAsNewIcon(n,i);break;case ContextMenuIconName.login:this.setDefaultMenuLoginIcon(n,i);break;case ContextMenuIconName.cancel:this.setDefaultMenuCancelIcon(n,i);break;case ContextMenuIconName.import_icon:this.setDefaultMenuImportIcon(n,i);break;case ContextMenuIconName.delete_data:this.setDefaultMenuDeleteDataIcon(n,i);break;case ContextMenuIconName.export_excel:this.setDefaultMenuExportIcon(n,i)}}this.setContextMenuGroupVisibility()}}setDefaultMenuImportIcon(e,t){this.importValidate()||e.addClass("invisible-image"),t>=1?e.removeClass("disable-image"):e.addClass("disable-image")}importValidate(e){var t=this.permission_id;return Global.isSet(e)||(e=this.getSelectedItem()),"report"===t||!(!this.editPermissionValidate(t,e)&&!this.addPermissionValidate(t,e))}setDefaultMenuDeleteDataIcon(e,t){this.importValidate()||e.addClass("invisible-image"),t>=1?e.removeClass("disable-image"):e.addClass("disable-image")}setEditMenu(){this.selectContextMenu();for(var e=this.context_menu_array.length,t=0;t<e;t++){var i=$(this.context_menu_array[t]),a=$(i.find(".ribbon-sub-menu-icon")).attr("id");if(i.removeClass("disable-image"),this.is_mass_editing)switch(a){case ContextMenuIconName.save:this.setEditMenuSaveIcon(i);break;case ContextMenuIconName.cancel:break;default:i.addClass("disable-image")}else switch(a){case ContextMenuIconName.add:this.setEditMenuAddIcon(i);break;case ContextMenuIconName.edit:this.setEditMenuEditIcon(i);break;case ContextMenuIconName.view:this.setEditMenuViewIcon(i);break;case ContextMenuIconName.mass_edit:this.setEditMenuMassEditIcon(i);break;case ContextMenuIconName.delete_icon:this.setEditMenuDeleteIcon(i);break;case ContextMenuIconName.delete_and_next:this.setEditMenuDeleteAndNextIcon(i);break;case ContextMenuIconName.save:this.setEditMenuSaveIcon(i);break;case ContextMenuIconName.save_and_continue:this.setEditMenuSaveAndContinueIcon(i);break;case ContextMenuIconName.save_and_new:this.setEditMenuSaveAndAddIcon(i);break;case ContextMenuIconName.save_and_next:this.setEditMenuSaveAndNextIcon(i);break;case ContextMenuIconName.save_and_copy:this.setEditMenuSaveAndCopyIcon(i);break;case ContextMenuIconName.copy_as_new:this.setEditMenuCopyAndAddIcon(i);break;case ContextMenuIconName.cancel:break;case ContextMenuIconName.import_icon:case ContextMenuIconName.delete_data:this.setEditMenuImportIcon(i);break;case ContextMenuIconName.export_excel:this.setDefaultMenuExportIcon(i)}}this.setContextMenuGroupVisibility()}setEditMenuImportIcon(e,t){this.importValidate()||e.addClass("invisible-image"),e.addClass("disable-image")}onCustomContextClick(e){var t,i=this,a=[];if(i.edit_view&&i.current_edit_record.id?a.push(i.current_edit_record.id):(t=this.getGridSelectIdArray(),$.each(t,(function(e,t){var n=i.getRecordFromGridById(t);a.push(n.id)}))),a.length>0)switch(e){case ContextMenuIconName.import_icon:TAlertManager.showConfirmAlert($.i18n._("This will import employee attendance data from other pay periods into this pay period.Are you sure you wish to continue?"),null,(function(e){e?(ProgressBar.showOverlay(),i.api.importData(a,{onResult:function(e){ProgressBar.closeOverlay(),e.isValid()?i.search(!1):TAlertManager.showErrorAlert(e)}})):ProgressBar.closeOverlay()}));break;case ContextMenuIconName.delete_data:TAlertManager.showConfirmAlert($.i18n._("This will delete all attendance data assigned to this pay period. Are you sure you wish to continue?"),null,(function(e){e?(ProgressBar.showOverlay(),i.api.deleteData(a,{onResult:function(e){ProgressBar.closeOverlay(),e.isValid()?i.search(!1):TAlertManager.showErrorAlert(e)}})):ProgressBar.closeOverlay()}));break;case ContextMenuIconName.export_excel:this.onExportClick("export"+this.api.key_name)}}getPayPeriodData(e,t){var i={filter_data:{}};i.filter_data.id=[e],this.api["get"+this.api.key_name](i,{onResult:function(e){var i=e.getResult();i||(i=[]),i=i[0],t(i)}})}buildSearchFields(){super.buildSearchFields(),this.search_fields=[new SearchField({label:$.i18n._("Pay Period Schedule"),in_column:1,field:"pay_period_schedule_id",layout_name:"global_pay_period_schedule",api_class:TTAPI.APIPayPeriodSchedule,multiple:!0,basic_search:!0,script_name:"PayPeriodScheduleView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Status"),in_column:1,field:"status_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("type"),in_column:1,field:"type_id",multiple:!0,basic_search:!0,layout_name:"global_option_column",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Created By"),in_column:2,field:"created_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX}),new SearchField({label:$.i18n._("Updated By"),in_column:2,field:"updated_by",layout_name:"global_user",api_class:TTAPI.APIUser,multiple:!0,basic_search:!0,script_name:"EmployeeView",form_item_type:FormItemType.AWESOME_BOX})]}buildEditViewUI(){super.buildEditViewUI();var e={"tab_pay_period":{"label":$.i18n._("Pay Period")},"tab_audit":!0};this.setTabModel(e),this.edit_only_mode||(this.navigation.AComboBox({id:this.script_name+"_navigation",api_class:TTAPI.APIPayPeriod,allow_multiple_selection:!1,layout_name:"global_Pay_period",navigation_mode:!0,show_search_inputs:!0}),this.setNavigation());var t=this.edit_view_tab.find("#tab_pay_period").find(".first-column");this.edit_view_tabs[0]=[],this.edit_view_tabs[0].push(t);var i=Global.loadWidgetByName(FormItemType.COMBO_BOX);i.TComboBox({field:"status_id",set_empty:!1}),i.setSourceData(this.status_array),this.addEditFieldToColumn($.i18n._("Status"),i,t,""),(i=Global.loadWidgetByName(FormItemType.TEXT)).TText({field:"pay_period_schedule"}),this.addEditFieldToColumn($.i18n._("Pay Period Schedule"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.AWESOME_BOX)).AComboBox({api_class:TTAPI.APIPayPeriodSchedule,allow_multiple_selection:!1,layout_name:"global_pay_period_schedule",show_search_inputs:!0,set_empty:!0,field:"pay_period_schedule_id"}),this.addEditFieldToColumn($.i18n._("Pay Period Schedule"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"start_date",mode:"date_time"}),this.addEditFieldToColumn($.i18n._("Start Date"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"end_date",mode:"date_time"}),this.addEditFieldToColumn($.i18n._("End Date"),i,t,"",null,!0),(i=Global.loadWidgetByName(FormItemType.DATE_PICKER)).TDatePicker({field:"transaction_date",mode:"date_time"}),this.addEditFieldToColumn($.i18n._("Transaction Date"),i,t,"",null,!0)}onFormItemChange(e,t){this.setIsChanged(e),this.setMassEditingFieldsWhenFormChange(e);var i=e.getField(),a=e.getValue();this.current_edit_record||(this.current_edit_record={}),this.current_edit_record[i]=a,"status_id"===i&&this.onStatusChange(),t||this.validate()}setDateColumnStatus(e,t){this.edit_view_ui_dic[e]&&(t?(this.edit_view_ui_dic[e].find("input").attr("disabled","disabled"),this.edit_view_ui_dic[e].find("img").unbind("click")):(this.edit_view_ui_dic[e].find("input").removeAttr("disabled"),this.edit_view_ui_dic[e].find("img").bind("click")))}onStatusChange(){this.current_edit_record&&20==this.current_edit_record.status_id?(this.setDateColumnStatus("start_date",!0),this.setDateColumnStatus("end_date",!0),this.setDateColumnStatus("transaction_date",!0)):(this.setDateColumnStatus("start_date",!1),this.setDateColumnStatus("end_date",!1),this.setDateColumnStatus("transaction_date",!1))}isEditChange(){this.current_edit_record&&this.current_edit_record.id?(this.attachElement("pay_period_schedule"),this.detachElement("pay_period_schedule_id")):this.is_mass_editing?(this.detachElement("pay_period_schedule"),this.detachElement("pay_period_schedule_id")):(this.detachElement("pay_period_schedule"),this.attachElement("pay_period_schedule_id")),this.editFieldResize()}setEditViewDataDone(){super.setEditViewDataDone(),this.onStatusChange(),this.isEditChange()}}a.loadSubView=function(e,t,i){Global.loadViewSource("PayPeriods","SubPayPeriodsView.html",(function(a){var n=_.template(a);Global.isSet(t)&&t(),Global.isSet(e)&&(e.html(n({})),Global.isSet(i)&&TTPromise.wait("BaseViewController","initialize",(function(){i(sub_pay_periods_view_controller)})))}))}}}]);
//# sourceMappingURL=payroll-pay_periods-PayPeriodsViewController.bundle.js.map?v=369642224ae1c6b1ca52