{"version":3,"sources":["webpack://timetrex/./interface/html5/views/invoice/area_policy/AreaPolicyViewController.js"],"names":["AreaPolicyViewController","BaseViewController","options","_","defaults","el","status_array","country_array","district_array","province_array","company_api","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIAreaPolicy","APICompany","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","target","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","key","getField","c_value","getValue","toString","current_edit_record","widget","edit_view_ui_dic","widget2","setValue","province","district","p","eSetProvince","setDistrict","c","validate","initDropDownOption","$this","district_widget","Global","isSet","getDistrictOptions","onResult","res","getResult","buildRecordArray","setSourceData","val","refresh","province_widget","getProvinceOptions","e_province_array","hasOwnProperty","setCountryValue","collectUIDataToCurrentEditRecord","setEditViewDataDone","buildEditViewUI","tab_model","setTabModel","navigation","AComboBox","api_class","id","allow_multiple_selection","layout_name","navigation_mode","show_search_inputs","setNavigation","tab_area_column1","edit_view_tab","find","edit_view_tabs","push","form_item_input","loadWidgetByName","FormItemType","TEXT_INPUT","TTextInput","field","width","addEditFieldToColumn","parent","AWESOME_BOX","set_empty","buildSearchFields","search_fields","SearchField","label","in_column","multiple","basic_search","form_item_type","APIUser","adv_search"],"mappings":"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","file":"invoice-area_policy-AreaPolicyViewController.bundle.js?v=3258f2fd7f8610ddc8a7","sourcesContent":["export class AreaPolicyViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#area_policy_view_container',\n\n\t\t\tstatus_array: null,\n\n\t\t\tcountry_array: null,\n\t\t\tdistrict_array: null,\n\t\t\tprovince_array: null,\n\n\t\t\tcompany_api: null\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'AreaPolicyEditView.html';\n\t\tthis.permission_id = 'area_policy';\n\t\tthis.viewId = 'AreaPolicy';\n\t\tthis.script_name = 'AreaPolicyView';\n\t\tthis.table_name_key = 'area_policy';\n\t\tthis.context_menu_name = $.i18n._( 'Area Policy' );\n\t\tthis.navigation_label = $.i18n._( 'Area' ) + ':';\n\t\tthis.api = TTAPI.APIAreaPolicy;\n\t\tthis.company_api = TTAPI.APICompany;\n\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary();\n\t}\n\n\t//Don't call super if override this function.\n\tonFormItemChange( target, doNotValidate ) {\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tswitch ( key ) {\n\t\t\tcase 'country':\n\t\t\t\tif ( c_value.toString() === this.current_edit_record[key].toString() ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar widget = this.edit_view_ui_dic['province'];\n\t\t\t\tvar widget2 = this.edit_view_ui_dic['district'];\n\t\t\t\twidget.setValue( null );\n\t\t\t\twidget2.setValue( null );\n\t\t\t\tthis.current_edit_record.province = false;\n\t\t\t\tthis.current_edit_record.district = false;\n\t\t\t\tvar p = this.edit_view_ui_dic['province'].getValue();\n\t\t\t\tthis.eSetProvince( c_value );\n\t\t\t\tthis.setDistrict( c_value, p );\n\t\t\t\tbreak;\n\t\t\tcase 'province':\n\n\t\t\t\tif ( c_value.toString() === this.current_edit_record[key].toString() ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\twidget = this.edit_view_ui_dic['district'];\n\t\t\t\twidget.setValue( null );\n\t\t\t\tvar c = this.edit_view_ui_dic['country'].getValue();\n\t\t\t\tthis.setDistrict( c, c_value );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.current_edit_record[key] = c_value;\n\n\t\tif ( key === 'country' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.validate();\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'country', null, this.company_api );\n\t}\n\n\tsetDistrict( c, p ) {\n\t\tvar $this = this;\n\t\tvar district_widget = $this.edit_view_ui_dic['district'];\n\n\t\tif ( !Global.isSet( c ) || c === '-1' || c === '0' || !Global.isSet( p ) || p === '-1' || p === '0' ) {\n\t\t\t$this.district_array = [];\n\t\t\tdistrict_widget.setSourceData( [] );\n\t\t} else {\n\n\t\t\tthis.api.getDistrictOptions( c, p, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\t$this.district_array = Global.buildRecordArray( res );\n\t\t\t\t\tdistrict_widget.setSourceData( $this.district_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.api.getProvinceOptions( val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.province_array = Global.buildRecordArray( res );\n\t\t\t\t\tprovince_widget.setSourceData( $this.province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\n\t\t\tif ( !this.current_edit_record.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t//Make sure reset data source everytime.\n\t\t\tthis.edit_view_ui_dic['province'].setSourceData( null );\n\t\t\tthis.edit_view_ui_dic['district'].setSourceData( null );\n\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'country': //popular case\n\t\t\t\t\t\tthis.setCountryValue( widget, key );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'province': //popular case\n\t\t\t\t\t\tthis.setDistrict( this.current_edit_record['country'], this.current_edit_record[key] );\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '': //popular case\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tbuildEditViewUI() {\n\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_area': { 'label': $.i18n._( 'Area' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIAreaPolicy,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_area_policy',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_area = this.edit_view_tab.find( '#tab_area' );\n\n\t\tvar tab_area_column1 = tab_area.find( '.first-column' );\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_area_column1 );\n\n\t\t// Name\n\n\t\tvar form_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\n\t\tform_item_input.TTextInput( { field: 'name', width: '100%' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Name' ), form_item_input, tab_area_column1, '' );\n\t\tform_item_input.parent().width( '45%' );\n\n\t\t// Country\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'country',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\n\t\tform_item_input.setSourceData( this.country_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Country' ), form_item_input, tab_area_column1, '' );\n\n\t\t// Province\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'province',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Province' ), form_item_input, tab_area_column1, '' );\n\n\t\t// Province\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input = form_item_input.AComboBox( {\n\t\t\tfield: 'district',\n\t\t\tset_empty: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tlayout_name: 'global_option_column',\n\t\t\tkey: 'value'\n\t\t} );\n\n\t\tthis.addEditFieldToColumn( $.i18n._( 'District' ), form_item_input, tab_area_column1, '' );\n\t}\n\n\tbuildSearchFields() {\n\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Name' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'name',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: false,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n}"],"sourceRoot":""}