{"version":3,"sources":["webpack://timetrex/./interface/html5/views/payroll/pay_stub/PayStubViewController.js"],"names":["PayStubViewController","BaseViewController","options","_","defaults","el","filtered_status_array","user_status_array","user_group_array","user_destination_account_array","currency_array","type_array","country_array","province_array","e_province_array","user_api","user_group_api","company_api","pay_stub_entry_api","include_pay_stub_accounts","transaction_status_array","net_pay_amount","pseal_link","original_status_id","super","this","edit_view_tpl","permission_id","viewId","script_name","table_name_key","context_menu_name","$","i18n","navigation_label","api","TTAPI","APIPayStub","APIUser","APIPayStubEntry","pay_stub_entry_account_link_api","APIPayStubEntryAccountLink","APIUserGroup","APICompany","pay_period_api","APIPayPeriod","pay_stub_transaction_api","APIPayStubTransaction","remittance_destination_account_api","APIRemittanceDestinationAccount","$this","when","preloadTransactionOptions","Deferred","preloadPayStubAccountLinks","done","completeInit","is_add","is_edit","dfd","getOptions","onResult","result","getResult","resolve","promise","getPayStubEntryAccountLink","data","total_gross_entry_account_id","total_deductions_entry_account_id","net_pay_entry_account_id","contributions_entry_account_id","total_gross","total_employee_deduction","total_net_pay","total_employer_deduction","initPermission","render","buildContextMenu","initData","setSelectRibbonMenuIfNecessary","PermissionManager","validate","show_search_tab","initDropDownOption","i","basic_search_field_ui_dic","setSourceData","Global","buildRecordArray","adv_search_field_ui_dic","getUserGroup","res","buildTreeRecord","sub_view_mode","groups","pay_stubs","label","id","exclude","ContextMenuIconName","copy","save_and_new","save_and_copy","include","timesheet","group","icon","Icons","schedule","pay_stub_amendment","pay_stub_transaction","items","permission_result","permission","sort_order","edit_employee","employee","edit_pay_period","pay_period","employee_pay_stubs","employer_pay_stubs","generate_pay_stub","process_payroll","direct_deposit","doNotSetFocus","context_menu_array","isSet","selectContextMenu","setTotalDisplaySpan","len","length","grid_selected_length","getGridSelectIdArray","context_btn","find","attr","removeClass","add","setDefaultMenuAddIcon","view","setDefaultMenuViewIcon","edit","setDefaultMenuEditIcon","mass_edit","setDefaultMenuMassEditIcon","delete_icon","setDefaultMenuDeleteIcon","delete_and_next","setDefaultMenuDeleteAndNextIcon","save","setDefaultMenuSaveIcon","copy_as_new","setDefaultMenuCopyAsNewIcon","save_and_next","setDefaultMenuSaveAndNextIcon","save_and_continue","setDefaultMenuSaveAndContinueIcon","cancel","setDefaultMenuCancelIcon","setDefaultMenuEditEmployeeIcon","setDefaultMenuEditPayPeriodIcon","print_checks","setDefaultMenuReportRelatedIcons","setDefaultMenuGeneratePayStubIcon","export_excel","setDefaultMenuExportIcon","setContextMenuGroupVisibility","pId","editPermissionValidate","addClass","editChildPermissionValidate","viewPermissionValidate","edit_only_mode","viewOwnerOrChildPermissionValidate","is_mass_editing","setEditMenuSaveIcon","setEditMenuAddIcon","setEditMenuEditIcon","setEditMenuMassEditIcon","setEditMenuCopyIcon","setEditMenuDeleteIcon","setEditMenuDeleteAndNextIcon","setEditMenuSaveAndContinueIcon","setEditMenuSaveAndAddIcon","setEditMenuSaveAndNextIcon","setEditMenuSaveAndCopyIcon","setEditMenuCopyAndAddIcon","import_icon","setEditMenuImportIcon","setEditMenuViewIcon","setEditMenuGeneratePayStubIcon","current_edit_record","selected_item","getSelectedItem","ownerOrChildPermissionValidate","payStubReportIconsValidate","checkTopLevelPermission","cover","remove","key","widget","edit_view_ui_dic","setCountryValue","setValue","collectUIDataToCurrentEditRecord","setEditViewDataDone","user_id","setEnabled","initInsideEntryEditorData","callback","index","key_name","result_data","push","args","filter_data","pay_stub_id","TTUUID","isUUID","copied_record_id","edit_view","size","getPayStubTransaction","isEditMode","editor","insideTransactionEditorSetValue","getPayStubTransactionDefaultData","handlePayStubEntryData","total_rows","retval","n","type_id","pay_stub_entry_account_id","newrow","total_row","type_ids","t","gross_total","name","employee_deduction_total","net_pay_total","employer_deduction_total","val","removeAllRows","removeCover","parent_controller","checkForNonHeaderData","getRender","headerRow","loadWidget","col1","col2","col3","col4","col5","col6","template","append","rows_widgets_array","row","addRow","setEarnings","setDeductions","setMiscellaneous","setEmployerContributions","setAccrual","$parent_controller","TTPromise","wait","initInsideTransactionEditorData","calcTotal","renderColumns","type","right_label","widgets","widgetContainer","pay_stub_amendment_id","user_expense_id","pay_stub_status_id","zero_id","row_enabled","form_item_name_input","loadWidgetByName","FormItemType","AWESOME_BOX","AComboBox","api_class","APIPayStubEntryAccount","width","is_static_width","allow_multiple_selection","layout_name","show_search_inputs","set_empty","field","pay_stub_entry_name_id","unbind","bind","e","target","onFormItemChange","form_item_name_text","TEXT","TText","form_item_note_input","TEXT_INPUT","TTextInput","display_na","description","form_item_note_text","form_item_rate_input","hasKeyEvent","removeTrailingZeros","rate","onFormItemKeyUp","onFormItemKeyDown","form_item_rate_text","form_item_units_input","units","form_item_units_text","form_item_amount_input","amount","form_item_amount_text","form_item_ytd_amount_text","ytd_amount","parseFloat","text","setReadOnly","css","getField","children","eq","setDefaultArgs","toString","last","hide","insertAfter","splice","addIconsEvent","empty","rowIndex","remove_id","delete_ids","record","callbackFunction","entries","saveInsideEntryEditorData","transactions","saveInsideTransactionEditorData","ignoreWarning","onSaveClick","savePayStub","doSaveAPICall","callBack","insideTransactionEditorGetValue","delete_transaction_ids","deleted","setCurrentEditViewState","LocalCacheData","current_doing_context_action","status_id","show_cover","setEditMenu","setTabStatus","is_changed","ProgressBar","closeOverlay","selectedId","filter","grid_selected_id_array","onCopyAsNewResult","TAlertManager","showAlert","initEditView","search","setDefaultMenu","onCancelClick","openEditView","parent_key","parent_value","uniformVariable","onSaveAndContinueResult","is_viewing","mass_edit_record_ids","each","value","unique_columns","result1","linked_columns","isValid","refresh_id","not_exist_id","onEditClick","onSaveAndContinueDone","setErrorTips","setErrorMenu","getValue","current_edit_item_id","isArray","undefined","column_filter","display_columns","grid","getGridParam","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","c_value","transaction_rows","remittance_destination_account_id","start_date","strToDate","format","end_date","transaction_date","search_panel","getSelectTabIndex","select_value","setProvince","change","proxy","selectVal","m","refresh","province_widget","province","hasOwnProperty","isChecked","getEnabled","validateResult","buildEditViewUI","tab_model","setTabModel","navigation","navigation_mode","setNavigation","form_item_input","tab_pay_stub","edit_view_tab","tab_pay_stub_column1","tab_pay_stub_column2","edit_view_tabs","addEditFieldToColumn","COMBO_BOX","TComboBox","APICurrency","DATE_PICKER","TDatePicker","inside_pay_stub_entry_editor_div","INSIDE_EDITOR","InsideEditor","insideEntryEditorAddRow","removeRow","insideEntryEditorRemoveRow","insideEntryEditorGetValue","insideEntryEditorSetValue","render_args","row_render","removeEntryInsideEditorCover","parent","widget_rate","widget_units","widget_amount","amount_value","MoneyRound","Decimal","mul","toFixed","original_ytd_amount","isNaN","original_amount","new_ytd_amount","sub","total_units","total_amount","total_ytd_amount","net_pay_ytd_amount","total_units_blank","current_units","isNumeric","current_total_amount","current_ytd_total","calcTransactionTotals","WidgetNamesDic","NO_RESULT_BOX","NoResultBox","related_view_controller","message","insideTransactionEditorAddRow","height","parent_id","insideTransactionEditorRemoveRow","isObject","form_item_record","current","difference","color","transaction","allowed_statuses","form_item_remittance_destination_account_input","default_args","form_item_remittance_destination_account_text","remittance_destination_account","note","form_item_status_input","form_item_status_text","status","form_item_transaction_date_input","form_item_confirmation_number_text","minus_icon","click","parents","buildSearchFields","search_fields","SearchField","in_column","multiple","basic_search","adv_search","form_item_type","APIUserTitle","tree_mode","APIBranch","APIDepartment","onNavigationClick","edit_record","noRefreshUI","ids","user_ids","pay_period_ids","pay_period_id","grid_selected_row","getRecordFromGridById","post_data","0","1","2","doFormIFrameCall","iconName","base_date","IndexViewController","addViewTab","window","location","href","goToView","include_users","include_user_ids","select_date","openWizard","3","TFeedback","source","delay","onExportClick","openWizardController","onReportPrintClick","postData","APIFileDownload","className"],"mappings":"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","file":"payroll-pay_stub-PayStubViewController.bundle.js?v=88d9028a0dee98590c98","sourcesContent":["import { Decimal } from 'decimal.js';\n\nexport class PayStubViewController extends BaseViewController {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\tel: '#pay_stub_view_container',\n\n\t\t\tfiltered_status_array: null,\n\t\t\tuser_status_array: null,\n\t\t\tuser_group_array: null,\n\t\t\tuser_destination_account_array: null,\n\t\t\tcurrency_array: null,\n\t\t\ttype_array: null,\n\n\t\t\tcountry_array: null,\n\t\t\tprovince_array: null,\n\n\t\t\te_province_array: null,\n\n\t\t\tuser_api: null,\n\t\t\tuser_group_api: null,\n\t\t\tcompany_api: null,\n\n\t\t\tpay_stub_entry_api: null,\n\n\t\t\tinclude_pay_stub_accounts: true,\n\t\t\ttransaction_status_array: false,\n\n\t\t\tnet_pay_amount: false,\n\n\t\t\tpseal_link: false,\n\n\t\t\toriginal_status_id: 10\n\t\t} );\n\n\t\tsuper( options );\n\t}\n\n\tinit( options ) {\n\t\t//this._super('initialize', options );\n\t\tthis.edit_view_tpl = 'PayStubEditView.html';\n\t\tthis.permission_id = 'pay_stub';\n\t\tthis.viewId = 'PayStub';\n\t\tthis.script_name = 'PayStubView';\n\t\tthis.table_name_key = 'pay_stub';\n\t\tthis.context_menu_name = $.i18n._( 'Pay Stub' );\n\t\tthis.navigation_label = $.i18n._( 'Pay Stubs' ) + ':';\n\t\tthis.api = TTAPI.APIPayStub;\n\t\tthis.user_api = TTAPI.APIUser;\n\t\tthis.pay_stub_entry_api = TTAPI.APIPayStubEntry;\n\t\tthis.pay_stub_entry_account_link_api = TTAPI.APIPayStubEntryAccountLink;\n\t\tthis.user_group_api = TTAPI.APIUserGroup;\n\t\tthis.company_api = TTAPI.APICompany;\n\t\tthis.pay_period_api = TTAPI.APIPayPeriod;\n\t\tthis.pay_stub_transaction_api = TTAPI.APIPayStubTransaction;\n\t\tthis.remittance_destination_account_api = TTAPI.APIRemittanceDestinationAccount;\n\n\t\tvar $this = this;\n\t\t$.when(\n\t\t\tthis.preloadTransactionOptions( new $.Deferred() ),\n\t\t\tthis.preloadPayStubAccountLinks( new $.Deferred() )\n\t\t).done( function() {\n\t\t\t$this.completeInit();\n\t\t} );\n\t}\n\n\tisEditMode() {\n\t\tif ( this.is_add || ( this.is_edit && this.original_status_id == 25 ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpreloadTransactionOptions( dfd ) {\n\t\tvar $this = this;\n\t\tthis.pay_stub_transaction_api.getOptions( 'status', false, false, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.transaction_status_array = result.getResult();\n\t\t\t\tdfd.resolve( true );\n\t\t\t}\n\t\t} );\n\n\t\treturn dfd.promise();\n\t}\n\n\tpreloadPayStubAccountLinks( dfd ) {\n\t\tvar $this = this;\n\t\tthis.pay_stub_entry_account_link_api.getPayStubEntryAccountLink( '', false, false, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar data = result.getResult()[0];\n\t\t\t\tif ( data ) {\n\t\t\t\t\t$this.pseal_link = {\n\t\t\t\t\t\ttotal_gross_entry_account_id: false,\n\t\t\t\t\t\ttotal_deductions_entry_account_id: false,\n\t\t\t\t\t\tnet_pay_entry_account_id: false,\n\t\t\t\t\t\tcontributions_entry_account_id: false\n\t\t\t\t\t};\n\n\t\t\t\t\t$this.pseal_link.total_gross_entry_account_id = data.total_gross;\n\t\t\t\t\t$this.pseal_link.total_deductions_entry_account_id = data.total_employee_deduction;\n\t\t\t\t\t$this.pseal_link.net_pay_entry_account_id = data.total_net_pay;\n\t\t\t\t\t$this.pseal_link.contributions_entry_account_id = data.total_employer_deduction;\n\t\t\t\t}\n\t\t\t\tdfd.resolve( true );\n\t\t\t}\n\t\t} );\n\n\t\treturn dfd.promise();\n\t}\n\n\tcompleteInit() {\n\t\tthis.initPermission();\n\t\tthis.render();\n\t\tthis.buildContextMenu();\n\n\t\tthis.initData();\n\t\tthis.setSelectRibbonMenuIfNecessary( 'PayStub' );\n\t}\n\n\tinitPermission() {\n\n\t\tsuper.initPermission();\n\n\t\tif ( PermissionManager.validate( this.permission_id, 'view' ) || PermissionManager.validate( this.permission_id, 'view_child' ) ) {\n\t\t\tthis.show_search_tab = true;\n\t\t} else {\n\t\t\tthis.show_search_tab = false;\n\t\t}\n\t\treturn {};\n\t}\n\n\tinitOptions() {\n\t\tvar $this = this;\n\n\t\tthis.initDropDownOption( 'filtered_status', 'status_id' );\n\t\tthis.initDropDownOption( 'type', 'type_id' );\n\t\tthis.initDropDownOption( 'status', 'user_status_id', this.user_api );\n\t\tthis.initDropDownOption( 'country', 'country', this.company_api );\n\t\tvar result = {};\n\t\tfor ( var i = 1; i <= 128; i++ ) {\n\t\t\tresult[i] = i;\n\t\t}\n\t\t$this.basic_search_field_ui_dic['run_id'].setSourceData( Global.buildRecordArray( result ) );\n\t\t$this.adv_search_field_ui_dic['run_id'].setSourceData( Global.buildRecordArray( result ) );\n\t\tthis.user_group_api.getUserGroup( '', false, false, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tres = res.getResult();\n\n\t\t\t\tres = Global.buildTreeRecord( res );\n\t\t\t\t$this.user_group_array = res;\n\n\t\t\t\tif ( !$this.sub_view_mode && $this.basic_search_field_ui_dic['group_id'] ) {\n\t\t\t\t\t$this.basic_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['group_id'].setSourceData( res );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {\n\t\t\t\tpay_stubs: {\n\t\t\t\t\tlabel: $.i18n._( 'Pay Stubs' ),\n\t\t\t\t\tid: this.script_name + 'Pay Stubs'\n\t\t\t\t}\n\t\t\t},\n\t\t\texclude: [\n\t\t\t\tContextMenuIconName.copy,\n\t\t\t\tContextMenuIconName.save_and_new,\n\t\t\t\tContextMenuIconName.save_and_copy,\n\t\t\t],\n\t\t\tinclude: [\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'TimeSheet' ),\n\t\t\t\t\tid: ContextMenuIconName.timesheet,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.timesheet\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Schedule' ),\n\t\t\t\t\tid: ContextMenuIconName.schedule,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.schedule\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Pay Stub<br>Amendments' ),\n\t\t\t\t\tid: ContextMenuIconName.pay_stub_amendment,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.pay_stub_amendment\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Pay Stub<br>Transactions' ),\n\t\t\t\t\tid: ContextMenuIconName.pay_stub_transaction,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.pay_stub_transaction,\n\t\t\t\t\titems: [],\n\t\t\t\t\tpermission_result: true,\n\t\t\t\t\tpermission: true,\n\t\t\t\t\tsort_order: null\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Edit<br>Employee' ),\n\t\t\t\t\tid: ContextMenuIconName.edit_employee,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.employee\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Edit Pay<br>Period' ),\n\t\t\t\t\tid: ContextMenuIconName.edit_pay_period,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\ticon: Icons.pay_period\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Employee Pay<br>Stubs' ),\n\t\t\t\t\tid: ContextMenuIconName.employee_pay_stubs,\n\t\t\t\t\tgroup: 'pay_stubs',\n\t\t\t\t\ticon: Icons.pay_stubs\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Employer Pay<br>Stubs' ),\n\t\t\t\t\tid: ContextMenuIconName.employer_pay_stubs,\n\t\t\t\t\tgroup: 'pay_stubs',\n\t\t\t\t\ticon: Icons.pay_stubs\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Generate<br>Pay Stub' ),\n\t\t\t\t\tid: ContextMenuIconName.generate_pay_stub,\n\t\t\t\t\tgroup: 'pay_stubs',\n\t\t\t\t\ticon: Icons.process_payroll\n\t\t\t\t},\n\n\t\t\t\t{\n\t\t\t\t\tlabel: $.i18n._( 'Process<br>Transactions' ),\n\t\t\t\t\tid: ContextMenuIconName.direct_deposit,\n\t\t\t\t\tgroup: 'pay_stubs',\n\t\t\t\t\ticon: 'direct_deposit-35x35.png',\n\t\t\t\t\titems: [],\n\t\t\t\t\tpermission_result: true,\n\t\t\t\t\tpermission: true\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tsetDefaultMenu( doNotSetFocus ) {\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Employee&a=edit&id=42411&tab=Wage line 282\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !Global.isSet( doNotSetFocus ) || !doNotSetFocus ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setDefaultMenuAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\t//View icon should be displayed separate from Employee Pay Stub/Employer Pay Stub icons.\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setDefaultMenuMassEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setDefaultMenuDeleteIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setDefaultMenuSaveIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\t\tthis.setDefaultMenuSaveAndContinueIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.pay_stub_amendment:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'pay_stub_amendment' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.pay_stub_transaction:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length, 'pay_stub_transaction' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\t\tthis.setDefaultMenuEditEmployeeIcon( context_btn, grid_selected_length, 'user' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_pay_period:\n\t\t\t\t\tthis.setDefaultMenuEditPayPeriodIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.employee_pay_stubs:\n\t\t\t\tcase ContextMenuIconName.employer_pay_stubs:\n\t\t\t\tcase ContextMenuIconName.print_checks:\n\t\t\t\tcase ContextMenuIconName.direct_deposit:\n\t\t\t\t\tthis.setDefaultMenuReportRelatedIcons( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.generate_pay_stub:\n\t\t\t\t\tthis.setDefaultMenuGeneratePayStubIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetDefaultMenuEditPayPeriodIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( 'pay_period_schedule' ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuEditEmployeeIcon( context_btn, grid_selected_length ) {\n\t\tif ( !this.editChildPermissionValidate( 'user' ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuViewIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( pId === 'punch' || pId === 'schedule' || pId === 'pay_stub_amendment' ) {\n\t\t\tsuper.setDefaultMenuViewIcon( context_btn, grid_selected_length, pId );\n\t\t} else if ( pId === 'pay_stub_transaction' ) {\n\t\t\tif ( PermissionManager.validate( 'pay_stub', 'enabled' )\n\t\t\t\t&& ( PermissionManager.validate( 'pay_stub', 'view' ) || PermissionManager.validate( 'pay_stub', 'view_child' ) ) ) {\n\t\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\t} else {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( !this.viewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\n\t\t\tif ( grid_selected_length > 0 && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\t} else {\n\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetEditMenu() {\n\t\tthis.selectContextMenu();\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tswitch ( id ) {\n\t\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setEditMenuAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setEditMenuMassEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setEditMenuCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setEditMenuDeleteIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setEditMenuDeleteAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\t\tthis.setEditMenuSaveAndContinueIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setEditMenuSaveAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setEditMenuSaveAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setEditMenuSaveAndCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setEditMenuCopyAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.import_icon:\n\t\t\t\t\tthis.setEditMenuImportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn, 'punch' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn, 'schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.pay_stub_amendment:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn, 'pay_stub_amendment' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn, 'user' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit_pay_period:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn, 'pay_period_schedule' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\tcase ContextMenuIconName.employer_pay_stubs:\n\t\t\t\tcase ContextMenuIconName.employee_pay_stubs:\n\t\t\t\tcase ContextMenuIconName.print_checks:\n\t\t\t\tcase ContextMenuIconName.direct_deposit:\n\t\t\t\t\t//this.setEditMenuReportRelatedIcons( context_btn );\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.generate_pay_stub:\n\t\t\t\t\tthis.setEditMenuGeneratePayStubIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetEditMenuViewIcon( context_btn, pId ) {\n\t\tif ( !this.viewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tpayStubReportIconsValidate() {\n\t\tif ( !PermissionManager.validate( 'pay_stub', 'enabled' ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar selected_item = this.getSelectedItem();\n\n\t\tif ( PermissionManager.validate( 'pay_stub', 'view' ) || this.ownerOrChildPermissionValidate( 'pay_stub', 'view_child', selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetDefaultMenuReportRelatedIcons( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.payStubReportIconsValidate() ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length > 0 && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuReportRelatedIcons( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.payStubReportIconsValidate() ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( this.current_edit_record.id && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuGeneratePayStubIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !PermissionManager.checkTopLevelPermission( 'GeneratePayStubs' ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tendOfPayValidate() {\n\t\tif ( PermissionManager.validate( 'pay_period_schedule', 'enabled' ) && PermissionManager.validate( 'pay_period_schedule', 'view' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsetDefaultMenuGeneratePayStubIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !PermissionManager.checkTopLevelPermission( 'GeneratePayStubs' ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tremoveEntryInsideEditorCover() {\n\t\tif ( this.cover && this.cover.length > 0 ) {\n\t\t\tthis.cover.remove();\n\t\t}\n\t\tthis.cover = null;\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\tthis.include_pay_stub_accounts = true;\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'country':\n\t\t\t\t\t\tthis.setCountryValue( widget, key );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'status_id':\n\t\t\t\t\t\tif ( this.current_edit_record[key] == 40 || this.current_edit_record[key] == 100 ) {\n\t\t\t\t\t\t\tthis.include_pay_stub_accounts = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetEditViewDataDone() {\n\t\tsuper.setEditViewDataDone();\n\n\t\tif ( this.is_add ) {\n\t\t\tthis.edit_view_ui_dic.user_id.setEnabled( true );\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic.user_id.setEnabled( false );\n\t\t}\n\n\t\tif ( !this.is_mass_editing ) {\n\t\t\tthis.initInsideEntryEditorData();\n\t\t}\n\t}\n\n\tgetPayStubTransactionDefaultData( callback, index ) {\n\t\tthis.pay_stub_transaction_api['get' + this.pay_stub_transaction_api.key_name + 'DefaultData']( {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar data = [];\n\t\t\t\tvar result_data = result.getResult();\n\t\t\t\tresult_data.id = false;\n\n\t\t\t\tdata.push( result_data );\n\n\t\t\t\tcallback( data, index );\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetPayStubTransaction( callback ) {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\t\targs.filter_data.pay_stub_id = TTUUID.isUUID( this.current_edit_record.id ) ? this.current_edit_record.id : ( TTUUID.isUUID( this.copied_record_id ) ? this.copied_record_id : '' );\n\t\tthis.pay_stub_transaction_api['getPayStubTransaction']( args, true, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar result_data = res.getResult();\n\t\t\t\tif ( _.size( result_data ) == 0 ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\tcallback( result_data );\n\t\t\t}\n\t\t} );\n\t}\n\n\tinitInsideTransactionEditorData() {\n\t\tvar $this = this;\n\n\t\tif ( ( !this.current_edit_record || TTUUID.isUUID( this.current_edit_record.id ) == false ) && !this.copied_record_id ) {\n\t\t\tthis.getPayStubTransactionDefaultData( function( data ) {\n\t\t\t\tif ( $this.isEditMode() == true || data.length > 0 ) {\n\t\t\t\t\t$this.editor.insideTransactionEditorSetValue( data );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tthis.getPayStubTransaction( function( data ) {\n\t\t\t\tif ( $this.isEditMode() == true || data.length > 0 ) {\n\t\t\t\t\t$this.editor.insideTransactionEditorSetValue( data );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tinitInsideEntryEditorData() {\n\t\tvar $this = this;\n\t\tvar args = {};\n\t\targs.filter_data = {};\n\n\t\tif ( this.copied_record_id || ( this.current_edit_record && this.current_edit_record.id ) ) {\n\t\t\targs.filter_data.pay_stub_id = TTUUID.isUUID( this.current_edit_record.id ) ? this.current_edit_record.id : this.copied_record_id;\n\t\t\tthis.pay_stub_entry_api['get' + this.pay_stub_entry_api.key_name]( args, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tif ( !$this.edit_view ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar data = $this.handlePayStubEntryData( res.getResult() );\n\n\t\t\t\t\t$this.editor.setValue( data );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tvar data = $this.handlePayStubEntryData();\n\t\t\t$this.editor.setValue( data );\n\t\t}\n\t}\n\n\thandlePayStubEntryData( data ) {\n\n\t\tvar total_rows = {};\n\t\tvar retval = {};\n\t\tif ( data ) {\n\t\t\tfor ( var n in data ) {\n\t\t\t\tvar type_id = data[n].type_id;\n\t\t\t\tif ( type_id == 40 ) {\n\t\t\t\t\tif ( data[n].pay_stub_entry_account_id ) {\n\t\t\t\t\t\tvar newrow = data[n];\n\t\t\t\t\t\tnewrow.total_row = true;\n\t\t\t\t\t\ttotal_rows[data[n].pay_stub_entry_account_id] = newrow[n];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( typeof retval[type_id] == 'undefined' ) {\n\t\t\t\t\t\tretval[type_id] = [];\n\t\t\t\t\t}\n\t\t\t\t\tretval[type_id].push( data[n] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//set blanks where there are no records in any given sections\n\t\tvar type_ids = [10, 20, 30, 50, 80]; //no net pay default row\n\t\tfor ( var t = 0; t < type_ids.length; t++ ) {\n\t\t\tif ( typeof retval[type_ids[t]] == 'undefined' || retval[type_ids[t]].length == 0 ) {\n\t\t\t\tretval[type_ids[t]] = [];\n\t\t\t\tretval[type_ids[t]].push( { type_id: type_ids[t] } );\n\t\t\t}\n\t\t}\n\n\t\t//Fill up the missing total rows.\n\t\tvar gross_total = {};\n\t\tif ( total_rows[this.pseal_link.total_gross_entry_account_id] ) {\n\t\t\tgross_total = total_rows[this.pseal_link.total_gross_entry_account_id];\n\t\t} else {\n\t\t\tgross_total = {\n\t\t\t\ttotal_row: true,\n\t\t\t\ttype_id: 40,\n\t\t\t\tname: $.i18n._( 'Total Gross' ),\n\t\t\t\tpay_stub_entry_account_id: this.pseal_link.total_gross_entry_account_id\n\t\t\t};\n\t\t}\n\t\tretval[10].push( gross_total );\n\n\t\tvar employee_deduction_total = {};\n\t\tif ( total_rows[this.pseal_link.total_deductions_entry_account_id] ) {\n\t\t\temployee_deduction_total = total_rows[this.pseal_link.total_deductions_entry_account_id];\n\t\t} else {\n\t\t\temployee_deduction_total = {\n\t\t\t\ttotal_row: true,\n\t\t\t\ttype_id: 40,\n\t\t\t\tname: $.i18n._( 'Total Deductions' ),\n\t\t\t\tpay_stub_entry_account_id: this.pseal_link.total_deductions_entry_account_id\n\t\t\t};\n\t\t}\n\t\tretval[20].push( employee_deduction_total );\n\n\t\tvar net_pay_total = {};\n\t\tif ( total_rows[this.pseal_link.net_pay_entry_account_id] ) {\n\t\t\tnet_pay_total = total_rows[this.pseal_link.net_pay_entry_account_id];\n\t\t} else {\n\t\t\tnet_pay_total = {\n\t\t\t\t//total_row: true,\n\t\t\t\ttype_id: 40,\n\t\t\t\tname: $.i18n._( 'Net Pay' ),\n\t\t\t\tpay_stub_entry_account_id: this.pseal_link.net_pay_entry_account_id\n\t\t\t};\n\t\t}\n\t\t//Because we don't add empty rows to retval[40], and there should only ever be one row in net pay, we will need to initialize retval[40] here.\n\t\tretval[40] = net_pay_total;\n\n\t\tvar employer_deduction_total = {};\n\t\tif ( total_rows[this.pseal_link.contributions_entry_account_id] ) {\n\t\t\temployer_deduction_total = total_rows[this.pseal_link.contributions_entry_account_id];\n\t\t} else {\n\t\t\temployer_deduction_total = {\n\t\t\t\ttotal_row: true,\n\t\t\t\ttype_id: 40,\n\t\t\t\tname: $.i18n._( 'Employer Total Contributions' ),\n\t\t\t\tpay_stub_entry_account_id: this.pseal_link.contributions_entry_account_id\n\t\t\t};\n\t\t}\n\t\tretval[30].push( employer_deduction_total );\n\n\t\treturn retval;\n\t}\n\n\tinsideEntryEditorSetValue( val ) {\n\t\tvar $this = this;\n\t\tthis.removeAllRows( true );\n\t\tthis.removeCover();\n\n\t\tfunction setEarnings( data ) {\n\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\tvar headerRow = Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorFiveColumnHeader.html' );\n\t\t\tvar args = {\n\t\t\t\tcol1: $.i18n._( 'Earnings' ),\n\t\t\t\tcol2: $.i18n._( 'Note' ),\n\t\t\t\tcol3: $.i18n._( 'Rate' ),\n\t\t\t\tcol4: $.i18n._( 'Hrs/Units' ),\n\t\t\t\tcol5: $.i18n._( 'Amount' ),\n\t\t\t\tcol6: $.i18n._( 'YTD Amount' )\n\t\t\t};\n\n\t\t\tvar template = _.template( headerRow );\n\t\t\t$( render ).append( template( args ) );\n\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t\tfor ( var i = 0; i < _.size( data ); i++ ) {\n\t\t\t\tif ( Global.isSet( data[i] ) ) {\n\t\t\t\t\tvar row = data[i];\n\t\t\t\t\trow.type_id = 10;\n\t\t\t\t\t$this.addRow( row );\n\t\t\t\t}\n\t\t\t}\n\t\t\t$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t}\n\n\t\tfunction setDeductions( data ) {\n\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\tvar headerRow = Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorThreeColumnHeader.html' );\n\t\t\tvar args = {\n\t\t\t\tcol1: $.i18n._( 'Deductions' ),\n\t\t\t\tcol2: $.i18n._( 'Note' ),\n\t\t\t\tcol3: $.i18n._( 'Amount' ),\n\t\t\t\tcol4: $.i18n._( 'YTD Amount' )\n\t\t\t};\n\n\t\t\tvar template = _.template( headerRow );\n\t\t\t$( render ).append( template( args ) );\n\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t\tfor ( var i = 0; i < _.size( data ); i++ ) {\n\t\t\t\tif ( Global.isSet( data[i] ) ) {\n\t\t\t\t\tvar row = data[i];\n\t\t\t\t\trow.type_id = 20;\n\t\t\t\t\t$this.addRow( row );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t$this.rows_widgets_array.push( true );\n\n\t\t}\n\n\t\tfunction setNetPay( data ) {\n\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\tif ( data ) {\n\t\t\t\t// data.type_id = 40;\n\t\t\t\t$this.addRow( data );\n\t\t\t}\n\n\t\t\t$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t$this.rows_widgets_array.push( true );\n\n\t\t}\n\n\t\tfunction setMiscellaneous( data ) {\n\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\tvar headerRow = Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorThreeColumnHeader.html' );\n\t\t\tvar args = {\n\t\t\t\tcol1: $.i18n._( 'Miscellaneous' ),\n\t\t\t\tcol2: $.i18n._( 'Note' ),\n\t\t\t\tcol3: $.i18n._( 'Amount' ),\n\t\t\t\tcol4: $.i18n._( 'YTD Amount' )\n\t\t\t};\n\n\t\t\tvar template = _.template( headerRow );\n\t\t\t$( render ).append( template( args ) );\n\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t\tfor ( var i in data ) {\n\t\t\t\t$this.addRow( data[i] );\n\t\t\t}\n\t\t\t$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t}\n\n\t\tfunction setEmployerContributions( data ) {\n\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\tvar headerRow = Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorThreeColumnHeader.html' );\n\t\t\tvar args = {\n\t\t\t\tcol1: $.i18n._( 'Employer Contributions' ),\n\t\t\t\tcol2: $.i18n._( 'Note' ),\n\t\t\t\tcol3: $.i18n._( 'Amount' ),\n\t\t\t\tcol4: $.i18n._( 'YTD Amount' )\n\t\t\t};\n\n\t\t\tvar template = _.template( headerRow );\n\t\t\t$( render ).append( template( args ) );\n\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t\tfor ( var i = 0; i < _.size( data ); i++ ) {\n\t\t\t\tif ( Global.isSet( data[i] ) ) {\n\t\t\t\t\tvar row = data[i];\n\t\t\t\t\trow.type_id = 30;\n\t\t\t\t\t$this.addRow( row );\n\t\t\t\t}\n\t\t\t}\n\t\t\t$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t}\n\n\t\tfunction setAccrual( data ) {\n\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\tvar headerRow = Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorThreeColumnHeader.html' );\n\t\t\tvar args = {\n\t\t\t\tcol1: $.i18n._( 'Accrual' ),\n\t\t\t\tcol2: $.i18n._( 'Note' ),\n\t\t\t\tcol3: $.i18n._( 'Amount' ),\n\t\t\t\tcol4: $.i18n._( 'Balance' )\n\t\t\t};\n\n\t\t\tvar template = _.template( headerRow );\n\t\t\t$( render ).append( template( args ) );\n\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t\tfor ( var i = 0; i < _.size( data ); i++ ) {\n\t\t\t\tif ( Global.isSet( data[i] ) ) {\n\t\t\t\t\tvar row = data[i];\n\t\t\t\t\trow.type_id = 50;\n\t\t\t\t\t$this.addRow( row );\n\t\t\t\t}\n\t\t\t}\n\t\t\t$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t$this.rows_widgets_array.push( true );\n\t\t}\n\n\t\tif ( this.parent_controller.isEditMode() == true || this.parent_controller.checkForNonHeaderData( val[10] ) ) {\n\t\t\tsetEarnings( val[10] );\n\t\t}\n\n\t\tif ( this.parent_controller.isEditMode() == true || this.parent_controller.checkForNonHeaderData( val[20] ) ) {\n\t\t\tsetDeductions( val[20] );\n\t\t}\n\n\t\tsetNetPay( val[40] );\n\n\t\tif ( this.parent_controller.isEditMode() == true || this.parent_controller.checkForNonHeaderData( val[80] ) ) {\n\t\t\tsetMiscellaneous( val[80] );\n\t\t}\n\n\t\tif ( this.parent_controller.isEditMode() == true || this.parent_controller.checkForNonHeaderData( val[30] ) ) {\n\t\t\tsetEmployerContributions( val[30] );\n\t\t}\n\n\t\tif ( this.parent_controller.isEditMode() == true || this.parent_controller.checkForNonHeaderData( val[50] ) ) {\n\t\t\tsetAccrual( val[50] );\n\t\t}\n\n\t\tvar $parent_controller = this.parent_controller;\n\t\tTTPromise.wait( null, null, function() {\n\t\t\t// render inside pay stub transaction\n\t\t\t$parent_controller.initInsideTransactionEditorData();\n\n\t\t\tif ( $parent_controller.copied_record_id && TTUUID.isUUID( $parent_controller.copied_record_id ) ) {\n\t\t\t\t$parent_controller.copied_record_id = '';\n\t\t\t}\n\t\t} );\n\n\t\tthis.calcTotal();\n\t}\n\n\tcheckForNonHeaderData( data ) {\n\t\tfor ( var n in data ) {\n\t\t\tif ( TTUUID.isUUID( data[n].id ) == true ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tinsideEntryEditorAddRow( data, index ) {\n\t\tvar $this = this;\n\t\tif ( !data ) {\n\t\t\t$this.addRow( {}, index );\n\t\t} else {\n\t\t\tif ( typeof index != 'undefined' && typeof this.rows_widgets_array[index].ytd_amount != 'undefined' && !data['type_id'] ) {\n\t\t\t\tdata['type_id'] = this.rows_widgets_array[index].ytd_amount.attr( 'type_id' );\n\t\t\t}\n\n\t\t\tfunction renderColumns( data, type, index ) {\n\t\t\t\tvar render = $this.getRender(); //get render, should be a table\n\t\t\t\tvar widgets = {}; //Save each row's widgets\n\t\t\t\tvar row; //Get Row render\n\t\t\t\tvar widgetContainer = $( '<div class=\\'widget-h-box\\'></div>' );\n\t\t\t\tvar right_label;\n\t\t\t\tvar args = { filter_data: {} };\n\t\t\t\tvar pay_stub_amendment_id = '', user_expense_id = '';\n\t\t\t\tvar pay_stub_status_id = $this.parent_controller['current_edit_record']['status_id'];\n\n\t\t\t\tvar is_add = false;\n\n\t\t\t\tif ( ( !$this.parent_controller['current_edit_record']['id'] && !$this.parent_controller.copied_record_id ) || ( !data.id ) ) {\n\t\t\t\t\tis_add = true;\n\t\t\t\t}\n\n\t\t\t\tif ( pay_stub_status_id == 40 || pay_stub_status_id == 100 ) {\n\t\t\t\t\tis_add = false;\n\t\t\t\t}\n\n\t\t\t\tif ( TTUUID.isUUID( data['pay_stub_amendment_id'] ) && data['pay_stub_amendment_id'] != TTUUID.zero_id ) {\n\t\t\t\t\tpay_stub_amendment_id = data['pay_stub_amendment_id'];\n\t\t\t\t}\n\t\t\t\tif ( TTUUID.isUUID( data['user_expense_id'] ) && data['user_expense_id'] != TTUUID.zero_id ) {\n\t\t\t\t\tuser_expense_id = data['user_expense_id'];\n\t\t\t\t}\n\n\t\t\t\tif ( $this.parent_controller.copied_record_id ) {\n\t\t\t\t\tpay_stub_amendment_id = '';\n\t\t\t\t\tuser_expense_id = '';\n\t\t\t\t}\n\n\t\t\t\tvar row_enabled = true;\n\t\t\t\t// if the pay_stub_amendment_id and user_expense_id all >0 how to display the right label?\n\t\t\t\tif ( TTUUID.isUUID( pay_stub_amendment_id ) && pay_stub_amendment_id != TTUUID.zero_id ) {\n\t\t\t\t\tright_label = $( '<span class=\\'widget-right-label\\'> (' + $.i18n._( 'Amendment' ) + ')</span>' );\n\t\t\t\t\trow_enabled = false;\n\t\t\t\t} else if ( TTUUID.isUUID( user_expense_id ) && user_expense_id != TTUUID.zero_id ) {\n\t\t\t\t\tright_label = $( '<span class=\\'widget-right-label\\'> (' + $.i18n._( 'Expense' ) + ')</span>' );\n\t\t\t\t\trow_enabled = false;\n\t\t\t\t}\n\n\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\trow = $( Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorFiveColumnRow.html' ) );\n\t\t\t\t} else {\n\t\t\t\t\trow = $( Global.loadWidget( 'views/payroll/pay_stub/PayStubEntryViewInsideEditorThreeColumnRow.html' ) );\n\t\t\t\t}\n\n\t\t\t\t// Pay Stub Account\n\t\t\t\tvar form_item_name_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\t\tform_item_name_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIPayStubEntryAccount,\n\t\t\t\t\twidth: 132,\n\t\t\t\t\tis_static_width: 132,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_PayStubAccount',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tfield: 'pay_stub_entry_name_id'\n\t\t\t\t} );\n\t\t\t\tform_item_name_input.setValue( data.pay_stub_entry_name_id );\n\t\t\t\tform_item_name_input.setEnabled( row_enabled );\n\n\t\t\t\tform_item_name_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.onFormItemChange( target );\n\t\t\t\t} );\n\n\t\t\t\tvar form_item_name_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_name_text.TText( { field: 'name' } );\n\t\t\t\tform_item_name_text.setValue( data.name ? ( ( data['type_id'] != 40 ) ? '  ' + data.name : data.name ) : '' );\n\n\t\t\t\t// Note(description)\n\t\t\t\tvar form_item_note_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_note_input.TTextInput( { field: 'description', width: 300, display_na: false } );\n\t\t\t\tform_item_note_input.setValue( data.description );\n\t\t\t\tform_item_note_input.attr( 'editable', true );\n\n\t\t\t\tvar form_item_note_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_note_text.TText( { field: 'description', display_na: false } );\n\t\t\t\tform_item_note_text.setValue( data.description ? data.description : ' ' );\n\n\t\t\t\t// Rate\n\t\t\t\tvar form_item_rate_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_rate_input.TTextInput( { field: 'rate', width: 60, hasKeyEvent: true } );\n\t\t\t\tform_item_rate_input.setValue( Global.removeTrailingZeros( data.rate ) );\n\t\t\t\tform_item_rate_input.attr( 'editable', true );\n\t\t\t\tform_item_rate_input.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\tform_item_rate_input.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\n\t\t\t\tform_item_rate_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.onFormItemChange( target );\n\t\t\t\t} );\n\n\t\t\t\tvar form_item_rate_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_rate_text.TText( { field: 'rate' } );\n\t\t\t\tform_item_rate_text.setValue( Global.removeTrailingZeros( data.rate ) );\n\n\t\t\t\t// Hrs/Units\n\t\t\t\tvar form_item_units_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_units_input.TTextInput( { field: 'units', width: 60, hasKeyEvent: true } );\n\t\t\t\tform_item_units_input.setValue( Global.removeTrailingZeros( data.units ) );\n\t\t\t\tform_item_units_input.attr( 'editable', true );\n\t\t\t\tform_item_units_input.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\tform_item_units_input.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\t\t\t\tform_item_units_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.onFormItemChange( target );\n\t\t\t\t} );\n\n\t\t\t\tvar form_item_units_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_units_text.TText( { field: 'units' } );\n\t\t\t\tform_item_units_text.setValue( Global.removeTrailingZeros( data.units ) );\n\n\t\t\t\t// Amount\n\t\t\t\tvar form_item_amount_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_amount_input.TTextInput( { field: 'amount', width: 60 } );\n\t\t\t\tform_item_amount_input.setValue( Global.removeTrailingZeros( data.amount ) );\n\n\t\t\t\tform_item_amount_input.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\tform_item_amount_input.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\n\t\t\t\tform_item_amount_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.onFormItemChange( target );\n\t\t\t\t} );\n\n\t\t\t\tvar form_item_amount_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_amount_text.TText( { field: 'amount' } );\n\t\t\t\tform_item_amount_text.setValue( Global.removeTrailingZeros( data.amount ) );\n\n\t\t\t\t// YTD Amount\n\t\t\t\tvar form_item_ytd_amount_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_ytd_amount_text.TText( { field: 'ytd_amount' } );\n\t\t\t\tform_item_ytd_amount_text.setValue( Global.removeTrailingZeros( data.ytd_amount ) );\n\t\t\t\tform_item_ytd_amount_text.attr( {\n\t\t\t\t\t'pay_stub_entry_id': ( data.id && $this.parent_controller.current_edit_record.id ) ? data.id : '',\n\t\t\t\t\t'type_id': data['type_id'],\n\t\t\t\t\t'original_amount': data['amount'] ? data['amount'] : '0.00',\n\t\t\t\t\t'original_ytd_amount': data['ytd_amount'] ? data['ytd_amount'] : '0.00',\n\t\t\t\t\t'pay_stub_entry_name_id': data['pay_stub_entry_name_id'] ? data['pay_stub_entry_name_id'] : null\n\t\t\t\t} );\n\n//\t\t\t\tif ( !$this.parent_controller.copied_record_id ) {\n\t\t\t\tform_item_ytd_amount_text.attr( 'pay_stub_amendment_id', pay_stub_amendment_id );\n\t\t\t\tform_item_ytd_amount_text.attr( 'user_expense_id', user_expense_id );\n//\t\t\t\t}\n\n\t\t\t\tif ( parseFloat( data['ytd_amount'] ) != 0 ) {\n\n\t\t\t\t} else if ( pay_stub_status_id == 40 || pay_stub_status_id == 100 || data.total_row === true ) {\n\t\t\t\t\tform_item_ytd_amount_text.text( '-' );\n\t\t\t\t}\n\n\t\t\t\tif ( data.rate && parseFloat( data.rate ) != 0 && !$this.parent_controller.copied_record_id ) {\n\t\t\t\t\tform_item_amount_input.setReadOnly( true );\n\t\t\t\t} else if ( pay_stub_status_id == 40 || pay_stub_status_id == 100 || data.total_row === true ) {\n\t\t\t\t\tform_item_rate_text.text( '-' );\n\t\t\t\t}\n\n\t\t\t\tif ( data.units && parseFloat( data.units ) != 0 && !$this.parent_controller.copied_record_id ) {\n\t\t\t\t\tform_item_amount_input.setReadOnly( true );\n\t\t\t\t} else if ( pay_stub_status_id == 40 || pay_stub_status_id == 100 || data.total_row === true ) {\n\t\t\t\t\tform_item_units_text.text( '-' );\n\t\t\t\t}\n\n\t\t\t\t// name\n\t\t\t\tif ( type == 40 || data.total_row === true ) {\n\t\t\t\t\tif ( data['type_id'] == 40 || data.total_row === true ) {\n\t\t\t\t\t\tform_item_name_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t}\n\t\t\t\t\twidgets[form_item_name_text.getField()] = form_item_name_text;\n\t\t\t\t\twidgetContainer.append( form_item_name_text );\n\t\t\t\t\twidgetContainer.append( right_label );\n\t\t\t\t\trow.children().eq( 0 ).append( widgetContainer );\n\n\t\t\t\t} else {\n\t\t\t\t\tif ( $this.parent_controller.isEditMode() == true || index ) {\n\n\t\t\t\t\t\tif ( data['type_id'] == 40 || data.total_row === true ) {\n\t\t\t\t\t\t\tform_item_name_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t\twidgets[form_item_name_text.getField()] = form_item_name_text;\n\t\t\t\t\t\t\twidgetContainer.append( form_item_name_text );\n\t\t\t\t\t\t\twidgetContainer.append( right_label );\n\t\t\t\t\t\t\trow.children().eq( 0 ).append( widgetContainer );\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\targs['filter_data']['type_id'] = [type];\n\t\t\t\t\t\t\tform_item_name_input.setDefaultArgs( args );\n\t\t\t\t\t\t\twidgets[form_item_name_input.getField()] = form_item_name_input;\n\t\t\t\t\t\t\twidgetContainer.append( form_item_name_input );\n\t\t\t\t\t\t\twidgetContainer.append( right_label );\n\t\t\t\t\t\t\trow.children().eq( 0 ).append( widgetContainer );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( data['type_id'] == 40 || data.total_row === true ) {\n\t\t\t\t\t\t\tform_item_name_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidgets[form_item_name_text.getField()] = form_item_name_text;\n\t\t\t\t\t\twidgetContainer.append( form_item_name_text );\n\t\t\t\t\t\twidgetContainer.append( right_label );\n\t\t\t\t\t\trow.children().eq( 0 ).append( widgetContainer );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Note\n\t\t\t\tif ( ( data['type_id'] == type.toString() || data['type_id'] === type ) && type != 40 && !data.total_row ) {\n\t\t\t\t\tif ( $this.parent_controller.isEditMode() == true ) {\n\t\t\t\t\t\tif ( ( ( TTUUID.isUUID( pay_stub_amendment_id ) && pay_stub_amendment_id != TTUUID.zero_id ) || ( TTUUID.isUUID( user_expense_id ) && user_expense_id != TTUUID.zero_id ) ) ) {\n\t\t\t\t\t\t\tform_item_note_input.setReadOnly( true );\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidgets[form_item_note_input.getField()] = form_item_note_input;\n\t\t\t\t\t\trow.children().eq( 1 ).append( form_item_note_input );\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\twidgets[form_item_note_text.getField()] = form_item_note_text;\n\t\t\t\t\t\trow.children().eq( 1 ).append( form_item_note_text );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( Global.isSet( index ) || is_add || ( _.size( data ) === 1 && ( $this.parent_controller.isEditMode() == true ) ) ) {\n\t\t\t\t\t\tif ( ( data['type_id'] == 40 || data.total_row === true ) ) {\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twidgets[form_item_note_input.getField()] = form_item_note_input;\n\t\t\t\t\t\t\trow.children().eq( 1 ).append( form_item_note_input );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( type == 20 || type == 30 || type == 50 || type == 80 ) {\n\t\t\t\t\t\twidgets[form_item_note_text.getField()] = form_item_note_text;\n\t\t\t\t\t\trow.children().eq( 1 ).append( form_item_note_text );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// amount\n\t\t\t\tif ( ( data['type_id'] === type.toString() || data['type_id'] === type ) && type != 40 && !data.total_row ) {\n\t\t\t\t\tif ( $this.parent_controller.isEditMode() == true ) {\n\t\t\t\t\t\tif ( ( TTUUID.isUUID( pay_stub_amendment_id ) && pay_stub_amendment_id != TTUUID.zero_id ) || ( TTUUID.isUUID( user_expense_id ) && user_expense_id != TTUUID.zero_id ) ) {\n\t\t\t\t\t\t\tform_item_amount_input.setReadOnly( true );\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidgets[form_item_amount_input.getField()] = form_item_amount_input;\n\t\t\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\t\t\trow.children().eq( 4 ).append( form_item_amount_input );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_amount_input );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\twidgets[form_item_amount_text.getField()] = form_item_amount_text;\n\t\t\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\t\t\trow.children().eq( 4 ).append( form_item_amount_text );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_amount_text );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( ( Global.isSet( index ) || is_add || ( _.size( data ) === 1 && ( $this.parent_controller.isEditMode() == true ) ) ) && type != 40 && !data.total_row ) {\n\n\t\t\t\t\t\tif ( data['type_id'] == 40 ) {\n\t\t\t\t\t\t\tform_item_amount_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t\twidgets[form_item_amount_text.getField()] = form_item_amount_text;\n\t\t\t\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\t\t\t\trow.children().eq( 4 ).append( form_item_amount_text );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_amount_text );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twidgets[form_item_amount_input.getField()] = form_item_amount_input;\n\t\t\t\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\t\t\t\trow.children().eq( 4 ).append( form_item_amount_input );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_amount_input );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( ( data['type_id'] == 40 || data.total_row ) && type == 30 ) {\n\t\t\t\t\t\t\tform_item_amount_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tform_item_amount_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\twidgets[form_item_amount_text.getField()] = form_item_amount_text;\n\t\t\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\t\t\trow.children().eq( 4 ).append( form_item_amount_text );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_amount_text );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Ytd amount\n\t\t\t\tif ( data['type_id'] == 40 || data.total_row ) {\n\t\t\t\t\tform_item_ytd_amount_text.css( 'font-weight', 'bold' );\n\t\t\t\t}\n\t\t\t\tif ( ( Global.isSet( index ) || is_add || _.size( data ) === 1 ) && type != 40 ) {\n\t\t\t\t\tform_item_ytd_amount_text.text( '-' );\n\t\t\t\t}\n\t\t\t\twidgets[form_item_ytd_amount_text.getField()] = form_item_ytd_amount_text;\n\t\t\t\tif ( type == 10 ) {\n\t\t\t\t\trow.children().eq( 5 ).append( form_item_ytd_amount_text );\n\t\t\t\t} else {\n\t\t\t\t\trow.children().eq( 3 ).append( form_item_ytd_amount_text );\n\t\t\t\t}\n\n\t\t\t\tif ( type == 10 ) { // && !data.total_row ) {\n\n\t\t\t\t\t// rate\n\t\t\t\t\tif ( data['type_id'] == 10 && !data.total_row ) {\n\t\t\t\t\t\tif ( $this.parent_controller.isEditMode() == true ) {\n\t\t\t\t\t\t\tif ( ( TTUUID.isUUID( pay_stub_amendment_id ) && pay_stub_amendment_id != TTUUID.zero_id ) || ( TTUUID.isUUID( user_expense_id ) && user_expense_id != TTUUID.zero_id ) ) {\n\t\t\t\t\t\t\t\tform_item_rate_input.setReadOnly( true );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twidgets[form_item_rate_input.getField()] = form_item_rate_input;\n\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_rate_input );\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twidgets[form_item_rate_text.getField()] = form_item_rate_text;\n\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_rate_text );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( Global.isSet( index ) || is_add ) {\n\t\t\t\t\t\t\tif ( data['type_id'] == 40 || data.total_row ) {\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidgets[form_item_rate_input.getField()] = form_item_rate_input;\n\t\t\t\t\t\t\t\trow.children().eq( 2 ).append( form_item_rate_input );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// units\n\t\t\t\t\tif ( data['type_id'] == 10 && !data.total_row ) {\n\t\t\t\t\t\tif ( $this.parent_controller.isEditMode() == true ) {\n\t\t\t\t\t\t\tif ( ( TTUUID.isUUID( pay_stub_amendment_id ) && pay_stub_amendment_id != TTUUID.zero_id ) || ( TTUUID.isUUID( user_expense_id ) && user_expense_id != TTUUID.zero_id ) ) {\n\t\t\t\t\t\t\t\tform_item_units_input.setReadOnly( true );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twidgets[form_item_units_input.getField()] = form_item_units_input;\n\t\t\t\t\t\t\trow.children().eq( 3 ).append( form_item_units_input );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twidgets[form_item_units_text.getField()] = form_item_units_text;\n\t\t\t\t\t\t\trow.children().eq( 3 ).append( form_item_units_text );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( Global.isSet( index ) || is_add ) {\n\n\t\t\t\t\t\t\tif ( data['type_id'] == 40 || data.total_row ) {\n\t\t\t\t\t\t\t\tform_item_units_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t\t\twidgets[form_item_units_text.getField()] = form_item_units_text;\n\t\t\t\t\t\t\t\trow.children().eq( 3 ).append( form_item_units_text );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidgets[form_item_units_input.getField()] = form_item_units_input;\n\t\t\t\t\t\t\t\trow.children().eq( 3 ).append( form_item_units_input );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tform_item_units_text.css( 'font-weight', 'bold' );\n\t\t\t\t\t\t\twidgets[form_item_units_text.getField()] = form_item_units_text;\n\t\t\t\t\t\t\trow.children().eq( 3 ).append( form_item_units_text );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//Build row widgets\n\t\t\t\tif ( ( TTUUID.isUUID( pay_stub_amendment_id ) && pay_stub_amendment_id != TTUUID.zero_id ) || ( TTUUID.isUUID( user_expense_id ) && user_expense_id != TTUUID.zero_id ) ) {\n\t\t\t\t\trow.children().last().find( '.minus-icon ' ).hide();\n\t\t\t\t}\n\n\t\t\t\tif ( data['total_row'] == true ) {\n\t\t\t\t\twidgets['total_row'] = true;\n\t\t\t\t}\n\n\t\t\t\tif ( typeof data['type_id'] != 'undefined' ) {\n\t\t\t\t\twidgets['type_id'] = data['type_id'];\n\t\t\t\t}\n\n\t\t\t\tif ( data['pay_stub_entry_account_id'] == $this.parent_controller.pseal_link.net_pay_entry_account_id ) {\n\t\t\t\t\twidgets['pay_stub_entry_account_id'] = $this.parent_controller.pseal_link.net_pay_entry_account_id;\n\t\t\t\t}\n\n\t\t\t\tif ( typeof index !== 'undefined' ) {\n\t\t\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\t\t\t$this.rows_widgets_array.splice( ( index + 1 ), 0, widgets );\n\n\t\t\t\t} else {\n\t\t\t\t\t$( render ).append( row );\n\t\t\t\t\t$this.rows_widgets_array.push( widgets );\n\t\t\t\t}\n\n\t\t\t\tif ( $this.parent_controller.isEditMode() == true ) {\n\t\t\t\t\t$this.addIconsEvent( row ); //Bind event to add and minus icon\n\t\t\t\t} else {\n\t\t\t\t\trow.children().last().empty();\n\t\t\t\t}\n\n\t\t\t\tif ( data.total_row || data.type_id == 40 ) {\n\t\t\t\t\trow.find( '.plus-icon' ).remove();\n\t\t\t\t\trow.find( '.minus-icon' ).remove();\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( data['type_id'] == 10 ) {\n\t\t\t\trenderColumns( data, 10, index );\n\t\t\t} else if ( data['type_id'] == 20 ) {\n\t\t\t\trenderColumns( data, 20, index );\n\t\t\t} else if ( data['type_id'] == 30 ) {\n\t\t\t\trenderColumns( data, 30, index );\n\t\t\t} else if ( data['type_id'] == 40 ) {\n\t\t\t\trenderColumns( data, 40, index );\n\t\t\t} else if ( data['type_id'] == 50 ) {\n\t\t\t\trenderColumns( data, 50, index );\n\t\t\t} else if ( data['type_id'] == 80 ) {\n\t\t\t\trenderColumns( data, 80, index );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinsideEntryEditorRemoveRow( row ) {\n\t\tvar index = row[0].rowIndex;\n\t\tif ( this.rows_widgets_array[index].ytd_amount ) {\n\t\t\tvar remove_id = this.rows_widgets_array[index].ytd_amount.attr( 'pay_stub_entry_id' );\n\t\t\tvar type_id = this.rows_widgets_array[index].ytd_amount.attr( 'type_id' );\n\t\t\tif ( TTUUID.isUUID( remove_id ) ) {\n\t\t\t\tthis.delete_ids.push( remove_id );\n\t\t\t}\n\t\t\trow.remove();\n\t\t\tif ( this.rows_widgets_array[index - 1] === true && ( this.rows_widgets_array[index + 1]['total_row'] === true || this.rows_widgets_array[index + 1] === true ) ) {\n\t\t\t\tthis.addRow( { id: '', type_id: type_id }, index - 1 );\n\t\t\t\tthis.rows_widgets_array.splice( index + 1, 1 ); //Remove from the array used in calcTotal()\n\t\t\t} else {\n\t\t\t\tthis.rows_widgets_array.splice( index, 1 ); //Remove from the array used in calcTotal()\n\t\t\t}\n\n\t\t}\n\t\tthis.calcTotal();\n\t}\n\n\tsavePayStub( record, callbackFunction ) {\n\t\t// when the user create a new pay stub record have them can send entries to api.\n\t\tif ( this.include_pay_stub_accounts ) {\n\t\t\tvar entries = this.saveInsideEntryEditorData();\n\t\t\tvar transactions = this.saveInsideTransactionEditorData();\n\t\t\tif ( entries.length > 0 ) {\n\t\t\t\trecord['entries'] = entries;\n\t\t\t}\n\t\t\tif ( transactions.length > 0 ) {\n\t\t\t\trecord['transactions'] = transactions;\n\t\t\t}\n\t\t}\n\t\tcallbackFunction();\n\t}\n\n\tonSaveClick( ignoreWarning ) {\n\t\tif ( this.is_mass_editing ) {\n\t\t\tthis.include_pay_stub_accounts = false;\n\t\t}\n\t\tsuper.onSaveClick( ignoreWarning );\n\t}\n\n\tdoSaveAPICall( record, ignoreWarning, callback ) {\n\t\tthis.savePayStub( record, () => {\n\t\t\tsuper.doSaveAPICall( record, true, callback );\n\t\t} );\n\t}\n\n\tonSaveDone( result ) {\n\t\tthis.current_edit_record = null;\n\t\treturn true;\n\t}\n\n\tsaveInsideTransactionEditorData( callBack ) {\n\t\t//called by validation function\n\t\tvar $this = this;\n\t\tvar data = this.editor.insideTransactionEditorGetValue( $this.current_edit_record.id ? $this.current_edit_record.id : '' );\n\n\t\tif ( this.editor.delete_transaction_ids.length > 0 ) {\n\t\t\tfor ( var i = 0; i < this.editor.delete_transaction_ids.length; i++ ) {\n\t\t\t\tfor ( var n = 0; n < data.length; n++ ) {\n\t\t\t\t\tif ( this.editor.delete_transaction_ids[i] == data[n].id ) {\n\t\t\t\t\t\tdata[n].deleted = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t}\n\n\tonCopyAsNewClick() {\n\t\tvar $this = this;\n\t\tvar reload_entries = false;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\t\tif ( Global.isSet( this.edit_view ) ) {\n//\t\t\tfor ( var i = 0; i < this.editor.rows_widgets_array.length; i++ ) {\n//\t\t\t\tif ( this.editor.rows_widgets_array[i] === true ) {\n//\t\t\t\t\tcontinue;\n//\t\t\t\t}\n//\t\t\t\tthis.editor.rows_widgets_array[i].ytd_amount.attr( 'pay_stub_entry_id', '' );\n//\t\t\t\tthis.editor.rows_widgets_array[i].ytd_amount.removeAttr( 'pay_stub_amendment_id' );\n//\t\t\t\tthis.editor.rows_widgets_array[i].ytd_amount.removeAttr( 'user_expense_id' );\n//\t\t\t}\n\t\t\tthis.copied_record_id = this.current_edit_record.id;\n\t\t\tthis.current_edit_record.id = '';\n\n\t\t\tthis.edit_view_ui_dic.user_id.setEnabled( true );\n\t\t\tif ( this.current_edit_record.status_id != 25 ) {\n\t\t\t\tthis.current_edit_record.status_id = 25;\n\t\t\t\tthis.edit_view_ui_dic.status_id.setValue( 25 );\n//\t\t\t\tthis.editor.show_cover = false;\n//\t\t\t\tthis.include_pay_stub_accounts = true;\n//\t\t\t\treload_entries = true;\n\t\t\t}\n\t\t\tthis.editor.show_cover = false;\n//\t\t\tthis.editor.removeCover();\n\n\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\t\t\tnavigation_div.css( 'display', 'none' );\n\t\t\tthis.setEditMenu();\n\t\t\tthis.setTabStatus();\n\t\t\tthis.is_changed = false;\n\t\t\t// reset the entries data.\n//\t\t\tif ( reload_entries ) {\n\t\t\tthis.editor.removeAllRows( true );\n\t\t\tthis.initInsideEntryEditorData();\n//\t\t\t}\n\n\t\t\tProgressBar.closeOverlay();\n\n\t\t} else {\n\n\t\t\tvar filter = {};\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\t\tvar selectedId;\n\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tselectedId = grid_selected_id_array[0];\n\n\t\t\t\tfilter.filter_data = {};\n\t\t\t\tfilter.filter_data.id = [selectedId];\n\n\t\t\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.onCopyAsNewResult( result );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'No selected record' ) );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinitEditView() {\n\t\tthis.original_status_id = this.current_edit_record.status_id;\n\t\tsuper.initEditView();\n\t}\n\n\tonSubViewRemoved() {\n\t\tthis.search();\n\n\t\tif ( !this.edit_view ) {\n\t\t\tthis.setDefaultMenu();\n\t\t} else {\n\t\t\tthis.setEditMenu();\n\t\t}\n\t}\n\n\tonCopyAsNewResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = result.getResult();\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist' ) );\n\t\t\t$this.onCancelClick();\n\t\t\treturn;\n\t\t}\n\n\t\t$this.openEditView(); // Put it here is to avoid if the selected one is not existed in data or have deleted by other pragram. in this case, the edit view should not be opend.\n\n\t\tresult_data = result_data[0];\n\t\tthis.copied_record_id = result_data.id;\n\t\tresult_data.id = '';\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\t\tif ( result_data.status_id != 25 ) {\n\t\t\tresult_data.status_id = 25; // If its status is not open then set it to open status.\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.editor.show_cover = false;\n\t\t$this.initEditView();\n\t}\n\n\tonSaveAndContinue( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.is_changed = false;\n\t\tthis.is_add = false;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_continue';\n\t\tvar record = this.current_edit_record;\n\t\tthis.original_status_id = record.status_id;\n\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.savePayStub( record, function() {\n\t\t\t$this.api['set' + $this.api.key_name]( record, false, ignoreWarning, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onSaveAndContinueResult( result );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\tonMassEditClick() {\n\t\tvar $this = this;\n\t\t$this.is_add = false;\n\t\t$this.is_viewing = false;\n\t\t$this.is_mass_editing = true;\n\t\tLocalCacheData.current_doing_context_action = 'mass_edit';\n\t\t$this.openEditView();\n\t\tvar filter = {};\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t$this.mass_edit_record_ids.push( value );\n\t\t} );\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = this.mass_edit_record_ids;\n\n\t\tthis.api['getCommon' + this.api.key_name + 'Data']( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( !result_data ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\t$this.api['getOptions']( 'unique_columns', {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.unique_columns = result.getResult();\n\t\t\t\t\t\t$this.api['getOptions']( 'linked_columns', {\n\t\t\t\t\t\t\tonResult: function( result1 ) {\n\t\t\t\t\t\t\t\t$this.linked_columns = result1.getResult();\n\t\t\t\t\t\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\t\t\t\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$this.current_edit_record = result_data;\n\t\t\t\t\t\t\t\t$this.initEditView();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndContinueResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\t\t\t$this.search( false );\n\t\t\t$this.editor.show_cover = false;\n\t\t\t$this.onEditClick( $this.refresh_id, true );\n\n\t\t\t$this.onSaveAndContinueDone( result );\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t// onSaveAndNextResult( result ) {\n\t// \tvar $this = this;\n\t// \tif ( result.isValid() ) {\n\t// \t\tvar result_data = result.getResult();\n\t// \t\tif ( result_data === true ) {\n\t// \t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t// \t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t// \t\t\t$this.refresh_id = result_data;\n\t// \t\t}\n\t// \t\t$this.editor.show_cover = true;\n\t// \t\t$this.onRightArrowClick();\n\t// \t\t$this.search( false );\n\t// \t\t$this.onSaveAndNextDone( result );\n\t//\n\t// \t} else {\n\t// \t\t$this.setErrorTips( result );\n\t// \t\t$this.setErrorMenu();\n\t// \t}\n\t// },\n\n\tsaveInsideEntryEditorData( callBack ) {\n\t\t//called by validation function\n\t\tvar $this = this;\n\t\tvar data = this.editor.getValue( $this.current_edit_record.id ? $this.current_edit_record.id : '' );\n\n\t\tif ( this.editor.delete_ids.length > 0 ) {\n\t\t\tfor ( var i = 0; i < this.editor.delete_ids.length; i++ ) {\n\t\t\t\tfor ( var n = 0; n < data.length; n++ ) {\n\t\t\t\t\tif ( this.editor.delete_ids[i] == data[n].id ) {\n\t\t\t\t\t\tdata[n].deleted = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif ( callBack && typeof callBack == 'function' ) {\n\t\t\tcallBack();\n\t\t}\n\t\treturn data;\n\t}\n\n\tinsideEntryEditorGetValue( current_edit_item_id ) {\n\t\tvar len = this.rows_widgets_array.length;\n\t\tvar result = [];\n\n\t\tif ( this.cover && this.cover.length > 0 ) {\n\t\t\treturn result;\n\t\t}\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\tvar data = {};\n\n\t\t\tif ( row === true || _.isArray( row ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n//\t\t\tvar pay_stub_amendment_id = row['ytd_amount'].attr( 'pay_stub_amendment_id' );\n//\t\t\tvar user_expense_id = row['ytd_amount'].attr( 'user_expense_id' );\n//\n//\t\t\tif (  pay_stub_amendment_id > 0 || user_expense_id > 0  ) {\n//\t\t\t\tcontinue;\n//\t\t\t}\n\n\t\t\tdata['id'] = row['ytd_amount'].attr( 'pay_stub_entry_id' );\n\n\t\t\tif ( row['ytd_amount'].attr( 'type_id' ) ) {\n\t\t\t\tdata['type'] = row['ytd_amount'].attr( 'type_id' );\n\t\t\t}\n\n\t\t\tdata['rate'] = row['rate'] ? row['rate'].getValue() : '';\n\t\t\tdata['units'] = row['units'] ? row['units'].getValue() : '';\n\t\t\tdata['amount'] = row['amount'] ? row['amount'].getValue() : '';\n\n\t\t\tif ( Global.isSet( row['ytd_amount'] ) ) {\n\t\t\t\tdata['ytd_amount'] = row['ytd_amount'].getValue();\n\t\t\t}\n\n\t\t\tdata['description'] = row['description'] ? row['description'].getValue() : '';\n\n\t\t\tif ( Global.isSet( row['pay_stub_entry_name_id'] ) ) {\n\t\t\t\tdata['pay_stub_entry_name_id'] = row['pay_stub_entry_name_id'].getValue();\n\t\t\t} else {\n\t\t\t\tdata['pay_stub_entry_name_id'] = row['ytd_amount'].attr( 'pay_stub_entry_name_id' );\n\t\t\t}\n\n\t\t\t// return back to the server with the same data get from API.\n\t\t\tdata['pay_stub_amendment_id'] = row['ytd_amount'].attr( 'pay_stub_amendment_id' );\n\t\t\tdata['user_expense_id'] = row['ytd_amount'].attr( 'user_expense_id' );\n\n\t\t\tdata['pay_stub_id'] = current_edit_item_id;\n\t\t\tif ( row['total_row'] != true && TTUUID.isUUID( data['pay_stub_entry_name_id'] )\n\t\t\t\t&& ( data['pay_stub_entry_name_id'] != TTUUID.zero_id\n\t\t\t\t\t|| ( data['description'] != undefined && data['description'].length > 0 )\n\t\t\t\t\t|| ( data['rate'] != undefined && data['rate'].length > 0 && parseFloat( data['rate'] ) != 0 )\n\t\t\t\t\t|| ( data['units'] != undefined && data['units'].length > 0 && parseFloat( data['units'] ) != 0 )\n\t\t\t\t\t|| ( data['amount'] != undefined && data['amount'].length > 0 && parseFloat( data['amount'] ) != 0 )\n\t\t\t\t) ) {\n\t\t\t\tresult.push( data );\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetFilterColumnsFromDisplayColumns() {\n\n\t\tvar column_filter = {};\n\t\tcolumn_filter.is_owner = true;\n\t\tcolumn_filter.id = true;\n\t\tcolumn_filter.user_id = true;\n\t\tcolumn_filter.is_child = true;\n\t\tcolumn_filter.in_use = true;\n\t\tcolumn_filter.first_name = true;\n\t\tcolumn_filter.last_name = true;\n\t\tcolumn_filter.start_date = true;\n\t\tcolumn_filter.end_date = true;\n\t\tcolumn_filter.pay_period_id = true;\n\n\t\t// Error: Unable to get property 'getGridParam' of undefined or null reference\n\t\tvar display_columns = [];\n\t\tif ( this.grid ) {\n\t\t\tdisplay_columns = this.grid.getGridParam( 'colModel' );\n\t\t}\n\n\t\tif ( display_columns ) {\n\t\t\tvar len = display_columns.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar column_info = display_columns[i];\n\t\t\t\tcolumn_filter[column_info.name] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tonFormItemChange( target, doNotValidate ) {\n\t\tvar $this = this;\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tvar c_value = target.getValue();\n\n\t\tthis.current_edit_record[key] = c_value;\n\t\tswitch ( key ) {\n//\t\t\tcase 'status_id':\n//\t\t\t\tif ( c_value == 40 || c_value == 100 ) {\n//\t\t\t\t\tthis.include_pay_stub_accounts = false;\n//\t\t\t\t}\n//\t\t\t\tbreak;\n\t\t\tcase 'user_id':\n\t\t\t\tif ( this.is_add ) {\n\t\t\t\t\tvar transaction_rows = $this.editor.rows_widgets_array[$this.editor.rows_widgets_array.length - 2];\n\t\t\t\t\tvar user_id = $this.edit_view_ui_dic.user_id.getValue();\n\t\t\t\t\tfor ( var t in transaction_rows ) {\n\t\t\t\t\t\tif ( Global.isArray( transaction_rows ) && transaction_rows[t].remittance_destination_account_id ) {\n\t\t\t\t\t\t\ttransaction_rows[t].remittance_destination_account_id.setDefaultArgs( { filter_data: { user_id: user_id } } );\n\t\t\t\t\t\t\ttransaction_rows[t].remittance_destination_account_id.setValue( TTUUID.zero_id );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'country':\n\t\t\t\tvar widget = this.edit_view_ui_dic['province'];\n\t\t\t\twidget.setValue( null );\n\t\t\t\tbreak;\n\t\t\tcase 'pay_period_id':\n\t\t\t\tvar filter = {};\n\t\t\t\tfilter.filter_data = {};\n\t\t\t\tfilter.filter_data.id = c_value;\n\t\t\t\tthis.pay_period_api['get' + this.pay_period_api.key_name]( filter, {\n\t\t\t\t\tonResult: function( res ) {\n\t\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'start_date' of undefined in interface/html5/#!m=PayStub&a=new&tab=PayStub line 1836\n\t\t\t\t\t\tif ( res.isValid() && res.getResult()[0] ) {\n\t\t\t\t\t\t\tvar result = res.getResult()[0];\n\t\t\t\t\t\t\tvar start_date = Global.strToDate( result.start_date ).format();\n\t\t\t\t\t\t\tvar end_date = Global.strToDate( result.end_date ).format();\n\t\t\t\t\t\t\tvar transaction_date = Global.strToDate( result.transaction_date ).format();\n\n\t\t\t\t\t\t\t$this.current_edit_record['start_date'] = start_date;\n\t\t\t\t\t\t\t$this.current_edit_record['end_date'] = end_date;\n\t\t\t\t\t\t\t$this.current_edit_record['transaction_date'] = transaction_date;\n\n\t\t\t\t\t\t\t$this.edit_view_ui_dic['start_date'].setValue( start_date );\n\t\t\t\t\t\t\t$this.edit_view_ui_dic['end_date'].setValue( end_date );\n\t\t\t\t\t\t\t$this.edit_view_ui_dic['transaction_date'].setValue( transaction_date );\n\n\t\t\t\t\t\t\tif ( !doNotValidate ) {\n\t\t\t\t\t\t\t\t$this.validate();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif ( !doNotValidate ) {\n\t\t\t\t\t$this.validate();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ( key === 'country' || key === 'pay_period_id' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\n\t\t}\n\t}\n\n\tonSetSearchFilterFinished() {\n\n\t\tif ( this.search_panel.getSelectTabIndex() === 1 ) {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar select_value = combo.getValue();\n\t\t\tthis.setProvince( select_value );\n\t\t}\n\t}\n\n\tonBuildAdvUIFinished() {\n\n\t\tthis.adv_search_field_ui_dic['country'].change( $.proxy( function() {\n\t\t\tvar combo = this.adv_search_field_ui_dic['country'];\n\t\t\tvar selectVal = combo.getValue();\n\n\t\t\tthis.setProvince( selectVal );\n\n\t\t\tthis.adv_search_field_ui_dic['province'].setValue( null );\n\n\t\t}, this ) );\n\t}\n\n\tsetProvince( val, m ) {\n\t\tvar $this = this;\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.province_array = [];\n\t\t\tthis.adv_search_field_ui_dic['province'].setSourceData( [] );\n\t\t} else {\n\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.province_array = Global.buildRecordArray( res );\n\t\t\t\t\t$this.adv_search_field_ui_dic['province'].setSourceData( $this.province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\teSetProvince( val, refresh ) {\n\t\tvar $this = this;\n\t\tvar province_widget = $this.edit_view_ui_dic['province'];\n\n\t\tif ( !val || val === '-1' || val === '0' ) {\n\t\t\t$this.e_province_array = [];\n\t\t\tprovince_widget.setSourceData( [] );\n\t\t} else {\n\t\t\tthis.company_api.getOptions( 'province', val, {\n\t\t\t\tonResult: function( res ) {\n\t\t\t\t\tres = res.getResult();\n\t\t\t\t\tif ( !res ) {\n\t\t\t\t\t\tres = [];\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.e_province_array = Global.buildRecordArray( res );\n\t\t\t\t\tif ( refresh && $this.e_province_array.length > 0 ) {\n\t\t\t\t\t\t$this.current_edit_record.province = $this.e_province_array[0].value;\n\t\t\t\t\t\tprovince_widget.setValue( $this.current_edit_record.province );\n\t\t\t\t\t}\n\t\t\t\t\tprovince_widget.setSourceData( $this.e_province_array );\n\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tvalidate() {\n\t\tvar $this = this;\n\n\t\tvar record = {};\n\t\tvar transaction_record = {};\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\t\trecord[key] = widget.getValue();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\trecord = this.current_edit_record;\n\t\t}\n\n\t\trecord = this.uniformVariable( record );\n\n\t\tif ( this.include_pay_stub_accounts ) {\n\t\t\tvar entries = $this.saveInsideEntryEditorData();\n\t\t\tvar transactions = $this.saveInsideTransactionEditorData();\n\t\t\tif ( typeof entries == 'object' ) {\n\t\t\t\trecord['entries'] = entries;\n\t\t\t}\n\t\t\tif ( typeof transactions == 'object' ) {\n\t\t\t\trecord['transactions'] = transactions;\n\t\t\t}\n\t\t}\n\n\t\tthis.api['validate' + this.api.key_name]( record, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.validateResult( result );\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildEditViewUI() {\n\t\tsuper.buildEditViewUI();\n\n\t\tvar $this = this;\n\n\t\tvar tab_model = {\n\t\t\t'tab_pay_stub': { 'label': $.i18n._( 'Pay Stub' ) },\n\t\t\t'tab_audit': true,\n\t\t};\n\t\tthis.setTabModel( tab_model );\n\n\t\tthis.navigation.AComboBox( {\n\t\t\tapi_class: TTAPI.APIPayStub,\n\t\t\tid: this.script_name + '_navigation',\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_pay_stub',\n\t\t\tnavigation_mode: true,\n\t\t\tshow_search_inputs: true\n\t\t} );\n\n\t\tthis.setNavigation();\n\n\t\t//Tab 0 start\n\n\t\tvar tab_pay_stub = this.edit_view_tab.find( '#tab_pay_stub' );\n\n\t\tvar tab_pay_stub_column1 = tab_pay_stub.find( '.first-column' );\n\t\tvar tab_pay_stub_column2 = tab_pay_stub.find( '.second-column' );\n//\t\tvar tab_pay_stub_column3 = tab_pay_stub.find( '.third-column' );\n\n\t\tvar form_item_input;\n\n\t\tthis.edit_view_tabs[0] = [];\n\n\t\tthis.edit_view_tabs[0].push( tab_pay_stub_column1 );\n\n\t\t// Employee\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIUser,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_user',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: false,\n\t\t\tfield: 'user_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Employee' ), form_item_input, tab_pay_stub_column1 );\n\n\t\t// Status\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'status_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.filtered_status_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Status' ), form_item_input, tab_pay_stub_column1 );\n\n\t\t// Type\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\tform_item_input.TComboBox( { field: 'type_id', set_empty: false } );\n\t\tform_item_input.setSourceData( $this.type_array );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Type' ), form_item_input, tab_pay_stub_column1 );\n\n\t\t// Currency\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_currency',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'currency_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Currency' ), form_item_input, tab_pay_stub_column1 );\n\n\t\t// Pay Period\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\n\t\tform_item_input.AComboBox( {\n\t\t\tapi_class: TTAPI.APIPayPeriod,\n\t\t\tallow_multiple_selection: false,\n\t\t\tlayout_name: 'global_Pay_period',\n\t\t\tshow_search_inputs: true,\n\t\t\tset_empty: true,\n\t\t\tfield: 'pay_period_id'\n\t\t} );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Pay Period' ), form_item_input, tab_pay_stub_column2 );\n\n\t\t// Payroll Run\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\tform_item_input.TTextInput( { field: 'run_id', width: 20 } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Payroll Run' ), form_item_input, tab_pay_stub_column2 );\n\n\t\t// Pay Start Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'start_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Pay Start Date' ), form_item_input, tab_pay_stub_column2 );\n\n\t\t// Pay End Date\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'end_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Pay End Date' ), form_item_input, tab_pay_stub_column2 );\n\n\t\t// Payment Date\n\n\t\tform_item_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\n\t\tform_item_input.TDatePicker( { field: 'transaction_date' } );\n\t\tthis.addEditFieldToColumn( $.i18n._( 'Payment Date' ), form_item_input, tab_pay_stub_column2, '' );\n\n\t\t//Inside pay stub entries editor\n\n\t\tvar inside_pay_stub_entry_editor_div = tab_pay_stub.find( '.inside-pay-stub-entry-editor-div' );\n\n\t\tthis.editor = Global.loadWidgetByName( FormItemType.INSIDE_EDITOR );\n\n\t\tthis.editor.InsideEditor( {\n\t\t\taddRow: this.insideEntryEditorAddRow,\n\t\t\tremoveRow: this.insideEntryEditorRemoveRow,\n\t\t\tgetValue: this.insideEntryEditorGetValue,\n\t\t\tsetValue: this.insideEntryEditorSetValue,\n\t\t\tparent_controller: this,\n\t\t\tapi: this.pay_stub_entry_api,\n\t\t\trender: 'views/payroll/pay_stub/PayStubEntryViewInsideEditorRender.html',\n\t\t\trender_args: {},\n\t\t\trow_render: 'views/payroll/pay_stub/PayStubEntryViewInsideEditorRow.html'\n\n\t\t} );\n\n\t\tthis.editor.show_cover = true;\n\t\tthis.editor.delete_transaction_ids = [];\n\t\tthis.editor.removeCover = this.removeEntryInsideEditorCover;\n\t\tthis.editor.onEditClick = this.removeEntryInsideEditorCover;\n\t\tthis.editor.onFormItemKeyUp = function( target ) {\n\t\t\tvar index = target.parent().parent().index();\n\t\t\tvar $this = this;\n\t\t\tvar widget_rate = $this.rows_widgets_array[index]['rate'];\n\t\t\tvar widget_units = $this.rows_widgets_array[index]['units'];\n\t\t\tvar widget_amount = $this.rows_widgets_array[index]['amount'];\n\n\t\t\tif ( target.getValue().length === 0 ) {\n\t\t\t\twidget_amount.setReadOnly( false );\n\t\t\t}\n\t\t\tif ( widget_rate.getValue().length > 0 || widget_units.getValue().length > 0 ) {\n\t\t\t\twidget_amount.setReadOnly( true );\n\t\t\t}\n\n\t\t\tif ( widget_rate.getValue().length > 0 && widget_units.getValue().length > 0 ) {\n\t\t\t\t//widget_amount.setValue( ( parseFloat( widget_rate.getValue() ) * parseFloat( widget_units.getValue() ) ).toFixed( 2 ) );\n\t\t\t\t//var amount_value = Global.MoneyRound( parseFloat( widget_rate.getValue() ) * parseFloat( widget_units.getValue() ) );\n\t\t\t\tvar amount_value = Global.MoneyRound( Decimal( parseFloat( widget_rate.getValue() ) ).mul( parseFloat( widget_units.getValue() ) ).toFixed( 4 ) );\n\t\t\t\tif ( amount_value == 'NaN' || amount_value == 0 || amount_value == '' ) {\n\t\t\t\t\tamount_value = '0.00';\n\t\t\t\t}\n\t\t\t\twidget_amount.setValue( amount_value );\n\t\t\t\tthis.onFormItemChange( widget_amount, true );\n\t\t\t} else {\n\t\t\t\twidget_amount.setValue( '0.00' );\n\t\t\t\tthis.onFormItemChange( widget_amount, true );\n\t\t\t}\n\t\t};\n\t\tthis.editor.onFormItemKeyDown = function( target ) {\n\t\t\tvar index = target.parent().parent().index();\n\t\t\tvar $this = this;\n\t\t\tvar widget = $this.rows_widgets_array[index]['amount'];\n\t\t\tvar widget_rate = $this.rows_widgets_array[index]['rate'];\n\t\t\tvar widget_units = $this.rows_widgets_array[index]['units'];\n\t\t\tif ( widget_rate.getValue().length > 0 && widget_units.getValue().length > 0 ) {\n\n\t\t\t} else {\n\t\t\t\twidget.setValue( '0.00' );\n\t\t\t\tthis.onFormItemChange( widget, true );\n\t\t\t}\n\n\t\t\twidget.setReadOnly( true );\n\t\t};\n\t\tthis.editor.onFormItemChange = function( target, doNotValidate ) {\n\t\t\tvar key = target.getField();\n\t\t\tvar c_value = parseFloat( target.getValue() ? target.getValue() : 0 ); // new value\n\t\t\tvar index = target.parent().parent().index();\n\n\t\t\tif ( key === 'amount' ) {\n\t\t\t\tvar original_ytd_amount = parseFloat( this.rows_widgets_array[index]['ytd_amount'].attr( 'original_ytd_amount' ) );\n\t\t\t\tif ( isNaN( original_ytd_amount ) ) {\n\t\t\t\t\toriginal_ytd_amount = 0.00;\n\t\t\t\t}\n\n\t\t\t\tvar original_amount = parseFloat( this.rows_widgets_array[index]['ytd_amount'].attr( 'original_amount' ) );\n\t\t\t\tif ( isNaN( original_amount ) ) {\n\t\t\t\t\toriginal_amount = 0.00;\n\t\t\t\t}\n\n\t\t\t\tvar new_ytd_amount = Global.removeTrailingZeros( Decimal( original_ytd_amount ).sub( original_amount ).add( c_value ).toFixed( 4 ) );\n\t\t\t\tif ( isNaN( new_ytd_amount ) ) {\n\t\t\t\t\tnew_ytd_amount = 0.00;\n\t\t\t\t}\n\n\t\t\t\tthis.rows_widgets_array[index]['ytd_amount'].setValue( new_ytd_amount != 0 ? new_ytd_amount : '-' );\n\t\t\t\tthis.rows_widgets_array[index]['ytd_amount'].attr( 'original_ytd_amount', new_ytd_amount );\n\t\t\t\tthis.rows_widgets_array[index]['ytd_amount'].attr( 'original_amount', c_value );\n\t\t\t}\n\n\t\t\tif ( doNotValidate ) {\n\n\t\t\t} else {\n\t\t\t\tthis.parent_controller.validate();\n\t\t\t}\n\n\t\t\tthis.calcTotal();\n\t\t};\n\n\t\tthis.editor.calcTotal = function() {\n\t\t\tvar total_units = 0;\n\t\t\tvar total_amount = 0;\n\t\t\tvar total_ytd_amount = 0;\n\t\t\tvar net_pay_amount = 0;\n\t\t\tvar net_pay_ytd_amount = 0;\n\t\t\tvar total_units_blank = true;\n\n\t\t\tfor ( var i = 0; i < this.rows_widgets_array.length; i++ ) {\n\t\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\t\tif ( row === true || _.isArray( row ) ) {\n\t\t\t\t\ttotal_units = 0;\n\t\t\t\t\ttotal_amount = 0;\n\t\t\t\t\ttotal_ytd_amount = 0;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( row['total_row'] === true ) {\n\t\t\t\t\tif ( !Global.isNumeric( total_amount ) ) {\n\t\t\t\t\t\ttotal_amount = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Global.isSet( row['units'] ) ) {\n\t\t\t\t\t\tif ( total_units_blank == false ) {\n\t\t\t\t\t\t\trow['units'].setValue( Global.MoneyRound( total_units ) );\n\t\t\t\t\t\t} else if ( total_units_blank ) {\n\t\t\t\t\t\t\trow['units'].setValue( '-' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trow['amount'].setValue( Global.MoneyRound( parseFloat( total_amount ) ) );\n\t\t\t\t\trow['ytd_amount'].setValue( Global.MoneyRound( parseFloat( total_ytd_amount ) ) );\n\n\t\t\t\t\tif ( row.type_id == 10 ) { // Start with total gross value\n\t\t\t\t\t\tnet_pay_amount = total_amount;\n\t\t\t\t\t\tnet_pay_ytd_amount = total_ytd_amount;\n\t\t\t\t\t} else if ( row.type_id == 20 ) { // Subtract deductions (only)\n\t\t\t\t\t\t//net_pay_amount = net_pay_amount - total_amount;\n\t\t\t\t\t\tnet_pay_amount = Decimal( net_pay_amount ).sub( total_amount ).toFixed( 4 );\n\n\t\t\t\t\t\t//net_pay_ytd_amount = net_pay_ytd_amount - total_ytd_amount;\n\t\t\t\t\t\tnet_pay_ytd_amount = Decimal( net_pay_ytd_amount ).sub( total_ytd_amount ).toFixed( 4 );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.parent_controller.net_pay_amount = net_pay_amount;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( row['pay_stub_entry_account_id'] && row['pay_stub_entry_account_id'] == this.parent_controller.pseal_link.net_pay_entry_account_id ) {\n\t\t\t\t\trow['amount'].setValue( Global.MoneyRound( net_pay_amount ) );\n\t\t\t\t\trow['ytd_amount'].setValue( Global.MoneyRound( net_pay_ytd_amount ) );\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar current_units = 0;\n\t\t\t\tif ( Global.isSet( row['units'] ) && Global.isNumeric( row['units'].getValue() ) ) {\n\t\t\t\t\tcurrent_units = Global.MoneyRound( parseFloat( row['units'].getValue() ) );\n\t\t\t\t\ttotal_units_blank = false;\n\t\t\t\t}\n\n\t\t\t\tvar current_total_amount = 0;\n\t\t\t\tif ( Global.isSet( row['amount'] ) && Global.isNumeric( row['amount'].getValue() ) ) {\n\t\t\t\t\tcurrent_total_amount = parseFloat( row['amount'].getValue() );\n\t\t\t\t\ttotal_units_blank = false;\n\t\t\t\t}\n\n\t\t\t\tvar current_ytd_total = 0;\n\t\t\t\tif ( Global.isSet( row['ytd_amount'] ) && Global.isNumeric( row['ytd_amount'].getValue() ) ) {\n\t\t\t\t\tcurrent_ytd_total = parseFloat( row['ytd_amount'].getValue() );\n\t\t\t\t}\n\n\t\t\t\tif ( total_units_blank == false ) {\n\t\t\t\t\t// total_units = parseFloat( total_units ) + parseFloat( current_units );\n\t\t\t\t\ttotal_units = Decimal( parseFloat( total_units ) ).add( parseFloat( current_units ) ).toFixed( 4 );\n\t\t\t\t} else {\n\t\t\t\t\ttotal_units = '';\n\t\t\t\t}\n\n\t\t\t\tif ( Global.isNumeric( current_total_amount ) ) {\n\t\t\t\t\t// total_amount = total_amount + current_total_amount;\n\t\t\t\t\ttotal_amount = Decimal( total_amount ).add( current_total_amount ).toFixed( 4 );\n\t\t\t\t}\n\n\t\t\t\tif ( Global.isNumeric( current_ytd_total ) ) {\n\t\t\t\t\t// total_ytd_amount = total_ytd_amount + current_ytd_total;\n\t\t\t\t\ttotal_ytd_amount = Decimal( total_ytd_amount ).add( current_ytd_total ).toFixed( 4 );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.calcTransactionTotals();\n\n\t\t};\n\n\t\tthis.editor.insideTransactionEditorSetValue = function( data ) {\n\t\t\t$this = this;\n\t\t\tif ( !this.parent_controller.current_edit_record ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar pay_stub_status_id = this.parent_controller['current_edit_record']['status_id'];\n\t\t\tvar is_add = false;\n\t\t\tif ( !this.parent_controller['current_edit_record']['id'] && !this.parent_controller.copied_record_id ) {\n\t\t\t\tis_add = true;\n\t\t\t}\n\t\t\tif ( !is_add && ( pay_stub_status_id == 25 ) && this.show_cover ) {\n\t\t\t\tthis.cover = Global.loadWidgetByName( WidgetNamesDic.NO_RESULT_BOX );\n\t\t\t\tthis.cover.NoResultBox( {\n\t\t\t\t\trelated_view_controller: this,\n\t\t\t\t\tmessage: $.i18n._( 'Click the Edit icon below to override pay stub amounts' ),\n\t\t\t\t\tis_edit: true\n\t\t\t\t} );\n\t\t\t}\n\t\t\tvar render = this.getRender(); //get render, should be a table\n\t\t\tvar headerRow = Global.loadWidget( 'views/payroll/pay_stub/PayStubTransactionViewInsideEditorColumnHeader.html' );\n\t\t\tvar args = {\n\t\t\t\tcol1: $.i18n._( 'Payment Method' ),\n\t\t\t\tcol2: $.i18n._( 'Note' ),\n\t\t\t\tcol3: $.i18n._( 'Status' ),\n\t\t\t\tcol4: $.i18n._( 'Payment Date' ),\n\t\t\t\tcol5: $.i18n._( 'Amount' )\n\t\t\t};\n\t\t\t$( render ).append( '<tr class=\"tblSepHeader\"><td colspan=\"8\">' + $.i18n._( 'Transactions' ) + '</td></tr>' );\n\n\t\t\tvar template = _.template( headerRow );\n\t\t\t$( render ).append( template( args ) );\n\n\t\t\tthis.rows_widgets_array.push( true );\n\t\t\tif ( _.size( data ) > 0 ) {\n\t\t\t\tfor ( var i = 0; i < _.size( data ); i++ ) {\n\t\t\t\t\tif ( Global.isSet( data[i] ) ) {\n\t\t\t\t\t\tvar row = data[i];\n\t\t\t\t\t\tthis.insideTransactionEditorAddRow( row );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t\tthis.rows_widgets_array.push( true );\n\t\t\t\tif ( this.cover && this.cover.length > 0 ) {\n\t\t\t\t\tthis.cover.css( { width: this.width(), height: this.height() + 30 } );\n\t\t\t\t\tthis.parent().append( this.cover );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.parent_controller.getPayStubTransactionDefaultData( function( data ) {\n\t\t\t\t\t$this.insideTransactionEditorAddRow( data );\n\t\t\t\t\t//$( render ).append( '<tr><td colspan=\"8\"><br></td></tr>' );\n\t\t\t\t\t$this.rows_widgets_array.push( true );\n\t\t\t\t\tif ( $this.cover && $this.cover.length > 0 ) {\n\t\t\t\t\t\t$this.cover.css( { width: $this.width(), height: $this.height() } );\n\t\t\t\t\t\t$this.parent().append( $this.cover );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.calcTransactionTotals();\n\t\t};\n\n\t\tthis.editor.insideTransactionEditorGetValue = function( parent_id ) {\n\t\t\tvar len = this.rows_widgets_array.length;\n\t\t\tvar result = [];\n\n\t\t\tif ( this.cover && this.cover.length > 0 ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar data = {};\n\t\t\t\tif ( _.isArray( this.rows_widgets_array[i] ) ) {\n\t\t\t\t\tvar row = this.rows_widgets_array[i][0];\n\n\t\t\t\t\tif ( !Global.isSet( row['remittance_destination_account_id'] ) || !row['remittance_destination_account_id'].getValue() ) {\n\t\t\t\t\t\tcontinue; //row is not editable but is among those that are.\n\t\t\t\t\t}\n\t\t\t\t\tdata['id'] = row['form_item_record']['id'];\n\t\t\t\t\tdata['remittance_destination_account_id'] = row['remittance_destination_account_id'] ? row['remittance_destination_account_id'].getValue() : TTUUID.zero_id;\n\n\t\t\t\t\tif ( Global.isSet( row['status_id'] ) ) {\n\t\t\t\t\t\tdata['status_id'] = row['status_id'].getValue();\n\t\t\t\t\t}\n\n\t\t\t\t\tdata['transaction_date'] = row['transaction_date'] ? row['transaction_date'].getValue() : '';\n\n\t\t\t\t\tif ( Global.isSet( row['currency_id'] ) ) {\n\t\t\t\t\t\tdata['currency_id'] = row['currency_id'].getValue();\n\t\t\t\t\t}\n\n\t\t\t\t\tdata['note'] = row['note'] ? row['note'].getValue() : '';\n\n\t\t\t\t\tdata['amount'] = row['amount'] ? row['amount'].getValue() : '';\n\n\t\t\t\t\tif ( Global.isSet( row['deleted'] ) && row['deleted'] == 1 ) {\n\t\t\t\t\t\tdata['deleted'] = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdata['deleted'] = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tdata['pay_stub_id'] = parent_id;\n\n\t\t\t\t\tif ( row['total_row'] != true && TTUUID.isUUID( data['remittance_destination_account_id'] )\n\t\t\t\t\t\t&& ( data['remittance_destination_account_id'] != TTUUID.zero_id\n\t\t\t\t\t\t\t|| ( data['note'] != undefined && data['note'].length > 0 )\n\t\t\t\t\t\t\t|| ( data['amount'] != undefined && data['amount'].length > 0 && parseFloat( data['amount'] ) != 0 )\n\t\t\t\t\t\t) ) {\n\t\t\t\t\t\tresult.push( data );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t};\n\n\t\tthis.editor.insideTransactionEditorRemoveRow = function( row ) {\n\t\t\tvar index = row[0].rowIndex - 1;\n\n\t\t\tif ( this.rows_widgets_array[index][0] ) {\n\t\t\t\tthis.rows_widgets_array[index][0]['form_item_record']['deleted'] = 1;\n\t\t\t\tvar remove_id = this.rows_widgets_array[index][0]['form_item_record']['id'];\n\t\t\t}\n\n\t\t\tif ( TTUUID.isUUID( remove_id ) ) {\n\t\t\t\tthis.delete_transaction_ids.push( remove_id );\n\t\t\t} else {\n\t\t\t\t// only remove the row if it was a new row, existing rows (in db) must only be hidden, not removed.\n\t\t\t\tthis.rows_widgets_array.splice( index, 1 );\n\t\t\t}\n\n\t\t\t// hide the row from user view, so we can still query the data during the save operation (api still needs it to know what to delete).\n\t\t\trow.hide();\n\n\t\t\t//count transaction rows.\n\t\t\tvar trows = $( '.paystub_transaction_row:visible' ).length;\n\n\t\t\tif ( trows == 0 ) {\n\t\t\t\t// if all rows removed, make sure we add a blank row in again.\n\t\t\t\tthis.insideTransactionEditorAddRow( {}, index );\n\t\t\t}\n\n\t\t\tthis.parent_controller.validate();\n\t\t\t$this.calcTransactionTotals();\n\n\t\t};\n\n\t\tthis.editor.calcTransactionTotals = function() {\n\t\t\tvar total_amount = 0;\n\n\t\t\tfor ( var i = 0; i < this.rows_widgets_array.length; i++ ) {\n\t\t\t\tvar row = this.rows_widgets_array[i];\n\t\t\t\t//use transaction_date column existence as is transaction flag.\n\t\t\t\tif ( _.isObject( row ) //row is object\n\t\t\t\t\t&& Global.isSet( row[0] )\t//row's object is set.\n\t\t\t\t\t&& Global.isSet( row[0].remittance_destination_account_id ) //row is a pay stub transaction\n\t\t\t\t\t&& Global.isSet( row[0].form_item_record.deleted ) == false //row is not removed\n\t\t\t\t\t&& Global.isSet( row[0].status_id ) //row is not removed\n\t\t\t\t\t&& ( row[0].status_id.getValue() == 10 || row[0].status_id.getValue() == 20 ) //status is valid\n\t\t\t\t) {\n\t\t\t\t\tvar current = parseFloat( row[0].amount.getValue() );\n\t\t\t\t\tif ( isNaN( current ) ) {\n\t\t\t\t\t\tcurrent = 0;\n\t\t\t\t\t}\n\t\t\t\t\ttotal_amount += current;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttotal_amount = Global.MoneyRound( total_amount );\n\n\t\t\t//total_amount = Global.removeTrailingZeros(total_amount);\n\t\t\tvar render = this.getRender();\n\t\t\t$( '.transaction_total_rows' ).remove();\n\n\t\t\tif ( total_amount > 0 ) {\n\t\t\t\t// var difference = Global.removeTrailingZeros( parseFloat( total_amount ) - parseFloat( this.parent_controller.net_pay_amount ) );\n\t\t\t\tvar difference = Global.removeTrailingZeros( Decimal( parseFloat( total_amount ) ).sub( parseFloat( this.parent_controller.net_pay_amount ) ).toFixed( 4 ) );\n\n\t\t\t\tif ( isNaN( difference ) ) {\n\t\t\t\t\tdifference = 0;\n\t\t\t\t}\n\n\t\t\t\tvar color = 'green';\n\t\t\t\tif ( difference != 0 ) {\n\t\t\t\t\tcolor = 'red';\n\t\t\t\t}\n\n\t\t\t\tif ( difference != 0 ) {\n\t\t\t\t\tdifference = Global.MoneyRound( difference );\n\t\t\t\t\t$( render ).append( '<tr class=\"tblDataWhite transaction_total_rows\"><td colspan=\"2\" style=\"text-align:left\"><b>Transaction Total</b></td><td colspan=\"3\"><br></td><td style=\"text-align:right;\"><span>Difference: <i  style=\"color:red;\">' + difference + '</i></b></td><td><b style=\"color:' + color + '\">' + Global.MoneyRound( total_amount ) + '</b></td><td></td></td></tr>' );\n\t\t\t\t} else {\n\t\t\t\t\t$( render ).append( '<tr class=\"tblDataWhite transaction_total_rows\"><td colspan=\"2\" style=\"text-align:left\"><b>Transaction Total</b></td><td colspan=\"4\"><br></td><td><b style=\"color:' + color + '\">' + total_amount + '</b></td><td></td></td></tr>' );\n\t\t\t\t}\n\n\t\t\t\tthis.rows_widgets_array.push( true );\n\t\t\t}\n\t\t};\n\n\t\tthis.editor.insideTransactionEditorAddRow = function( data, index ) {\n\t\t\tvar $this = this;\n\t\t\tif ( _.size( data ) == 0 ) {\n\t\t\t\tthis.parent_controller.getPayStubTransactionDefaultData( function( data ) {\n\t\t\t\t\t$this.insideTransactionEditorAddRow( data, index );\n\t\t\t\t}, index );\n\t\t\t} else {\n\t\t\t\tvar render = $this.getRender();\n\t\t\t\tvar widgets = [];\n\t\t\t\tvar transaction = {};\n\t\t\t\ttransaction.form_item_record = {};\n\t\t\t\tvar row = $( Global.loadWidget( 'views/payroll/pay_stub/PayStubTransactionViewInsideEditorColumnRow.html' ) );\n\t\t\t\tdata = _.isArray( data ) ? data[0] : data;\n\t\t\t\ttransaction.form_item_record.id = ( data.id && $this.parent_controller.current_edit_record.id ) ? data.id : '';\n\t\t\t\tvar pay_stub_status_id = $this.parent_controller.current_edit_record.status_id;\n\t\t\t\tvar is_add = false;\n\t\t\t\tif ( !$this.parent_controller.current_edit_record.id && !$this.parent_controller.copied_record_id ) {\n\t\t\t\t\tis_add = true;\n\t\t\t\t\tdata.status_id = 10; //10=Pending == When using Copy as New force transaction statuses to pending.\n\t\t\t\t}\n\n\t\t\t\t// Destination Account - writable\n\t\t\t\tvar allowed_statuses = [10];\n\t\t\t\tif ( $this.parent_controller.is_add == false ) {\n\t\t\t\t\tallowed_statuses.push( 20 );\n\t\t\t\t}\n\t\t\t\tvar form_item_remittance_destination_account_input = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\t\tform_item_remittance_destination_account_input.AComboBox( {\n\t\t\t\t\tapi_class: TTAPI.APIRemittanceDestinationAccount,\n\t\t\t\t\tallow_multiple_selection: false,\n\t\t\t\t\tlayout_name: 'global_remittance_destination_account',\n\t\t\t\t\tshow_search_inputs: true,\n\t\t\t\t\tset_empty: true,\n\t\t\t\t\tfield: 'remittance_destination_account_id',\n\t\t\t\t\tdefault_args: {\n\t\t\t\t\t\tfilter_data: {\n\t\t\t\t\t\t\tuser_id: $this.parent_controller.current_edit_record.user_id,\n\t\t\t\t\t\t\tstatus_id: allowed_statuses\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tform_item_remittance_destination_account_input.setValue( data.remittance_destination_account_id ? data.remittance_destination_account_id : '' );\n\t\t\t\tform_item_remittance_destination_account_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.parent_controller.validate();\n\t\t\t\t} );\n\n\t\t\t\t// readable\n\t\t\t\tvar form_item_remittance_destination_account_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_remittance_destination_account_text.TText( { field: 'remittance_destination_account' } );\n\t\t\t\tform_item_remittance_destination_account_text.setValue( data.remittance_destination_account ? data.remittance_destination_account : '' );\n\n\t\t\t\t// Note - writable\n\t\t\t\tvar form_item_note_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_note_input.TTextInput( { field: 'note', width: 300, display_na: false } );\n\t\t\t\tform_item_note_input.setValue( data.note );\n\t\t\t\tform_item_note_input.attr( 'editable', true );\n\t\t\t\t//readable\n\t\t\t\tvar form_item_note_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_note_text.TText( { field: 'description', display_na: false } );\n\t\t\t\tform_item_note_text.setValue( data.description );\n\n\t\t\t\t// Transaction Status - writable\n\t\t\t\tvar form_item_status_input = Global.loadWidgetByName( FormItemType.COMBO_BOX );\n\t\t\t\tform_item_status_input.TComboBox( { field: 'status_id', set_empty: false } );\n\t\t\t\tform_item_status_input.setSourceData( $this.parent_controller.transaction_status_array );\n\t\t\t\tform_item_status_input.setValue( data.status_id ? data.status_id : '' );\n\t\t\t\tform_item_status_input.setEnabled( ( LocalCacheData.current_doing_context_action == 'copy_as_new' ) );\n\t\t\t\tform_item_status_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.parent_controller.validate();\n\t\t\t\t} );\n\t\t\t\t// readable\n\t\t\t\tvar form_item_status_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_status_text.TText( { field: 'status' } );\n\t\t\t\tform_item_status_text.setValue( data.status ? data.status : '' );\n\n\t\t\t\t// Transaction Date - writable\n\t\t\t\tvar form_item_transaction_date_input = Global.loadWidgetByName( FormItemType.DATE_PICKER );\n\t\t\t\tform_item_transaction_date_input.TDatePicker( { field: 'transaction_date' } );\n\t\t\t\tform_item_transaction_date_input.setValue( data.transaction_date ? data.transaction_date : '' );\n\t\t\t\tform_item_transaction_date_input.attr( 'editable', true );\n\n\t\t\t\tif ( !data['transaction_date'] ) {\n\t\t\t\t\tform_item_transaction_date_input.setValue( $this.parent_controller.edit_view_ui_dic.transaction_date.getValue() );\n\t\t\t\t}\n\n\t\t\t\tform_item_transaction_date_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.parent_controller.validate();\n\t\t\t\t} );\n\t\t\t\t// readable\n\t\t\t\tvar form_item_confirmation_number_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_confirmation_number_text.TText( { field: 'transaction_date' } );\n\t\t\t\tform_item_confirmation_number_text.setValue( data.transaction_date ? data.transaction_date : '' );\n\n\t\t\t\t// Amount - writable\n\t\t\t\tvar form_item_amount_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\t\tform_item_amount_input.TTextInput( { field: 'amount', width: 60 } );\n\t\t\t\tform_item_amount_input.setValue( data.amount ? Global.removeTrailingZeros( data.amount ) : '' );\n\t\t\t\tform_item_amount_input.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\t\t\t\t\t$this.parent_controller.validate();\n\t\t\t\t\t$this.calcTransactionTotals();\n\t\t\t\t} );\n\t\t\t\tform_item_amount_input.attr( 'editable', true );\n\t\t\t\t// readable\n\t\t\t\tvar form_item_amount_text = Global.loadWidgetByName( FormItemType.TEXT );\n\t\t\t\tform_item_amount_text.TText( { field: 'amount' } );\n\t\t\t\tform_item_amount_text.setValue( data.amount ? Global.removeTrailingZeros( data.amount ) : '' );\n\n\t\t\t\tif ( !data.status_id ) {\n\t\t\t\t\tdata.status_id = 10;\n\t\t\t\t}\n\n\t\t\t\tif ( $this.parent_controller.isEditMode() ) {\n\t\t\t\t\tform_item_remittance_destination_account_input.setEnabled( data.status_id == 10 );\n\t\t\t\t\tform_item_transaction_date_input.setEnabled( data.status_id == 10 );\n\t\t\t\t\tform_item_amount_input.setReadOnly( data.status_id != 10 );\n\t\t\t\t\tform_item_note_input.setReadOnly( data.status_id != 10 );\n\t\t\t\t\t//form_item_status_input.setValue( 10 ); //set to pending\n\t\t\t\t\tform_item_status_input.setEnabled( false );\n\t\t\t\t} else {\n\t\t\t\t\t//status is not pending. disable editing the row.\n\t\t\t\t\tform_item_remittance_destination_account_input.setEnabled( false );\n\t\t\t\t\tform_item_transaction_date_input.setEnabled( false );\n\t\t\t\t\tform_item_amount_input.setEnabled( false );\n\t\t\t\t\tform_item_note_input.setEnabled( false );\n\t\t\t\t\tform_item_status_input.setEnabled( false );\n\t\t\t\t\tform_item_input = form_item_note_text; //only way to hide the N/A is to swap in a Text Field in view mode.\n\t\t\t\t}\n\n\t\t\t\t//actually append the row to the DOM\n\t\t\t\ttransaction[form_item_remittance_destination_account_input.getField()] = form_item_remittance_destination_account_input;\n\t\t\t\trow.children().eq( 0 ).append( form_item_remittance_destination_account_input );\n\n\t\t\t\ttransaction[form_item_note_input.getField()] = form_item_note_input;\n\t\t\t\trow.children().eq( 1 ).append( form_item_note_input );\n\n\t\t\t\ttransaction[form_item_status_input.getField()] = form_item_status_input;\n\t\t\t\trow.children().eq( 2 ).append( form_item_status_input );\n\n\t\t\t\ttransaction[form_item_transaction_date_input.getField()] = form_item_transaction_date_input;\n\t\t\t\trow.children().eq( 3 ).append( form_item_transaction_date_input );\n\n\t\t\t\ttransaction[form_item_amount_input.getField()] = form_item_amount_input;\n\t\t\t\trow.children().eq( 4 ).append( form_item_amount_input );\n\n\t\t\t\twidgets.push( transaction );\n\t\t\t\tif ( typeof index !== 'undefined' ) {\n\t\t\t\t\trow.insertAfter( $( render ).find( 'tr' ).eq( index ) );\n\t\t\t\t\t$this.rows_widgets_array.splice( ( index ), 0, widgets );\n\t\t\t\t} else {\n\t\t\t\t\t$( render ).append( row );\n\t\t\t\t\t$this.rows_widgets_array.push( widgets );\n\t\t\t\t}\n\n\t\t\t\tif ( $this.parent_controller.isEditMode() == true ) {\n\t\t\t\t\tvar minus_icon = row.find( '.minus-icon' );\n\t\t\t\t\tif ( data.status_id != 10 ) {\n\t\t\t\t\t\tminus_icon.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tminus_icon.click( function() {\n\t\t\t\t\t\t\t$this.insideTransactionEditorRemoveRow( row );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\tvar plus_icon = row.find( '.plus-icon' );\n\t\t\t\t\tplus_icon.click( function() {\n\t\t\t\t\t\t$this.insideTransactionEditorAddRow( {}, $( this ).parents( 'tr' ).index() );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\t//#2548 - Do not show plus button in view mode (when paystub is marked paid)\n\t\t\t\t\trow.children().last().find( '.minus-icon' ).remove();\n\t\t\t\t\t//if ( data.status_id != 20 ) {\n\t\t\t\t\trow.children().last().find( '.plus-icon' ).remove();\n\t\t\t\t\t//}\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tinside_pay_stub_entry_editor_div.append( this.editor );\n\t}\n\n\tbuildSearchFields() {\n\t\tsuper.buildSearchFields();\n\t\tthis.search_fields = [\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Pay Stub Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Pay Stub Type' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'type_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee Status' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_status_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Pay Period' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'pay_period_id',\n\t\t\t\tlayout_name: 'global_Pay_period',\n\t\t\t\tapi_class: TTAPI.APIPayPeriod,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Payroll Run' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'run_id',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Employee' ),\n\t\t\t\tin_column: 1,\n\t\t\t\tfield: 'user_id',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Title' ),\n\t\t\t\tfield: 'title_id',\n\t\t\t\tin_column: 1,\n\t\t\t\tlayout_name: 'global_job_title',\n\t\t\t\tapi_class: TTAPI.APIUserTitle,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Currency' ),\n\t\t\t\tfield: 'currency_id',\n\t\t\t\tin_column: 1,\n\t\t\t\tlayout_name: 'global_currency',\n\t\t\t\tapi_class: TTAPI.APICurrency,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Group' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tmultiple: true,\n\t\t\t\tfield: 'group_id',\n\t\t\t\tlayout_name: 'global_tree_column',\n\t\t\t\ttree_mode: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Default Branch' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'default_branch_id',\n\t\t\t\tlayout_name: 'global_branch',\n\t\t\t\tapi_class: TTAPI.APIBranch,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Default Department' ),\n\t\t\t\tfield: 'default_department_id',\n\t\t\t\tin_column: 2,\n\t\t\t\tlayout_name: 'global_department',\n\t\t\t\tapi_class: TTAPI.APIDepartment,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: true,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Country' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'country',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.COMBO_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Province/State' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'province',\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tlayout_name: 'global_option_column',\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'City' ),\n\t\t\t\tfield: 'city',\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tin_column: 2,\n\t\t\t\tform_item_type: FormItemType.TEXT_INPUT\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Created By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'created_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} ),\n\n\t\t\tnew SearchField( {\n\t\t\t\tlabel: $.i18n._( 'Updated By' ),\n\t\t\t\tin_column: 2,\n\t\t\t\tfield: 'updated_by',\n\t\t\t\tlayout_name: 'global_user',\n\t\t\t\tapi_class: TTAPI.APIUser,\n\t\t\t\tmultiple: true,\n\t\t\t\tbasic_search: false,\n\t\t\t\tadv_search: true,\n\t\t\t\tform_item_type: FormItemType.AWESOME_BOX\n\t\t\t} )\n\t\t];\n\t}\n\n\tonCustomContextClick( id ) {\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\tcase ContextMenuIconName.schedule:\n\t\t\tcase ContextMenuIconName.pay_stub_amendment:\n\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\tcase ContextMenuIconName.employee_pay_stubs:\n\t\t\tcase ContextMenuIconName.employer_pay_stubs:\n\t\t\tcase ContextMenuIconName.generate_pay_stub:\n\t\t\tcase ContextMenuIconName.edit_pay_period:\n\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\tcase ContextMenuIconName.pay_stub_transaction:\n\t\t\tdefault:\n\t\t\t\tthis.onNavigationClick( id );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonViewClick( edit_record, noRefreshUI ) {\n\t\tthis.onNavigationClick( ContextMenuIconName.view );\n\t}\n\n\tonReportPrintClick( key ) {\n\t\tvar $this = this;\n\n\t\tvar grid_selected_id_array;\n\n\t\tvar filter = {};\n\n\t\tvar ids = [];\n\n\t\tvar user_ids = [];\n\n\t\tvar base_date;\n\n\t\tvar pay_period_ids = [];\n\n\t\tif ( $this.edit_view && $this.current_edit_record.id ) {\n\t\t\tids.push( $this.current_edit_record.id );\n\t\t\tuser_ids.push( $this.current_edit_record.user_id );\n\t\t\tpay_period_ids.push( $this.current_edit_record.pay_period_id );\n\t\t\tbase_date = $this.current_edit_record.start_date;\n\t\t} else {\n\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t\tvar grid_selected_row = $this.getRecordFromGridById( value );\n\t\t\t\tids.push( grid_selected_row.id );\n\t\t\t\tuser_ids.push( grid_selected_row.user_id );\n\t\t\t\tpay_period_ids.push( grid_selected_row.pay_period_id );\n\t\t\t\tbase_date = grid_selected_row.start_date;\n\t\t\t} );\n\t\t}\n\n\t\tvar args = { filter_data: { id: ids } };\n\t\tvar post_data = { 0: args, 1: true, 2: key };\n\n\t\tthis.doFormIFrameCall( post_data );\n\t}\n\n\tonNavigationClick( iconName ) {\n\n\t\tvar $this = this;\n\n\t\tvar grid_selected_id_array;\n\n\t\tvar filter = {};\n\n\t\tvar ids = [];\n\n\t\tvar user_ids = [];\n\n\t\tvar base_date;\n\n\t\tvar pay_period_ids = [];\n\n\t\tif ( $this.edit_view && $this.current_edit_record.id ) {\n\t\t\tids.push( $this.current_edit_record.id );\n\t\t\tuser_ids.push( $this.current_edit_record.user_id );\n\t\t\tpay_period_ids.push( $this.current_edit_record.pay_period_id );\n\t\t\tbase_date = $this.current_edit_record.start_date;\n\t\t} else {\n\t\t\tgrid_selected_id_array = this.getGridSelectIdArray();\n\t\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t\tvar grid_selected_row = $this.getRecordFromGridById( value );\n\t\t\t\tids.push( grid_selected_row.id );\n\t\t\t\tuser_ids.push( grid_selected_row.user_id );\n\t\t\t\tpay_period_ids.push( grid_selected_row.pay_period_id );\n\t\t\t\tbase_date = grid_selected_row.start_date;\n\t\t\t} );\n\t\t}\n\n\t\tvar args = { filter_data: { id: ids } };\n\n\t\tvar post_data;\n\n\t\tswitch ( iconName ) {\n\t\t\tcase ContextMenuIconName.edit_employee:\n\t\t\t\tif ( user_ids.length > 0 ) {\n\t\t\t\t\tIndexViewController.openEditView( this, 'Employee', user_ids[0] );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.edit_pay_period:\n\t\t\t\tif ( pay_period_ids.length > 0 ) {\n\t\t\t\t\tIndexViewController.openEditView( this, 'PayPeriods', pay_period_ids[0] );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.timesheet:\n\t\t\t\tif ( user_ids.length > 0 ) {\n\t\t\t\t\tfilter.user_id = user_ids[0];\n\t\t\t\t\tfilter.base_date = base_date;\n\t\t\t\t\tGlobal.addViewTab( $this.viewId, $.i18n._( 'Pay Stubs' ), window.location.href );\n\t\t\t\t\tIndexViewController.goToView( 'TimeSheet', filter );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.schedule:\n\t\t\t\tfilter.filter_data = {};\n\t\t\t\tvar include_users = { value: user_ids };\n\t\t\t\tfilter.filter_data.include_user_ids = include_users;\n\t\t\t\tfilter.select_date = base_date;\n\t\t\t\tGlobal.addViewTab( this.viewId, $.i18n._( 'Pay Stubs' ), window.location.href );\n\t\t\t\tIndexViewController.goToView( 'Schedule', filter );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.pay_stub_amendment:\n\t\t\t\tfilter.filter_data = {};\n\t\t\t\tfilter.filter_data.user_id = user_ids[0];\n\t\t\t\tfilter.filter_data.pay_period_id = pay_period_ids[0];\n\t\t\t\tGlobal.addViewTab( this.viewId, $.i18n._( 'Pay Stubs' ), window.location.href );\n\t\t\t\tIndexViewController.goToView( 'PayStubAmendment', filter );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.generate_pay_stub:\n\n\t\t\t\tif ( user_ids.length === 1 ) {\n\t\t\t\t\tfilter.user_id = user_ids[0];\n\t\t\t\t} else if ( user_ids.length > 1 ) {\n\t\t\t\t\tfilter.user_id = user_ids;\n\t\t\t\t}\n\n\t\t\t\tif ( pay_period_ids.length === 1 ) {\n\t\t\t\t\tfilter.pay_period_id = [pay_period_ids[0]];\n\t\t\t\t} else if ( pay_period_ids.length > 1 ) {\n\t\t\t\t\tfilter.pay_period_id = pay_period_ids;\n\t\t\t\t} else {\n\t\t\t\t\tfilter.pay_period_id = [];\n\t\t\t\t}\n\n\t\t\t\tIndexViewController.openWizard( 'GeneratePayStubWizard', filter, function() {\n\t\t\t\t\t$this.search();\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.view:\n\t\t\t\tpost_data = { 0: args, 1: false, 2: 'pdf', 3: true };\n\t\t\t\tthis.doFormIFrameCall( post_data );\n\t\t\t\t$().TFeedback( {\n\t\t\t\t\tsource: 'View', // viewId GovernmentDocument will be prepended in TFeedback functions.\n\t\t\t\t\tdelay: 5000\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.employee_pay_stubs:\n\t\t\t\tpost_data = { 0: args, 1: false, 2: 'pdf', 3: true };\n\t\t\t\tthis.doFormIFrameCall( post_data );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.employer_pay_stubs:\n\t\t\t\tpost_data = { 0: args, 1: false, 2: 'pdf', 3: false };\n\t\t\t\tthis.doFormIFrameCall( post_data );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.pay_stub_transaction:\n\t\t\t\tfilter = {};\n\t\t\t\tfilter.filter_data = {};\n\n\t\t\t\tfilter.filter_data.user_id = { value: user_ids };\n\t\t\t\tfilter.filter_data.pay_period_id = { value: pay_period_ids };\n\n\t\t\t\tGlobal.addViewTab( this.viewId, $.i18n._( 'Pay Stubs' ), window.location.href );\n\t\t\t\tIndexViewController.goToView( 'PayStubTransaction', filter );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\tthis.onExportClick( 'export' + this.api.key_name );\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.direct_deposit:\n\t\t\t\tvar data = {\n\t\t\t\t\tfilter_data: {\n\t\t\t\t\t\tpay_stub_id: this.getGridSelectIdArray()\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tIndexViewController.openWizardController( 'ProcessTransactionsWizardController', data );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonReportMenuClick( id ) {\n\t\tthis.onReportPrintClick( id );\n\t}\n\n\tdoFormIFrameCall( postData ) {\n\t\tGlobal.APIFileDownload( this.api.className, 'get' + this.api.key_name, postData );\n\t}\n\n}\n"],"sourceRoot":""}